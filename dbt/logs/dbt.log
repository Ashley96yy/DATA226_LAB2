[0m01:30:34.544132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bbea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94317d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c45a60>]}


============================== 01:30:34.575579 | aea000f1-6adf-40d3-b5d8-644fd596966c ==============================
[0m01:30:34.575579 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:30:34.576365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:30:34.580590 [info ] [MainThread]: dbt version: 1.8.8
[0m01:30:34.580932 [info ] [MainThread]: python version: 3.12.4
[0m01:30:34.581274 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m01:30:34.581705 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m01:30:35.030405 [info ] [MainThread]: Using profiles dir at .
[0m01:30:35.031236 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m01:30:35.031650 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m01:30:35.032250 [info ] [MainThread]: adapter type: snowflake
[0m01:30:35.032542 [info ] [MainThread]: adapter version: 1.8.4
[0m01:30:35.055781 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:30:35.056291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aea000f1-6adf-40d3-b5d8-644fd596966c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff739dac30>]}
[0m01:30:35.060506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fa6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97b1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9222c00>]}


============================== 01:30:35.064735 | 5b4acb80-0324-41dc-8195-d0fa71f1e658 ==============================
[0m01:30:35.064735 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:30:35.065144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:35.068426 [info ] [MainThread]: dbt version: 1.8.8
[0m01:30:35.068700 [info ] [MainThread]: python version: 3.12.4
[0m01:30:35.068930 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m01:30:35.069203 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m01:30:35.070295 [info ] [MainThread]: Configuration:
[0m01:30:35.070744 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:30:35.071040 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:30:35.071385 [info ] [MainThread]: Required dependencies:
[0m01:30:35.071666 [debug] [MainThread]: Executing "git --help"
[0m01:30:35.080251 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:30:35.080610 [debug] [MainThread]: STDERR: "b''"
[0m01:30:35.080836 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:30:35.081200 [info ] [MainThread]: Connection:
[0m01:30:35.081450 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m01:30:35.081639 [info ] [MainThread]:   user: MALLARD
[0m01:30:35.081862 [info ] [MainThread]:   database: ASH_DB
[0m01:30:35.082079 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m01:30:35.082321 [info ] [MainThread]:   role: TRAINING_ROLE
[0m01:30:35.082508 [info ] [MainThread]:   schema: STOCK_RAW
[0m01:30:35.082684 [info ] [MainThread]:   authenticator: None
[0m01:30:35.082898 [info ] [MainThread]:   oauth_client_id: None
[0m01:30:35.083127 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m01:30:35.083398 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:30:35.083625 [info ] [MainThread]:   host: None
[0m01:30:35.083835 [info ] [MainThread]:   port: None
[0m01:30:35.084063 [info ] [MainThread]:   proxy_host: None
[0m01:30:35.084272 [info ] [MainThread]:   proxy_port: None
[0m01:30:35.084468 [info ] [MainThread]:   protocol: None
[0m01:30:35.084682 [info ] [MainThread]:   connect_retries: 1
[0m01:30:35.084916 [info ] [MainThread]:   connect_timeout: None
[0m01:30:35.085222 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:30:35.085490 [info ] [MainThread]:   retry_all: False
[0m01:30:35.085792 [info ] [MainThread]:   insecure_mode: False
[0m01:30:35.086191 [info ] [MainThread]:   reuse_connections: None
[0m01:30:35.086645 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:35.089026 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:30:35.089506 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:30:35.089765 [debug] [MainThread]: On debug: select 1 as id
[0m01:30:35.089987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:35.509005 [info ] [MainThread]: Using profiles dir at .
[0m01:30:35.510344 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m01:30:35.510898 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m01:30:35.512970 [info ] [MainThread]: adapter type: snowflake
[0m01:30:35.513367 [info ] [MainThread]: adapter version: 1.8.4
[0m01:30:35.545267 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:30:35.545724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5b4acb80-0324-41dc-8195-d0fa71f1e658', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ed2f30>]}
[0m01:30:35.562215 [info ] [MainThread]: Configuration:
[0m01:30:35.562642 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:30:35.562937 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:30:35.563247 [info ] [MainThread]: Required dependencies:
[0m01:30:35.563567 [debug] [MainThread]: Executing "git --help"
[0m01:30:35.565010 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:30:35.565304 [debug] [MainThread]: STDERR: "b''"
[0m01:30:35.565581 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:30:35.565854 [info ] [MainThread]: Connection:
[0m01:30:35.566225 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m01:30:35.566479 [info ] [MainThread]:   user: MALLARD
[0m01:30:35.566761 [info ] [MainThread]:   database: ASH_DB
[0m01:30:35.567021 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m01:30:35.567264 [info ] [MainThread]:   role: TRAINING_ROLE
[0m01:30:35.567526 [info ] [MainThread]:   schema: STOCK_RAW
[0m01:30:35.567759 [info ] [MainThread]:   authenticator: None
[0m01:30:35.568013 [info ] [MainThread]:   oauth_client_id: None
[0m01:30:35.568259 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m01:30:35.568556 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:30:35.568798 [info ] [MainThread]:   host: None
[0m01:30:35.569061 [info ] [MainThread]:   port: None
[0m01:30:35.569328 [info ] [MainThread]:   proxy_host: None
[0m01:30:35.569571 [info ] [MainThread]:   proxy_port: None
[0m01:30:35.569812 [info ] [MainThread]:   protocol: None
[0m01:30:35.570055 [info ] [MainThread]:   connect_retries: 1
[0m01:30:35.570287 [info ] [MainThread]:   connect_timeout: None
[0m01:30:35.570564 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:30:35.570833 [info ] [MainThread]:   retry_all: False
[0m01:30:35.571120 [info ] [MainThread]:   insecure_mode: False
[0m01:30:35.571371 [info ] [MainThread]:   reuse_connections: None
[0m01:30:35.571721 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:35.573701 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:30:35.574254 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:30:35.574505 [debug] [MainThread]: On debug: select 1 as id
[0m01:30:35.574729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:36.550982 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.461 seconds
[0m01:30:36.551744 [debug] [MainThread]: On debug: Close
[0m01:30:36.706622 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:30:36.709006 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:30:36.710013 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.2068076, "process_user_time": 1.974084, "process_kernel_time": 0.447677, "process_mem_max_rss": "237508", "process_in_blocks": "29416", "process_out_blocks": "2670"}
[0m01:30:36.710543 [debug] [MainThread]: Command `dbt debug` succeeded at 01:30:36.710475 after 2.21 seconds
[0m01:30:36.710905 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:30:36.711222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bbea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7939f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73993f20>]}
[0m01:30:36.711507 [debug] [MainThread]: Flushing usage events
[0m01:30:36.717363 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.142 seconds
[0m01:30:36.718376 [debug] [MainThread]: On debug: Close
[0m01:30:36.869819 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:30:36.870356 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:30:36.871221 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8501456, "process_user_time": 2.045247, "process_kernel_time": 0.331381, "process_mem_max_rss": "237520", "process_out_blocks": "2174", "process_in_blocks": "0"}
[0m01:30:36.871689 [debug] [MainThread]: Command `dbt debug` succeeded at 01:30:36.871631 after 1.85 seconds
[0m01:30:36.871966 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:30:36.872248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913df950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c34350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b5d460>]}
[0m01:30:36.872568 [debug] [MainThread]: Flushing usage events
[0m01:30:40.461159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb523fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4db30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb523fc50>]}


============================== 01:30:40.465014 | 15b63609-31f4-47b7-8a89-12554b8c523a ==============================
[0m01:30:40.465014 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:30:40.465582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:30:40.463884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c65910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929c45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c62360>]}


============================== 01:30:40.467694 | 9c603881-40c8-4cf4-8d68-322f550e5447 ==============================
[0m01:30:40.467694 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:30:40.468195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:30:40.868396 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:30:40.868861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c603881-40c8-4cf4-8d68-322f550e5447', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75cc03b0>]}
[0m01:30:40.877390 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:30:40.877837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15b63609-31f4-47b7-8a89-12554b8c523a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ba5d30>]}
[0m01:30:40.937016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b63609-31f4-47b7-8a89-12554b8c523a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b1f680>]}
[0m01:30:40.937014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c603881-40c8-4cf4-8d68-322f550e5447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75e2b620>]}
[0m01:30:40.959093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15b63609-31f4-47b7-8a89-12554b8c523a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fe1490>]}
[0m01:30:40.959672 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:40.959614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c603881-40c8-4cf4-8d68-322f550e5447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75dd7ce0>]}
[0m01:30:40.960231 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:40.966375 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m01:30:40.966412 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m01:30:40.967122 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:30:40.967182 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:30:40.967538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15b63609-31f4-47b7-8a89-12554b8c523a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a24a090>]}
[0m01:30:40.967747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c603881-40c8-4cf4-8d68-322f550e5447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b12180>]}
[0m01:30:41.650299 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_fact_stock_price_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "fact_stock_price_daily").
  
  To fix this, change the name of one of these resources:
  - source.stock_analytics.raw.fact_stock_price_daily (models/staging/schema.yml)
  - source.stock_analytics.raw.fact_stock_price_daily (models/sources.yml)
[0m01:30:41.651377 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.2311574, "process_user_time": 2.334165, "process_kernel_time": 0.177137, "process_mem_max_rss": "237512", "process_in_blocks": "1552", "process_out_blocks": "6", "command_success": false}
[0m01:30:41.651852 [debug] [MainThread]: Command `dbt snapshot` failed at 01:30:41.651782 after 1.23 seconds
[0m01:30:41.652163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c65910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7571c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7571c530>]}
[0m01:30:41.652477 [debug] [MainThread]: Flushing usage events
[0m01:30:41.661318 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_fact_stock_price_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "fact_stock_price_daily").
  
  To fix this, change the name of one of these resources:
  - source.stock_analytics.raw.fact_stock_price_daily (models/staging/schema.yml)
  - source.stock_analytics.raw.fact_stock_price_daily (models/sources.yml)
[0m01:30:41.662391 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.2452607, "process_user_time": 2.328859, "process_kernel_time": 0.170404, "process_mem_max_rss": "237520", "process_in_blocks": "864", "process_out_blocks": "6", "command_success": false}
[0m01:30:41.663110 [debug] [MainThread]: Command `dbt snapshot` failed at 01:30:41.663031 after 1.25 seconds
[0m01:30:41.663481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98514350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985158b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990078f0>]}
[0m01:30:41.663791 [debug] [MainThread]: Flushing usage events
[0m01:35:45.617598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ad6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92157f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a2d0a0>]}


============================== 01:35:45.622369 | 84cab1db-4a92-44b6-ab81-beccce3b14db ==============================
[0m01:35:45.622369 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:35:45.623130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:35:45.625342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1f0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc98980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8bc980>]}


============================== 01:35:45.630864 | 1e3e71ce-bf19-4821-aac5-cdc1fec7c0bb ==============================
[0m01:35:45.630864 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:35:45.631691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:35:46.214007 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:35:46.214656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e3e71ce-bf19-4821-aac5-cdc1fec7c0bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f835f0>]}
[0m01:35:46.217303 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:35:46.219851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '84cab1db-4a92-44b6-ab81-beccce3b14db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74dcfa70>]}
[0m01:35:46.254387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e3e71ce-bf19-4821-aac5-cdc1fec7c0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7071a480>]}
[0m01:35:46.254486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84cab1db-4a92-44b6-ab81-beccce3b14db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75540e30>]}
[0m01:35:46.284928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84cab1db-4a92-44b6-ab81-beccce3b14db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841c5ee0>]}
[0m01:35:46.285826 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:35:46.286181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e3e71ce-bf19-4821-aac5-cdc1fec7c0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d85d910>]}
[0m01:35:46.287492 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:35:46.297444 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m01:35:46.299987 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m01:35:46.300378 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:35:46.301643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '84cab1db-4a92-44b6-ab81-beccce3b14db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74b088f0>]}
[0m01:35:46.302005 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:35:46.302544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e3e71ce-bf19-4821-aac5-cdc1fec7c0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f4fb30>]}
[0m01:35:46.996163 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_fact_stock_price_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "fact_stock_price_daily").
  
  To fix this, change the name of one of these resources:
  - source.stock_analytics.raw.fact_stock_price_daily (models/staging/schema.yml)
  - source.stock_analytics.raw.fact_stock_price_daily (models/sources.yml)
[0m01:35:47.001008 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.448299, "process_user_time": 2.68775, "process_kernel_time": 0.20226, "process_mem_max_rss": "237524", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m01:35:47.001094 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_fact_stock_price_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "fact_stock_price_daily").
  
  To fix this, change the name of one of these resources:
  - source.stock_analytics.raw.fact_stock_price_daily (models/staging/schema.yml)
  - source.stock_analytics.raw.fact_stock_price_daily (models/sources.yml)
[0m01:35:47.002038 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.4566834, "process_user_time": 2.712027, "process_kernel_time": 0.180935, "process_mem_max_rss": "237508", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m01:35:47.002047 [debug] [MainThread]: Command `dbt snapshot` failed at 01:35:47.001854 after 1.45 seconds
[0m01:35:47.002566 [debug] [MainThread]: Command `dbt snapshot` failed at 01:35:47.002485 after 1.46 seconds
[0m01:35:47.002883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1f0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70366ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701e1610>]}
[0m01:35:47.002950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d5d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7470da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7470c0e0>]}
[0m01:35:47.003242 [debug] [MainThread]: Flushing usage events
[0m01:35:47.003485 [debug] [MainThread]: Flushing usage events
[0m02:08:35.191658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cae1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3847a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6c1fa0>]}


============================== 02:08:35.195363 | dff51879-3fff-40e8-96d4-a4490e2a5b96 ==============================
[0m02:08:35.195363 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:08:35.196040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:08:35.199214 [info ] [MainThread]: dbt version: 1.8.8
[0m02:08:35.199581 [info ] [MainThread]: python version: 3.12.4
[0m02:08:35.199831 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m02:08:35.200159 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m02:08:35.545016 [info ] [MainThread]: Using profiles dir at .
[0m02:08:35.545527 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m02:08:35.545872 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m02:08:35.546291 [info ] [MainThread]: adapter type: snowflake
[0m02:08:35.546622 [info ] [MainThread]: adapter version: 1.8.4
[0m02:08:35.568551 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:08:35.568971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dff51879-3fff-40e8-96d4-a4490e2a5b96', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bd96cc0>]}
[0m02:08:35.580552 [info ] [MainThread]: Configuration:
[0m02:08:35.580841 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:08:35.581126 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:08:35.581474 [info ] [MainThread]: Required dependencies:
[0m02:08:35.581770 [debug] [MainThread]: Executing "git --help"
[0m02:08:35.583386 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:08:35.583655 [debug] [MainThread]: STDERR: "b''"
[0m02:08:35.583887 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:08:35.584146 [info ] [MainThread]: Connection:
[0m02:08:35.584414 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m02:08:35.584654 [info ] [MainThread]:   user: MALLARD
[0m02:08:35.584918 [info ] [MainThread]:   database: ASH_DB
[0m02:08:35.585159 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m02:08:35.585422 [info ] [MainThread]:   role: TRAINING_ROLE
[0m02:08:35.585687 [info ] [MainThread]:   schema: STOCK_RAW
[0m02:08:35.585956 [info ] [MainThread]:   authenticator: None
[0m02:08:35.586196 [info ] [MainThread]:   oauth_client_id: None
[0m02:08:35.586428 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m02:08:35.586665 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:08:35.586945 [info ] [MainThread]:   host: None
[0m02:08:35.587180 [info ] [MainThread]:   port: None
[0m02:08:35.587423 [info ] [MainThread]:   proxy_host: None
[0m02:08:35.587670 [info ] [MainThread]:   proxy_port: None
[0m02:08:35.587943 [info ] [MainThread]:   protocol: None
[0m02:08:35.588178 [info ] [MainThread]:   connect_retries: 1
[0m02:08:35.588419 [info ] [MainThread]:   connect_timeout: None
[0m02:08:35.588660 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:08:35.588946 [info ] [MainThread]:   retry_all: False
[0m02:08:35.589186 [info ] [MainThread]:   insecure_mode: False
[0m02:08:35.589428 [info ] [MainThread]:   reuse_connections: None
[0m02:08:35.589768 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:08:35.591287 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:08:35.591686 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:08:35.591931 [debug] [MainThread]: On debug: select 1 as id
[0m02:08:35.592182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:08:37.040571 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.448 seconds
[0m02:08:37.046187 [debug] [MainThread]: On debug: Close
[0m02:08:37.303826 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:08:37.306445 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:08:37.310653 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.1559443, "process_user_time": 1.838768, "process_kernel_time": 0.125052, "process_mem_max_rss": "237516", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m02:08:37.312148 [debug] [MainThread]: Command `dbt debug` succeeded at 02:08:37.311967 after 2.16 seconds
[0m02:08:37.313279 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:08:37.314244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3847a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7170f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c07f830>]}
[0m02:08:37.315045 [debug] [MainThread]: Flushing usage events
[0m02:08:40.523561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c11a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c11b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1188c0>]}


============================== 02:08:40.526858 | 0b630095-963b-41e8-8f1e-2100b210f937 ==============================
[0m02:08:40.526858 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:08:40.527442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:08:40.950946 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:08:40.951602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b630095-963b-41e8-8f1e-2100b210f937', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78906510>]}
[0m02:08:40.976483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b630095-963b-41e8-8f1e-2100b210f937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff604369f0>]}
[0m02:08:40.995781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b630095-963b-41e8-8f1e-2100b210f937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff669b7dd0>]}
[0m02:08:40.996249 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:08:41.001276 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m02:08:41.001926 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:08:41.002326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b630095-963b-41e8-8f1e-2100b210f937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bf87fe0>]}
[0m02:08:41.589152 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_fact_stock_price_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "fact_stock_price_daily").
  
  To fix this, change the name of one of these resources:
  - source.stock_analytics.raw.fact_stock_price_daily (models/staging/schema.yml)
  - source.stock_analytics.raw.fact_stock_price_daily (models/sources.yml)
[0m02:08:41.590127 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1126039, "process_user_time": 2.568502, "process_kernel_time": 0.121386, "process_mem_max_rss": "237512", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m02:08:41.590570 [debug] [MainThread]: Command `dbt snapshot` failed at 02:08:41.590520 after 1.11 seconds
[0m02:08:41.590875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8f82f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6697ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bb3c080>]}
[0m02:08:41.591172 [debug] [MainThread]: Flushing usage events
[0m02:13:45.062218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d0fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b180d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884e3590>]}


============================== 02:13:45.065617 | 09584d5f-96c7-40de-95b5-32cfc8965985 ==============================
[0m02:13:45.065617 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:13:45.066428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:13:45.420092 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:13:45.420661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09584d5f-96c7-40de-95b5-32cfc8965985', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c877a70>]}
[0m02:13:45.444135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09584d5f-96c7-40de-95b5-32cfc8965985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c757dd0>]}
[0m02:13:45.463792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09584d5f-96c7-40de-95b5-32cfc8965985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d2229f0>]}
[0m02:13:45.464232 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:13:45.469313 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m02:13:45.470024 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:13:45.470392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09584d5f-96c7-40de-95b5-32cfc8965985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c467740>]}
[0m02:13:46.054569 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_fact_stock_price_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "fact_stock_price_daily").
  
  To fix this, change the name of one of these resources:
  - source.stock_analytics.raw.fact_stock_price_daily (models/staging/schema.yml)
  - source.stock_analytics.raw.fact_stock_price_daily (models/sources.yml)
[0m02:13:46.055743 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0297304, "process_user_time": 2.440843, "process_kernel_time": 0.161293, "process_mem_max_rss": "237512", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m02:13:46.056288 [debug] [MainThread]: Command `dbt snapshot` failed at 02:13:46.056220 after 1.03 seconds
[0m02:13:46.056672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884e71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8893bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f755e0>]}
[0m02:13:46.056987 [debug] [MainThread]: Flushing usage events
[0m03:41:29.789707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b353a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0fdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9abe9b80>]}


============================== 03:41:29.793264 | b079ebad-36e7-4ee7-8d74-b238773d37e3 ==============================
[0m03:41:29.793264 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:41:29.793733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m03:41:29.796794 [info ] [MainThread]: dbt version: 1.8.8
[0m03:41:29.797061 [info ] [MainThread]: python version: 3.12.4
[0m03:41:29.797262 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m03:41:29.797475 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m03:41:30.117422 [info ] [MainThread]: Using profiles dir at .
[0m03:41:30.117918 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m03:41:30.118311 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m03:41:30.118742 [info ] [MainThread]: adapter type: snowflake
[0m03:41:30.119018 [info ] [MainThread]: adapter version: 1.8.4
[0m03:41:30.140655 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:41:30.141035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b079ebad-36e7-4ee7-8d74-b238773d37e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2bdd30>]}
[0m03:41:30.152444 [info ] [MainThread]: Configuration:
[0m03:41:30.152755 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:41:30.153062 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:41:30.153360 [info ] [MainThread]: Required dependencies:
[0m03:41:30.153631 [debug] [MainThread]: Executing "git --help"
[0m03:41:30.155209 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:41:30.155465 [debug] [MainThread]: STDERR: "b''"
[0m03:41:30.155675 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:41:30.155931 [info ] [MainThread]: Connection:
[0m03:41:30.156225 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m03:41:30.156486 [info ] [MainThread]:   user: MALLARD
[0m03:41:30.156727 [info ] [MainThread]:   database: ASH_DB
[0m03:41:30.156951 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m03:41:30.157179 [info ] [MainThread]:   role: TRAINING_ROLE
[0m03:41:30.157406 [info ] [MainThread]:   schema: STOCK_RAW
[0m03:41:30.157676 [info ] [MainThread]:   authenticator: None
[0m03:41:30.157912 [info ] [MainThread]:   oauth_client_id: None
[0m03:41:30.158144 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m03:41:30.158401 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:41:30.158642 [info ] [MainThread]:   host: None
[0m03:41:30.158887 [info ] [MainThread]:   port: None
[0m03:41:30.159119 [info ] [MainThread]:   proxy_host: None
[0m03:41:30.159357 [info ] [MainThread]:   proxy_port: None
[0m03:41:30.159576 [info ] [MainThread]:   protocol: None
[0m03:41:30.159817 [info ] [MainThread]:   connect_retries: 1
[0m03:41:30.160095 [info ] [MainThread]:   connect_timeout: None
[0m03:41:30.160336 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:41:30.160563 [info ] [MainThread]:   retry_all: False
[0m03:41:30.160785 [info ] [MainThread]:   insecure_mode: False
[0m03:41:30.161027 [info ] [MainThread]:   reuse_connections: None
[0m03:41:30.161341 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:41:30.162857 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:41:30.163247 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:41:30.163496 [debug] [MainThread]: On debug: select 1 as id
[0m03:41:30.163715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:41:30.603760 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.440 seconds
[0m03:41:30.606457 [debug] [MainThread]: On debug: Close
[0m03:41:30.781418 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:41:30.781981 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:41:30.782592 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0283791, "process_user_time": 1.770002, "process_kernel_time": 0.093902, "process_mem_max_rss": "237520", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m03:41:30.782978 [debug] [MainThread]: Command `dbt debug` succeeded at 03:41:30.782925 after 1.03 seconds
[0m03:41:30.783252 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:41:30.783506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0fdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3a1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a313bf0>]}
[0m03:41:30.783785 [debug] [MainThread]: Flushing usage events
[0m03:41:33.802392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60be3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d7dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6634c50>]}


============================== 03:41:33.805859 | 961b7767-76e0-431f-baa0-dba9bf8b32fb ==============================
[0m03:41:33.805859 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:41:33.806610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir .', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:41:34.152408 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:41:34.152919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '961b7767-76e0-431f-baa0-dba9bf8b32fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d9ecf0>]}
[0m03:41:34.176478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '961b7767-76e0-431f-baa0-dba9bf8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dc7350>]}
[0m03:41:34.195864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '961b7767-76e0-431f-baa0-dba9bf8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3600620>]}
[0m03:41:34.196365 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:41:34.201076 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m03:41:34.201756 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:41:34.202124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '961b7767-76e0-431f-baa0-dba9bf8b32fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55c1250>]}
[0m03:41:34.796106 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_fact_stock_price_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "fact_stock_price_daily").
  
  To fix this, change the name of one of these resources:
  - source.stock_analytics.raw.fact_stock_price_daily (models/staging/schema.yml)
  - source.stock_analytics.raw.fact_stock_price_daily (models/sources.yml)
[0m03:41:34.797006 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0432969, "process_user_time": 2.374689, "process_kernel_time": 0.081194, "process_mem_max_rss": "237524", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m03:41:34.797413 [debug] [MainThread]: Command `dbt snapshot` failed at 03:41:34.797365 after 1.04 seconds
[0m03:41:34.797744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46888c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834a2750>]}
[0m03:41:34.798016 [debug] [MainThread]: Flushing usage events
[0m03:46:37.778438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9518d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96635be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941bfbc0>]}


============================== 03:46:37.782998 | 6b9c02e9-9050-45b0-8ce7-bb61fbde31e9 ==============================
[0m03:46:37.782998 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:46:37.783633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:46:38.266713 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:46:38.267767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b9c02e9-9050-45b0-8ce7-bb61fbde31e9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73b38b60>]}
[0m03:46:38.298112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b9c02e9-9050-45b0-8ce7-bb61fbde31e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939e1b80>]}
[0m03:46:38.319531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b9c02e9-9050-45b0-8ce7-bb61fbde31e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9010a4b0>]}
[0m03:46:38.320302 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:46:38.326023 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m03:46:38.326741 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:46:38.327213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b9c02e9-9050-45b0-8ce7-bb61fbde31e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a5fa10>]}
[0m03:46:38.960806 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_fact_stock_price_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "fact_stock_price_daily").
  
  To fix this, change the name of one of these resources:
  - source.stock_analytics.raw.fact_stock_price_daily (models/staging/schema.yml)
  - source.stock_analytics.raw.fact_stock_price_daily (models/sources.yml)
[0m03:46:38.961772 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.2201871, "process_user_time": 2.338192, "process_kernel_time": 0.154322, "process_mem_max_rss": "237520", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m03:46:38.962188 [debug] [MainThread]: Command `dbt snapshot` failed at 03:46:38.962140 after 1.22 seconds
[0m03:46:38.962546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9518d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941ea780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9497cdd0>]}
[0m03:46:38.962864 [debug] [MainThread]: Flushing usage events
[0m03:49:44.268810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac04cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb61cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac04c800>]}


============================== 03:49:44.273184 | bbcf858a-ee59-4949-9046-c88c075bf3c8 ==============================
[0m03:49:44.273184 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:49:44.273910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:49:44.644946 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:49:44.645666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbcf858a-ee59-4949-9046-c88c075bf3c8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904b16a0>]}
[0m03:49:44.669190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbcf858a-ee59-4949-9046-c88c075bf3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900d7680>]}
[0m03:49:44.689603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbcf858a-ee59-4949-9046-c88c075bf3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908ea330>]}
[0m03:49:44.690237 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:49:44.695218 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m03:49:44.695910 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:49:44.696348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bbcf858a-ee59-4949-9046-c88c075bf3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90242960>]}
[0m03:49:45.276598 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'mart_stock_daily_metrics' in the 'models' section of file 'models/marts/schema.yml'
[0m03:49:45.308966 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_bollinger_bands' in the 'models' section of file 'models/intermediate/schema.yml'
[0m03:49:45.337655 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.mart_stock_daily_metics' (models/marts/mart_stock_daily_metics.sql) depends on a node named 'int_stock_moving_averages' which was not found
[0m03:49:45.338376 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1100067, "process_user_time": 2.456485, "process_kernel_time": 0.125587, "process_mem_max_rss": "237520", "process_out_blocks": "7", "command_success": false, "process_in_blocks": "0"}
[0m03:49:45.338741 [debug] [MainThread]: Command `dbt snapshot` failed at 03:49:45.338683 after 1.11 seconds
[0m03:49:45.339040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb61cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b79fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad400560>]}
[0m03:49:45.339321 [debug] [MainThread]: Flushing usage events
[0m03:50:35.657693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94293920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94203290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f48f80>]}


============================== 03:50:35.661974 | a8051b0f-2cb2-4e22-a177-dabc5641e682 ==============================
[0m03:50:35.661974 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:50:35.662394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:50:35.665466 [info ] [MainThread]: dbt version: 1.8.8
[0m03:50:35.665720 [info ] [MainThread]: python version: 3.12.4
[0m03:50:35.665934 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m03:50:35.666188 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m03:50:35.995282 [info ] [MainThread]: Using profiles dir at .
[0m03:50:35.995804 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m03:50:35.996315 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m03:50:35.996667 [info ] [MainThread]: adapter type: snowflake
[0m03:50:35.996988 [info ] [MainThread]: adapter version: 1.8.4
[0m03:50:36.019166 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:50:36.019567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a8051b0f-2cb2-4e22-a177-dabc5641e682', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d66c00>]}
[0m03:50:36.031253 [info ] [MainThread]: Configuration:
[0m03:50:36.031587 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:50:36.031870 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:50:36.032207 [info ] [MainThread]: Required dependencies:
[0m03:50:36.032523 [debug] [MainThread]: Executing "git --help"
[0m03:50:36.034115 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:50:36.034359 [debug] [MainThread]: STDERR: "b''"
[0m03:50:36.034571 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:50:36.034827 [info ] [MainThread]: Connection:
[0m03:50:36.035098 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m03:50:36.035406 [info ] [MainThread]:   user: MALLARD
[0m03:50:36.035821 [info ] [MainThread]:   database: ASH_DB
[0m03:50:36.036253 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m03:50:36.036713 [info ] [MainThread]:   role: TRAINING_ROLE
[0m03:50:36.037030 [info ] [MainThread]:   schema: STOCK_RAW
[0m03:50:36.037320 [info ] [MainThread]:   authenticator: None
[0m03:50:36.037588 [info ] [MainThread]:   oauth_client_id: None
[0m03:50:36.037904 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m03:50:36.038451 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:50:36.038728 [info ] [MainThread]:   host: None
[0m03:50:36.039002 [info ] [MainThread]:   port: None
[0m03:50:36.039283 [info ] [MainThread]:   proxy_host: None
[0m03:50:36.039530 [info ] [MainThread]:   proxy_port: None
[0m03:50:36.039767 [info ] [MainThread]:   protocol: None
[0m03:50:36.039991 [info ] [MainThread]:   connect_retries: 1
[0m03:50:36.040268 [info ] [MainThread]:   connect_timeout: None
[0m03:50:36.040515 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:50:36.040883 [info ] [MainThread]:   retry_all: False
[0m03:50:36.041311 [info ] [MainThread]:   insecure_mode: False
[0m03:50:36.041775 [info ] [MainThread]:   reuse_connections: None
[0m03:50:36.042295 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:50:36.044150 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:50:36.044848 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:50:36.045251 [debug] [MainThread]: On debug: select 1 as id
[0m03:50:36.045590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:50:36.519796 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.474 seconds
[0m03:50:36.522772 [debug] [MainThread]: On debug: Close
[0m03:50:36.639762 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:50:36.641893 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:50:36.644162 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0208884, "process_user_time": 1.892695, "process_kernel_time": 0.104702, "process_mem_max_rss": "237584", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m03:50:36.645334 [debug] [MainThread]: Command `dbt debug` succeeded at 03:50:36.645209 after 1.02 seconds
[0m03:50:36.646183 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:50:36.646976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95dcd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9afa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73e9d550>]}
[0m03:50:36.647827 [debug] [MainThread]: Flushing usage events
[0m03:50:39.476367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b472810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de4b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4a1730>]}


============================== 03:50:39.479692 | 6c801877-01ab-42d2-bbe9-8b1cbadbb83c ==============================
[0m03:50:39.479692 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:50:39.480245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:50:39.819958 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:50:39.820498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6c801877-01ab-42d2-bbe9-8b1cbadbb83c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d0a960>]}
[0m03:50:39.844026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c801877-01ab-42d2-bbe9-8b1cbadbb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b759b20>]}
[0m03:50:39.863053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c801877-01ab-42d2-bbe9-8b1cbadbb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b5b0ef0>]}
[0m03:50:39.863491 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:50:39.868093 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m03:50:39.868742 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:50:39.869116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6c801877-01ab-42d2-bbe9-8b1cbadbb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b31b590>]}
[0m03:50:40.446378 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'mart_stock_daily_metrics' in the 'models' section of file 'models/marts/schema.yml'
[0m03:50:40.478614 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_bollinger_bands' in the 'models' section of file 'models/intermediate/schema.yml'
[0m03:50:40.507332 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.mart_stock_daily_metics' (models/marts/mart_stock_daily_metics.sql) depends on a node named 'int_stock_moving_averages' which was not found
[0m03:50:40.508046 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0668943, "process_user_time": 2.405571, "process_kernel_time": 0.084089, "process_mem_max_rss": "237580", "process_out_blocks": "7", "command_success": false, "process_in_blocks": "0"}
[0m03:50:40.508398 [debug] [MainThread]: Command `dbt snapshot` failed at 03:50:40.508349 after 1.07 seconds
[0m03:50:40.508676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b638ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5af47ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7091e840>]}
[0m03:50:40.508941 [debug] [MainThread]: Flushing usage events
[0m03:55:43.320891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b0aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999c3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab11850>]}


============================== 03:55:43.324507 | 3b820f86-55db-48ef-ad26-4738383d078b ==============================
[0m03:55:43.324507 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:55:43.325092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:55:43.692357 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:55:43.693020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b820f86-55db-48ef-ad26-4738383d078b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b52fc0>]}
[0m03:55:43.720943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b820f86-55db-48ef-ad26-4738383d078b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edf3a40>]}
[0m03:55:43.745131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b820f86-55db-48ef-ad26-4738383d078b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b9a3f0>]}
[0m03:55:43.745859 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:55:43.751835 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m03:55:43.752884 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:55:43.753641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b820f86-55db-48ef-ad26-4738383d078b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1fd130>]}
[0m03:55:44.351123 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'mart_stock_daily_metrics' in the 'models' section of file 'models/marts/schema.yml'
[0m03:55:44.384572 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_bollinger_bands' in the 'models' section of file 'models/intermediate/schema.yml'
[0m03:55:44.414083 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.mart_stock_daily_metics' (models/marts/mart_stock_daily_metics.sql) depends on a node named 'int_stock_moving_averages' which was not found
[0m03:55:44.414854 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1365747, "process_user_time": 2.46564, "process_kernel_time": 0.123835, "process_mem_max_rss": "237580", "process_out_blocks": "7", "command_success": false, "process_in_blocks": "0"}
[0m03:55:44.415254 [debug] [MainThread]: Command `dbt snapshot` failed at 03:55:44.415205 after 1.14 seconds
[0m03:55:44.415571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99498ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb8fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb8edb0>]}
[0m03:55:44.415858 [debug] [MainThread]: Flushing usage events
[0m17:09:40.302610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb32a2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3950b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d1ec30>]}


============================== 17:09:40.306131 | 7181ea9f-8d5c-4f4b-921f-733e2e1c63af ==============================
[0m17:09:40.306131 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:09:40.306685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:40.309892 [info ] [MainThread]: dbt version: 1.8.8
[0m17:09:40.310175 [info ] [MainThread]: python version: 3.12.4
[0m17:09:40.310443 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:09:40.310708 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:09:40.647078 [info ] [MainThread]: Using profiles dir at .
[0m17:09:40.647591 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:09:40.647914 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m17:09:40.648279 [info ] [MainThread]: adapter type: snowflake
[0m17:09:40.648559 [info ] [MainThread]: adapter version: 1.8.4
[0m17:09:40.674346 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:09:40.675000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7181ea9f-8d5c-4f4b-921f-733e2e1c63af', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2097b90>]}
[0m17:09:40.691456 [info ] [MainThread]: Configuration:
[0m17:09:40.692061 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:09:40.692535 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:09:40.693029 [info ] [MainThread]: Required dependencies:
[0m17:09:40.693681 [debug] [MainThread]: Executing "git --help"
[0m17:09:40.695790 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:09:40.696096 [debug] [MainThread]: STDERR: "b''"
[0m17:09:40.696324 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:09:40.696628 [info ] [MainThread]: Connection:
[0m17:09:40.696927 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m17:09:40.697198 [info ] [MainThread]:   user: MALLARD
[0m17:09:40.697453 [info ] [MainThread]:   database: ASH_DB
[0m17:09:40.697738 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m17:09:40.697984 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:09:40.698237 [info ] [MainThread]:   schema: STOCK_RAW
[0m17:09:40.698510 [info ] [MainThread]:   authenticator: None
[0m17:09:40.698773 [info ] [MainThread]:   oauth_client_id: None
[0m17:09:40.699009 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m17:09:40.699462 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:09:40.699740 [info ] [MainThread]:   host: None
[0m17:09:40.699992 [info ] [MainThread]:   port: None
[0m17:09:40.700224 [info ] [MainThread]:   proxy_host: None
[0m17:09:40.700469 [info ] [MainThread]:   proxy_port: None
[0m17:09:40.700753 [info ] [MainThread]:   protocol: None
[0m17:09:40.700985 [info ] [MainThread]:   connect_retries: 1
[0m17:09:40.701215 [info ] [MainThread]:   connect_timeout: None
[0m17:09:40.701457 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:09:40.701736 [info ] [MainThread]:   retry_all: False
[0m17:09:40.701993 [info ] [MainThread]:   insecure_mode: False
[0m17:09:40.702231 [info ] [MainThread]:   reuse_connections: None
[0m17:09:40.702564 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:09:40.704148 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:09:40.704677 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:09:40.704993 [debug] [MainThread]: On debug: select 1 as id
[0m17:09:40.705265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:41.140931 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.435 seconds
[0m17:09:41.143255 [debug] [MainThread]: On debug: Close
[0m17:09:41.260382 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:09:41.261901 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:09:41.263172 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.99529, "process_user_time": 1.781648, "process_kernel_time": 0.134729, "process_mem_max_rss": "237584", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m17:09:41.263808 [debug] [MainThread]: Command `dbt debug` succeeded at 17:09:41.263719 after 1.00 seconds
[0m17:09:41.264247 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:09:41.264694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb280e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924f1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb406d010>]}
[0m17:09:41.265128 [debug] [MainThread]: Flushing usage events
[0m17:09:44.207732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8187a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8153b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810cb0b0>]}


============================== 17:09:44.211697 | 8d463d71-694d-4549-bcaf-9aca96579525 ==============================
[0m17:09:44.211697 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:09:44.212456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:44.637084 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:09:44.637830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8d463d71-694d-4549-bcaf-9aca96579525', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81177410>]}
[0m17:09:44.666717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d463d71-694d-4549-bcaf-9aca96579525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f77680>]}
[0m17:09:44.690465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d463d71-694d-4549-bcaf-9aca96579525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb51430>]}
[0m17:09:44.691075 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:09:44.697390 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:09:44.698143 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:09:44.698755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d463d71-694d-4549-bcaf-9aca96579525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64db9460>]}
[0m17:09:45.431717 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.mart_stock_daily_metrics' (models/marts/mart_stock_daily_metrics.sql) depends on a node named 'int_stock_moving_averages' which was not found
[0m17:09:45.432688 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.2675551, "process_user_time": 2.409806, "process_kernel_time": 0.136988, "process_mem_max_rss": "237584", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m17:09:45.433028 [debug] [MainThread]: Command `dbt snapshot` failed at 17:09:45.432972 after 1.27 seconds
[0m17:09:45.433331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fd0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b5b46b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff641ef740>]}
[0m17:09:45.433599 [debug] [MainThread]: Flushing usage events
[0m17:11:47.788963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19fde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fbfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57f9400>]}


============================== 17:11:47.793327 | 4acac5f8-d5b1-41cf-a808-1fb5f8d89f61 ==============================
[0m17:11:47.793327 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:11:47.794311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:48.264515 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:11:48.265866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4acac5f8-d5b1-41cf-a808-1fb5f8d89f61', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b27a70>]}
[0m17:11:48.297893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4acac5f8-d5b1-41cf-a808-1fb5f8d89f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb30e3680>]}
[0m17:11:48.321069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4acac5f8-d5b1-41cf-a808-1fb5f8d89f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28997c0>]}
[0m17:11:48.321963 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:11:48.328798 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:11:48.329763 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:11:48.330356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4acac5f8-d5b1-41cf-a808-1fb5f8d89f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95817e00>]}
[0m17:11:49.045907 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.mart_stock_daily_metrics' (models/marts/mart_stock_daily_metrics.sql) depends on a node named 'int_stock_moving_averages' which was not found
[0m17:11:49.047718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.310754, "process_user_time": 2.644047, "process_kernel_time": 0.170003, "process_mem_max_rss": "237592", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m17:11:49.048172 [debug] [MainThread]: Command `dbt run` failed at 17:11:49.048106 after 1.31 seconds
[0m17:11:49.048547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4551af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954fc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9551f800>]}
[0m17:11:49.048842 [debug] [MainThread]: Flushing usage events
[0m17:11:52.252388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54f6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a93830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5757440>]}


============================== 17:11:52.255717 | 310aab21-1061-493d-a548-af44c2cd285f ==============================
[0m17:11:52.255717 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:11:52.256376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:11:52.644303 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:11:52.644908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '310aab21-1061-493d-a548-af44c2cd285f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890c78f0>]}
[0m17:11:52.666755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '310aab21-1061-493d-a548-af44c2cd285f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebb75f0>]}
[0m17:11:52.685225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '310aab21-1061-493d-a548-af44c2cd285f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895e0e60>]}
[0m17:11:52.685682 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:11:52.690531 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:11:52.691118 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:11:52.691503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '310aab21-1061-493d-a548-af44c2cd285f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa439ca10>]}
[0m17:11:53.304183 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.mart_stock_daily_metrics' (models/marts/mart_stock_daily_metrics.sql) depends on a node named 'int_stock_moving_averages' which was not found
[0m17:11:53.305037 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.0975884, "process_user_time": 2.386349, "process_kernel_time": 0.117869, "process_mem_max_rss": "237600", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m17:11:53.305402 [debug] [MainThread]: Command `dbt test` failed at 17:11:53.305343 after 1.10 seconds
[0m17:11:53.305683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83bdd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fd5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fa1790>]}
[0m17:11:53.305952 [debug] [MainThread]: Flushing usage events
[0m17:13:37.762900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e737d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ead2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e736d50>]}


============================== 17:13:37.766656 | 2d7691c6-882e-4efe-bc37-3ceab62a1de6 ==============================
[0m17:13:37.766656 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:13:37.767412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:13:37.770638 [info ] [MainThread]: dbt version: 1.8.8
[0m17:13:37.770949 [info ] [MainThread]: python version: 3.12.4
[0m17:13:37.771191 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:13:37.771455 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:13:38.109178 [info ] [MainThread]: Using profiles dir at .
[0m17:13:38.109728 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:13:38.110038 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m17:13:38.110479 [info ] [MainThread]: adapter type: snowflake
[0m17:13:38.110768 [info ] [MainThread]: adapter version: 1.8.4
[0m17:13:38.131608 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:13:38.131946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d7691c6-882e-4efe-bc37-3ceab62a1de6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e7d5880>]}
[0m17:13:38.143149 [info ] [MainThread]: Configuration:
[0m17:13:38.143470 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:13:38.143746 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:13:38.144019 [info ] [MainThread]: Required dependencies:
[0m17:13:38.144271 [debug] [MainThread]: Executing "git --help"
[0m17:13:38.146006 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:13:38.146310 [debug] [MainThread]: STDERR: "b''"
[0m17:13:38.146531 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:13:38.146836 [info ] [MainThread]: Connection:
[0m17:13:38.147141 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m17:13:38.147420 [info ] [MainThread]:   user: MALLARD
[0m17:13:38.147692 [info ] [MainThread]:   database: ASH_DB
[0m17:13:38.147974 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m17:13:38.148227 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:13:38.148474 [info ] [MainThread]:   schema: STOCK_RAW
[0m17:13:38.148730 [info ] [MainThread]:   authenticator: None
[0m17:13:38.148962 [info ] [MainThread]:   oauth_client_id: None
[0m17:13:38.149228 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m17:13:38.149767 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:13:38.150003 [info ] [MainThread]:   host: None
[0m17:13:38.150232 [info ] [MainThread]:   port: None
[0m17:13:38.150515 [info ] [MainThread]:   proxy_host: None
[0m17:13:38.150773 [info ] [MainThread]:   proxy_port: None
[0m17:13:38.150999 [info ] [MainThread]:   protocol: None
[0m17:13:38.151241 [info ] [MainThread]:   connect_retries: 1
[0m17:13:38.151482 [info ] [MainThread]:   connect_timeout: None
[0m17:13:38.151742 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:13:38.151981 [info ] [MainThread]:   retry_all: False
[0m17:13:38.152204 [info ] [MainThread]:   insecure_mode: False
[0m17:13:38.152436 [info ] [MainThread]:   reuse_connections: None
[0m17:13:38.152736 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:13:38.155067 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:13:38.155490 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:13:38.155740 [debug] [MainThread]: On debug: select 1 as id
[0m17:13:38.155971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:38.805251 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.649 seconds
[0m17:13:38.807157 [debug] [MainThread]: On debug: Close
[0m17:13:38.952274 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:13:38.953050 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:13:38.953978 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2446078, "process_user_time": 1.775334, "process_kernel_time": 0.137335, "process_mem_max_rss": "237584", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m17:13:38.954339 [debug] [MainThread]: Command `dbt debug` succeeded at 17:13:38.954290 after 1.25 seconds
[0m17:13:38.954681 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:13:38.954947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb17230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fe57590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e8105f0>]}
[0m17:13:38.955253 [debug] [MainThread]: Flushing usage events
[0m17:13:42.947298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa43eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c65d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa43fe60>]}


============================== 17:13:42.951284 | cafe0162-3684-4391-993f-886bc11cf6db ==============================
[0m17:13:42.951284 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:13:42.952315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:13:43.312433 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:13:43.312990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cafe0162-3684-4391-993f-886bc11cf6db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1aae70>]}
[0m17:13:43.338119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cafe0162-3684-4391-993f-886bc11cf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc75ca0>]}
[0m17:13:43.358904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cafe0162-3684-4391-993f-886bc11cf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabfeba0>]}
[0m17:13:43.359499 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:13:43.364676 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:13:43.365329 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:13:43.365755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cafe0162-3684-4391-993f-886bc11cf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d18b440>]}
[0m17:13:43.997643 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.mart_stock_daily_metrics' (models/marts/mart_stock_daily_metrics.sql) depends on a node named 'int_stock_rsi' which was not found
[0m17:13:43.998598 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0848281, "process_user_time": 2.282362, "process_kernel_time": 0.112672, "process_mem_max_rss": "237568", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m17:13:43.998992 [debug] [MainThread]: Command `dbt snapshot` failed at 17:13:43.998933 after 1.09 seconds
[0m17:13:43.999296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d887f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa989d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3dee10>]}
[0m17:13:43.999612 [debug] [MainThread]: Flushing usage events
[0m17:18:39.412091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2269eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4512210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25419d0>]}


============================== 17:18:39.415644 | ca8cf936-32ed-404d-8077-870d22b9e891 ==============================
[0m17:18:39.415644 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:18:39.416326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:39.419561 [info ] [MainThread]: dbt version: 1.8.8
[0m17:18:39.419869 [info ] [MainThread]: python version: 3.12.4
[0m17:18:39.420128 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:18:39.420491 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:18:39.783531 [info ] [MainThread]: Using profiles dir at .
[0m17:18:39.784234 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:18:39.784588 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m17:18:39.785086 [info ] [MainThread]: adapter type: snowflake
[0m17:18:39.785395 [info ] [MainThread]: adapter version: 1.8.4
[0m17:18:39.813880 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:18:39.814423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca8cf936-32ed-404d-8077-870d22b9e891', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9613a330>]}
[0m17:18:39.825471 [info ] [MainThread]: Configuration:
[0m17:18:39.825760 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:18:39.826048 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:18:39.826340 [info ] [MainThread]: Required dependencies:
[0m17:18:39.826655 [debug] [MainThread]: Executing "git --help"
[0m17:18:39.828151 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:18:39.828437 [debug] [MainThread]: STDERR: "b''"
[0m17:18:39.828682 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:18:39.828961 [info ] [MainThread]: Connection:
[0m17:18:39.829249 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m17:18:39.829495 [info ] [MainThread]:   user: MALLARD
[0m17:18:39.829726 [info ] [MainThread]:   database: ASH_DB
[0m17:18:39.829970 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m17:18:39.830258 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:18:39.830498 [info ] [MainThread]:   schema: STOCK_RAW
[0m17:18:39.830723 [info ] [MainThread]:   authenticator: None
[0m17:18:39.830946 [info ] [MainThread]:   oauth_client_id: None
[0m17:18:39.831196 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m17:18:39.831710 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:18:39.831953 [info ] [MainThread]:   host: None
[0m17:18:39.832197 [info ] [MainThread]:   port: None
[0m17:18:39.832453 [info ] [MainThread]:   proxy_host: None
[0m17:18:39.832687 [info ] [MainThread]:   proxy_port: None
[0m17:18:39.832919 [info ] [MainThread]:   protocol: None
[0m17:18:39.833164 [info ] [MainThread]:   connect_retries: 1
[0m17:18:39.833381 [info ] [MainThread]:   connect_timeout: None
[0m17:18:39.833594 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:18:39.833810 [info ] [MainThread]:   retry_all: False
[0m17:18:39.834040 [info ] [MainThread]:   insecure_mode: False
[0m17:18:39.834282 [info ] [MainThread]:   reuse_connections: None
[0m17:18:39.834572 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:18:39.836062 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:18:39.836456 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:18:39.836689 [debug] [MainThread]: On debug: select 1 as id
[0m17:18:39.836918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:40.342678 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.505 seconds
[0m17:18:40.345507 [debug] [MainThread]: On debug: Close
[0m17:18:40.623645 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:18:40.626030 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:18:40.628348 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2498364, "process_user_time": 1.769481, "process_kernel_time": 0.124853, "process_mem_max_rss": "237556", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m17:18:40.629554 [debug] [MainThread]: Command `dbt debug` succeeded at 17:18:40.629412 after 1.25 seconds
[0m17:18:40.630406 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:18:40.631200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20f8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2269eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f5a750>]}
[0m17:18:40.632012 [debug] [MainThread]: Flushing usage events
[0m17:18:43.540590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8dbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dee4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0bb530>]}


============================== 17:18:43.544588 | aaad0ebe-5574-4ce9-8b4e-07e23c52adea ==============================
[0m17:18:43.544588 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:18:43.545199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:43.889499 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:18:43.890029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67949010>]}
[0m17:18:43.912720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff679277d0>]}
[0m17:18:43.930898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ccfbdd0>]}
[0m17:18:43.931314 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:18:43.935873 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:18:43.936528 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:18:43.936862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e099100>]}
[0m17:18:44.570338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff609d7e90>]}
[0m17:18:44.627434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f3a330>]}
[0m17:18:44.627783 [info ] [MainThread]: Found 7 models, 1 snapshot, 35 data tests, 1 source, 454 macros
[0m17:18:44.628224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2af020>]}
[0m17:18:44.629359 [info ] [MainThread]: 
[0m17:18:44.629823 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:44.630407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m17:18:44.636235 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m17:18:44.636486 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m17:18:44.636734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:45.068610 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.432 seconds
[0m17:18:45.071786 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m17:18:45.223588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_snapshots)
[0m17:18:45.225344 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "snapshots"
"
[0m17:18:45.233328 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_snapshots"
[0m17:18:45.234162 [debug] [ThreadPool]: On create_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_snapshots"} */
create schema if not exists ASH_DB.snapshots
[0m17:18:45.234783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:45.623602 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.389 seconds
[0m17:18:45.626307 [debug] [ThreadPool]: On create_ASH_DB_snapshots: Close
[0m17:18:45.804276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_snapshots, now list_ASH_DB_STOCK_RAW_test_failures)
[0m17:18:45.804984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_marts'
[0m17:18:45.805511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_intermediate'
[0m17:18:45.806424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m17:18:45.812191 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m17:18:45.813716 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_marts"
[0m17:18:45.815230 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_intermediate"
[0m17:18:45.816561 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m17:18:45.816927 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m17:18:45.817290 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_marts"} */
show objects in ASH_DB.STOCK_RAW_marts limit 10000
[0m17:18:45.817665 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_intermediate"} */
show objects in ASH_DB.STOCK_RAW_intermediate limit 10000
[0m17:18:45.818038 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m17:18:45.818363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:45.818689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:45.819103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:45.819431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:46.222334 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c6e-0106-eb87-000f-c0df006fb656
[0m17:18:46.224489 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c6e-0106-eb84-000f-c0df006f673e
[0m17:18:46.225044 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:18:46.225689 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:18:46.226507 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:18:46.227371 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:18:46.228050 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:46.228668 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:46.229431 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: Close
[0m17:18:46.230643 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m17:18:46.261319 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.442 seconds
[0m17:18:46.262760 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m17:18:46.340130 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c6e-0106-ebeb-000f-c0df007023a6
[0m17:18:46.340976 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:18:46.341724 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:18:46.342297 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:46.342919 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: Close
[0m17:18:46.359965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now list_ASH_DB_STOCK_RAW_staging)
[0m17:18:46.363547 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_staging"
[0m17:18:46.364520 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_staging"} */
show objects in ASH_DB.STOCK_RAW_staging limit 10000
[0m17:18:46.365007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:46.769324 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c6e-0106-eb87-000f-c0df006fb65a
[0m17:18:46.770979 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:18:46.772200 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:18:46.773145 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:46.774152 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: Close
[0m17:18:46.917518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e754410>]}
[0m17:18:46.918609 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:18:46.920035 [info ] [MainThread]: 
[0m17:18:46.929784 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m17:18:46.930406 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m17:18:46.931479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_staging, now snapshot.stock_analytics.stock_price_snapshot)
[0m17:18:46.931975 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m17:18:46.944430 [debug] [Thread-1 (]: Compilation Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:18:46.945516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaad0ebe-5574-4ce9-8b4e-07e23c52adea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6126ede0>]}
[0m17:18:46.946104 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stock_price_snapshot ....................... [[31mERROR[0m in 0.01s]
[0m17:18:46.946671 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m17:18:46.948101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:46.948384 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m17:18:46.948630 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_marts' was properly closed.
[0m17:18:46.948851 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_intermediate' was properly closed.
[0m17:18:46.949061 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m17:18:46.949373 [info ] [MainThread]: 
[0m17:18:46.949782 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m17:18:46.950296 [debug] [MainThread]: Command end result
[0m17:18:46.974185 [info ] [MainThread]: 
[0m17:18:46.974620 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:18:46.974902 [info ] [MainThread]: 
[0m17:18:46.975223 [error] [MainThread]:   Compilation Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:18:46.975463 [info ] [MainThread]: 
[0m17:18:46.975684 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:18:46.976304 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.4836707, "process_user_time": 2.625674, "process_kernel_time": 0.12527, "process_mem_max_rss": "237556", "process_in_blocks": "968", "process_out_blocks": "3463", "command_success": false}
[0m17:18:46.976654 [debug] [MainThread]: Command `dbt snapshot` failed at 17:18:46.976598 after 3.48 seconds
[0m17:18:46.976932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0b61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d89e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d89e1e0>]}
[0m17:18:46.977197 [debug] [MainThread]: Flushing usage events
[0m17:23:50.275684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe16870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef73d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1781c40>]}


============================== 17:23:50.280062 | 6d17a110-6896-4940-917c-4dc2e6fe5e25 ==============================
[0m17:23:50.280062 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:23:50.280747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:23:50.693639 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:23:50.694385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d17a110-6896-4940-917c-4dc2e6fe5e25', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842a2c30>]}
[0m17:23:50.719086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d17a110-6896-4940-917c-4dc2e6fe5e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ece5d60>]}
[0m17:23:50.738850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d17a110-6896-4940-917c-4dc2e6fe5e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8439bfb0>]}
[0m17:23:50.739610 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:23:50.745623 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:23:50.819406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:23:50.819760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:23:50.843071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d17a110-6896-4940-917c-4dc2e6fe5e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98955130>]}
[0m17:23:50.895199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d17a110-6896-4940-917c-4dc2e6fe5e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e966630>]}
[0m17:23:50.895598 [info ] [MainThread]: Found 7 models, 1 snapshot, 35 data tests, 1 source, 454 macros
[0m17:23:50.896023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d17a110-6896-4940-917c-4dc2e6fe5e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e78ec90>]}
[0m17:23:50.896933 [info ] [MainThread]: 
[0m17:23:50.897327 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:50.897850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m17:23:50.904529 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m17:23:50.904778 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m17:23:50.904984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:51.629063 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.724 seconds
[0m17:23:51.632702 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m17:23:51.845630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m17:23:51.847685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_marts'
[0m17:23:51.858225 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m17:23:51.858756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m17:23:51.860197 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_marts"
[0m17:23:51.860569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_intermediate'
[0m17:23:51.860931 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m17:23:51.862380 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m17:23:51.862755 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_marts"} */
show objects in ASH_DB.STOCK_RAW_marts limit 10000
[0m17:23:51.863958 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_intermediate"
[0m17:23:51.864251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:51.864534 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m17:23:51.864806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:51.865102 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_intermediate"} */
show objects in ASH_DB.STOCK_RAW_intermediate limit 10000
[0m17:23:51.866740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:51.872275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:52.283639 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c73-0106-ed95-000f-c0df00709042
[0m17:23:52.284143 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:23:52.284510 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:23:52.284768 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:23:52.285079 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: Close
[0m17:23:52.415783 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c73-0106-eb82-000f-c0df006fd41e
[0m17:23:52.416223 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c73-0106-eb82-000f-c0df006fd41a
[0m17:23:52.417026 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:23:52.418141 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.551 seconds
[0m17:23:52.418787 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:23:52.420013 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:23:52.422324 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m17:23:52.423433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_marts, now list_ASH_DB_STOCK_RAW_staging)
[0m17:23:52.424027 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:23:52.424541 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:23:52.428756 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_staging"
[0m17:23:52.429242 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:23:52.429740 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m17:23:52.430177 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_staging"} */
show objects in ASH_DB.STOCK_RAW_staging limit 10000
[0m17:23:52.430650 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: Close
[0m17:23:52.432728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:52.778796 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c73-0106-ebe6-000f-c0df00701632
[0m17:23:52.780179 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:23:52.781309 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:23:52.781942 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:23:52.782580 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: Close
[0m17:23:52.913511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d17a110-6896-4940-917c-4dc2e6fe5e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddaacc0>]}
[0m17:23:52.915095 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:23:52.918783 [info ] [MainThread]: 
[0m17:23:52.931385 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m17:23:52.932546 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m17:23:52.933708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_staging, now snapshot.stock_analytics.stock_price_snapshot)
[0m17:23:52.934296 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m17:23:52.945189 [debug] [Thread-1 (]: Compilation Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:23:52.946685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d17a110-6896-4940-917c-4dc2e6fe5e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3e2e10>]}
[0m17:23:52.947470 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stock_price_snapshot ....................... [[31mERROR[0m in 0.01s]
[0m17:23:52.948354 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m17:23:52.950386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:52.950766 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_test_failures' was properly closed.
[0m17:23:52.951059 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m17:23:52.951345 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m17:23:52.951621 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_intermediate' was properly closed.
[0m17:23:52.951905 [info ] [MainThread]: 
[0m17:23:52.952425 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m17:23:52.953061 [debug] [MainThread]: Command end result
[0m17:23:52.985661 [info ] [MainThread]: 
[0m17:23:52.986712 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:23:52.987749 [info ] [MainThread]: 
[0m17:23:52.988467 [error] [MainThread]:   Compilation Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:23:52.989060 [info ] [MainThread]: 
[0m17:23:52.989568 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:23:52.993438 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 2.7599337, "process_user_time": 2.267946, "process_kernel_time": 0.259076, "process_mem_max_rss": "237568", "process_out_blocks": "2390", "command_success": false, "process_in_blocks": "0"}
[0m17:23:52.994668 [debug] [MainThread]: Command `dbt snapshot` failed at 17:23:52.994553 after 2.76 seconds
[0m17:23:52.995325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec2d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08f92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb2d4c0>]}
[0m17:23:52.995751 [debug] [MainThread]: Flushing usage events
[0m17:27:49.399029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fe5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92499970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b90560>]}
[0m17:27:49.399759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e95ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3094bf0>]}


============================== 17:27:49.403626 | 599a9597-ffe0-429d-89e9-d160a8f783ff ==============================
[0m17:27:49.403626 [info ] [MainThread]: Running with dbt=1.8.8


============================== 17:27:49.403675 | df752758-bce2-427b-a6f1-f53ca6d2b602 ==============================
[0m17:27:49.403675 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:27:49.404234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:27:49.404272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:27:49.431095 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:27:49.431776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '599a9597-ffe0-429d-89e9-d160a8f783ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9276bdd0>]}
[0m17:27:49.461380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '599a9597-ffe0-429d-89e9-d160a8f783ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9232cd40>]}
[0m17:27:49.538199 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:27:49.539518 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:27:49.540191 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.18624, "process_user_time": 0.934704, "process_kernel_time": 0.095173, "process_mem_max_rss": "237588", "process_in_blocks": "192", "process_out_blocks": "4"}
[0m17:27:49.540563 [debug] [MainThread]: Command `dbt deps` succeeded at 17:27:49.540508 after 0.19 seconds
[0m17:27:49.540835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cf05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9232cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fc02f0>]}
[0m17:27:49.541094 [debug] [MainThread]: Flushing usage events
[0m17:27:49.865696 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:27:49.866680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d6ae10>]}
[0m17:27:49.898811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8221f680>]}
[0m17:27:49.928297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fbef00>]}
[0m17:27:49.928966 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:27:49.936640 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:27:50.087637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:50.088218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:50.117386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f6fcb0>]}
[0m17:27:50.197703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e9a3f0>]}
[0m17:27:50.198111 [info ] [MainThread]: Found 7 models, 1 snapshot, 35 data tests, 1 source, 454 macros
[0m17:27:50.198456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2cece00>]}
[0m17:27:50.199745 [info ] [MainThread]: 
[0m17:27:50.200352 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:27:50.202804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m17:27:50.203186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m17:27:50.210005 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m17:27:50.210315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m17:27:50.211481 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m17:27:50.211748 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m17:27:50.212674 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m17:27:50.212967 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m17:27:50.213276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:50.213511 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m17:27:50.213750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:50.215526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:50.839540 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.626 seconds
[0m17:27:50.841186 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.626 seconds
[0m17:27:50.842918 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m17:27:50.844174 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m17:27:50.852206 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.638 seconds
[0m17:27:50.853496 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m17:27:50.996847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_RAW_intermediate)
[0m17:27:50.997418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_RAW_staging)
[0m17:27:50.997864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_RAW_marts)
[0m17:27:50.998278 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_RAW_intermediate"
"
[0m17:27:50.998616 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_RAW_staging"
"
[0m17:27:50.998938 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_RAW_marts"
"
[0m17:27:51.001983 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_RAW_intermediate"
[0m17:27:51.003141 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_RAW_staging"
[0m17:27:51.004234 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_RAW_marts"
[0m17:27:51.004549 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_RAW_intermediate"} */
create schema if not exists ASH_DB.STOCK_RAW_intermediate
[0m17:27:51.004833 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_RAW_staging"} */
create schema if not exists ASH_DB.STOCK_RAW_staging
[0m17:27:51.005120 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_RAW_marts"} */
create schema if not exists ASH_DB.STOCK_RAW_marts
[0m17:27:51.005419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:51.005656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:51.005925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:51.463081 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.458 seconds
[0m17:27:51.463972 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_intermediate: Close
[0m17:27:51.507992 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.502 seconds
[0m17:27:51.508732 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_staging: Close
[0m17:27:51.600671 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.595 seconds
[0m17:27:51.601360 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_marts: Close
[0m17:27:51.705461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_RAW_intermediate, now list_ASH_DB_snapshots)
[0m17:27:51.706270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_RAW_staging, now list_ASH_DB_STOCK_RAW_test_failures)
[0m17:27:51.706785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_RAW_marts, now list_ASH_DB_STOCK_RAW_intermediate)
[0m17:27:51.707322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_staging'
[0m17:27:51.713673 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m17:27:51.715170 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m17:27:51.716617 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_intermediate"
[0m17:27:51.718836 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_staging"
[0m17:27:51.719193 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m17:27:51.719505 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m17:27:51.719891 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_intermediate"} */
show objects in ASH_DB.STOCK_RAW_intermediate limit 10000
[0m17:27:51.720252 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_staging"} */
show objects in ASH_DB.STOCK_RAW_staging limit 10000
[0m17:27:51.720560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:51.720880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:51.721194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:51.721475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:52.103874 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c77-0106-eb82-000f-c0df006fd426
[0m17:27:52.104351 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:27:52.104758 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:27:52.105015 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:27:52.105273 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m17:27:52.115189 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.394 seconds
[0m17:27:52.116234 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: Close
[0m17:27:52.223907 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.503 seconds
[0m17:27:52.229086 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m17:27:52.253733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_intermediate, now list_ASH_DB_STOCK_RAW_marts)
[0m17:27:52.256674 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_marts"
[0m17:27:52.257071 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_marts"} */
show objects in ASH_DB.STOCK_RAW_marts limit 10000
[0m17:27:52.257362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:52.272405 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.551 seconds
[0m17:27:52.273752 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: Close
[0m17:27:52.717972 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.461 seconds
[0m17:27:52.719036 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: Close
[0m17:27:52.840989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c57ec0>]}
[0m17:27:52.841696 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:27:52.842117 [info ] [MainThread]: 
[0m17:27:52.848444 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m17:27:52.848966 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_staging.stg_stock_daily .................. [RUN]
[0m17:27:52.849337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_marts, now model.stock_analytics.stg_stock_daily)
[0m17:27:52.849618 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m17:27:52.854434 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m17:27:52.856932 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m17:27:52.874616 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m17:27:52.875034 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m17:27:52.875317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:54.107261 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.232 seconds
[0m17:27:54.115626 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m17:27:54.119005 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m17:27:54.119409 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_staging.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m17:27:54.594554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m17:27:54.620392 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m17:27:54.621354 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_staging.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m17:27:54.710481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m17:27:54.742873 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m17:27:54.884528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8227aa50>]}
[0m17:27:54.885963 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_staging.stg_stock_daily ............. [[32mSUCCESS 1[0m in 2.03s]
[0m17:27:54.887395 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m17:27:54.890725 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m17:27:54.891870 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m17:27:54.893136 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m17:27:54.893839 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m17:27:54.894870 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_intermediate.int_bollinger .............. [RUN]
[0m17:27:54.896046 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_intermediate.int_daily_returns .......... [RUN]
[0m17:27:54.897121 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_intermediate.int_macd ................... [RUN]
[0m17:27:54.897870 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_intermediate.int_moving_averages ........ [RUN]
[0m17:27:54.898797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_bollinger)
[0m17:27:54.899368 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.int_daily_returns)
[0m17:27:54.899920 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_staging, now model.stock_analytics.int_macd)
[0m17:27:54.900363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m17:27:54.900828 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m17:27:54.901285 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m17:27:54.901754 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m17:27:54.902220 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m17:27:54.906213 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m17:27:54.908924 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m17:27:54.912963 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m17:27:54.916746 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m17:27:54.919174 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m17:27:54.919528 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m17:27:54.932004 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m17:27:54.934252 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m17:27:54.934465 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m17:27:54.935879 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m17:27:54.937139 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m17:27:54.939033 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m17:27:54.940925 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m17:27:54.941902 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m17:27:54.942140 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_daily_returns
         as
        (
SELECT
	SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Previous day's close
    LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
    
    -- Daily change (absolte)
    "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
    
    -- Daily return (percentage)
    ROUND(
        ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
        / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
        4
    ) AS ADJ_DAILY_RETURN_PCT
    
    -- Log return (for financial analysis)
    LN(
        "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
    ) AS LOG_RETURN,
    
    -- Rolling volatility (20-day standard deviation)
    ROUND(
        STDDEV(
            ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
            / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
        ) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,
    
    -- Cumulative return from start
    ROUND(
        (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT

FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
WHERE DATE_QUALITY_FLAG = 'VALID'
        );
[0m17:27:54.943559 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m17:27:54.942551 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m17:27:54.944433 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m17:27:54.944654 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:27:54.944920 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m17:27:54.945219 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:27:54.945520 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26
    
    - Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m17:27:54.947911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:27:54.949571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:55.323858 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03c77-0106-eb84-000f-c0df006f674e
[0m17:27:55.328254 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 4 unexpected 'LN'.
syntax error line 24 at position 79 unexpected ')'.
[0m17:27:55.329411 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m17:27:55.360058 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03c77-0106-ebe6-000f-c0df00701636
[0m17:27:55.360950 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 4 unexpected '-'.
syntax error line 65 at position 16 unexpected 'ROWS'.
[0m17:27:55.362250 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m17:27:55.460016 [debug] [Thread-4 (]: Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'LN'.
  syntax error line 24 at position 79 unexpected ')'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m17:27:55.462707 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8072e750>]}
[0m17:27:55.463555 [error] [Thread-4 (]: 3 of 7 ERROR creating sql table model STOCK_RAW_intermediate.int_daily_returns . [[31mERROR[0m in 0.56s]
[0m17:27:55.464069 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m17:27:55.464415 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_rsi
[0m17:27:55.465505 [info ] [Thread-4 (]: 6 of 7 START sql table model STOCK_RAW_intermediate.int_rsi .................... [RUN]
[0m17:27:55.465928 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_daily_returns, now model.stock_analytics.int_rsi)
[0m17:27:55.466172 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_rsi
[0m17:27:55.468272 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m17:27:55.469608 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_rsi
[0m17:27:55.471560 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m17:27:55.472700 [debug] [Thread-1 (]: Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m17:27:55.473252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8063b770>]}
[0m17:27:55.473691 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model STOCK_RAW_intermediate.int_moving_averages  [[31mERROR[0m in 0.57s]
[0m17:27:55.474561 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m17:27:55.475348 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m17:27:55.475075 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m17:27:55.475600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:27:56.949046 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.001 seconds
[0m17:27:56.953810 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m17:27:56.955686 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_macd IS $$MACD indicator$$;
[0m17:27:57.179481 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.234 seconds
[0m17:27:57.181037 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m17:27:57.185681 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m17:27:57.207647 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m17:27:57.208579 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_bollinger IS $$Bollinger Bands$$;
[0m17:27:57.209182 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_macd
[0m17:27:57.341891 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.130 seconds
[0m17:27:57.347691 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m17:27:57.348806 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m17:27:57.375976 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.166 seconds
[0m17:27:57.379697 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m17:27:57.380321 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_bollinger
[0m17:27:57.486488 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m17:27:57.492004 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m17:27:57.493236 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m17:27:57.498440 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.023 seconds
[0m17:27:57.500901 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m17:27:57.501465 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m17:27:57.573119 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m17:27:57.578208 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m17:27:57.617815 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m17:27:57.624801 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m17:27:57.625940 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_rsi
[0m17:27:57.698115 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807d4ce0>]}
[0m17:27:57.699470 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_intermediate.int_macd .............. [[32mSUCCESS 1[0m in 2.80s]
[0m17:27:57.701826 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m17:27:57.710409 [debug] [Thread-4 (]: SQL status: SUCCESS 8 in 0.084 seconds
[0m17:27:57.713425 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m17:27:57.714057 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m17:27:57.716790 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m17:27:57.719110 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m17:27:57.850871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8071af00>]}
[0m17:27:57.852388 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_intermediate.int_bollinger ......... [[32mSUCCESS 1[0m in 2.95s]
[0m17:27:57.854075 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m17:27:57.856906 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m17:27:57.861265 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: Close
[0m17:27:57.981128 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df752758-bce2-427b-a6f1-f53ca6d2b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8063bf80>]}
[0m17:27:57.982696 [info ] [Thread-4 (]: 6 of 7 OK created sql table model STOCK_RAW_intermediate.int_rsi ............... [[32mSUCCESS 1[0m in 2.51s]
[0m17:27:57.986095 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_rsi
[0m17:27:57.988089 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m17:27:57.988935 [info ] [Thread-1 (]: 7 of 7 SKIP relation STOCK_RAW_marts.mart_stock_daily_metrics .................. [[33mSKIP[0m]
[0m17:27:57.990070 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m17:27:57.994549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:57.995578 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m17:27:57.996067 [debug] [MainThread]: Connection 'model.stock_analytics.int_moving_averages' was properly closed.
[0m17:27:57.996443 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m17:27:57.996807 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m17:27:57.997374 [info ] [MainThread]: 
[0m17:27:57.997905 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 7.80 seconds (7.80s).
[0m17:27:58.000025 [debug] [MainThread]: Command end result
[0m17:27:58.040104 [info ] [MainThread]: 
[0m17:27:58.041020 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:27:58.042121 [info ] [MainThread]: 
[0m17:27:58.042887 [error] [MainThread]:   Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'LN'.
  syntax error line 24 at position 79 unexpected ')'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m17:27:58.043924 [info ] [MainThread]: 
[0m17:27:58.044808 [error] [MainThread]:   Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m17:27:58.046856 [info ] [MainThread]: 
[0m17:27:58.049411 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 TOTAL=7
[0m17:27:58.053116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.698797, "process_user_time": 2.884672, "process_kernel_time": 0.290009, "process_mem_max_rss": "237572", "process_in_blocks": "96", "process_out_blocks": "2550", "command_success": false}
[0m17:27:58.053879 [debug] [MainThread]: Command `dbt run` failed at 17:27:58.053785 after 8.70 seconds
[0m17:27:58.055039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa097f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63902f0>]}
[0m17:27:58.055487 [debug] [MainThread]: Flushing usage events
[0m17:28:15.044293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8296a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87c6c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c53530>]}


============================== 17:28:15.048586 | d934e390-2b74-4e92-a915-5045b12f138f ==============================
[0m17:28:15.048586 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:28:15.049213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:28:15.052532 [info ] [MainThread]: dbt version: 1.8.8
[0m17:28:15.052896 [info ] [MainThread]: python version: 3.12.4
[0m17:28:15.053194 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:28:15.053541 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:28:15.378287 [info ] [MainThread]: Using profiles dir at .
[0m17:28:15.378804 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:28:15.379110 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m17:28:15.379509 [info ] [MainThread]: adapter type: snowflake
[0m17:28:15.379777 [info ] [MainThread]: adapter version: 1.8.4
[0m17:28:15.400505 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:28:15.400851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd934e390-2b74-4e92-a915-5045b12f138f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca8e2a0>]}
[0m17:28:15.412127 [info ] [MainThread]: Configuration:
[0m17:28:15.412473 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:28:15.412748 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:28:15.413020 [info ] [MainThread]: Required dependencies:
[0m17:28:15.413288 [debug] [MainThread]: Executing "git --help"
[0m17:28:15.414813 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:28:15.415057 [debug] [MainThread]: STDERR: "b''"
[0m17:28:15.415256 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:28:15.415529 [info ] [MainThread]: Connection:
[0m17:28:15.415845 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m17:28:15.416089 [info ] [MainThread]:   user: MALLARD
[0m17:28:15.416324 [info ] [MainThread]:   database: ASH_DB
[0m17:28:15.416565 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m17:28:15.416809 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:28:15.417024 [info ] [MainThread]:   schema: STOCK_RAW
[0m17:28:15.417242 [info ] [MainThread]:   authenticator: None
[0m17:28:15.417451 [info ] [MainThread]:   oauth_client_id: None
[0m17:28:15.417707 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m17:28:15.418178 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:28:15.418412 [info ] [MainThread]:   host: None
[0m17:28:15.418664 [info ] [MainThread]:   port: None
[0m17:28:15.418926 [info ] [MainThread]:   proxy_host: None
[0m17:28:15.419160 [info ] [MainThread]:   proxy_port: None
[0m17:28:15.419390 [info ] [MainThread]:   protocol: None
[0m17:28:15.419639 [info ] [MainThread]:   connect_retries: 1
[0m17:28:15.419910 [info ] [MainThread]:   connect_timeout: None
[0m17:28:15.420137 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:28:15.420355 [info ] [MainThread]:   retry_all: False
[0m17:28:15.420612 [info ] [MainThread]:   insecure_mode: False
[0m17:28:15.420856 [info ] [MainThread]:   reuse_connections: None
[0m17:28:15.421136 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:28:15.422658 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:28:15.423058 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:28:15.423282 [debug] [MainThread]: On debug: select 1 as id
[0m17:28:15.423508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:16.065736 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.642 seconds
[0m17:28:16.066511 [debug] [MainThread]: On debug: Close
[0m17:28:16.169715 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:28:16.170273 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:28:16.170957 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1603777, "process_user_time": 1.72167, "process_kernel_time": 0.118114, "process_mem_max_rss": "237560", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m17:28:16.171316 [debug] [MainThread]: Command `dbt debug` succeeded at 17:28:16.171270 after 1.16 seconds
[0m17:28:16.171559 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:28:16.171823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c8eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a997710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875652e0>]}
[0m17:28:16.172115 [debug] [MainThread]: Flushing usage events
[0m17:28:19.017204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908d7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918d1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91466d80>]}


============================== 17:28:19.020585 | 8361af4c-3d61-4d8b-8d1d-387405dada3e ==============================
[0m17:28:19.020585 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:28:19.020945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:28:19.041937 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:28:19.042394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8361af4c-3d61-4d8b-8d1d-387405dada3e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902d2f00>]}
[0m17:28:19.067326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8361af4c-3d61-4d8b-8d1d-387405dada3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91043380>]}
[0m17:28:19.072720 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:28:19.073930 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:28:19.074563 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.091512956, "process_user_time": 0.882317, "process_kernel_time": 0.071944, "process_mem_max_rss": "237552", "process_out_blocks": "4", "process_in_blocks": "0"}
[0m17:28:19.074911 [debug] [MainThread]: Command `dbt deps` succeeded at 17:28:19.074856 after 0.09 seconds
[0m17:28:19.075170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e81130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9001ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d770e0>]}
[0m17:28:19.075418 [debug] [MainThread]: Flushing usage events
[0m17:28:21.774311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8ad520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5eab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f97e1e0>]}


============================== 17:28:21.777855 | 067a58f5-c14b-4d25-b607-4b900b3f15b6 ==============================
[0m17:28:21.777855 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:28:21.778615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:28:22.178211 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:28:22.178897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '067a58f5-c14b-4d25-b607-4b900b3f15b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea791c0>]}
[0m17:28:22.202834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '067a58f5-c14b-4d25-b607-4b900b3f15b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69967680>]}
[0m17:28:22.224661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '067a58f5-c14b-4d25-b607-4b900b3f15b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f76bec0>]}
[0m17:28:22.225282 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:28:22.231708 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:28:22.310082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:28:22.310534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:28:22.335776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067a58f5-c14b-4d25-b607-4b900b3f15b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f12d9a0>]}
[0m17:28:22.397148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067a58f5-c14b-4d25-b607-4b900b3f15b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f05ac90>]}
[0m17:28:22.397561 [info ] [MainThread]: Found 7 models, 1 snapshot, 35 data tests, 1 source, 454 macros
[0m17:28:22.398092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067a58f5-c14b-4d25-b607-4b900b3f15b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ee82330>]}
[0m17:28:22.399307 [info ] [MainThread]: 
[0m17:28:22.399929 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:28:22.400511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m17:28:22.409117 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m17:28:22.409622 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m17:28:22.409964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:22.808453 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.398 seconds
[0m17:28:22.809657 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m17:28:22.911117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_staging)
[0m17:28:22.911625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m17:28:22.912332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m17:28:22.916700 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_staging"
[0m17:28:22.917087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_intermediate'
[0m17:28:22.918127 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m17:28:22.919263 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m17:28:22.919573 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_staging"} */
show objects in ASH_DB.STOCK_RAW_staging limit 10000
[0m17:28:22.920595 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_intermediate"
[0m17:28:22.920856 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m17:28:22.921123 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m17:28:22.921372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:22.921643 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_intermediate"} */
show objects in ASH_DB.STOCK_RAW_intermediate limit 10000
[0m17:28:22.921882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:22.922128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:22.923058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:23.372158 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c78-0106-eb82-000f-c0df006fd43e
[0m17:28:23.372629 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:28:23.373096 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:28:23.373467 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:28:23.373919 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m17:28:23.403442 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.481 seconds
[0m17:28:23.404535 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m17:28:23.418431 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.497 seconds
[0m17:28:23.419417 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: Close
[0m17:28:23.478700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now list_ASH_DB_STOCK_RAW_marts)
[0m17:28:23.480141 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_marts"
[0m17:28:23.480412 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_marts"} */
show objects in ASH_DB.STOCK_RAW_marts limit 10000
[0m17:28:23.480674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:23.504449 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.581 seconds
[0m17:28:23.505539 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: Close
[0m17:28:23.838981 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.358 seconds
[0m17:28:23.839940 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: Close
[0m17:28:23.975547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067a58f5-c14b-4d25-b607-4b900b3f15b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6992bef0>]}
[0m17:28:23.976009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:28:23.976507 [info ] [MainThread]: 
[0m17:28:23.981941 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m17:28:23.982352 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m17:28:23.982796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_marts, now snapshot.stock_analytics.stock_price_snapshot)
[0m17:28:23.983024 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m17:28:23.987886 [debug] [Thread-1 (]: Compilation Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:28:23.988632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067a58f5-c14b-4d25-b607-4b900b3f15b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9e8560>]}
[0m17:28:23.989050 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stock_price_snapshot ....................... [[31mERROR[0m in 0.01s]
[0m17:28:23.989485 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m17:28:23.990553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:23.990795 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_staging' was properly closed.
[0m17:28:23.990998 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m17:28:23.991185 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m17:28:23.991364 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_intermediate' was properly closed.
[0m17:28:23.991565 [info ] [MainThread]: 
[0m17:28:23.991907 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m17:28:23.992329 [debug] [MainThread]: Command end result
[0m17:28:24.015920 [info ] [MainThread]: 
[0m17:28:24.016750 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:28:24.017269 [info ] [MainThread]: 
[0m17:28:24.017834 [error] [MainThread]:   Compilation Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:28:24.018353 [info ] [MainThread]: 
[0m17:28:24.018726 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:28:24.019506 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 2.2823913, "process_user_time": 2.10954, "process_kernel_time": 0.12415, "process_mem_max_rss": "237556", "process_out_blocks": "2387", "command_success": false, "process_in_blocks": "0"}
[0m17:28:24.022893 [debug] [MainThread]: Command `dbt snapshot` failed at 17:28:24.022810 after 2.29 seconds
[0m17:28:24.023399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8ad520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6449b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6453a0>]}
[0m17:28:24.023750 [debug] [MainThread]: Flushing usage events
[0m17:33:27.023195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c3bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c3bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc77260>]}


============================== 17:33:27.027959 | 7411a14e-bdd3-4079-ae93-b3373c334937 ==============================
[0m17:33:27.027959 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:33:27.029520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir .', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:27.527056 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:33:27.527923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7411a14e-bdd3-4079-ae93-b3373c334937', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9b1a60>]}
[0m17:33:27.570712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7411a14e-bdd3-4079-ae93-b3373c334937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d4bf440>]}
[0m17:33:27.595913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7411a14e-bdd3-4079-ae93-b3373c334937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3f9460>]}
[0m17:33:27.597335 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:33:27.600084 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m17:33:27.601378 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.61895317, "process_user_time": 1.927724, "process_kernel_time": 0.26631, "process_mem_max_rss": "237552", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:33:27.601855 [debug] [MainThread]: Command `dbt snapshot` failed at 17:33:27.601789 after 0.62 seconds
[0m17:33:27.602317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a838980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4414c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c972750>]}
[0m17:33:27.603048 [debug] [MainThread]: Flushing usage events
[0m09:34:05.735635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110160b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110160890>]}


============================== 09:34:05.738643 | 53191da0-a59c-4dce-b401-acd44d2d77cf ==============================
[0m09:34:05.738643 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m09:34:05.738891 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps --profiles-dir .', 'profiles_dir': '.', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/dingyuyao/airflow-docker/dbt/logs', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m09:34:05.847597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53191da0-a59c-4dce-b401-acd44d2d77cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e1a00>]}
[0m09:34:05.858433 [debug] [MainThread]: Set downloads directory='/var/folders/4f/6jnm_f3j7nj7w5jj9_61s9y40000gn/T/dbt-downloads-yjy6y7jm'
[0m09:34:05.858647 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:34:06.179042 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:34:06.180810 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:34:06.391902 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:34:06.406701 [info ] [MainThread]: Updating lock file in file path: /Users/dingyuyao/airflow-docker/dbt/package-lock.yml
[0m09:34:06.409529 [debug] [MainThread]: Set downloads directory='/var/folders/4f/6jnm_f3j7nj7w5jj9_61s9y40000gn/T/dbt-downloads-jrmow4rb'
[0m09:34:06.410947 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:34:06.930542 [info ] [MainThread]: Installed from version 1.1.1
[0m09:34:06.930811 [info ] [MainThread]: Updated version available: 1.3.2
[0m09:34:06.930992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '53191da0-a59c-4dce-b401-acd44d2d77cf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f43b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e1c10>]}
[0m09:34:06.931174 [info ] [MainThread]: 
[0m09:34:06.931305 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m09:34:06.951301 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2439008, "process_in_blocks": "0", "process_kernel_time": 0.135934, "process_mem_max_rss": "116736000", "process_out_blocks": "0", "process_user_time": 0.639742}
[0m09:34:06.951735 [debug] [MainThread]: Command `dbt deps` succeeded at 09:34:06.951676 after 1.24 seconds
[0m09:34:06.951926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101608f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110160890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110322930>]}
[0m09:34:06.952093 [debug] [MainThread]: Flushing usage events
[0m09:34:07.227703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:10.373026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a1b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a1b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a18a70>]}


============================== 17:36:10.376545 | 9c6ccfc9-103a-40d3-a412-c0e9fd884346 ==============================
[0m17:36:10.376545 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:36:10.376937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:10.380094 [info ] [MainThread]: dbt version: 1.8.8
[0m17:36:10.380339 [info ] [MainThread]: python version: 3.12.4
[0m17:36:10.380648 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:36:10.380958 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:36:10.726461 [info ] [MainThread]: Using profiles dir at .
[0m17:36:10.727069 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:36:10.727394 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m17:36:10.727789 [info ] [MainThread]: adapter type: snowflake
[0m17:36:10.728087 [info ] [MainThread]: adapter version: 1.8.4
[0m17:36:10.749036 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:36:10.749513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c6ccfc9-103a-40d3-a412-c0e9fd884346', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff637ce870>]}
[0m17:36:10.763145 [info ] [MainThread]: Configuration:
[0m17:36:10.763464 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:36:10.763744 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:36:10.764053 [info ] [MainThread]: Required dependencies:
[0m17:36:10.764321 [debug] [MainThread]: Executing "git --help"
[0m17:36:10.765870 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:36:10.766136 [debug] [MainThread]: STDERR: "b''"
[0m17:36:10.766338 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:36:10.766685 [info ] [MainThread]: Connection:
[0m17:36:10.766936 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m17:36:10.767183 [info ] [MainThread]:   user: MALLARD
[0m17:36:10.767427 [info ] [MainThread]:   database: ASH_DB
[0m17:36:10.767682 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m17:36:10.767923 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:36:10.768157 [info ] [MainThread]:   schema: STOCK_RAW
[0m17:36:10.768391 [info ] [MainThread]:   authenticator: None
[0m17:36:10.768635 [info ] [MainThread]:   oauth_client_id: None
[0m17:36:10.768878 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m17:36:10.769378 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:36:10.769623 [info ] [MainThread]:   host: None
[0m17:36:10.769866 [info ] [MainThread]:   port: None
[0m17:36:10.770126 [info ] [MainThread]:   proxy_host: None
[0m17:36:10.770360 [info ] [MainThread]:   proxy_port: None
[0m17:36:10.770603 [info ] [MainThread]:   protocol: None
[0m17:36:10.770835 [info ] [MainThread]:   connect_retries: 1
[0m17:36:10.771075 [info ] [MainThread]:   connect_timeout: None
[0m17:36:10.771329 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:36:10.771564 [info ] [MainThread]:   retry_all: False
[0m17:36:10.771841 [info ] [MainThread]:   insecure_mode: False
[0m17:36:10.772193 [info ] [MainThread]:   reuse_connections: None
[0m17:36:10.772525 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:36:10.774132 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:36:10.774501 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:36:10.774696 [debug] [MainThread]: On debug: select 1 as id
[0m17:36:10.774868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:11.185192 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.410 seconds
[0m17:36:11.187684 [debug] [MainThread]: On debug: Close
[0m17:36:11.292400 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:36:11.293758 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:36:11.295297 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9563668, "process_user_time": 1.747011, "process_kernel_time": 0.144573, "process_mem_max_rss": "237552", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m17:36:11.295947 [debug] [MainThread]: Command `dbt debug` succeeded at 17:36:11.295847 after 0.96 seconds
[0m17:36:11.296344 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:36:11.296764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82db2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63123bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62af2b40>]}
[0m17:36:11.297196 [debug] [MainThread]: Flushing usage events
[0m17:36:14.643839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e138f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e136b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f3cbf0>]}


============================== 17:36:14.647493 | ceae35f9-c199-4e23-8ce6-f0aa0fe33269 ==============================
[0m17:36:14.647493 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:36:14.648313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:36:14.675161 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:36:14.675765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ceae35f9-c199-4e23-8ce6-f0aa0fe33269', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a4c380>]}
[0m17:36:14.703470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceae35f9-c199-4e23-8ce6-f0aa0fe33269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb32c1310>]}
[0m17:36:14.753894 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1'}} is not valid under any of the given schemas
  
[0m17:36:14.754879 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.15135613, "process_user_time": 0.984459, "process_kernel_time": 0.080942, "process_mem_max_rss": "237544", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:36:14.755302 [debug] [MainThread]: Command `dbt deps` failed at 17:36:14.755252 after 0.15 seconds
[0m17:36:14.755584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36c4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a7f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a3b020>]}
[0m17:36:14.755920 [debug] [MainThread]: Flushing usage events
[0m17:42:06.796478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c07170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945a8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9797ac60>]}


============================== 17:42:06.800763 | 1ae79b8d-5e14-47b6-a983-cad9854cfbcd ==============================
[0m17:42:06.800763 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:42:06.801286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:06.830002 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:42:06.831457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ae79b8d-5e14-47b6-a983-cad9854cfbcd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9393dd60>]}
[0m17:42:06.867038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ae79b8d-5e14-47b6-a983-cad9854cfbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93422900>]}
[0m17:42:06.876197 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.1.1'}} is not valid under any of the given schemas
  
[0m17:42:06.876956 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.1390535, "process_user_time": 1.068919, "process_kernel_time": 0.126051, "process_mem_max_rss": "237552", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:42:06.878570 [debug] [MainThread]: Command `dbt deps` failed at 17:42:06.878497 after 0.14 seconds
[0m17:42:06.879092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c07170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94762b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947606e0>]}
[0m17:42:06.879640 [debug] [MainThread]: Flushing usage events
[0m17:49:15.227849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab865a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6cd220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac53b00>]}


============================== 17:49:15.231924 | 298d52af-a2ff-4f79-a2ed-120e4c5c5a38 ==============================
[0m17:49:15.231924 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:49:15.232551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:49:15.235883 [info ] [MainThread]: dbt version: 1.8.8
[0m17:49:15.236175 [info ] [MainThread]: python version: 3.12.4
[0m17:49:15.236373 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:49:15.236613 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:49:15.646683 [info ] [MainThread]: Using profiles dir at .
[0m17:49:15.647189 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:49:15.647547 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m17:49:15.648014 [info ] [MainThread]: adapter type: snowflake
[0m17:49:15.648313 [info ] [MainThread]: adapter version: 1.8.4
[0m17:49:15.672810 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:49:15.673379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '298d52af-a2ff-4f79-a2ed-120e4c5c5a38', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab867ce0>]}
[0m17:49:15.694442 [info ] [MainThread]: Configuration:
[0m17:49:15.695124 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:49:15.695458 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:49:15.695757 [info ] [MainThread]: Required dependencies:
[0m17:49:15.696107 [debug] [MainThread]: Executing "git --help"
[0m17:49:15.697830 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:49:15.698192 [debug] [MainThread]: STDERR: "b''"
[0m17:49:15.698457 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:49:15.698752 [info ] [MainThread]: Connection:
[0m17:49:15.699030 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m17:49:15.699310 [info ] [MainThread]:   user: MALLARD
[0m17:49:15.699565 [info ] [MainThread]:   database: ASH_DB
[0m17:49:15.699917 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m17:49:15.700204 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:49:15.700459 [info ] [MainThread]:   schema: STOCK_RAW
[0m17:49:15.700728 [info ] [MainThread]:   authenticator: None
[0m17:49:15.700977 [info ] [MainThread]:   oauth_client_id: None
[0m17:49:15.701219 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m17:49:15.701466 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:49:15.701740 [info ] [MainThread]:   host: None
[0m17:49:15.701998 [info ] [MainThread]:   port: None
[0m17:49:15.702268 [info ] [MainThread]:   proxy_host: None
[0m17:49:15.702508 [info ] [MainThread]:   proxy_port: None
[0m17:49:15.702751 [info ] [MainThread]:   protocol: None
[0m17:49:15.702981 [info ] [MainThread]:   connect_retries: 1
[0m17:49:15.703228 [info ] [MainThread]:   connect_timeout: None
[0m17:49:15.703482 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:49:15.703719 [info ] [MainThread]:   retry_all: False
[0m17:49:15.703964 [info ] [MainThread]:   insecure_mode: False
[0m17:49:15.704228 [info ] [MainThread]:   reuse_connections: None
[0m17:49:15.704561 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:49:15.706473 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:49:15.706957 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:49:15.707299 [debug] [MainThread]: On debug: select 1 as id
[0m17:49:15.707658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:16.318737 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.611 seconds
[0m17:49:16.319685 [debug] [MainThread]: On debug: Close
[0m17:49:16.493361 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:49:16.494639 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:49:16.495517 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3082291, "process_user_time": 1.711243, "process_kernel_time": 0.166286, "process_mem_max_rss": "236824", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m17:49:16.495909 [debug] [MainThread]: Command `dbt debug` succeeded at 17:49:16.495848 after 1.31 seconds
[0m17:49:16.496202 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:49:16.496465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad3b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aca3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab8989b0>]}
[0m17:49:16.496751 [debug] [MainThread]: Flushing usage events
[0m17:49:19.211666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881b7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883e0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88680c50>]}


============================== 17:49:19.214920 | 5ca8eda6-8891-49e9-85b8-09f56466d472 ==============================
[0m17:49:19.214920 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:49:19.215426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:19.237179 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:49:19.237524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ca8eda6-8891-49e9-85b8-09f56466d472', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88520980>]}
[0m17:49:19.263634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ca8eda6-8891-49e9-85b8-09f56466d472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886db2c0>]}
[0m17:49:19.268499 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-km5s2vmk'
[0m17:49:19.268815 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:49:19.583799 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:49:19.585279 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:49:19.799763 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:49:19.816939 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m17:49:19.821916 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8iq1ihy2'
[0m17:49:19.824942 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:49:20.504011 [info ] [MainThread]: Installed from version 1.1.1
[0m17:49:20.506886 [info ] [MainThread]: Updated version available: 1.3.2
[0m17:49:20.507670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ca8eda6-8891-49e9-85b8-09f56466d472', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f802c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f80110>]}
[0m17:49:20.508330 [info ] [MainThread]: 
[0m17:49:20.508879 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:49:20.510947 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3335924, "process_user_time": 0.920725, "process_kernel_time": 0.123032, "process_mem_max_rss": "236824", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m17:49:20.511659 [debug] [MainThread]: Command `dbt deps` succeeded at 17:49:20.511542 after 1.33 seconds
[0m17:49:20.512165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8b7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8908e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8839cb00>]}
[0m17:49:20.512555 [debug] [MainThread]: Flushing usage events
[0m17:49:23.439022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909c9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9008f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9008fc50>]}


============================== 17:49:23.442628 | 234c5463-bfe9-4bb6-85f3-ba619bcfcd53 ==============================
[0m17:49:23.442628 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:49:23.443055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:49:23.815123 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:49:23.815515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '234c5463-bfe9-4bb6-85f3-ba619bcfcd53', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff750d9400>]}
[0m17:49:23.840689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '234c5463-bfe9-4bb6-85f3-ba619bcfcd53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f9d36b0>]}
[0m17:49:23.860225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '234c5463-bfe9-4bb6-85f3-ba619bcfcd53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f87dca0>]}
[0m17:49:23.860643 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:49:23.867837 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:49:23.918277 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:49:23.918853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '234c5463-bfe9-4bb6-85f3-ba619bcfcd53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f4ece90>]}
[0m17:49:24.564708 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_unique_combination_of_columns_stg_stock_daily_DATE__SYMBOL__DATE (models/staging/schema.yml)
  macro 'dbt_macro__test_unique_combination_of_columns' takes no keyword argument 'column_name'
[0m17:49:24.565757 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1682329, "process_user_time": 2.533533, "process_kernel_time": 0.16146, "process_mem_max_rss": "236848", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m17:49:24.566178 [debug] [MainThread]: Command `dbt snapshot` failed at 17:49:24.566131 after 1.17 seconds
[0m17:49:24.566419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c8c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f8cbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ef11970>]}
[0m17:49:24.566674 [debug] [MainThread]: Flushing usage events
[0m17:53:15.159739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cefabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b213d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2acbf0>]}


============================== 17:53:15.165400 | 06dd4727-045c-4fce-a731-e5a35ae19cdc ==============================
[0m17:53:15.165400 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:53:15.166216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:53:15.171820 [info ] [MainThread]: dbt version: 1.8.8
[0m17:53:15.172552 [info ] [MainThread]: python version: 3.12.4
[0m17:53:15.172964 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:53:15.173583 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:53:15.527195 [info ] [MainThread]: Using profiles dir at .
[0m17:53:15.527826 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:53:15.528180 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m17:53:15.528543 [info ] [MainThread]: adapter type: snowflake
[0m17:53:15.528876 [info ] [MainThread]: adapter version: 1.8.4
[0m17:53:15.550541 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:53:15.550904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '06dd4727-045c-4fce-a731-e5a35ae19cdc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff624aac90>]}
[0m17:53:15.565025 [info ] [MainThread]: Configuration:
[0m17:53:15.565348 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:53:15.565607 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:53:15.565878 [info ] [MainThread]: Required dependencies:
[0m17:53:15.566171 [debug] [MainThread]: Executing "git --help"
[0m17:53:15.567730 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:53:15.568023 [debug] [MainThread]: STDERR: "b''"
[0m17:53:15.568263 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:53:15.568598 [info ] [MainThread]: Connection:
[0m17:53:15.568902 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m17:53:15.569131 [info ] [MainThread]:   user: MALLARD
[0m17:53:15.569378 [info ] [MainThread]:   database: ASH_DB
[0m17:53:15.569646 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m17:53:15.569897 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:53:15.570144 [info ] [MainThread]:   schema: STOCK_RAW
[0m17:53:15.570389 [info ] [MainThread]:   authenticator: None
[0m17:53:15.570623 [info ] [MainThread]:   oauth_client_id: None
[0m17:53:15.570860 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m17:53:15.571107 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:53:15.571366 [info ] [MainThread]:   host: None
[0m17:53:15.571601 [info ] [MainThread]:   port: None
[0m17:53:15.571836 [info ] [MainThread]:   proxy_host: None
[0m17:53:15.572056 [info ] [MainThread]:   proxy_port: None
[0m17:53:15.572308 [info ] [MainThread]:   protocol: None
[0m17:53:15.572602 [info ] [MainThread]:   connect_retries: 1
[0m17:53:15.572833 [info ] [MainThread]:   connect_timeout: None
[0m17:53:15.573068 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:53:15.573316 [info ] [MainThread]:   retry_all: False
[0m17:53:15.573629 [info ] [MainThread]:   insecure_mode: False
[0m17:53:15.573864 [info ] [MainThread]:   reuse_connections: None
[0m17:53:15.574197 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:53:15.576641 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:53:15.577047 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:53:15.577312 [debug] [MainThread]: On debug: select 1 as id
[0m17:53:15.577555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:16.150901 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.573 seconds
[0m17:53:16.154859 [debug] [MainThread]: On debug: Close
[0m17:53:16.289433 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:53:16.290836 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:53:16.292360 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1732876, "process_user_time": 1.807003, "process_kernel_time": 0.137522, "process_mem_max_rss": "236836", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m17:53:16.293023 [debug] [MainThread]: Command `dbt debug` succeeded at 17:53:16.292929 after 1.17 seconds
[0m17:53:16.293407 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:53:16.293760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d27bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9f65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b561b0>]}
[0m17:53:16.294202 [debug] [MainThread]: Flushing usage events
[0m17:53:19.711591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88554a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88554140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88556450>]}


============================== 17:53:19.715554 | e20f27b2-a301-4226-9f4e-88074b32b237 ==============================
[0m17:53:19.715554 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:53:19.716606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:53:19.741938 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:53:19.742522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e20f27b2-a301-4226-9f4e-88074b32b237', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a7ffe0>]}
[0m17:53:19.780768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e20f27b2-a301-4226-9f4e-88074b32b237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880c9760>]}
[0m17:53:19.830351 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9tvktzo9'
[0m17:53:19.830700 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:53:20.149328 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:53:20.150204 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:53:20.364004 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:53:20.366227 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:53:20.962982 [info ] [MainThread]: Installed from version 1.1.1
[0m17:53:20.963479 [info ] [MainThread]: Updated version available: 1.3.2
[0m17:53:20.963954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e20f27b2-a301-4226-9f4e-88074b32b237', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d2be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d6a900>]}
[0m17:53:20.964228 [info ] [MainThread]: 
[0m17:53:20.964638 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:53:20.965564 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2964202, "process_user_time": 1.099181, "process_kernel_time": 0.202988, "process_mem_max_rss": "236832", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m17:53:20.965902 [debug] [MainThread]: Command `dbt deps` succeeded at 17:53:20.965858 after 1.30 seconds
[0m17:53:20.966193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8810e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c3ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880c9760>]}
[0m17:53:20.966448 [debug] [MainThread]: Flushing usage events
[0m17:53:24.112923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6395b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4d6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b84acf0>]}


============================== 17:53:24.116293 | 6af8ff63-f03d-4c88-93f0-5747fe76ac93 ==============================
[0m17:53:24.116293 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:53:24.116840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:53:24.480402 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:53:24.480990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6af8ff63-f03d-4c88-93f0-5747fe76ac93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bfbf410>]}
[0m17:53:24.503885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6af8ff63-f03d-4c88-93f0-5747fe76ac93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa7c200>]}
[0m17:53:24.523325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6af8ff63-f03d-4c88-93f0-5747fe76ac93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bba8a40>]}
[0m17:53:24.523768 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:53:24.531741 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:53:24.584663 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:53:24.585205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6af8ff63-f03d-4c88-93f0-5747fe76ac93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aad9160>]}
[0m17:53:25.275574 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_DATE__SYMBOL__DATE (models/marts/schema.yml)
  macro 'dbt_macro__test_unique_combination_of_columns' takes no keyword argument 'column_name'
[0m17:53:25.276858 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.2001256, "process_user_time": 2.479305, "process_kernel_time": 0.122247, "process_mem_max_rss": "236836", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m17:53:25.277228 [debug] [MainThread]: Command `dbt snapshot` failed at 17:53:25.277172 after 1.20 seconds
[0m17:53:25.277576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6395b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a55a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aa07ad0>]}
[0m17:53:25.277836 [debug] [MainThread]: Flushing usage events
[0m17:57:23.229741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b6b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9462a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963fe360>]}


============================== 17:57:23.233208 | 8bb86fb0-d4dd-495b-959f-40439704dd58 ==============================
[0m17:57:23.233208 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:57:23.233872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:23.237116 [info ] [MainThread]: dbt version: 1.8.8
[0m17:57:23.237454 [info ] [MainThread]: python version: 3.12.4
[0m17:57:23.237691 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:57:23.237981 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:57:23.615188 [info ] [MainThread]: Using profiles dir at .
[0m17:57:23.615801 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m17:57:23.616171 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m17:57:23.616595 [info ] [MainThread]: adapter type: snowflake
[0m17:57:23.616905 [info ] [MainThread]: adapter version: 1.8.4
[0m17:57:23.640295 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:57:23.640887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8bb86fb0-d4dd-495b-959f-40439704dd58', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783ddd30>]}
[0m17:57:23.655731 [info ] [MainThread]: Configuration:
[0m17:57:23.656127 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:57:23.656480 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:57:23.656808 [info ] [MainThread]: Required dependencies:
[0m17:57:23.657134 [debug] [MainThread]: Executing "git --help"
[0m17:57:23.658842 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:57:23.659198 [debug] [MainThread]: STDERR: "b''"
[0m17:57:23.659451 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:57:23.659758 [info ] [MainThread]: Connection:
[0m17:57:23.660132 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m17:57:23.660456 [info ] [MainThread]:   user: MALLARD
[0m17:57:23.660727 [info ] [MainThread]:   database: ASH_DB
[0m17:57:23.660994 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m17:57:23.661242 [info ] [MainThread]:   role: TRAINING_ROLE
[0m17:57:23.661505 [info ] [MainThread]:   schema: STOCK_RAW
[0m17:57:23.661741 [info ] [MainThread]:   authenticator: None
[0m17:57:23.661967 [info ] [MainThread]:   oauth_client_id: None
[0m17:57:23.662154 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m17:57:23.662380 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:57:23.662593 [info ] [MainThread]:   host: None
[0m17:57:23.662771 [info ] [MainThread]:   port: None
[0m17:57:23.662946 [info ] [MainThread]:   proxy_host: None
[0m17:57:23.663125 [info ] [MainThread]:   proxy_port: None
[0m17:57:23.663293 [info ] [MainThread]:   protocol: None
[0m17:57:23.663480 [info ] [MainThread]:   connect_retries: 1
[0m17:57:23.663705 [info ] [MainThread]:   connect_timeout: None
[0m17:57:23.663895 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:57:23.664094 [info ] [MainThread]:   retry_all: False
[0m17:57:23.664290 [info ] [MainThread]:   insecure_mode: False
[0m17:57:23.664486 [info ] [MainThread]:   reuse_connections: None
[0m17:57:23.664760 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:57:23.666460 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:57:23.666897 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:57:23.667156 [debug] [MainThread]: On debug: select 1 as id
[0m17:57:23.667397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:23.982108 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.315 seconds
[0m17:57:23.986639 [debug] [MainThread]: On debug: Close
[0m17:57:24.102103 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:57:24.104082 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:57:24.106327 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.91323036, "process_user_time": 1.796279, "process_kernel_time": 0.127477, "process_mem_max_rss": "236812", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m17:57:24.107382 [debug] [MainThread]: Command `dbt debug` succeeded at 17:57:24.107285 after 0.91 seconds
[0m17:57:24.107952 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:57:24.108642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9449c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2e7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79917290>]}
[0m17:57:24.109339 [debug] [MainThread]: Flushing usage events
[0m17:57:27.357094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e91bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840988c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8504bb90>]}


============================== 17:57:27.360252 | 01457240-be87-44a4-bfc2-efb8d34c9f7f ==============================
[0m17:57:27.360252 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:57:27.360792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m17:57:27.382676 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:57:27.383089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '01457240-be87-44a4-bfc2-efb8d34c9f7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849cd670>]}
[0m17:57:27.408205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01457240-be87-44a4-bfc2-efb8d34c9f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b7b380>]}
[0m17:57:27.451797 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8j6yv1ka'
[0m17:57:27.452233 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:57:27.785933 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:57:27.787717 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:57:27.982704 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:57:27.989370 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:57:28.625796 [info ] [MainThread]: Installed from version 1.1.1
[0m17:57:28.626467 [info ] [MainThread]: Updated version available: 1.3.2
[0m17:57:28.626893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '01457240-be87-44a4-bfc2-efb8d34c9f7f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f59040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b7b710>]}
[0m17:57:28.627263 [info ] [MainThread]: 
[0m17:57:28.627648 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:57:28.628610 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3066643, "process_user_time": 0.920279, "process_kernel_time": 0.085677, "process_mem_max_rss": "236832", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m17:57:28.628935 [debug] [MainThread]: Command `dbt deps` succeeded at 17:57:28.628891 after 1.31 seconds
[0m17:57:28.629195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d29190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847d1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84253830>]}
[0m17:57:28.629453 [debug] [MainThread]: Flushing usage events
[0m17:57:31.478323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ee8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb906c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90098e0>]}


============================== 17:57:31.482521 | b5bd2c6b-2f76-4568-b5bf-70d11ed5db90 ==============================
[0m17:57:31.482521 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:57:31.484242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:57:32.065177 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:57:32.066392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb190ade0>]}
[0m17:57:32.094128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d274890>]}
[0m17:57:32.114271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ecc350>]}
[0m17:57:32.114777 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:57:32.122648 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m17:57:32.186286 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:57:32.187153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbd8cb0>]}
[0m17:57:33.000818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c32dca0>]}
[0m17:57:33.054626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c249940>]}
[0m17:57:33.054947 [info ] [MainThread]: Found 7 models, 1 snapshot, 35 data tests, 1 source, 568 macros
[0m17:57:33.055559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf45340>]}
[0m17:57:33.056514 [info ] [MainThread]: 
[0m17:57:33.056920 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:57:33.057465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m17:57:33.063182 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m17:57:33.063406 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m17:57:33.063586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:33.530246 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.467 seconds
[0m17:57:33.531576 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m17:57:33.653907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_intermediate)
[0m17:57:33.654682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_staging'
[0m17:57:33.656577 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m17:57:33.662378 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_intermediate"
[0m17:57:33.663861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_marts'
[0m17:57:33.666529 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_staging"
[0m17:57:33.670548 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m17:57:33.672901 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_intermediate"} */
show objects in ASH_DB.STOCK_RAW_intermediate limit 10000
[0m17:57:33.674634 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_marts"
[0m17:57:33.674979 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_staging"} */
show objects in ASH_DB.STOCK_RAW_staging limit 10000
[0m17:57:33.675284 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m17:57:33.675545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:33.675796 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_marts"} */
show objects in ASH_DB.STOCK_RAW_marts limit 10000
[0m17:57:33.676042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:33.676268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:33.677602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:34.023798 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c95-0106-eb7f-000f-c0df0070a016
[0m17:57:34.027129 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:57:34.027557 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:57:34.027795 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:57:34.028034 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m17:57:34.057781 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.380 seconds
[0m17:57:34.058996 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: Close
[0m17:57:34.062547 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.387 seconds
[0m17:57:34.063841 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: Close
[0m17:57:34.096001 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.420 seconds
[0m17:57:34.096955 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: Close
[0m17:57:34.144665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now list_ASH_DB_snapshots)
[0m17:57:34.146522 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m17:57:34.146814 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m17:57:34.147098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:34.592245 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.444 seconds
[0m17:57:34.593685 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m17:57:34.752751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cfba060>]}
[0m17:57:34.753468 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:34.754934 [info ] [MainThread]: 
[0m17:57:34.762251 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m17:57:34.762799 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m17:57:34.763301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now snapshot.stock_analytics.stock_price_snapshot)
[0m17:57:34.763667 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m17:57:34.769633 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m17:57:34.805706 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m17:57:34.806031 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    CLOSE,
    ADJ_CLOSE,
    "MIN" AS LOW,
    "MAX" AS HIGH,
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:57:34.806343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:35.287886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03c95-0106-eb84-000f-c0df006f67e6
[0m17:57:35.288704 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 4
invalid identifier 'ADJ_CLOSE'
[0m17:57:35.289413 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m17:57:35.420246 [debug] [Thread-1 (]: Database Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  000904 (42000): SQL compilation error: error line 23 at position 4
  invalid identifier 'ADJ_CLOSE'
[0m17:57:35.423158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5bd2c6b-2f76-4568-b5bf-70d11ed5db90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7eb6e0>]}
[0m17:57:35.424406 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stock_price_snapshot ....................... [[31mERROR[0m in 0.66s]
[0m17:57:35.425387 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m17:57:35.427894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:35.428248 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_intermediate' was properly closed.
[0m17:57:35.428519 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_staging' was properly closed.
[0m17:57:35.428789 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m17:57:35.429040 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_marts' was properly closed.
[0m17:57:35.429389 [info ] [MainThread]: 
[0m17:57:35.430044 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m17:57:35.430961 [debug] [MainThread]: Command end result
[0m17:57:35.461951 [info ] [MainThread]: 
[0m17:57:35.462583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:57:35.463031 [info ] [MainThread]: 
[0m17:57:35.463397 [error] [MainThread]:   Database Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  000904 (42000): SQL compilation error: error line 23 at position 4
  invalid identifier 'ADJ_CLOSE'
[0m17:57:35.463839 [info ] [MainThread]: 
[0m17:57:35.464269 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:57:35.465117 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.036133, "process_user_time": 3.221488, "process_kernel_time": 0.281307, "process_mem_max_rss": "236812", "process_out_blocks": "4181", "command_success": false, "process_in_blocks": "0"}
[0m17:57:35.465506 [debug] [MainThread]: Command `dbt snapshot` failed at 17:57:35.465460 after 4.04 seconds
[0m17:57:35.465816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba308cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3726120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9318470>]}
[0m17:57:35.466040 [debug] [MainThread]: Flushing usage events
[0m18:00:25.245859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b27f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0ecec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba5cbf0>]}


============================== 18:00:25.249521 | f09ca858-d9bb-49f6-b24d-5e9e5dfb8203 ==============================
[0m18:00:25.249521 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:00:25.250053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:25.253908 [info ] [MainThread]: dbt version: 1.8.8
[0m18:00:25.254249 [info ] [MainThread]: python version: 3.12.4
[0m18:00:25.254609 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:00:25.255065 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m18:00:25.649663 [info ] [MainThread]: Using profiles dir at .
[0m18:00:25.650307 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m18:00:25.650748 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m18:00:25.651152 [info ] [MainThread]: adapter type: snowflake
[0m18:00:25.651465 [info ] [MainThread]: adapter version: 1.8.4
[0m18:00:25.676567 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:25.677230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f09ca858-d9bb-49f6-b24d-5e9e5dfb8203', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5af73890>]}
[0m18:00:25.699623 [info ] [MainThread]: Configuration:
[0m18:00:25.700245 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:00:25.700584 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:00:25.700943 [info ] [MainThread]: Required dependencies:
[0m18:00:25.701261 [debug] [MainThread]: Executing "git --help"
[0m18:00:25.702950 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:00:25.703222 [debug] [MainThread]: STDERR: "b''"
[0m18:00:25.703438 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:00:25.703964 [info ] [MainThread]: Connection:
[0m18:00:25.704453 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m18:00:25.704802 [info ] [MainThread]:   user: MALLARD
[0m18:00:25.705108 [info ] [MainThread]:   database: ASH_DB
[0m18:00:25.705385 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m18:00:25.705677 [info ] [MainThread]:   role: TRAINING_ROLE
[0m18:00:25.705998 [info ] [MainThread]:   schema: STOCK_RAW
[0m18:00:25.706278 [info ] [MainThread]:   authenticator: None
[0m18:00:25.706547 [info ] [MainThread]:   oauth_client_id: None
[0m18:00:25.706872 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m18:00:25.707214 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:00:25.707516 [info ] [MainThread]:   host: None
[0m18:00:25.707973 [info ] [MainThread]:   port: None
[0m18:00:25.708263 [info ] [MainThread]:   proxy_host: None
[0m18:00:25.708538 [info ] [MainThread]:   proxy_port: None
[0m18:00:25.708871 [info ] [MainThread]:   protocol: None
[0m18:00:25.709178 [info ] [MainThread]:   connect_retries: 1
[0m18:00:25.709462 [info ] [MainThread]:   connect_timeout: None
[0m18:00:25.709754 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:00:25.710068 [info ] [MainThread]:   retry_all: False
[0m18:00:25.710367 [info ] [MainThread]:   insecure_mode: False
[0m18:00:25.710627 [info ] [MainThread]:   reuse_connections: None
[0m18:00:25.711014 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:25.713055 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:00:25.713762 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:00:25.714026 [debug] [MainThread]: On debug: select 1 as id
[0m18:00:25.714301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:26.502578 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.788 seconds
[0m18:00:26.504373 [debug] [MainThread]: On debug: Close
[0m18:00:26.733525 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:00:26.734445 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:00:26.735162 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.5361722, "process_user_time": 1.905671, "process_kernel_time": 0.193081, "process_mem_max_rss": "236832", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m18:00:26.735528 [debug] [MainThread]: Command `dbt debug` succeeded at 18:00:26.735481 after 1.54 seconds
[0m18:00:26.735773 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:00:26.736003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9f6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b0a5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60e27200>]}
[0m18:00:26.736251 [debug] [MainThread]: Flushing usage events
[0m18:00:29.834059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edc3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1d5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea61b80>]}


============================== 18:00:29.837265 | 2c93dedc-6bd3-4ecd-a347-48f712018d4c ==============================
[0m18:00:29.837265 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:00:29.837706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:29.859721 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:29.860320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c93dedc-6bd3-4ecd-a347-48f712018d4c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e549ca0>]}
[0m18:00:29.884766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c93dedc-6bd3-4ecd-a347-48f712018d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e95cbf0>]}
[0m18:00:29.923963 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bbc4kgya'
[0m18:00:29.924374 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:00:30.238079 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:00:30.239174 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:00:30.448574 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:00:30.453127 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:00:31.057007 [info ] [MainThread]: Installed from version 1.1.1
[0m18:00:31.057941 [info ] [MainThread]: Updated version available: 1.3.2
[0m18:00:31.059261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2c93dedc-6bd3-4ecd-a347-48f712018d4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e5f12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7327b0>]}
[0m18:00:31.059693 [info ] [MainThread]: 
[0m18:00:31.060165 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m18:00:31.061425 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2670586, "process_user_time": 0.925099, "process_kernel_time": 0.089046, "process_mem_max_rss": "236796", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m18:00:31.061906 [debug] [MainThread]: Command `dbt deps` succeeded at 18:00:31.061830 after 1.27 seconds
[0m18:00:31.062217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e95d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdf0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e59b620>]}
[0m18:00:31.062477 [debug] [MainThread]: Flushing usage events
[0m18:00:33.877168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4082600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f933b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb67f0b60>]}


============================== 18:00:33.880452 | d2e96473-b800-43fb-9b55-5f0fabcfc4eb ==============================
[0m18:00:33.880452 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:00:33.881019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:00:34.236924 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:34.237467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd2e96473-b800-43fb-9b55-5f0fabcfc4eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e31ff80>]}
[0m18:00:34.261418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2e96473-b800-43fb-9b55-5f0fabcfc4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d25190>]}
[0m18:00:34.280655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2e96473-b800-43fb-9b55-5f0fabcfc4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40815b0>]}
[0m18:00:34.281091 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:34.289475 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m18:00:34.371859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:34.372322 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://snapshots/snapshot_price_corrections.sql
[0m18:00:34.483556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2e96473-b800-43fb-9b55-5f0fabcfc4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937525a0>]}
[0m18:00:34.540806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2e96473-b800-43fb-9b55-5f0fabcfc4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93752840>]}
[0m18:00:34.541211 [info ] [MainThread]: Found 7 models, 35 data tests, 1 snapshot, 1 source, 568 macros
[0m18:00:34.541697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e96473-b800-43fb-9b55-5f0fabcfc4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937592e0>]}
[0m18:00:34.542956 [info ] [MainThread]: 
[0m18:00:34.543412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:34.543973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m18:00:34.549812 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m18:00:34.550074 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m18:00:34.550297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:35.303289 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.753 seconds
[0m18:00:35.308109 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m18:00:35.498872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m18:00:35.500738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m18:00:35.513235 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m18:00:35.513654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_intermediate'
[0m18:00:35.515220 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m18:00:35.515652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_marts'
[0m18:00:35.516082 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m18:00:35.517395 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_intermediate"
[0m18:00:35.517735 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m18:00:35.519208 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_marts"
[0m18:00:35.519575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:35.519889 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_intermediate"} */
show objects in ASH_DB.STOCK_RAW_intermediate limit 10000
[0m18:00:35.520199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:35.520573 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_marts"} */
show objects in ASH_DB.STOCK_RAW_marts limit 10000
[0m18:00:35.522225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:35.523904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:36.241019 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c98-0106-ebeb-000f-c0df0070248a
[0m18:00:36.241800 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:00:36.242408 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:00:36.242835 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:00:36.243359 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m18:00:36.261504 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.738 seconds
[0m18:00:36.264823 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: Close
[0m18:00:36.325125 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.805 seconds
[0m18:00:36.326593 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m18:00:36.388766 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.866 seconds
[0m18:00:36.389970 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: Close
[0m18:00:36.408931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_marts, now list_ASH_DB_STOCK_RAW_staging)
[0m18:00:36.410588 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_staging"
[0m18:00:36.410866 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_staging"} */
show objects in ASH_DB.STOCK_RAW_staging limit 10000
[0m18:00:36.411127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:37.173166 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.762 seconds
[0m18:00:37.175284 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: Close
[0m18:00:37.384633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e96473-b800-43fb-9b55-5f0fabcfc4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb526cb30>]}
[0m18:00:37.386189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:37.387170 [info ] [MainThread]: 
[0m18:00:37.399467 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m18:00:37.400158 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m18:00:37.400964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_staging, now snapshot.stock_analytics.stock_price_snapshot)
[0m18:00:37.401389 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m18:00:37.408145 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m18:00:37.449091 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m18:00:37.449432 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:00:37.449724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:38.609652 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.160 seconds
[0m18:00:38.616365 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m18:00:38.617404 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:00:38.735183 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.117 seconds
[0m18:00:38.736951 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m18:00:38.742848 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m18:00:38.743774 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace transient table ASH_DB.snapshots.stock_price_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

    ) sbq



        );
[0m18:00:41.867956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.123 seconds
[0m18:00:41.881940 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m18:00:42.168235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e96473-b800-43fb-9b55-5f0fabcfc4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c071d0>]}
[0m18:00:42.169078 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 1[0m in 4.77s]
[0m18:00:42.169871 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m18:00:42.171702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:42.172067 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_test_failures' was properly closed.
[0m18:00:42.172386 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m18:00:42.172772 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_intermediate' was properly closed.
[0m18:00:42.173102 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m18:00:42.173499 [info ] [MainThread]: 
[0m18:00:42.173996 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m18:00:42.174747 [debug] [MainThread]: Command end result
[0m18:00:42.201383 [info ] [MainThread]: 
[0m18:00:42.201976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:42.202279 [info ] [MainThread]: 
[0m18:00:42.202617 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:00:42.203602 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.361294, "process_user_time": 2.373698, "process_kernel_time": 0.152301, "process_mem_max_rss": "236816", "process_out_blocks": "4211", "process_in_blocks": "0"}
[0m18:00:42.203999 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:00:42.203941 after 8.36 seconds
[0m18:00:42.204311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bd6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bd8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93758f20>]}
[0m18:00:42.204579 [debug] [MainThread]: Flushing usage events
[0m18:00:44.743060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d1ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69702c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2920a40>]}


============================== 18:00:44.746314 | 9de36374-ebb0-4cdb-a642-a626c461e16f ==============================
[0m18:00:44.746314 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:00:44.746859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:45.097546 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:45.098181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf4e3f0>]}
[0m18:00:45.130634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf4f560>]}
[0m18:00:45.161725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fdf3e0>]}
[0m18:00:45.163152 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:00:45.185004 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m18:00:45.274943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:45.275295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:45.303508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827667b0>]}
[0m18:00:45.369063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82707ec0>]}
[0m18:00:45.369506 [info ] [MainThread]: Found 7 models, 35 data tests, 1 snapshot, 1 source, 568 macros
[0m18:00:45.371450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2893800>]}
[0m18:00:45.372921 [info ] [MainThread]: 
[0m18:00:45.373683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:45.376309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m18:00:45.376679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m18:00:45.383828 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m18:00:45.384098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m18:00:45.385550 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m18:00:45.385842 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m18:00:45.386877 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m18:00:45.387148 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m18:00:45.387459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:45.387745 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m18:00:45.388009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:45.389766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:45.900337 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.513 seconds
[0m18:00:45.901498 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m18:00:46.129844 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.740 seconds
[0m18:00:46.130873 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m18:00:46.399478 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.011 seconds
[0m18:00:46.400652 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m18:00:46.601785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_intermediate)
[0m18:00:46.603364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_staging)
[0m18:00:46.604653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m18:00:46.609908 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_intermediate"
[0m18:00:46.610565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m18:00:46.612289 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_staging"
[0m18:00:46.614572 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m18:00:46.614987 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_intermediate"} */
show objects in ASH_DB.STOCK_RAW_intermediate limit 10000
[0m18:00:46.616600 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m18:00:46.617029 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_staging"} */
show objects in ASH_DB.STOCK_RAW_staging limit 10000
[0m18:00:46.617452 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m18:00:46.617867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:46.618322 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m18:00:46.618739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:46.619182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:46.621078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:47.050716 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.433 seconds
[0m18:00:47.054855 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: Close
[0m18:00:47.057986 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.439 seconds
[0m18:00:47.063555 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: Close
[0m18:00:47.071855 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03c98-0106-eb81-000f-c0df006f56a6
[0m18:00:47.072663 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:00:47.073379 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:00:47.074039 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:00:47.074582 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m18:00:47.234022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_intermediate, now list_ASH_DB_STOCK_RAW_marts)
[0m18:00:47.239247 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_marts"
[0m18:00:47.240261 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_marts"} */
show objects in ASH_DB.STOCK_RAW_marts limit 10000
[0m18:00:47.241960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:47.246397 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.627 seconds
[0m18:00:47.249442 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m18:00:48.210066 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.968 seconds
[0m18:00:48.215073 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: Close
[0m18:00:48.460680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8283fda0>]}
[0m18:00:48.462748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:48.464837 [info ] [MainThread]: 
[0m18:00:48.478493 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m18:00:48.479457 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_staging.stg_stock_daily .................. [RUN]
[0m18:00:48.480521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_marts, now model.stock_analytics.stg_stock_daily)
[0m18:00:48.481094 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m18:00:48.488234 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m18:00:48.491114 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m18:00:48.512652 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m18:00:48.513060 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m18:00:48.513438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.179558 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.666 seconds
[0m18:00:50.189695 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m18:00:50.192275 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m18:00:50.192736 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_staging.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m18:00:50.896601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m18:00:50.926487 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m18:00:50.927240 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_staging.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m18:00:51.051542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m18:00:51.063730 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m18:00:51.191656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa617d040>]}
[0m18:00:51.192791 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_staging.stg_stock_daily ............. [[32mSUCCESS 1[0m in 2.71s]
[0m18:00:51.194873 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m18:00:51.196871 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m18:00:51.197524 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m18:00:51.198117 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m18:00:51.198716 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m18:00:51.199383 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_intermediate.int_bollinger .............. [RUN]
[0m18:00:51.201373 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_intermediate.int_daily_returns .......... [RUN]
[0m18:00:51.202384 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_intermediate.int_macd ................... [RUN]
[0m18:00:51.203695 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_intermediate.int_moving_averages ........ [RUN]
[0m18:00:51.205115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_bollinger)
[0m18:00:51.205902 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_staging, now model.stock_analytics.int_daily_returns)
[0m18:00:51.206750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.int_macd)
[0m18:00:51.207438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m18:00:51.208110 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m18:00:51.208775 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m18:00:51.209450 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m18:00:51.210101 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m18:00:51.214634 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m18:00:51.217775 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m18:00:51.220422 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m18:00:51.223092 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m18:00:51.226229 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m18:00:51.227107 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m18:00:51.239971 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m18:00:51.254601 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m18:00:51.254975 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m18:00:51.255326 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m18:00:51.257230 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m18:00:51.259635 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m18:00:51.260778 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m18:00:51.261898 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m18:00:51.262267 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_daily_returns
         as
        (
SELECT
	SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Previous day's close
    LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
    
    -- Daily change (absolte)
    "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
    
    -- Daily return (percentage)
    ROUND(
        ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
        / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
        4
    ) AS ADJ_DAILY_RETURN_PCT
    
    -- Log return (for financial analysis)
    LN(
        "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
    ) AS LOG_RETURN,
    
    -- Rolling volatility (20-day standard deviation)
    ROUND(
        STDDEV(
            ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
            / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
        ) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,
    
    -- Cumulative return from start
    ROUND(
        (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT

FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
WHERE DATE_QUALITY_FLAG = 'VALID'
        );
[0m18:00:51.263222 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m18:00:51.264500 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m18:00:51.264738 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m18:00:51.265091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:51.265401 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m18:00:51.265759 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26
    
    - Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m18:00:51.266057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:51.267363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:51.267968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:51.922686 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03c98-0106-ebeb-000f-c0df007024a2
[0m18:00:51.924044 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 4 unexpected 'LN'.
syntax error line 24 at position 79 unexpected ')'.
[0m18:00:51.925451 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m18:00:52.435659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03c98-0106-eb84-000f-c0df006f682a
[0m18:00:52.439421 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 4 unexpected '-'.
syntax error line 65 at position 16 unexpected 'ROWS'.
[0m18:00:52.443220 [debug] [Thread-4 (]: Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'LN'.
  syntax error line 24 at position 79 unexpected ')'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m18:00:52.444267 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m18:00:52.445845 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61821e0>]}
[0m18:00:52.450126 [error] [Thread-4 (]: 3 of 7 ERROR creating sql table model STOCK_RAW_intermediate.int_daily_returns . [[31mERROR[0m in 1.24s]
[0m18:00:52.452152 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m18:00:52.453052 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_rsi
[0m18:00:52.454854 [info ] [Thread-4 (]: 6 of 7 START sql table model STOCK_RAW_intermediate.int_rsi .................... [RUN]
[0m18:00:52.456477 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_daily_returns, now model.stock_analytics.int_rsi)
[0m18:00:52.457317 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_rsi
[0m18:00:52.461410 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m18:00:52.462957 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_rsi
[0m18:00:52.465802 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m18:00:52.468254 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m18:00:52.468744 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m18:00:52.469224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:52.656355 [debug] [Thread-1 (]: Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m18:00:52.657008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f89640>]}
[0m18:00:52.657580 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model STOCK_RAW_intermediate.int_moving_averages  [[31mERROR[0m in 1.45s]
[0m18:00:52.658462 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m18:00:53.370185 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.103 seconds
[0m18:00:53.375506 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m18:00:53.376810 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_macd IS $$MACD indicator$$;
[0m18:00:53.569161 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m18:00:53.590601 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m18:00:53.591701 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_macd
[0m18:00:53.751163 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.485 seconds
[0m18:00:53.755822 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m18:00:53.757170 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_bollinger IS $$Bollinger Bands$$;
[0m18:00:53.882353 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.290 seconds
[0m18:00:53.886279 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m18:00:53.886772 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m18:00:53.980271 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m18:00:53.983634 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m18:00:53.984680 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_bollinger
[0m18:00:54.109825 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.124 seconds
[0m18:00:54.112688 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m18:00:54.113064 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m18:00:54.148076 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.261 seconds
[0m18:00:54.150351 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m18:00:54.275875 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.807 seconds
[0m18:00:54.277598 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m18:00:54.277966 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m18:00:54.341275 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m18:00:54.342709 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m18:00:54.415928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f9d310>]}
[0m18:00:54.417081 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_intermediate.int_macd .............. [[32mSUCCESS 1[0m in 3.21s]
[0m18:00:54.418763 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m18:00:54.534448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f74ce0>]}
[0m18:00:54.535168 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_intermediate.int_bollinger ......... [[32mSUCCESS 1[0m in 3.33s]
[0m18:00:54.535938 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m18:00:54.676516 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m18:00:54.684172 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m18:00:54.685973 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_rsi
[0m18:00:54.780008 [debug] [Thread-4 (]: SQL status: SUCCESS 8 in 0.093 seconds
[0m18:00:54.784907 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m18:00:54.785987 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m18:00:55.063265 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m18:00:55.068025 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: Close
[0m18:00:55.204884 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de36374-ebb0-4cdb-a642-a626c461e16f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6181d60>]}
[0m18:00:55.206199 [info ] [Thread-4 (]: 6 of 7 OK created sql table model STOCK_RAW_intermediate.int_rsi ............... [[32mSUCCESS 1[0m in 2.75s]
[0m18:00:55.208034 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_rsi
[0m18:00:55.209860 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m18:00:55.210607 [info ] [Thread-1 (]: 7 of 7 SKIP relation STOCK_RAW_marts.mart_stock_daily_metrics .................. [[33mSKIP[0m]
[0m18:00:55.212380 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m18:00:55.214252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:55.214944 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m18:00:55.215359 [debug] [MainThread]: Connection 'model.stock_analytics.int_moving_averages' was properly closed.
[0m18:00:55.215629 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m18:00:55.216041 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m18:00:55.216789 [info ] [MainThread]: 
[0m18:00:55.217465 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 9.84 seconds (9.84s).
[0m18:00:55.218370 [debug] [MainThread]: Command end result
[0m18:00:55.246568 [info ] [MainThread]: 
[0m18:00:55.247149 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:00:55.247484 [info ] [MainThread]: 
[0m18:00:55.247848 [error] [MainThread]:   Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'LN'.
  syntax error line 24 at position 79 unexpected ')'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m18:00:55.248107 [info ] [MainThread]: 
[0m18:00:55.248490 [error] [MainThread]:   Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m18:00:55.248773 [info ] [MainThread]: 
[0m18:00:55.249131 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 TOTAL=7
[0m18:00:55.250344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.541927, "process_user_time": 2.776396, "process_kernel_time": 0.173147, "process_mem_max_rss": "236796", "process_out_blocks": "3024", "command_success": false, "process_in_blocks": "0"}
[0m18:00:55.250893 [debug] [MainThread]: Command `dbt run` failed at 18:00:55.250823 after 10.54 seconds
[0m18:00:55.251249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f83da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2798470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ff6990>]}
[0m18:00:55.251510 [debug] [MainThread]: Flushing usage events
[0m18:23:21.320677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95943050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e3cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934fc0e0>]}


============================== 18:23:21.324897 | 0a9f2b2a-1e98-440e-afdd-bf30dd78a69c ==============================
[0m18:23:21.324897 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:23:21.325716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m18:23:21.714980 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:23:21.715634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5cf560>]}
[0m18:23:21.740194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72f77050>]}
[0m18:23:21.758767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73082ff0>]}
[0m18:23:21.759160 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:23:21.767339 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m18:23:21.840156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:21.840451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:21.861566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c8cb00>]}
[0m18:23:21.913034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72da69f0>]}
[0m18:23:21.913342 [info ] [MainThread]: Found 7 models, 35 data tests, 1 snapshot, 1 source, 568 macros
[0m18:23:21.913817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73142c30>]}
[0m18:23:21.914875 [info ] [MainThread]: 
[0m18:23:21.915304 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:23:21.917353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m18:23:21.917771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m18:23:21.924205 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m18:23:21.924434 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m18:23:21.925680 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m18:23:21.925929 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m18:23:21.926833 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m18:23:21.927066 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m18:23:21.927304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:21.927510 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m18:23:21.927710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:21.929176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:22.745983 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.817 seconds
[0m18:23:22.748874 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.821 seconds
[0m18:23:22.751809 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m18:23:22.754451 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m18:23:22.824327 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.897 seconds
[0m18:23:22.827299 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m18:23:38.367435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_staging)
[0m18:23:38.376879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m18:23:38.378399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m18:23:38.381698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_marts'
[0m18:23:38.396674 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_staging"
[0m18:23:38.401311 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m18:23:38.402715 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_marts"
[0m18:23:38.404496 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m18:23:38.404815 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_staging"} */
show objects in ASH_DB.STOCK_RAW_staging limit 10000
[0m18:23:38.405143 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m18:23:38.405419 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_marts"} */
show objects in ASH_DB.STOCK_RAW_marts limit 10000
[0m18:23:38.405719 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m18:23:38.406045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:38.406317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:38.406564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:38.406817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:38.932158 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.525 seconds
[0m18:23:38.938636 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_marts: Close
[0m18:23:38.944037 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03ccd-0106-eb84-000f-c0df006f6836
[0m18:23:38.946177 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:23:38.946746 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:23:38.947049 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:23:38.947393 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m18:23:39.008477 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.602 seconds
[0m18:23:39.009997 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_staging: Close
[0m18:23:39.068253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now list_ASH_DB_STOCK_RAW_intermediate)
[0m18:23:39.070245 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_intermediate"
[0m18:23:39.070618 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_intermediate"} */
show objects in ASH_DB.STOCK_RAW_intermediate limit 10000
[0m18:23:39.070931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:39.166649 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.760 seconds
[0m18:23:39.168454 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m18:23:39.635238 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.564 seconds
[0m18:23:39.639584 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_intermediate: Close
[0m18:23:39.833274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72da4200>]}
[0m18:23:39.834210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:23:39.838961 [info ] [MainThread]: 
[0m18:23:39.847035 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m18:23:39.847520 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_staging.stg_stock_daily .................. [RUN]
[0m18:23:39.848100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_intermediate, now model.stock_analytics.stg_stock_daily)
[0m18:23:39.848344 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m18:23:39.854949 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m18:23:39.856939 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m18:23:39.873491 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m18:23:39.873888 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m18:23:39.874147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:40.311945 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.438 seconds
[0m18:23:40.316076 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m18:23:40.317434 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m18:23:40.317749 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_staging.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m18:23:40.568812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m18:23:40.582713 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m18:23:40.583128 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_staging.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m18:23:41.464391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.871 seconds
[0m18:23:41.540705 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m18:23:41.906300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93564680>]}
[0m18:23:41.908306 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_staging.stg_stock_daily ............. [[32mSUCCESS 1[0m in 2.06s]
[0m18:23:41.913510 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m18:23:41.938535 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m18:23:41.940648 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m18:23:41.941904 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m18:23:41.942152 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m18:23:41.942875 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_intermediate.int_macd ................... [RUN]
[0m18:23:41.945482 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_intermediate.int_bollinger .............. [RUN]
[0m18:23:41.946439 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_intermediate.int_moving_averages ........ [RUN]
[0m18:23:41.946862 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_intermediate.int_daily_returns .......... [RUN]
[0m18:23:41.947802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_macd)
[0m18:23:41.948887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_staging, now model.stock_analytics.int_bollinger)
[0m18:23:41.949237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m18:23:41.949585 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_marts, now model.stock_analytics.int_daily_returns)
[0m18:23:41.950010 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m18:23:41.951768 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m18:23:41.954370 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m18:23:41.956307 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m18:23:41.967114 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m18:23:41.971586 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m18:23:41.975839 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m18:23:41.979030 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m18:23:41.981941 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m18:23:41.982526 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m18:23:41.997936 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m18:23:41.998283 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m18:23:42.000160 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m18:23:42.000413 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m18:23:42.002177 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m18:23:42.004394 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m18:23:42.006401 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m18:23:42.007939 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m18:23:42.008307 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m18:23:42.010259 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m18:23:42.011109 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m18:23:42.012593 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m18:23:42.012927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:23:42.013286 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26
    
    - Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m18:23:42.013699 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:23:42.014060 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_daily_returns
         as
        (
SELECT
	SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Previous day's close
    LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
    
    -- Daily change (absolte)
    "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
    
    -- Daily return (percentage)
    ROUND(
        ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
        / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
        4
    ) AS ADJ_DAILY_RETURN_PCT
    
    -- Log return (for financial analysis)
    LN(
        "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
    ) AS LOG_RETURN,
    
    -- Rolling volatility (20-day standard deviation)
    ROUND(
        STDDEV(
            ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
            / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
        ) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,
    
    -- Cumulative return from start
    ROUND(
        (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT

FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
WHERE DATE_QUALITY_FLAG = 'VALID'
        );
[0m18:23:42.018523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:42.021125 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:23:42.443698 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03ccd-0106-ec6f-000f-c0df00707546
[0m18:23:42.444194 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 4 unexpected '-'.
syntax error line 65 at position 16 unexpected 'ROWS'.
[0m18:23:42.444588 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m18:23:42.469399 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03ccd-0106-ec6f-000f-c0df00707542
[0m18:23:42.469858 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 4 unexpected 'LN'.
syntax error line 24 at position 79 unexpected ')'.
[0m18:23:42.470193 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m18:23:42.567221 [debug] [Thread-1 (]: Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m18:23:42.567688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9671e1b0>]}
[0m18:23:42.568095 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model STOCK_RAW_intermediate.int_moving_averages  [[31mERROR[0m in 0.62s]
[0m18:23:42.568822 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m18:23:42.569087 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_rsi
[0m18:23:42.570363 [info ] [Thread-1 (]: 6 of 7 START sql table model STOCK_RAW_intermediate.int_rsi .................... [RUN]
[0m18:23:42.570659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.int_rsi)
[0m18:23:42.570925 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_rsi
[0m18:23:42.572685 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m18:23:42.573283 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_rsi
[0m18:23:42.574385 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m18:23:42.575464 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m18:23:42.575710 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_intermediate.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_staging.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m18:23:42.575962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:42.627318 [debug] [Thread-4 (]: Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'LN'.
  syntax error line 24 at position 79 unexpected ')'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m18:23:42.627744 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713f13d0>]}
[0m18:23:42.628150 [error] [Thread-4 (]: 3 of 7 ERROR creating sql table model STOCK_RAW_intermediate.int_daily_returns . [[31mERROR[0m in 0.68s]
[0m18:23:42.628776 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m18:23:44.140997 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.124 seconds
[0m18:23:44.150528 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m18:23:44.150954 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_bollinger IS $$Bollinger Bands$$;
[0m18:23:44.255230 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.242 seconds
[0m18:23:44.260186 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m18:23:44.261458 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_macd IS $$MACD indicator$$;
[0m18:23:44.275765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.700 seconds
[0m18:23:44.277783 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m18:23:44.278061 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_intermediate.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m18:23:44.303017 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m18:23:44.317915 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m18:23:44.318376 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_bollinger
[0m18:23:44.424347 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m18:23:44.426759 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m18:23:44.427144 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_macd
[0m18:23:44.435988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m18:23:44.437857 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m18:23:44.438128 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_intermediate.int_rsi
[0m18:23:44.453107 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.134 seconds
[0m18:23:44.457586 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m18:23:44.458193 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m18:23:44.532587 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.094 seconds
[0m18:23:44.534106 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m18:23:44.534383 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m18:23:44.601355 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.174 seconds
[0m18:23:44.603290 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m18:23:44.603601 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_intermediate.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m18:23:44.613859 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m18:23:44.617273 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m18:23:44.667875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m18:23:44.669703 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: Close
[0m18:23:44.767547 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m18:23:44.770366 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m18:23:44.796356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713a6fc0>]}
[0m18:23:44.797890 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STOCK_RAW_intermediate.int_rsi ............... [[32mSUCCESS 1[0m in 2.22s]
[0m18:23:44.801536 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_rsi
[0m18:23:44.812273 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff727c1880>]}
[0m18:23:44.812964 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_intermediate.int_bollinger ......... [[32mSUCCESS 1[0m in 2.86s]
[0m18:23:44.815677 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m18:23:44.921361 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9f2b2a-1e98-440e-afdd-bf30dd78a69c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7132a6c0>]}
[0m18:23:44.922010 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_intermediate.int_macd .............. [[32mSUCCESS 1[0m in 2.97s]
[0m18:23:44.922895 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m18:23:44.924241 [debug] [Thread-4 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m18:23:44.924650 [info ] [Thread-4 (]: 7 of 7 SKIP relation STOCK_RAW_marts.mart_stock_daily_metrics .................. [[33mSKIP[0m]
[0m18:23:44.925235 [debug] [Thread-4 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m18:23:44.927196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:44.927554 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m18:23:44.927862 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m18:23:44.928061 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m18:23:44.928278 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m18:23:44.928872 [info ] [MainThread]: 
[0m18:23:44.929526 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 23.01 seconds (23.01s).
[0m18:23:44.930760 [debug] [MainThread]: Command end result
[0m18:23:44.977247 [info ] [MainThread]: 
[0m18:23:44.977977 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:23:44.978756 [info ] [MainThread]: 
[0m18:23:44.979036 [error] [MainThread]:   Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m18:23:44.979542 [info ] [MainThread]: 
[0m18:23:44.979967 [error] [MainThread]:   Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'LN'.
  syntax error line 24 at position 79 unexpected ')'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m18:23:44.980422 [info ] [MainThread]: 
[0m18:23:44.980874 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 TOTAL=7
[0m18:23:44.983053 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 23.71629, "process_user_time": 3.594031, "process_kernel_time": 0.345156, "process_mem_max_rss": "236792", "process_in_blocks": "608", "process_out_blocks": "3023", "command_success": false}
[0m18:23:44.983815 [debug] [MainThread]: Command `dbt run` failed at 18:23:44.983759 after 23.72 seconds
[0m18:23:44.984245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941389e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7291f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72921790>]}
[0m18:23:44.984602 [debug] [MainThread]: Flushing usage events
[0m20:04:58.221147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96041700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989e02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96041cd0>]}


============================== 20:04:58.224768 | 3fc839ea-bf7f-4753-be15-9ead2f7fded1 ==============================
[0m20:04:58.224768 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:04:58.225212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:58.228667 [info ] [MainThread]: dbt version: 1.8.8
[0m20:04:58.229029 [info ] [MainThread]: python version: 3.12.4
[0m20:04:58.229341 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:04:58.229638 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m20:04:58.600488 [info ] [MainThread]: Using profiles dir at .
[0m20:04:58.601117 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m20:04:58.601451 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m20:04:58.601846 [info ] [MainThread]: adapter type: snowflake
[0m20:04:58.602123 [info ] [MainThread]: adapter version: 1.8.4
[0m20:04:58.624075 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:04:58.624480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3fc839ea-bf7f-4753-be15-9ead2f7fded1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e483b0>]}
[0m20:04:58.638328 [info ] [MainThread]: Configuration:
[0m20:04:58.638705 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:04:58.639106 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:04:58.639420 [info ] [MainThread]: Required dependencies:
[0m20:04:58.639764 [debug] [MainThread]: Executing "git --help"
[0m20:04:58.643867 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:04:58.644187 [debug] [MainThread]: STDERR: "b''"
[0m20:04:58.644395 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:04:58.644752 [info ] [MainThread]: Connection:
[0m20:04:58.645036 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m20:04:58.645277 [info ] [MainThread]:   user: MALLARD
[0m20:04:58.645505 [info ] [MainThread]:   database: ASH_DB
[0m20:04:58.645735 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m20:04:58.646012 [info ] [MainThread]:   role: TRAINING_ROLE
[0m20:04:58.646327 [info ] [MainThread]:   schema: STOCK_RAW
[0m20:04:58.646607 [info ] [MainThread]:   authenticator: None
[0m20:04:58.646980 [info ] [MainThread]:   oauth_client_id: None
[0m20:04:58.647218 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m20:04:58.647473 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:04:58.647720 [info ] [MainThread]:   host: None
[0m20:04:58.648012 [info ] [MainThread]:   port: None
[0m20:04:58.648266 [info ] [MainThread]:   proxy_host: None
[0m20:04:58.648539 [info ] [MainThread]:   proxy_port: None
[0m20:04:58.648803 [info ] [MainThread]:   protocol: None
[0m20:04:58.649073 [info ] [MainThread]:   connect_retries: 1
[0m20:04:58.649326 [info ] [MainThread]:   connect_timeout: None
[0m20:04:58.649559 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:04:58.649805 [info ] [MainThread]:   retry_all: False
[0m20:04:58.650071 [info ] [MainThread]:   insecure_mode: False
[0m20:04:58.650344 [info ] [MainThread]:   reuse_connections: None
[0m20:04:58.650663 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:04:58.652276 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:04:58.652662 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:04:58.652927 [debug] [MainThread]: On debug: select 1 as id
[0m20:04:58.653161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:59.034712 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.381 seconds
[0m20:04:59.037120 [debug] [MainThread]: On debug: Close
[0m20:04:59.169994 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:04:59.172094 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:04:59.174242 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9903107, "process_user_time": 1.897693, "process_kernel_time": 0.153267, "process_mem_max_rss": "234816", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m20:04:59.175327 [debug] [MainThread]: Command `dbt debug` succeeded at 20:04:59.175174 after 0.99 seconds
[0m20:04:59.176099 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:04:59.176878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989e02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9959fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955b0f50>]}
[0m20:04:59.177659 [debug] [MainThread]: Flushing usage events
[0m20:05:01.797796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55256d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa335ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa335eab0>]}


============================== 20:05:01.801255 | 8c742326-b0dd-4a4c-85b5-39f7f4bd063b ==============================
[0m20:05:01.801255 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:05:01.801808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:05:01.824166 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:05:01.824559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c742326-b0dd-4a4c-85b5-39f7f4bd063b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3486ab0>]}
[0m20:05:01.852937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c742326-b0dd-4a4c-85b5-39f7f4bd063b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c19be0>]}
[0m20:05:01.899274 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9e8lvtb8'
[0m20:05:01.899634 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:05:02.193478 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:05:02.194392 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:05:02.371692 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:05:02.378989 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:05:03.036525 [info ] [MainThread]: Installed from version 1.1.1
[0m20:05:03.037361 [info ] [MainThread]: Updated version available: 1.3.2
[0m20:05:03.037796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8c742326-b0dd-4a4c-85b5-39f7f4bd063b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28d2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28d27b0>]}
[0m20:05:03.038150 [info ] [MainThread]: 
[0m20:05:03.038448 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:05:03.039356 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2775296, "process_user_time": 0.93315, "process_kernel_time": 0.100197, "process_mem_max_rss": "234840", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m20:05:03.039813 [debug] [MainThread]: Command `dbt deps` succeeded at 20:05:03.039759 after 1.28 seconds
[0m20:05:03.040057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55256d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27909e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2791bb0>]}
[0m20:05:03.040298 [debug] [MainThread]: Flushing usage events
[0m20:05:06.163858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ce5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874c82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850bc440>]}


============================== 20:05:06.167518 | df2defb0-dc84-48bc-abb0-c2b865f6a58c ==============================
[0m20:05:06.167518 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:05:06.168131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:06.582082 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:05:06.582617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df2defb0-dc84-48bc-abb0-c2b865f6a58c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff697b3cb0>]}
[0m20:05:06.607761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df2defb0-dc84-48bc-abb0-c2b865f6a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86067410>]}
[0m20:05:06.628588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df2defb0-dc84-48bc-abb0-c2b865f6a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69117f80>]}
[0m20:05:06.629194 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:05:06.636820 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:05:06.716489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m20:05:06.717010 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_bollinger.sql
[0m20:05:06.717324 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_moving_averages.sql
[0m20:05:06.717633 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_daily_returns.sql
[0m20:05:06.717941 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_rsi.sql
[0m20:05:06.718245 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/staging/stg_stock_daily.sql
[0m20:05:06.718523 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_macd.sql
[0m20:05:06.718832 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/marts/mart_stock_daily_metrics.sql
[0m20:05:06.933417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df2defb0-dc84-48bc-abb0-c2b865f6a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6831fa10>]}
[0m20:05:07.021049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df2defb0-dc84-48bc-abb0-c2b865f6a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68123bf0>]}
[0m20:05:07.021801 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:05:07.022584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df2defb0-dc84-48bc-abb0-c2b865f6a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6848f290>]}
[0m20:05:07.024269 [info ] [MainThread]: 
[0m20:05:07.025201 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:07.025979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:05:07.033401 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:05:07.033819 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:05:07.034109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:07.552460 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.518 seconds
[0m20:05:07.556959 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:05:07.744943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_snapshots)
[0m20:05:07.747961 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "snapshots"
"
[0m20:05:07.756951 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_snapshots"
[0m20:05:07.757900 [debug] [ThreadPool]: On create_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_snapshots"} */
create schema if not exists ASH_DB.snapshots
[0m20:05:07.758562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:08.176850 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.418 seconds
[0m20:05:08.180313 [debug] [ThreadPool]: On create_ASH_DB_snapshots: Close
[0m20:05:08.325078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_snapshots, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m20:05:08.326466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m20:05:08.328305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m20:05:08.337418 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:05:08.341194 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:05:08.400276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m20:05:08.401589 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:05:08.401929 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:05:08.402211 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:05:08.403248 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:05:08.403522 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:05:08.403779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:08.404049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:08.404342 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:05:08.404588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:08.406909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:08.910695 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.506 seconds
[0m20:05:08.914331 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:05:08.918971 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d15-0106-ec6f-000f-c0df007076fa
[0m20:05:08.919582 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:05:08.920311 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:05:08.920893 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:05:08.921334 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:05:09.129501 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d15-0106-eb81-000f-c0df006f5852
[0m20:05:09.131165 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:05:09.132924 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:05:09.133848 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:05:09.134797 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:05:09.200873 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d15-0106-ed95-000f-c0df007092d6
[0m20:05:09.202262 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:05:09.203477 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:05:09.204386 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:05:09.205395 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:05:09.374284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df2defb0-dc84-48bc-abb0-c2b865f6a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63fb6a20>]}
[0m20:05:09.376398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:09.393596 [info ] [MainThread]: 
[0m20:05:09.404187 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m20:05:09.404924 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m20:05:09.405701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now snapshot.stock_analytics.stock_price_snapshot)
[0m20:05:09.406105 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m20:05:09.425335 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m20:05:09.484053 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:05:09.484556 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m20:05:09.484958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:10.396501 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.911 seconds
[0m20:05:10.400107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:05:10.400515 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:05:10.566407 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.165 seconds
[0m20:05:10.568649 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m20:05:10.574923 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:05:10.575996 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace transient table ASH_DB.snapshots.stock_price_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

    ) sbq



        );
[0m20:05:11.934981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.358 seconds
[0m20:05:11.965593 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m20:05:12.158433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2defb0-dc84-48bc-abb0-c2b865f6a58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68295880>]}
[0m20:05:12.159186 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 1[0m in 2.75s]
[0m20:05:12.160101 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m20:05:12.161209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:12.161494 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_raw' was properly closed.
[0m20:05:12.161791 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m20:05:12.162012 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_analytics' was properly closed.
[0m20:05:12.162234 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m20:05:12.162523 [info ] [MainThread]: 
[0m20:05:12.162894 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m20:05:12.163450 [debug] [MainThread]: Command end result
[0m20:05:12.190864 [info ] [MainThread]: 
[0m20:05:12.191436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:12.191737 [info ] [MainThread]: 
[0m20:05:12.192050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:05:12.192871 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.0683165, "process_user_time": 2.730067, "process_kernel_time": 0.175971, "process_mem_max_rss": "236800", "process_out_blocks": "4189", "process_in_blocks": "0"}
[0m20:05:12.193296 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:05:12.193248 after 6.07 seconds
[0m20:05:12.193598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d67500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84837ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68333770>]}
[0m20:05:12.193925 [debug] [MainThread]: Flushing usage events
[0m20:05:15.445658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1670b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eba8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e165d00>]}


============================== 20:05:15.450067 | 71e3c18c-6a6e-451b-9cca-b5958ebe02cb ==============================
[0m20:05:15.450067 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:05:15.450510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:15.864410 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:05:15.865207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f240500>]}
[0m20:05:15.912262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b3ab70>]}
[0m20:05:15.932178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b3b590>]}
[0m20:05:15.932620 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:05:15.940553 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:05:16.017593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:16.017917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:16.040456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61cdca70>]}
[0m20:05:16.096800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61bd9c70>]}
[0m20:05:16.097146 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:05:16.097669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61cddb50>]}
[0m20:05:16.098954 [info ] [MainThread]: 
[0m20:05:16.099577 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:05:16.101745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:05:16.102107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:05:16.108683 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:05:16.110016 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:05:16.110261 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:05:16.110476 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:05:16.110673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:16.110867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:16.530999 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.420 seconds
[0m20:05:16.534096 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:05:16.587160 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.476 seconds
[0m20:05:16.590708 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:05:16.771273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_RAW_stock_raw)
[0m20:05:16.773148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_RAW_stock_analytics)
[0m20:05:16.774760 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_RAW_stock_raw"
"
[0m20:05:16.775913 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_RAW_stock_analytics"
"
[0m20:05:16.784481 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_RAW_stock_raw"
[0m20:05:16.787322 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:05:16.787972 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_RAW_stock_raw"} */
create schema if not exists ASH_DB.STOCK_RAW_stock_raw
[0m20:05:16.788574 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_RAW_stock_analytics"} */
create schema if not exists ASH_DB.STOCK_RAW_stock_analytics
[0m20:05:16.789129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:16.789619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:17.247754 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.458 seconds
[0m20:05:17.250620 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:05:17.266264 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.477 seconds
[0m20:05:17.267887 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:05:17.482065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_RAW_stock_raw, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m20:05:17.483590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_RAW_stock_analytics, now list_ASH_DB_STOCK_RAW_test_failures)
[0m20:05:17.485012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m20:05:17.486932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m20:05:17.496792 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:05:17.500256 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:05:17.502359 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:05:17.504072 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:05:17.504519 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:05:17.504938 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:05:17.505391 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:05:17.505867 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:05:17.506277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:17.506659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:17.507099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:17.507497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:17.850623 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.344 seconds
[0m20:05:17.853785 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:05:17.975319 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d15-0106-eb86-000f-c0df006fa91e
[0m20:05:17.976163 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:05:17.976846 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:05:17.977335 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:05:17.977863 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:05:18.037802 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.530 seconds
[0m20:05:18.040853 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:05:18.390033 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.883 seconds
[0m20:05:18.391607 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:05:18.546322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61849e80>]}
[0m20:05:18.548640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:18.550835 [info ] [MainThread]: 
[0m20:05:18.565042 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m20:05:18.566099 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m20:05:18.567154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.stg_stock_daily)
[0m20:05:18.567637 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m20:05:18.575795 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m20:05:18.578190 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m20:05:18.599276 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:05:18.599650 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m20:05:18.599966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:19.642810 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.042 seconds
[0m20:05:19.656985 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m20:05:19.660672 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:05:19.661394 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m20:05:20.024668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.362 seconds
[0m20:05:20.045209 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:05:20.045634 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m20:05:20.183858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m20:05:20.195905 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m20:05:20.341093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e584410>]}
[0m20:05:20.343838 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.77s]
[0m20:05:20.346931 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m20:05:20.349603 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m20:05:20.351206 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m20:05:20.352575 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m20:05:20.353286 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m20:05:20.353994 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m20:05:20.355102 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m20:05:20.356088 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m20:05:20.357004 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m20:05:20.358059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_bollinger)
[0m20:05:20.358803 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.int_daily_returns)
[0m20:05:20.359376 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_macd)
[0m20:05:20.359890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m20:05:20.360451 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m20:05:20.360982 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m20:05:20.361469 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m20:05:20.361923 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m20:05:20.365792 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m20:05:20.368381 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m20:05:20.370613 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m20:05:20.372951 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m20:05:20.375526 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m20:05:20.375813 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m20:05:20.382355 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m20:05:20.389434 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m20:05:20.389766 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m20:05:20.391116 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m20:05:20.392522 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m20:05:20.393974 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m20:05:20.395367 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:05:20.396390 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:05:20.396710 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (
SELECT
	SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Previous day's close
    LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
    
    -- Daily change (absolte)
    "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
    
    -- Daily return (percentage)
    ROUND(
        ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
        / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
        4
    ) AS ADJ_DAILY_RETURN_PCT,
    
    -- Log return (for financial analysis)
    LN(
        "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
    ) AS LOG_RETURN,
    
    -- Rolling volatility (20-day standard deviation)
    ROUND(
        STDDEV(
            ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
            / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
        ) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,
    
    -- Cumulative return from start
    ROUND(
        (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m20:05:20.397859 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:05:20.398141 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m20:05:20.399300 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:05:20.400719 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26
    
    - Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m20:05:20.400048 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m20:05:20.400429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:05:20.399601 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:05:20.401047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:20.401335 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:05:20.889028 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d15-0106-ec6f-000f-c0df0070770a
[0m20:05:20.889564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 4 unexpected '-'.
syntax error line 65 at position 16 unexpected 'ROWS'.
[0m20:05:20.890105 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m20:05:21.006352 [debug] [Thread-1 (]: Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m20:05:21.006989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81739d00>]}
[0m20:05:21.007568 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[31mERROR[0m in 0.65s]
[0m20:05:21.008472 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m20:05:21.008920 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_rsi
[0m20:05:21.009938 [info ] [Thread-1 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m20:05:21.010563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.int_rsi)
[0m20:05:21.010962 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_rsi
[0m20:05:21.013303 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m20:05:21.014111 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_rsi
[0m20:05:21.015825 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m20:05:21.017214 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:05:21.017523 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m20:05:21.017843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:21.054616 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03d15-0106-eb7f-000f-c0df0070a1f2
[0m20:05:21.058922 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002062 (42601): SQL compilation error:
Window function [LAG(STG_STOCK_DAILY.CLOSE) OVER (PARTITION BY STG_STOCK_DAILY.SYMBOL ORDER BY STG_STOCK_DAILY.DATE ASC NULLS LAST)] may not be nested inside another window function.
[0m20:05:21.059381 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m20:05:21.224187 [debug] [Thread-4 (]: Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  002062 (42601): SQL compilation error:
  Window function [LAG(STG_STOCK_DAILY.CLOSE) OVER (PARTITION BY STG_STOCK_DAILY.SYMBOL ORDER BY STG_STOCK_DAILY.DATE ASC NULLS LAST)] may not be nested inside another window function.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m20:05:21.226118 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d5c1d0>]}
[0m20:05:21.227633 [error] [Thread-4 (]: 3 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.int_daily_returns  [[31mERROR[0m in 0.87s]
[0m20:05:21.229515 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m20:05:21.767279 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.367 seconds
[0m20:05:21.768685 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.367 seconds
[0m20:05:21.772891 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:05:21.776649 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:05:21.777862 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m20:05:21.778700 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m20:05:21.897187 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m20:05:21.905823 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m20:05:21.906441 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:05:21.908545 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:05:21.909090 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m20:05:21.909494 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m20:05:22.009867 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.100 seconds
[0m20:05:22.011670 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:05:22.012014 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m20:05:22.015354 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m20:05:22.016848 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:05:22.017167 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m20:05:22.171984 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m20:05:22.174073 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m20:05:22.419463 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m20:05:22.422386 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m20:05:22.482422 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60dcf8f0>]}
[0m20:05:22.483235 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 2.12s]
[0m20:05:22.484107 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m20:05:22.574654 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60392360>]}
[0m20:05:22.575998 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 2.22s]
[0m20:05:22.577378 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m20:05:23.198278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.180 seconds
[0m20:05:23.202252 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:05:23.203268 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m20:05:23.608103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m20:05:23.614758 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:05:23.615832 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m20:05:23.820485 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.204 seconds
[0m20:05:23.826047 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:05:23.827633 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m20:05:23.973949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m20:05:23.977939 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: Close
[0m20:05:24.426492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e3c18c-6a6e-451b-9cca-b5958ebe02cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61777a40>]}
[0m20:05:24.428010 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 3.42s]
[0m20:05:24.429462 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_rsi
[0m20:05:24.430511 [debug] [Thread-4 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m20:05:24.430915 [info ] [Thread-4 (]: 7 of 7 SKIP relation STOCK_RAW_stock_analytics.mart_stock_daily_metrics ........ [[33mSKIP[0m]
[0m20:05:24.431609 [debug] [Thread-4 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m20:05:24.433452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:24.433895 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m20:05:24.434275 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m20:05:24.434681 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m20:05:24.435106 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m20:05:24.435764 [info ] [MainThread]: 
[0m20:05:24.436562 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m20:05:24.438355 [debug] [MainThread]: Command end result
[0m20:05:24.466543 [info ] [MainThread]: 
[0m20:05:24.467190 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:05:24.467602 [info ] [MainThread]: 
[0m20:05:24.468016 [error] [MainThread]:   Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m20:05:24.468339 [info ] [MainThread]: 
[0m20:05:24.468838 [error] [MainThread]:   Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  002062 (42601): SQL compilation error:
  Window function [LAG(STG_STOCK_DAILY.CLOSE) OVER (PARTITION BY STG_STOCK_DAILY.SYMBOL ORDER BY STG_STOCK_DAILY.DATE ASC NULLS LAST)] may not be nested inside another window function.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m20:05:24.469373 [info ] [MainThread]: 
[0m20:05:24.469805 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 TOTAL=7
[0m20:05:24.471046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.064652, "process_user_time": 2.852013, "process_kernel_time": 0.230911, "process_mem_max_rss": "234812", "process_in_blocks": "14184", "process_out_blocks": "3023", "command_success": false}
[0m20:05:24.471437 [debug] [MainThread]: Command `dbt run` failed at 20:05:24.471380 after 9.07 seconds
[0m20:05:24.471732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1bfef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea0bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b3a4b0>]}
[0m20:05:24.471968 [debug] [MainThread]: Flushing usage events
[0m20:10:28.008893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4444590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5dc02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb332d100>]}


============================== 20:10:28.012973 | 1835fb23-e284-4235-b992-9f63af1ae24a ==============================
[0m20:10:28.012973 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:10:28.013570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:10:28.440152 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:10:28.440889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935471d0>]}
[0m20:10:28.467967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933ac260>]}
[0m20:10:28.490451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb42c94f0>]}
[0m20:10:28.491076 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:10:28.502098 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:10:28.588595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:28.588965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:28.612050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9325c5f0>]}
[0m20:10:28.674525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9315db50>]}
[0m20:10:28.674893 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:10:28.675298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932344d0>]}
[0m20:10:28.676393 [info ] [MainThread]: 
[0m20:10:28.676806 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:28.679138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:10:28.679513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:10:28.686094 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:10:28.687465 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:10:28.687735 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:10:28.688011 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:10:28.688242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:28.688479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:29.396518 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.708 seconds
[0m20:10:29.400162 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:10:29.405950 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.718 seconds
[0m20:10:29.408596 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:10:29.550935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m20:10:29.551960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_analytics)
[0m20:10:29.552455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m20:10:29.553632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m20:10:29.559439 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:10:29.561083 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:10:29.562639 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:10:29.564786 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:10:29.565220 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:10:29.565587 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:10:29.565936 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:10:29.566255 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:10:29.566582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:29.566921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:29.567220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:29.567573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:30.087507 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d1a-0106-eb87-000f-c0df0070d00e
[0m20:10:30.088240 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:10:30.090098 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:10:30.091863 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:10:30.092288 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:10:30.148791 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.582 seconds
[0m20:10:30.149830 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.582 seconds
[0m20:10:30.151797 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:10:30.153630 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:10:30.163829 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.597 seconds
[0m20:10:30.165228 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:10:30.311658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cc2e70>]}
[0m20:10:30.312665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:30.313564 [info ] [MainThread]: 
[0m20:10:30.321727 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m20:10:30.322320 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m20:10:30.322936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.stg_stock_daily)
[0m20:10:30.323331 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m20:10:30.330666 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m20:10:30.332434 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m20:10:30.351478 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:10:30.352072 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m20:10:30.352402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:30.939650 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.587 seconds
[0m20:10:30.952639 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m20:10:30.956663 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:10:30.957535 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m20:10:31.425252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m20:10:31.448589 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:10:31.449180 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m20:10:31.632668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m20:10:31.644169 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m20:10:31.798285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93546d50>]}
[0m20:10:31.799924 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.47s]
[0m20:10:31.802049 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m20:10:31.804055 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m20:10:31.804659 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m20:10:31.805189 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m20:10:31.805741 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m20:10:31.806332 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m20:10:31.807494 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m20:10:31.808242 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m20:10:31.808965 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m20:10:31.809785 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_bollinger)
[0m20:10:31.810283 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.int_daily_returns)
[0m20:10:31.811052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_macd)
[0m20:10:31.811532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m20:10:31.812095 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m20:10:31.812506 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m20:10:31.812890 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m20:10:31.813233 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m20:10:31.815870 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m20:10:31.819094 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m20:10:31.821306 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m20:10:31.823288 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m20:10:31.825079 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m20:10:31.825501 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m20:10:31.838174 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m20:10:31.840502 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m20:10:31.840850 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m20:10:31.842553 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m20:10:31.844132 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m20:10:31.845949 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m20:10:31.847461 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:10:31.848686 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:10:31.849197 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m20:10:31.850369 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:10:31.850832 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (
SELECT
	SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Previous day's close
    LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
    
    -- Daily change (absolte)
    "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
    
    -- Daily return (percentage)
    ROUND(
        ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
        / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
        4
    ) AS ADJ_DAILY_RETURN_PCT,
    
    -- Log return (for financial analysis)
    LN(
        "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
    ) AS LOG_RETURN,
    
    -- Rolling volatility (20-day standard deviation)
    ROUND(
        STDDEV(
            ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
            / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
        ) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,
    
    -- Cumulative return from start
    ROUND(
        (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m20:10:31.852422 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:10:31.852724 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:31.853089 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m20:10:31.853476 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:31.853818 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26
    
    - Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m20:10:31.855247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:31.856717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.289317 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d1a-0106-eb81-000f-c0df006f5862
[0m20:10:32.290497 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 4 unexpected '-'.
syntax error line 65 at position 16 unexpected 'ROWS'.
[0m20:10:32.291492 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m20:10:32.433716 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03d1a-0106-eb81-000f-c0df006f586a
[0m20:10:32.435636 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002062 (42601): SQL compilation error:
Window function [LAG(STG_STOCK_DAILY.CLOSE) OVER (PARTITION BY STG_STOCK_DAILY.SYMBOL ORDER BY STG_STOCK_DAILY.DATE ASC NULLS LAST)] may not be nested inside another window function.
[0m20:10:32.436841 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m20:10:32.457789 [debug] [Thread-1 (]: Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m20:10:32.459353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9325ce00>]}
[0m20:10:32.460571 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[31mERROR[0m in 0.65s]
[0m20:10:32.462113 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m20:10:32.462816 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_rsi
[0m20:10:32.464291 [info ] [Thread-1 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m20:10:32.465128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.int_rsi)
[0m20:10:32.465680 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_rsi
[0m20:10:32.469664 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m20:10:32.471358 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_rsi
[0m20:10:32.474196 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m20:10:32.476912 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:10:32.477636 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m20:10:32.478472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.640104 [debug] [Thread-4 (]: Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  002062 (42601): SQL compilation error:
  Window function [LAG(STG_STOCK_DAILY.CLOSE) OVER (PARTITION BY STG_STOCK_DAILY.SYMBOL ORDER BY STG_STOCK_DAILY.DATE ASC NULLS LAST)] may not be nested inside another window function.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m20:10:32.640933 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91935fd0>]}
[0m20:10:32.641740 [error] [Thread-4 (]: 3 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.int_daily_returns  [[31mERROR[0m in 0.83s]
[0m20:10:32.642734 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m20:10:34.188911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.710 seconds
[0m20:10:34.190760 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:10:34.191124 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m20:10:34.231052 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.376 seconds
[0m20:10:34.232891 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:10:34.233276 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m20:10:34.316047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m20:10:34.317033 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.464 seconds
[0m20:10:34.328591 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:10:34.330857 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:10:34.331347 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m20:10:34.331819 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m20:10:34.376616 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m20:10:34.379544 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:10:34.380238 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m20:10:34.475638 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m20:10:34.479777 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:10:34.480612 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m20:10:34.534781 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.154 seconds
[0m20:10:34.538567 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:10:34.539009 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m20:10:34.598245 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.117 seconds
[0m20:10:34.600614 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:10:34.601093 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m20:10:34.613323 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.281 seconds
[0m20:10:34.614972 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:10:34.615261 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m20:10:34.750588 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m20:10:34.752547 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m20:10:34.767559 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m20:10:34.769139 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m20:10:34.781360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.166 seconds
[0m20:10:34.782726 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: Close
[0m20:10:34.899596 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91903e30>]}
[0m20:10:34.901674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91991010>]}
[0m20:10:34.905266 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 2.44s]
[0m20:10:34.902719 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 3.09s]
[0m20:10:34.906299 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_rsi
[0m20:10:34.907081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1835fb23-e284-4235-b992-9f63af1ae24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91921610>]}
[0m20:10:34.907668 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m20:10:34.909094 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 3.10s]
[0m20:10:34.910558 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m20:10:34.912345 [debug] [Thread-4 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m20:10:34.912960 [info ] [Thread-4 (]: 7 of 7 SKIP relation STOCK_RAW_stock_analytics.mart_stock_daily_metrics ........ [[33mSKIP[0m]
[0m20:10:34.913875 [debug] [Thread-4 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m20:10:34.916301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:34.917171 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m20:10:34.917516 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m20:10:34.917800 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m20:10:34.918054 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m20:10:34.918521 [info ] [MainThread]: 
[0m20:10:34.919367 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m20:10:34.920869 [debug] [MainThread]: Command end result
[0m20:10:34.989995 [info ] [MainThread]: 
[0m20:10:34.991012 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:10:34.991686 [info ] [MainThread]: 
[0m20:10:34.992546 [error] [MainThread]:   Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 4 unexpected '-'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m20:10:34.993244 [info ] [MainThread]: 
[0m20:10:34.993912 [error] [MainThread]:   Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  002062 (42601): SQL compilation error:
  Window function [LAG(STG_STOCK_DAILY.CLOSE) OVER (PARTITION BY STG_STOCK_DAILY.SYMBOL ORDER BY STG_STOCK_DAILY.DATE ASC NULLS LAST)] may not be nested inside another window function.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m20:10:34.994553 [info ] [MainThread]: 
[0m20:10:34.995212 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 TOTAL=7
[0m20:10:34.997218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.0372677, "process_user_time": 2.731553, "process_kernel_time": 0.194537, "process_mem_max_rss": "232856", "process_out_blocks": "3019", "command_success": false, "process_in_blocks": "0"}
[0m20:10:34.998450 [debug] [MainThread]: Command `dbt run` failed at 20:10:34.998352 after 7.04 seconds
[0m20:10:34.999378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4444590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919140b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb31029c0>]}
[0m20:10:35.000067 [debug] [MainThread]: Flushing usage events
[0m20:25:10.904696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82643e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ae95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ab5d30>]}


============================== 20:25:10.908275 | 76905f49-55d7-4fcf-9fe4-3b3f1182ada4 ==============================
[0m20:25:10.908275 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:25:10.909092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:25:10.913496 [info ] [MainThread]: dbt version: 1.8.8
[0m20:25:10.913838 [info ] [MainThread]: python version: 3.12.4
[0m20:25:10.914086 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:25:10.914374 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m20:25:11.267328 [info ] [MainThread]: Using profiles dir at .
[0m20:25:11.267932 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m20:25:11.268314 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m20:25:11.268745 [info ] [MainThread]: adapter type: snowflake
[0m20:25:11.269032 [info ] [MainThread]: adapter version: 1.8.4
[0m20:25:11.291122 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:25:11.291487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76905f49-55d7-4fcf-9fe4-3b3f1182ada4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66ca47a0>]}
[0m20:25:11.305517 [info ] [MainThread]: Configuration:
[0m20:25:11.305811 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:25:11.306091 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:25:11.306457 [info ] [MainThread]: Required dependencies:
[0m20:25:11.306786 [debug] [MainThread]: Executing "git --help"
[0m20:25:11.310165 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:25:11.310410 [debug] [MainThread]: STDERR: "b''"
[0m20:25:11.310631 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:25:11.310884 [info ] [MainThread]: Connection:
[0m20:25:11.311182 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m20:25:11.311416 [info ] [MainThread]:   user: MALLARD
[0m20:25:11.311645 [info ] [MainThread]:   database: ASH_DB
[0m20:25:11.311942 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m20:25:11.312216 [info ] [MainThread]:   role: TRAINING_ROLE
[0m20:25:11.312453 [info ] [MainThread]:   schema: STOCK_RAW
[0m20:25:11.312693 [info ] [MainThread]:   authenticator: None
[0m20:25:11.312935 [info ] [MainThread]:   oauth_client_id: None
[0m20:25:11.313194 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m20:25:11.313443 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:25:11.313689 [info ] [MainThread]:   host: None
[0m20:25:11.313926 [info ] [MainThread]:   port: None
[0m20:25:11.314176 [info ] [MainThread]:   proxy_host: None
[0m20:25:11.314405 [info ] [MainThread]:   proxy_port: None
[0m20:25:11.314651 [info ] [MainThread]:   protocol: None
[0m20:25:11.314886 [info ] [MainThread]:   connect_retries: 1
[0m20:25:11.315140 [info ] [MainThread]:   connect_timeout: None
[0m20:25:11.315388 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:25:11.315642 [info ] [MainThread]:   retry_all: False
[0m20:25:11.315899 [info ] [MainThread]:   insecure_mode: False
[0m20:25:11.316162 [info ] [MainThread]:   reuse_connections: None
[0m20:25:11.316478 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:25:11.318072 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:25:11.318550 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:25:11.318782 [debug] [MainThread]: On debug: select 1 as id
[0m20:25:11.319045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:11.674079 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.355 seconds
[0m20:25:11.674803 [debug] [MainThread]: On debug: Close
[0m20:25:11.806252 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:25:11.807172 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:25:11.808703 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9427642, "process_user_time": 1.795819, "process_kernel_time": 0.150504, "process_mem_max_rss": "236792", "process_in_blocks": "392", "process_out_blocks": "22"}
[0m20:25:11.809595 [debug] [MainThread]: Command `dbt debug` succeeded at 20:25:11.809417 after 0.94 seconds
[0m20:25:11.810326 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:25:11.811082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8226e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817272c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff753a7470>]}
[0m20:25:11.811908 [debug] [MainThread]: Flushing usage events
[0m20:25:14.885883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac95a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa17a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa1798e0>]}


============================== 20:25:14.889732 | f312493b-4c85-45a4-a630-c87c25cf1760 ==============================
[0m20:25:14.889732 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:25:14.890394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:25:14.916590 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:25:14.917213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f312493b-4c85-45a4-a630-c87c25cf1760', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e3fe60>]}
[0m20:25:14.959196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f312493b-4c85-45a4-a630-c87c25cf1760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e3c9e0>]}
[0m20:25:15.026200 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-icw5bv1c'
[0m20:25:15.026738 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:25:15.340123 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:25:15.342173 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:25:15.536582 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:25:15.540991 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:25:16.163822 [info ] [MainThread]: Installed from version 1.1.1
[0m20:25:16.164523 [info ] [MainThread]: Updated version available: 1.3.2
[0m20:25:16.165074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f312493b-4c85-45a4-a630-c87c25cf1760', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b14b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99a15e0>]}
[0m20:25:16.165474 [info ] [MainThread]: 
[0m20:25:16.165849 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:25:16.166722 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3272728, "process_user_time": 0.968245, "process_kernel_time": 0.11207, "process_mem_max_rss": "236792", "process_in_blocks": "176", "process_out_blocks": "743"}
[0m20:25:16.167094 [debug] [MainThread]: Command `dbt deps` succeeded at 20:25:16.167041 after 1.33 seconds
[0m20:25:16.167360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e3cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa8f6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf09070>]}
[0m20:25:16.167647 [debug] [MainThread]: Flushing usage events
[0m20:25:19.004574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa772ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac70aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f34740>]}


============================== 20:25:19.007770 | c1525c03-89a5-48f7-8180-0b238a4eaca0 ==============================
[0m20:25:19.007770 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:25:19.008315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:25:19.374761 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:25:19.375403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1525c03-89a5-48f7-8180-0b238a4eaca0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b93ad0>]}
[0m20:25:19.399016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1525c03-89a5-48f7-8180-0b238a4eaca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b3f110>]}
[0m20:25:19.419410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1525c03-89a5-48f7-8180-0b238a4eaca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7dcfaa0>]}
[0m20:25:19.419916 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:25:19.427610 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:25:19.508481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:25:19.509008 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_moving_averages.sql
[0m20:25:19.509346 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_daily_returns.sql
[0m20:25:19.575630 [error] [MainThread]: Encountered an error:
Compilation Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  expected token ',', got '='
    line 3
      --         materialized='table'
[0m20:25:19.576398 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.60732144, "process_user_time": 1.909163, "process_kernel_time": 0.111163, "process_mem_max_rss": "236800", "process_in_blocks": "32", "process_out_blocks": "6", "command_success": false}
[0m20:25:19.576778 [debug] [MainThread]: Command `dbt snapshot` failed at 20:25:19.576722 after 0.61 seconds
[0m20:25:19.577066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa833cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73163c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86eea1b0>]}
[0m20:25:19.577324 [debug] [MainThread]: Flushing usage events
[0m20:30:23.169200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f686210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90acd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f505f70>]}


============================== 20:30:23.173929 | bc53ccd6-11af-4de8-9eab-de890b6736c2 ==============================
[0m20:30:23.173929 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:30:23.174700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:30:23.632514 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:30:23.633432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bc53ccd6-11af-4de8-9eab-de890b6736c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f0c1340>]}
[0m20:30:23.662354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc53ccd6-11af-4de8-9eab-de890b6736c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ed5c260>]}
[0m20:30:23.695489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc53ccd6-11af-4de8-9eab-de890b6736c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8fb2c0>]}
[0m20:30:23.696220 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:30:23.706644 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:30:23.801267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:30:23.801813 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_daily_returns.sql
[0m20:30:23.802128 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_moving_averages.sql
[0m20:30:23.865045 [error] [MainThread]: Encountered an error:
Compilation Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  expected token ',', got '='
    line 3
      --         materialized='table'
[0m20:30:23.865952 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.7431308, "process_user_time": 2.065743, "process_kernel_time": 0.224228, "process_mem_max_rss": "236788", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m20:30:23.866349 [debug] [MainThread]: Command `dbt snapshot` failed at 20:30:23.866285 after 0.74 seconds
[0m20:30:23.866682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931bb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e902fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e901a60>]}
[0m20:30:23.866955 [debug] [MainThread]: Flushing usage events
[0m20:32:03.656100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a34e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fad8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fac350>]}


============================== 20:32:03.660289 | ddc733a3-c665-4fca-9374-1a10e1599ca8 ==============================
[0m20:32:03.660289 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:32:03.661128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:03.664581 [info ] [MainThread]: dbt version: 1.8.8
[0m20:32:03.664947 [info ] [MainThread]: python version: 3.12.4
[0m20:32:03.665261 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:32:03.665626 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m20:32:04.026843 [info ] [MainThread]: Using profiles dir at .
[0m20:32:04.027406 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m20:32:04.027750 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m20:32:04.028138 [info ] [MainThread]: adapter type: snowflake
[0m20:32:04.028434 [info ] [MainThread]: adapter version: 1.8.4
[0m20:32:04.050907 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:32:04.051298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ddc733a3-c665-4fca-9374-1a10e1599ca8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8572e870>]}
[0m20:32:04.066453 [info ] [MainThread]: Configuration:
[0m20:32:04.066750 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:32:04.067032 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:32:04.067359 [info ] [MainThread]: Required dependencies:
[0m20:32:04.067657 [debug] [MainThread]: Executing "git --help"
[0m20:32:04.069335 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:32:04.069592 [debug] [MainThread]: STDERR: "b''"
[0m20:32:04.069795 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:32:04.070067 [info ] [MainThread]: Connection:
[0m20:32:04.070373 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m20:32:04.070632 [info ] [MainThread]:   user: MALLARD
[0m20:32:04.070889 [info ] [MainThread]:   database: ASH_DB
[0m20:32:04.071132 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m20:32:04.071386 [info ] [MainThread]:   role: TRAINING_ROLE
[0m20:32:04.071629 [info ] [MainThread]:   schema: STOCK_RAW
[0m20:32:04.071863 [info ] [MainThread]:   authenticator: None
[0m20:32:04.072106 [info ] [MainThread]:   oauth_client_id: None
[0m20:32:04.072345 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m20:32:04.072573 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:32:04.072801 [info ] [MainThread]:   host: None
[0m20:32:04.073044 [info ] [MainThread]:   port: None
[0m20:32:04.073313 [info ] [MainThread]:   proxy_host: None
[0m20:32:04.073550 [info ] [MainThread]:   proxy_port: None
[0m20:32:04.073791 [info ] [MainThread]:   protocol: None
[0m20:32:04.074031 [info ] [MainThread]:   connect_retries: 1
[0m20:32:04.074317 [info ] [MainThread]:   connect_timeout: None
[0m20:32:04.074556 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:32:04.074790 [info ] [MainThread]:   retry_all: False
[0m20:32:04.075073 [info ] [MainThread]:   insecure_mode: False
[0m20:32:04.075298 [info ] [MainThread]:   reuse_connections: None
[0m20:32:04.075581 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:32:04.077144 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:32:04.077538 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:32:04.077772 [debug] [MainThread]: On debug: select 1 as id
[0m20:32:04.078009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:32:04.503865 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.426 seconds
[0m20:32:04.506783 [debug] [MainThread]: On debug: Close
[0m20:32:04.653653 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:32:04.654634 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:32:04.655917 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0360314, "process_user_time": 1.907814, "process_kernel_time": 0.168365, "process_mem_max_rss": "236792", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m20:32:04.656492 [debug] [MainThread]: Command `dbt debug` succeeded at 20:32:04.656414 after 1.04 seconds
[0m20:32:04.656931 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:32:04.657336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85498bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ab54800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a34e00>]}
[0m20:32:04.657772 [debug] [MainThread]: Flushing usage events
[0m20:32:07.915359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa456630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa9dadb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa456c60>]}


============================== 20:32:07.918844 | efe4f801-aeff-48db-8f58-04ed6ee5772d ==============================
[0m20:32:07.918844 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:32:07.919436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:32:07.941608 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:32:07.942042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'efe4f801-aeff-48db-8f58-04ed6ee5772d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa456a20>]}
[0m20:32:07.973066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efe4f801-aeff-48db-8f58-04ed6ee5772d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaac6300>]}
[0m20:32:08.017468 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r68d_9iu'
[0m20:32:08.017849 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:32:08.312609 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:32:08.314739 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:32:08.490115 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:32:08.492539 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:32:09.178745 [info ] [MainThread]: Installed from version 1.1.1
[0m20:32:09.179260 [info ] [MainThread]: Updated version available: 1.3.2
[0m20:32:09.179652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'efe4f801-aeff-48db-8f58-04ed6ee5772d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa203a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa203980>]}
[0m20:32:09.180255 [info ] [MainThread]: 
[0m20:32:09.180646 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:32:09.181661 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3013817, "process_user_time": 0.937845, "process_kernel_time": 0.120522, "process_mem_max_rss": "236788", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m20:32:09.182081 [debug] [MainThread]: Command `dbt deps` succeeded at 20:32:09.182016 after 1.30 seconds
[0m20:32:09.182384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7c0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3159a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3149b0>]}
[0m20:32:09.182682 [debug] [MainThread]: Flushing usage events
[0m20:32:12.685195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01147a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0116a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2db1e50>]}


============================== 20:32:12.688514 | 59ba6475-a6bd-40ae-b386-e2d9792d3851 ==============================
[0m20:32:12.688514 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:32:12.689154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:32:13.067008 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:32:13.067931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '59ba6475-a6bd-40ae-b386-e2d9792d3851', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8483bf20>]}
[0m20:32:13.093487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ba6475-a6bd-40ae-b386-e2d9792d3851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1354c0>]}
[0m20:32:13.113601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ba6475-a6bd-40ae-b386-e2d9792d3851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a949c40>]}
[0m20:32:13.114081 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:32:13.121912 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:32:13.204737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:32:13.205263 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_daily_returns.sql
[0m20:32:13.205664 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_moving_averages.sql
[0m20:32:13.379234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ba6475-a6bd-40ae-b386-e2d9792d3851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb53a10>]}
[0m20:32:13.438120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ba6475-a6bd-40ae-b386-e2d9792d3851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f336600>]}
[0m20:32:13.438459 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:32:13.438852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ba6475-a6bd-40ae-b386-e2d9792d3851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fedb290>]}
[0m20:32:13.439824 [info ] [MainThread]: 
[0m20:32:13.440239 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:32:13.440928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:32:13.446979 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:32:13.447216 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:32:13.447424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:13.952805 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.505 seconds
[0m20:32:13.957394 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:32:14.147584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m20:32:14.149148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m20:32:14.151028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m20:32:14.160529 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:32:14.161401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m20:32:14.163392 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:32:14.165351 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:32:14.165824 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:32:14.168307 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:32:14.168740 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:32:14.169183 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:32:14.169588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:14.169946 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:32:14.170307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:14.170713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:14.172313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:14.563215 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.392 seconds
[0m20:32:14.567230 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:32:14.573699 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d30-0106-ec41-000f-c0df0070470a
[0m20:32:14.577204 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:32:14.578015 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:32:14.578553 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:32:14.579096 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:32:14.594528 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.425 seconds
[0m20:32:14.596537 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:32:14.695923 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.526 seconds
[0m20:32:14.697623 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:32:14.824340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ba6475-a6bd-40ae-b386-e2d9792d3851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8410f1a0>]}
[0m20:32:14.826186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:32:14.827980 [info ] [MainThread]: 
[0m20:32:14.839887 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m20:32:14.840633 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m20:32:14.841465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now snapshot.stock_analytics.stock_price_snapshot)
[0m20:32:14.841912 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m20:32:14.856336 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m20:32:14.886635 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:14.886995 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m20:32:14.887305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:16.090002 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.202 seconds
[0m20:32:16.099366 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:16.100085 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:32:16.202719 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.102 seconds
[0m20:32:16.207284 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:16.207671 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:32:16.292797 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.085 seconds
[0m20:32:16.362753 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:16.363319 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace temporary table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:32:18.341978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.978 seconds
[0m20:32:18.345578 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:18.346068 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:32:18.508851 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.162 seconds
[0m20:32:18.511657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:18.512060 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:32:18.648363 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.136 seconds
[0m20:32:18.650757 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:18.651116 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:32:18.763078 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.112 seconds
[0m20:32:18.765122 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:18.765411 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:32:18.848559 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.083 seconds
[0m20:32:18.852358 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:18.852707 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:32:18.954888 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.102 seconds
[0m20:32:18.964142 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:18.964519 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m20:32:19.570224 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.605 seconds
[0m20:32:19.573842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:19.574330 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:32:19.654825 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m20:32:19.656397 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:19.660292 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:19.660903 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
BEGIN
[0m20:32:19.748737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m20:32:19.749510 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:19.750216 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
merge into "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:32:20.635261 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.884 seconds
[0m20:32:20.637403 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:32:20.638486 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
COMMIT
[0m20:32:21.208014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m20:32:21.220606 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m20:32:21.326798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ba6475-a6bd-40ae-b386-e2d9792d3851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff52c00>]}
[0m20:32:21.327555 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 12[0m in 6.48s]
[0m20:32:21.329027 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m20:32:21.330901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:21.331198 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m20:32:21.331410 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m20:32:21.331621 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_analytics' was properly closed.
[0m20:32:21.331824 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_test_failures' was properly closed.
[0m20:32:21.332132 [info ] [MainThread]: 
[0m20:32:21.332574 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m20:32:21.333197 [debug] [MainThread]: Command end result
[0m20:32:21.360186 [info ] [MainThread]: 
[0m20:32:21.360761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:32:21.361067 [info ] [MainThread]: 
[0m20:32:21.361357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:32:21.362330 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.714312, "process_user_time": 2.568353, "process_kernel_time": 0.179774, "process_mem_max_rss": "236800", "process_in_blocks": "8", "process_out_blocks": "4242"}
[0m20:32:21.362683 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:32:21.362636 after 8.71 seconds
[0m20:32:21.363015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d0fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa029c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0548980>]}
[0m20:32:21.363269 [debug] [MainThread]: Flushing usage events
[0m20:32:24.646896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab054c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb2337d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab06cc0>]}


============================== 20:32:24.650256 | 6e7087c7-cde6-4b31-9f58-e4811ea0319c ==============================
[0m20:32:24.650256 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:32:24.650799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:32:25.000264 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:32:25.000745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb413ef30>]}
[0m20:32:25.026643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb012e0>]}
[0m20:32:25.047469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcbd070>]}
[0m20:32:25.047950 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:32:25.055502 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:32:25.135258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:32:25.135604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:32:25.157735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1e7440>]}
[0m20:32:25.214148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1015b0>]}
[0m20:32:25.214487 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:32:25.214874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ea3800>]}
[0m20:32:25.215924 [info ] [MainThread]: 
[0m20:32:25.216350 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:32:25.218476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:32:25.218854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:32:25.225225 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:32:25.226585 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:32:25.226851 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:32:25.227084 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:32:25.227302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:25.227521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:25.712361 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.485 seconds
[0m20:32:25.716096 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:32:25.747509 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.520 seconds
[0m20:32:25.751693 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:32:25.911382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m20:32:25.913495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m20:32:25.915880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m20:32:25.922416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m20:32:25.926436 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:32:25.928446 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:32:25.930642 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:32:25.933517 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:32:25.934000 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:32:25.934471 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:32:25.934898 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:32:25.935342 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:32:25.935751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:25.936147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:25.936506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:25.936896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:26.310510 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d30-0106-eb7f-000f-c0df0070a20e
[0m20:32:26.310945 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:32:26.311328 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:32:26.311584 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:32:26.311894 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:32:26.320173 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.384 seconds
[0m20:32:26.321272 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:32:26.326058 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.389 seconds
[0m20:32:26.327063 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:32:26.330801 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.395 seconds
[0m20:32:26.331655 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:32:26.462840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a17ea20>]}
[0m20:32:26.463857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:32:26.464812 [info ] [MainThread]: 
[0m20:32:26.474645 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m20:32:26.475252 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m20:32:26.475850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.stg_stock_daily)
[0m20:32:26.476322 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m20:32:26.482973 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m20:32:26.485229 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m20:32:26.506029 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:32:26.506421 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m20:32:26.506752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:26.991775 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.485 seconds
[0m20:32:26.996268 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m20:32:26.997738 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:32:26.998082 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m20:32:27.347774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m20:32:27.357234 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:32:27.357588 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m20:32:27.532274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m20:32:27.543060 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m20:32:27.654317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4f6f00>]}
[0m20:32:27.655725 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.18s]
[0m20:32:27.657146 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m20:32:27.658580 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m20:32:27.659153 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m20:32:27.659650 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m20:32:27.660116 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m20:32:27.660638 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m20:32:27.661476 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m20:32:27.662199 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m20:32:27.662949 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m20:32:27.663707 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_bollinger)
[0m20:32:27.664304 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_daily_returns)
[0m20:32:27.665139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.int_macd)
[0m20:32:27.665682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m20:32:27.666230 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m20:32:27.666753 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m20:32:27.667290 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m20:32:27.667735 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m20:32:27.670704 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m20:32:27.674745 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m20:32:27.676865 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m20:32:27.679011 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m20:32:27.680274 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m20:32:27.680661 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m20:32:27.693141 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m20:32:27.693422 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m20:32:27.693699 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m20:32:27.695085 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m20:32:27.696679 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m20:32:27.698099 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m20:32:27.699121 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:32:27.700759 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:32:27.701041 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m20:32:27.702476 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:32:27.703424 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:32:27.703685 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (
-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc;
[0m20:32:27.704034 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:32:27.704329 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    - Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m20:32:27.704673 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m20:32:27.705038 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:32:27.706266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:27.706569 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:32:28.031597 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d30-0106-eb7f-000f-c0df0070a212
[0m20:32:28.032479 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 21 unexpected 'relative'.
syntax error line 65 at position 16 unexpected 'ROWS'.
[0m20:32:28.033330 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m20:32:28.092443 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03d30-0106-ec6f-000f-c0df00707726
[0m20:32:28.093836 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 106 at position 9 unexpected ';'.
[0m20:32:28.095119 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m20:32:28.136735 [debug] [Thread-1 (]: Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 21 unexpected 'relative'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m20:32:28.138608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9936f5c0>]}
[0m20:32:28.140094 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[31mERROR[0m in 0.47s]
[0m20:32:28.141926 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m20:32:28.142867 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_rsi
[0m20:32:28.146290 [info ] [Thread-1 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m20:32:28.147408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.int_rsi)
[0m20:32:28.148053 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_rsi
[0m20:32:28.151896 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m20:32:28.153511 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_rsi
[0m20:32:28.155960 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m20:32:28.158354 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:32:28.158950 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m20:32:28.159480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:28.208422 [debug] [Thread-4 (]: Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 106 at position 9 unexpected ';'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m20:32:28.209055 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9898c9e0>]}
[0m20:32:28.209611 [error] [Thread-4 (]: 3 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.int_daily_returns  [[31mERROR[0m in 0.54s]
[0m20:32:28.210409 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m20:32:28.993889 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.287 seconds
[0m20:32:29.004787 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:32:29.008348 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m20:32:29.403282 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.699 seconds
[0m20:32:29.407707 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:32:29.409145 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m20:32:29.503553 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m20:32:29.519286 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:32:29.520151 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m20:32:29.535635 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m20:32:29.538183 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:32:29.538639 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m20:32:29.619529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.460 seconds
[0m20:32:29.621689 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:32:29.622165 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m20:32:29.632920 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m20:32:29.635781 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:32:29.636349 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m20:32:29.749888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m20:32:29.757129 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:32:29.758736 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m20:32:29.780825 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.260 seconds
[0m20:32:29.782900 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m20:32:29.786494 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:32:29.789512 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m20:32:29.790241 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m20:32:29.865586 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.106 seconds
[0m20:32:29.868120 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:32:29.868596 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m20:32:29.883717 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99383ad0>]}
[0m20:32:29.884454 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 2.22s]
[0m20:32:29.885465 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m20:32:29.910414 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m20:32:29.912359 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m20:32:30.010301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m20:32:30.012811 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: Close
[0m20:32:30.045946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9934f920>]}
[0m20:32:30.046439 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 2.38s]
[0m20:32:30.047100 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m20:32:30.129706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e7087c7-cde6-4b31-9f58-e4811ea0319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9898cd70>]}
[0m20:32:30.131638 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 1.98s]
[0m20:32:30.133413 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_rsi
[0m20:32:30.135284 [debug] [Thread-4 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m20:32:30.136453 [info ] [Thread-4 (]: 7 of 7 SKIP relation STOCK_RAW_stock_analytics.mart_stock_daily_metrics ........ [[33mSKIP[0m]
[0m20:32:30.137580 [debug] [Thread-4 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m20:32:30.140228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:30.140938 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m20:32:30.141655 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m20:32:30.142295 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m20:32:30.142868 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m20:32:30.143589 [info ] [MainThread]: 
[0m20:32:30.144404 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m20:32:30.146116 [debug] [MainThread]: Command end result
[0m20:32:30.184309 [info ] [MainThread]: 
[0m20:32:30.184840 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:32:30.185133 [info ] [MainThread]: 
[0m20:32:30.185447 [error] [MainThread]:   Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 21 unexpected 'relative'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m20:32:30.185719 [info ] [MainThread]: 
[0m20:32:30.185975 [error] [MainThread]:   Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 106 at position 9 unexpected ';'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m20:32:30.186229 [info ] [MainThread]: 
[0m20:32:30.186476 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 TOTAL=7
[0m20:32:30.187051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.5766234, "process_user_time": 2.541591, "process_kernel_time": 0.160171, "process_mem_max_rss": "236792", "process_in_blocks": "24", "process_out_blocks": "3043", "command_success": false}
[0m20:32:30.187393 [debug] [MainThread]: Command `dbt run` failed at 20:32:30.187345 after 5.58 seconds
[0m20:32:30.187694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba43c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb438d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99dbe120>]}
[0m20:32:30.187967 [debug] [MainThread]: Flushing usage events
[0m20:37:33.515632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93debe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949f88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a620f0>]}


============================== 20:37:33.519431 | db723ac9-aa96-41fa-a3b6-9ef3a4913bef ==============================
[0m20:37:33.519431 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:37:33.520098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:37:33.869000 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:37:33.869533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7397a0f0>]}
[0m20:37:33.894346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a620f0>]}
[0m20:37:33.914451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945badb0>]}
[0m20:37:33.914910 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:37:33.923676 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:37:34.009930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:37:34.010408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:37:34.033539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73562450>]}
[0m20:37:34.094328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff731fd160>]}
[0m20:37:34.094656 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:37:34.095224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e81130>]}
[0m20:37:34.096709 [info ] [MainThread]: 
[0m20:37:34.097226 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:37:34.099276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:37:34.099607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:37:34.106010 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:37:34.107393 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:37:34.107667 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:37:34.107917 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:37:34.108152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:34.108406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:34.794063 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.686 seconds
[0m20:37:34.798545 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:37:34.883281 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.775 seconds
[0m20:37:34.885608 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:37:35.013311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m20:37:35.014103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m20:37:35.014553 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m20:37:35.015479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m20:37:35.020317 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:37:35.021496 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:37:35.022944 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:37:35.024947 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:37:35.025384 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:37:35.025717 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:37:35.026037 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:37:35.026383 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:37:35.026667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:35.026959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:35.027410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:35.027735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:35.406824 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d35-0106-ec42-000f-c0df0070e01a
[0m20:37:35.407280 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:37:35.407638 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:37:35.407864 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:37:35.408147 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:37:35.443099 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.415 seconds
[0m20:37:35.447209 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:37:35.484326 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.457 seconds
[0m20:37:35.489871 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:37:35.521024 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.494 seconds
[0m20:37:35.523946 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:37:35.624812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73840080>]}
[0m20:37:35.625838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:37:35.626911 [info ] [MainThread]: 
[0m20:37:35.635204 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m20:37:35.635727 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m20:37:35.636372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.stg_stock_daily)
[0m20:37:35.636750 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m20:37:35.642423 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m20:37:35.644203 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m20:37:35.661901 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:37:35.662271 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m20:37:35.662559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:36.143475 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.481 seconds
[0m20:37:36.158163 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m20:37:36.161669 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:37:36.162411 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m20:37:36.707251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m20:37:36.730908 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:37:36.731553 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m20:37:36.997285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m20:37:37.009449 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m20:37:37.169656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71d7fb60>]}
[0m20:37:37.170524 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.53s]
[0m20:37:37.171676 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m20:37:37.172842 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m20:37:37.173283 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m20:37:37.173869 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m20:37:37.174233 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m20:37:37.174578 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m20:37:37.175275 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m20:37:37.175870 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m20:37:37.176433 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m20:37:37.176924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_bollinger)
[0m20:37:37.177388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_daily_returns)
[0m20:37:37.177998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.int_macd)
[0m20:37:37.178428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m20:37:37.178822 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m20:37:37.179225 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m20:37:37.179600 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m20:37:37.179951 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m20:37:37.182249 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m20:37:37.185562 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m20:37:37.187322 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m20:37:37.189121 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m20:37:37.190397 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m20:37:37.190658 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m20:37:37.201739 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m20:37:37.201974 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m20:37:37.202286 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m20:37:37.203782 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m20:37:37.205283 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m20:37:37.206747 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m20:37:37.207781 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:37:37.209184 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:37:37.209462 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m20:37:37.210482 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:37:37.210744 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (
-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc;
[0m20:37:37.211803 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:37:37.212053 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:37:37.212343 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m20:37:37.212665 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:37:37.212951 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    - Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m20:37:37.213989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:37:37.215197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:37.592019 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d35-0106-ed95-000f-c0df00709316
[0m20:37:37.592648 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 21 unexpected 'relative'.
syntax error line 65 at position 16 unexpected 'ROWS'.
[0m20:37:37.593209 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m20:37:37.598532 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03d35-0106-ec7d-000f-c0df0070c03a
[0m20:37:37.598995 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 106 at position 9 unexpected ';'.
[0m20:37:37.599496 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m20:37:37.701795 [debug] [Thread-1 (]: Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 21 unexpected 'relative'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m20:37:37.703405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71dc5a90>]}
[0m20:37:37.704679 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[31mERROR[0m in 0.52s]
[0m20:37:37.706371 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m20:37:37.707223 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_rsi
[0m20:37:37.709061 [info ] [Thread-1 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m20:37:37.709984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.int_rsi)
[0m20:37:37.710583 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_rsi
[0m20:37:37.714261 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m20:37:37.718060 [debug] [Thread-4 (]: Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 106 at position 9 unexpected ';'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m20:37:37.718658 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_rsi
[0m20:37:37.719238 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7132e2a0>]}
[0m20:37:37.721709 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m20:37:37.722381 [error] [Thread-4 (]: 3 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.int_daily_returns  [[31mERROR[0m in 0.54s]
[0m20:37:37.723419 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m20:37:37.725043 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:37:37.725500 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m20:37:37.726016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:39.162825 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.949 seconds
[0m20:37:39.163436 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.951 seconds
[0m20:37:39.165996 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:37:39.167247 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:37:39.167575 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m20:37:39.167885 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m20:37:39.317256 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m20:37:39.318246 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m20:37:39.327822 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:37:39.330020 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:37:39.330519 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m20:37:39.330940 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m20:37:39.412039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.686 seconds
[0m20:37:39.414863 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:37:39.415707 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m20:37:39.464398 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.132 seconds
[0m20:37:39.467552 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:37:39.468344 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m20:37:39.469293 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.138 seconds
[0m20:37:39.473053 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:37:39.473568 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m20:37:39.541816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m20:37:39.545619 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:37:39.546304 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m20:37:39.622899 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m20:37:39.625934 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m20:37:39.627962 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.081 seconds
[0m20:37:39.631436 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:37:39.631945 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m20:37:39.714511 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m20:37:39.717384 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m20:37:39.780208 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71d8e180>]}
[0m20:37:39.782101 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 2.60s]
[0m20:37:39.784489 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m20:37:39.815880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m20:37:39.822174 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: Close
[0m20:37:39.825561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7132d520>]}
[0m20:37:39.827588 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 2.65s]
[0m20:37:39.829400 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m20:37:39.942648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db723ac9-aa96-41fa-a3b6-9ef3a4913bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71dd7b00>]}
[0m20:37:39.957685 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 2.23s]
[0m20:37:39.958639 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_rsi
[0m20:37:39.959921 [debug] [Thread-4 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m20:37:39.960489 [info ] [Thread-4 (]: 7 of 7 SKIP relation STOCK_RAW_stock_analytics.mart_stock_daily_metrics ........ [[33mSKIP[0m]
[0m20:37:39.961388 [debug] [Thread-4 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m20:37:39.964406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:39.965194 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m20:37:39.965713 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m20:37:39.966207 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m20:37:39.966575 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m20:37:39.967023 [info ] [MainThread]: 
[0m20:37:39.967553 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m20:37:39.968513 [debug] [MainThread]: Command end result
[0m20:37:40.006871 [info ] [MainThread]: 
[0m20:37:40.007514 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:37:40.007865 [info ] [MainThread]: 
[0m20:37:40.008264 [error] [MainThread]:   Database Error in model int_moving_averages (models/intermediate/int_moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 21 unexpected 'relative'.
  syntax error line 65 at position 16 unexpected 'ROWS'.
  compiled code at target/run/stock_analytics/models/intermediate/int_moving_averages.sql
[0m20:37:40.008548 [info ] [MainThread]: 
[0m20:37:40.008884 [error] [MainThread]:   Database Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 106 at position 9 unexpected ';'.
  compiled code at target/run/stock_analytics/models/intermediate/int_daily_returns.sql
[0m20:37:40.009165 [info ] [MainThread]: 
[0m20:37:40.009503 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 TOTAL=7
[0m20:37:40.010643 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5348477, "process_user_time": 2.666567, "process_kernel_time": 0.168458, "process_mem_max_rss": "232864", "process_out_blocks": "3043", "command_success": false, "process_in_blocks": "0"}
[0m20:37:40.011180 [debug] [MainThread]: Command `dbt run` failed at 20:37:40.011114 after 6.54 seconds
[0m20:37:40.011574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7390a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff731f14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e25880>]}
[0m20:37:40.011881 [debug] [MainThread]: Flushing usage events
[0m20:40:09.657245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb596d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb519b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb44dcd70>]}


============================== 20:40:09.661796 | 72d4da04-4153-449a-8daf-023e8cd3b42d ==============================
[0m20:40:09.661796 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:40:09.662766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:09.666748 [info ] [MainThread]: dbt version: 1.8.8
[0m20:40:09.667303 [info ] [MainThread]: python version: 3.12.4
[0m20:40:09.667798 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:40:09.668531 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m20:40:10.036000 [info ] [MainThread]: Using profiles dir at .
[0m20:40:10.036597 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m20:40:10.037008 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m20:40:10.037445 [info ] [MainThread]: adapter type: snowflake
[0m20:40:10.037759 [info ] [MainThread]: adapter version: 1.8.4
[0m20:40:10.062210 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:40:10.062774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '72d4da04-4153-449a-8daf-023e8cd3b42d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9877acf0>]}
[0m20:40:10.077149 [info ] [MainThread]: Configuration:
[0m20:40:10.077525 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:40:10.077851 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:40:10.078172 [info ] [MainThread]: Required dependencies:
[0m20:40:10.078495 [debug] [MainThread]: Executing "git --help"
[0m20:40:10.080270 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:40:10.080545 [debug] [MainThread]: STDERR: "b''"
[0m20:40:10.080788 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:40:10.081083 [info ] [MainThread]: Connection:
[0m20:40:10.081400 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m20:40:10.081655 [info ] [MainThread]:   user: MALLARD
[0m20:40:10.081945 [info ] [MainThread]:   database: ASH_DB
[0m20:40:10.082223 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m20:40:10.082477 [info ] [MainThread]:   role: TRAINING_ROLE
[0m20:40:10.082724 [info ] [MainThread]:   schema: STOCK_RAW
[0m20:40:10.083005 [info ] [MainThread]:   authenticator: None
[0m20:40:10.083258 [info ] [MainThread]:   oauth_client_id: None
[0m20:40:10.083520 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m20:40:10.083799 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:40:10.084051 [info ] [MainThread]:   host: None
[0m20:40:10.084285 [info ] [MainThread]:   port: None
[0m20:40:10.084515 [info ] [MainThread]:   proxy_host: None
[0m20:40:10.084764 [info ] [MainThread]:   proxy_port: None
[0m20:40:10.085031 [info ] [MainThread]:   protocol: None
[0m20:40:10.085274 [info ] [MainThread]:   connect_retries: 1
[0m20:40:10.085527 [info ] [MainThread]:   connect_timeout: None
[0m20:40:10.085783 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:40:10.086056 [info ] [MainThread]:   retry_all: False
[0m20:40:10.086311 [info ] [MainThread]:   insecure_mode: False
[0m20:40:10.086549 [info ] [MainThread]:   reuse_connections: None
[0m20:40:10.086874 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:40:10.088562 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:40:10.089023 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:40:10.089253 [debug] [MainThread]: On debug: select 1 as id
[0m20:40:10.089471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:10.606673 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.517 seconds
[0m20:40:10.609214 [debug] [MainThread]: On debug: Close
[0m20:40:10.751831 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:40:10.753822 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:40:10.756181 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1477594, "process_user_time": 1.784607, "process_kernel_time": 0.150051, "process_mem_max_rss": "236792", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m20:40:10.758050 [debug] [MainThread]: Command `dbt debug` succeeded at 20:40:10.757903 after 1.15 seconds
[0m20:40:10.758859 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:40:10.759648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45ca3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b2f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4177ce0>]}
[0m20:40:10.760424 [debug] [MainThread]: Flushing usage events
[0m20:40:13.531954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ef1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ef1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8010cef0>]}


============================== 20:40:13.535305 | bc1f79cd-3112-4615-8575-a34568acf391 ==============================
[0m20:40:13.535305 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:40:13.535877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:13.558993 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:40:13.559368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bc1f79cd-3112-4615-8575-a34568acf391', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805525a0>]}
[0m20:40:13.585216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc1f79cd-3112-4615-8575-a34568acf391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800cb5c0>]}
[0m20:40:13.631256 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x5vi83i_'
[0m20:40:13.631731 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:40:13.917784 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:40:13.918578 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:40:14.101111 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:40:14.104099 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:40:14.757347 [info ] [MainThread]: Installed from version 1.1.1
[0m20:40:14.758028 [info ] [MainThread]: Updated version available: 1.3.2
[0m20:40:14.758680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bc1f79cd-3112-4615-8575-a34568acf391', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fc0c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812efda0>]}
[0m20:40:14.759145 [info ] [MainThread]: 
[0m20:40:14.759496 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:40:14.760602 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.264467, "process_user_time": 0.907034, "process_kernel_time": 0.076594, "process_mem_max_rss": "236792", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m20:40:14.761175 [debug] [MainThread]: Command `dbt deps` succeeded at 20:40:14.761049 after 1.27 seconds
[0m20:40:14.761691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800cad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8447ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff809489e0>]}
[0m20:40:14.762260 [debug] [MainThread]: Flushing usage events
[0m20:40:18.147025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94417530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9441a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94565c40>]}


============================== 20:40:18.150854 | 6fcac2bf-b668-434a-8b2c-15025962b6c5 ==============================
[0m20:40:18.150854 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:40:18.151314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:40:18.604101 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:40:18.605049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6fcac2bf-b668-434a-8b2c-15025962b6c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78b66cf0>]}
[0m20:40:18.634736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fcac2bf-b668-434a-8b2c-15025962b6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff785734a0>]}
[0m20:40:18.654630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fcac2bf-b668-434a-8b2c-15025962b6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948036b0>]}
[0m20:40:18.655072 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:40:18.663604 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:40:18.831015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:40:18.831758 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_moving_averages.sql
[0m20:40:18.832104 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_daily_returns.sql
[0m20:40:18.908153 [error] [MainThread]: Encountered an error:
Compilation Error in model int_daily_returns (models/intermediate/int_daily_returns.sql)
  expected token ',', got '='
    line 3
      --         materialized='table'
[0m20:40:18.909694 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.80954784, "process_user_time": 2.229449, "process_kernel_time": 0.295908, "process_mem_max_rss": "234820", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m20:40:18.910453 [debug] [MainThread]: Command `dbt snapshot` failed at 20:40:18.910394 after 0.81 seconds
[0m20:40:18.910765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9441a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98777620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff782f4b90>]}
[0m20:40:18.911023 [debug] [MainThread]: Flushing usage events
[0m20:45:22.320606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0fbff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b9ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2529100>]}


============================== 20:45:22.326043 | e2d4b669-fb79-4349-9027-91ae95b4a67a ==============================
[0m20:45:22.326043 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:45:22.326809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:45:22.787888 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:45:22.788662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e2d4b669-fb79-4349-9027-91ae95b4a67a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af461e0>]}
[0m20:45:22.823915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2d4b669-fb79-4349-9027-91ae95b4a67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af215b0>]}
[0m20:45:22.848824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2d4b669-fb79-4349-9027-91ae95b4a67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0356450>]}
[0m20:45:22.849511 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:45:22.861220 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:45:22.963682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:45:22.964305 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_daily_returns.sql
[0m20:45:22.964604 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/intermediate/int_moving_averages.sql
[0m20:45:23.178058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2d4b669-fb79-4349-9027-91ae95b4a67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94135be0>]}
[0m20:45:23.246194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2d4b669-fb79-4349-9027-91ae95b4a67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff2af30>]}
[0m20:45:23.246671 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:45:23.246941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2d4b669-fb79-4349-9027-91ae95b4a67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941a0e60>]}
[0m20:45:23.248281 [info ] [MainThread]: 
[0m20:45:23.248688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:45:23.249390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:45:23.256742 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:45:23.257227 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:45:23.257680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:23.925672 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.668 seconds
[0m20:45:23.926729 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:45:24.065768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m20:45:24.066209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m20:45:24.070721 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:45:24.071064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m20:45:24.071549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m20:45:24.072589 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:45:24.073006 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:45:24.073988 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:45:24.075526 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:45:24.075811 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:45:24.076097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:24.076373 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:45:24.076633 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:45:24.076875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:24.078190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:24.078556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:24.523658 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d3d-0106-eb85-000f-c0df0070b0ba
[0m20:45:24.524350 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:45:24.524838 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:45:24.525199 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:45:24.525630 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:45:24.618746 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.540 seconds
[0m20:45:24.619958 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.543 seconds
[0m20:45:24.622372 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:45:24.624198 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:45:24.629298 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.551 seconds
[0m20:45:24.630796 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:45:24.790106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2d4b669-fb79-4349-9027-91ae95b4a67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9452b260>]}
[0m20:45:24.791509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:24.794483 [info ] [MainThread]: 
[0m20:45:24.806732 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m20:45:24.807558 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m20:45:24.808763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now snapshot.stock_analytics.stock_price_snapshot)
[0m20:45:24.809344 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m20:45:24.824775 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m20:45:24.857030 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:24.857535 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m20:45:24.857858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:26.527739 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.670 seconds
[0m20:45:26.545143 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:26.546327 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:45:26.668362 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.121 seconds
[0m20:45:26.675729 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:26.676239 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:45:26.994931 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.318 seconds
[0m20:45:27.076831 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:27.077373 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace temporary table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:45:28.761775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.683 seconds
[0m20:45:28.769654 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:28.770264 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:45:28.874172 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.103 seconds
[0m20:45:28.881382 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:28.882505 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:45:28.964549 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.081 seconds
[0m20:45:28.971802 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:28.972876 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:45:29.083512 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.109 seconds
[0m20:45:29.090317 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:29.091545 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:45:29.215568 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.122 seconds
[0m20:45:29.232851 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:29.233626 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:45:29.316434 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.082 seconds
[0m20:45:29.337738 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:29.339085 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m20:45:29.906643 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.566 seconds
[0m20:45:29.913492 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:29.914489 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:45:30.039631 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.124 seconds
[0m20:45:30.045019 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:30.051054 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:30.052647 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
BEGIN
[0m20:45:30.234559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m20:45:30.235821 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:30.236714 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
merge into "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:45:31.135684 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.898 seconds
[0m20:45:31.137037 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:45:31.138308 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
COMMIT
[0m20:45:31.532848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m20:45:31.555339 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m20:45:31.667583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2d4b669-fb79-4349-9027-91ae95b4a67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947a2840>]}
[0m20:45:31.668844 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 8[0m in 6.86s]
[0m20:45:31.672014 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m20:45:31.675900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:31.676320 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_test_failures' was properly closed.
[0m20:45:31.676524 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_raw' was properly closed.
[0m20:45:31.676736 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m20:45:31.676987 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m20:45:31.677391 [info ] [MainThread]: 
[0m20:45:31.677958 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m20:45:31.678734 [debug] [MainThread]: Command end result
[0m20:45:31.708389 [info ] [MainThread]: 
[0m20:45:31.709300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:31.709777 [info ] [MainThread]: 
[0m20:45:31.710192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:45:31.712098 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.430875, "process_user_time": 2.725517, "process_kernel_time": 0.272145, "process_mem_max_rss": "232856", "process_out_blocks": "4242", "process_in_blocks": "0"}
[0m20:45:31.712818 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:45:31.712733 after 9.43 seconds
[0m20:45:31.713425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb173d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb173cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9437e810>]}
[0m20:45:31.713828 [debug] [MainThread]: Flushing usage events
[0m20:45:51.141161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfbfef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfbfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfbf0b0>]}


============================== 20:45:51.145503 | 80b69dd3-b536-498b-84ba-0277a436aa04 ==============================
[0m20:45:51.145503 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:45:51.146206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:51.149433 [info ] [MainThread]: dbt version: 1.8.8
[0m20:45:51.149785 [info ] [MainThread]: python version: 3.12.4
[0m20:45:51.150132 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:45:51.150496 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m20:45:51.500010 [info ] [MainThread]: Using profiles dir at .
[0m20:45:51.500552 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m20:45:51.500896 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m20:45:51.501291 [info ] [MainThread]: adapter type: snowflake
[0m20:45:51.501635 [info ] [MainThread]: adapter version: 1.8.4
[0m20:45:51.523904 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:45:51.524295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '80b69dd3-b536-498b-84ba-0277a436aa04', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e5c6a80>]}
[0m20:45:51.539134 [info ] [MainThread]: Configuration:
[0m20:45:51.539555 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:45:51.539856 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:45:51.540153 [info ] [MainThread]: Required dependencies:
[0m20:45:51.540461 [debug] [MainThread]: Executing "git --help"
[0m20:45:51.542198 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:45:51.542496 [debug] [MainThread]: STDERR: "b''"
[0m20:45:51.542703 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:45:51.542997 [info ] [MainThread]: Connection:
[0m20:45:51.543297 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m20:45:51.543545 [info ] [MainThread]:   user: MALLARD
[0m20:45:51.543812 [info ] [MainThread]:   database: ASH_DB
[0m20:45:51.544077 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m20:45:51.544330 [info ] [MainThread]:   role: TRAINING_ROLE
[0m20:45:51.544573 [info ] [MainThread]:   schema: STOCK_RAW
[0m20:45:51.544813 [info ] [MainThread]:   authenticator: None
[0m20:45:51.545111 [info ] [MainThread]:   oauth_client_id: None
[0m20:45:51.545416 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m20:45:51.545649 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:45:51.545879 [info ] [MainThread]:   host: None
[0m20:45:51.546131 [info ] [MainThread]:   port: None
[0m20:45:51.546425 [info ] [MainThread]:   proxy_host: None
[0m20:45:51.546679 [info ] [MainThread]:   proxy_port: None
[0m20:45:51.546925 [info ] [MainThread]:   protocol: None
[0m20:45:51.547179 [info ] [MainThread]:   connect_retries: 1
[0m20:45:51.547419 [info ] [MainThread]:   connect_timeout: None
[0m20:45:51.547657 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:45:51.547906 [info ] [MainThread]:   retry_all: False
[0m20:45:51.548163 [info ] [MainThread]:   insecure_mode: False
[0m20:45:51.548405 [info ] [MainThread]:   reuse_connections: None
[0m20:45:51.548701 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:45:51.550280 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:45:51.550721 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:45:51.550970 [debug] [MainThread]: On debug: select 1 as id
[0m20:45:51.551221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:51.946182 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.395 seconds
[0m20:45:51.948590 [debug] [MainThread]: On debug: Close
[0m20:45:52.104711 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:45:52.107087 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:45:52.109323 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0046685, "process_user_time": 1.787051, "process_kernel_time": 0.155701, "process_mem_max_rss": "234808", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m20:45:52.110422 [debug] [MainThread]: Command `dbt debug` succeeded at 20:45:52.110280 after 1.01 seconds
[0m20:45:52.111206 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:45:52.111988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e5acec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67fbb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61eee180>]}
[0m20:45:52.112899 [debug] [MainThread]: Flushing usage events
[0m20:45:54.612667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa221c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ebfec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27686e0>]}


============================== 20:45:54.616683 | fb38d4e4-3774-4ee3-b739-fcb253e4dad0 ==============================
[0m20:45:54.616683 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:45:54.617459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:45:54.642186 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:45:54.642790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb38d4e4-3774-4ee3-b739-fcb253e4dad0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19cd310>]}
[0m20:45:54.674321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb38d4e4-3774-4ee3-b739-fcb253e4dad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f4e210>]}
[0m20:45:54.737528 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pvcesygm'
[0m20:45:54.737957 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:45:55.028056 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:45:55.028747 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:45:55.214615 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:45:55.216971 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:45:55.837317 [info ] [MainThread]: Installed from version 1.1.1
[0m20:45:55.838055 [info ] [MainThread]: Updated version available: 1.3.2
[0m20:45:55.838518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fb38d4e4-3774-4ee3-b739-fcb253e4dad0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1931a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19337d0>]}
[0m20:45:55.838889 [info ] [MainThread]: 
[0m20:45:55.839214 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:45:55.840079 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2686362, "process_user_time": 1.012092, "process_kernel_time": 0.10966, "process_mem_max_rss": "234808", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m20:45:55.840448 [debug] [MainThread]: Command `dbt deps` succeeded at 20:45:55.840400 after 1.27 seconds
[0m20:45:55.840731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa221f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa257d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa257c230>]}
[0m20:45:55.841011 [debug] [MainThread]: Flushing usage events
[0m20:45:58.785751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88cf8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892016d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892698e0>]}


============================== 20:45:58.789581 | 065edab3-849c-4a75-879a-c2c280f3668c ==============================
[0m20:45:58.789581 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:45:58.790475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:45:59.184540 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:45:59.185202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '065edab3-849c-4a75-879a-c2c280f3668c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d69ecf0>]}
[0m20:45:59.209161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065edab3-849c-4a75-879a-c2c280f3668c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d3ded50>]}
[0m20:45:59.229586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065edab3-849c-4a75-879a-c2c280f3668c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a3c950>]}
[0m20:45:59.230070 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:45:59.237671 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:45:59.336828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:59.337275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:59.359860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065edab3-849c-4a75-879a-c2c280f3668c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890b7440>]}
[0m20:45:59.449385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065edab3-849c-4a75-879a-c2c280f3668c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ccdb050>]}
[0m20:45:59.449943 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:45:59.450633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065edab3-849c-4a75-879a-c2c280f3668c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cce11f0>]}
[0m20:45:59.451876 [info ] [MainThread]: 
[0m20:45:59.452385 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:45:59.453103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:45:59.460024 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:45:59.460314 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:45:59.460547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:59.879292 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.418 seconds
[0m20:45:59.882828 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:46:00.000549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_analytics)
[0m20:46:00.002610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m20:46:00.004703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m20:46:00.014032 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:46:00.016337 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:46:00.016861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m20:46:00.018910 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:46:00.019348 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:46:00.019799 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:46:00.021571 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:46:00.021999 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:46:00.022409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:00.022799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:00.023232 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:46:00.023725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:00.027972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:00.354752 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d3e-0106-eb7f-000f-c0df0070a236
[0m20:46:00.355646 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:46:00.356356 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:46:00.356842 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:46:00.357396 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:46:00.466078 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.438 seconds
[0m20:46:00.468117 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:46:00.471186 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.449 seconds
[0m20:46:00.472537 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:46:00.569017 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.546 seconds
[0m20:46:00.571138 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:46:00.728459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065edab3-849c-4a75-879a-c2c280f3668c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ccdbfb0>]}
[0m20:46:00.729313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:00.730285 [info ] [MainThread]: 
[0m20:46:00.739244 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m20:46:00.741269 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m20:46:00.744604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now snapshot.stock_analytics.stock_price_snapshot)
[0m20:46:00.745035 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m20:46:00.757857 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m20:46:00.784060 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:00.784507 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m20:46:00.784839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:01.651318 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.866 seconds
[0m20:46:01.667245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:01.668345 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:46:01.744966 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.076 seconds
[0m20:46:01.753743 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:01.754342 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:46:01.841362 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.086 seconds
[0m20:46:01.863688 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:01.864200 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace temporary table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:46:03.145006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.280 seconds
[0m20:46:03.151214 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:03.152103 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:46:03.266916 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.114 seconds
[0m20:46:03.274373 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:03.275286 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:46:03.460773 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.185 seconds
[0m20:46:03.463055 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:03.463363 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:46:03.594483 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.131 seconds
[0m20:46:03.596777 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:03.597124 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m20:46:03.676458 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.079 seconds
[0m20:46:03.688417 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:03.689185 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m20:46:04.109479 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.419 seconds
[0m20:46:04.132325 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:04.133153 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m20:46:04.516754 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.383 seconds
[0m20:46:04.519148 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:04.519460 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:46:04.631079 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.111 seconds
[0m20:46:04.631825 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:04.635242 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:04.635795 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
BEGIN
[0m20:46:04.827227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m20:46:04.828488 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:04.829354 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
merge into "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:46:05.951030 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 1.121 seconds
[0m20:46:05.952817 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m20:46:05.953920 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
COMMIT
[0m20:46:06.324259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m20:46:06.353040 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m20:46:06.461910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065edab3-849c-4a75-879a-c2c280f3668c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d327110>]}
[0m20:46:06.464513 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 10[0m in 5.71s]
[0m20:46:06.468620 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m20:46:06.472096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:06.472837 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_analytics' was properly closed.
[0m20:46:06.473415 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_raw' was properly closed.
[0m20:46:06.473914 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m20:46:06.474371 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m20:46:06.474947 [info ] [MainThread]: 
[0m20:46:06.475990 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m20:46:06.477077 [debug] [MainThread]: Command end result
[0m20:46:06.514844 [info ] [MainThread]: 
[0m20:46:06.515438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:06.515778 [info ] [MainThread]: 
[0m20:46:06.516125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:46:06.517172 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.781648, "process_user_time": 2.500439, "process_kernel_time": 0.178531, "process_mem_max_rss": "236800", "process_out_blocks": "2911", "process_in_blocks": "0"}
[0m20:46:06.517678 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:46:06.517612 after 7.78 seconds
[0m20:46:06.518050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5bb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898cbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cce17f0>]}
[0m20:46:06.518338 [debug] [MainThread]: Flushing usage events
[0m20:46:09.896505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889c8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fc85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a655b80>]}


============================== 20:46:09.899960 | 9ef4242a-7ab2-43fe-9503-2ea63ca2293f ==============================
[0m20:46:09.899960 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:46:09.900917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:46:10.289922 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:46:10.290526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cf35a90>]}
[0m20:46:10.320568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84da9bb0>]}
[0m20:46:10.340844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0c3230>]}
[0m20:46:10.341322 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:46:10.349641 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:46:10.437979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:10.438356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:10.460671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c5c61e0>]}
[0m20:46:10.520414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c4c15b0>]}
[0m20:46:10.520735 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:46:10.521159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c255bb0>]}
[0m20:46:10.522273 [info ] [MainThread]: 
[0m20:46:10.522809 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:46:10.524954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:46:10.525322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:46:10.532131 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:46:10.533488 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:46:10.533769 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:46:10.534003 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:46:10.534213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:10.534404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:11.065601 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.531 seconds
[0m20:46:11.069627 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:46:11.103608 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.569 seconds
[0m20:46:11.107323 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:46:11.206723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m20:46:11.207433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_analytics)
[0m20:46:11.208427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m20:46:11.208999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m20:46:11.214259 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:46:11.215798 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:46:11.217311 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:46:11.219520 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:46:11.219933 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:46:11.220325 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:46:11.220693 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:46:11.221040 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:46:11.221410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:11.221775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:11.222142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:11.222504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:11.608562 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.387 seconds
[0m20:46:11.612242 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:46:11.642545 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d3e-0106-eb86-000f-c0df006fa972
[0m20:46:11.643834 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:46:11.644912 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:46:11.645645 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:46:11.646449 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:46:11.676000 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.453 seconds
[0m20:46:11.678962 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:46:11.706946 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.484 seconds
[0m20:46:11.711743 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:46:11.860091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c643410>]}
[0m20:46:11.860772 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:11.861417 [info ] [MainThread]: 
[0m20:46:11.868726 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m20:46:11.869233 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m20:46:11.869735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.stg_stock_daily)
[0m20:46:11.870085 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m20:46:11.874548 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m20:46:11.876723 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m20:46:11.893806 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:46:11.894176 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m20:46:11.894496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:12.341756 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.447 seconds
[0m20:46:12.351625 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m20:46:12.355181 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:46:12.355742 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m20:46:12.817989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m20:46:12.844577 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:46:12.845283 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m20:46:12.999329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m20:46:13.010697 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m20:46:13.161339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f0d6a0>]}
[0m20:46:13.163055 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.29s]
[0m20:46:13.165062 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m20:46:13.167588 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m20:46:13.168977 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m20:46:13.169527 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m20:46:13.170188 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m20:46:13.170865 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m20:46:13.172094 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m20:46:13.173484 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m20:46:13.174586 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m20:46:13.175906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_bollinger)
[0m20:46:13.176719 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_daily_returns)
[0m20:46:13.177814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.int_macd)
[0m20:46:13.178499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m20:46:13.179130 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m20:46:13.179776 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m20:46:13.180412 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m20:46:13.180905 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m20:46:13.184230 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m20:46:13.188518 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m20:46:13.190937 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m20:46:13.193105 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m20:46:13.194517 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m20:46:13.195149 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m20:46:13.208367 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m20:46:13.209947 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m20:46:13.210193 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m20:46:13.210442 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m20:46:13.212926 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m20:46:13.214447 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m20:46:13.215486 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:46:13.216435 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:46:13.217665 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m20:46:13.219236 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:46:13.219517 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc
        );
[0m20:46:13.220648 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:46:13.220972 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:13.221290 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m20:46:13.221594 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:46:13.221926 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    -- Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m20:46:13.223040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:13.224422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:14.452526 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.231 seconds
[0m20:46:14.453971 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.231 seconds
[0m20:46:14.454616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.230 seconds
[0m20:46:14.456660 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:46:14.458287 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:46:14.459510 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:46:14.459942 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m20:46:14.460311 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m20:46:14.460664 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages IS $$Moving averages for trend analysis$$;
[0m20:46:14.565362 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m20:46:14.566588 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m20:46:14.581432 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:46:14.583888 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:46:14.584736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m20:46:14.585157 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m20:46:14.585709 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m20:46:14.588092 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:46:14.590390 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
[0m20:46:14.597932 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.376 seconds
[0m20:46:14.599343 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:46:14.599704 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns IS $$Daily returns and volatility metrics$$;
[0m20:46:14.660762 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.070 seconds
[0m20:46:14.663619 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:46:14.664153 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "PRICE_VS_MA20_PCT" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$Golden cross or death cross signal$$;
[0m20:46:14.666430 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.078 seconds
[0m20:46:14.668990 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:46:14.669431 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m20:46:14.683513 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.094 seconds
[0m20:46:14.685833 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:46:14.686311 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m20:46:14.699629 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m20:46:14.702492 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:46:14.703008 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
[0m20:46:14.784332 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.081 seconds
[0m20:46:14.787337 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:46:14.787779 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "PREV_ADJ_CLOSE" COMMENT $$$$,
    
        "ADJ_DAILY_CHANGE" COMMENT $$$$,
    
        "ADJ_DAILY_RETURN_PCT" COMMENT $$$$,
    
        "LOG_RETURN" COMMENT $$$$,
    
        "VOLATILITY_20D" COMMENT $$20-day rolling volatility$$,
    
        "CUMULATIVE_RETURN_PCT" COMMENT $$$$;
[0m20:46:14.827600 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m20:46:14.828559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m20:46:14.828967 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m20:46:14.830393 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m20:46:14.831444 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m20:46:14.832435 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m20:46:14.936344 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b45a90>]}
[0m20:46:14.937258 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 1.76s]
[0m20:46:14.938513 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m20:46:14.938879 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_rsi
[0m20:46:14.939336 [info ] [Thread-3 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m20:46:14.939786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_bollinger, now model.stock_analytics.int_rsi)
[0m20:46:14.940060 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_rsi
[0m20:46:14.942422 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m20:46:14.943668 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_rsi
[0m20:46:14.944129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67583ef0>]}
[0m20:46:14.945589 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m20:46:14.946077 [info ] [Thread-1 (]: 5 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[32mSUCCESS 1[0m in 1.77s]
[0m20:46:14.948475 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m20:46:14.950132 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:46:14.950465 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m20:46:14.951127 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:14.960343 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b46ba0>]}
[0m20:46:14.960982 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 1.78s]
[0m20:46:14.961735 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m20:46:15.214358 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m20:46:15.216219 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m20:46:15.322389 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67590530>]}
[0m20:46:15.323174 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_daily_returns .. [[32mSUCCESS 1[0m in 2.15s]
[0m20:46:15.324109 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m20:46:16.598882 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.648 seconds
[0m20:46:16.600759 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:46:16.601080 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m20:46:16.692161 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.091 seconds
[0m20:46:16.694827 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:46:16.695188 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m20:46:16.772025 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.076 seconds
[0m20:46:16.773783 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:46:16.774105 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m20:46:16.914200 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m20:46:16.915580 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: Close
[0m20:46:17.036567 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b46ba0>]}
[0m20:46:17.037205 [info ] [Thread-3 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 2.10s]
[0m20:46:17.038001 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_rsi
[0m20:46:17.038930 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m20:46:17.039294 [info ] [Thread-1 (]: 7 of 7 START sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [RUN]
[0m20:46:17.039738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.mart_stock_daily_metrics)
[0m20:46:17.040043 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_daily_metrics
[0m20:46:17.043139 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_daily_metrics"
[0m20:46:17.044199 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_daily_metrics
[0m20:46:17.047090 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_daily_metrics"
[0m20:46:17.049497 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m20:46:17.049880 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
         as
        (

WITH base AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
),

ma AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
),

rsi AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_rsi
),

bollinger AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
),

macd AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_macd
)

SELECT 
    -- Basic information
    base.SYMBOL,
    base."DATE",
    base."CLOSE",
    base."OPEN",
    base."MAX",
    base."MIN",
    base.VOLUME,
    
    -- Daily changes
    base.DAILY_CHANGE,
    base.DAILY_CHANGE_PCT,
    base.INTRADAY_RANGE,
    base.INTRADAY_RANGE_PCT,
    
    -- Moving Averages
    ma.MA_5,
    ma.MA_10,
    ma.MA_20,
    ma.MA_50,
    ma.MA_100,
    ma.EMA_12,
    ma.EMA_26,
    ma.AVG_VOLUME_20,
    
    -- MA Cross Signals (Golden Cross / Death Cross)
    CASE 
        -- Golden Cross: MA5 crosses above MA20
        WHEN ma.MA_5 > ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") 
        THEN 'GOLDEN_CROSS_5_20'
        
        -- Death Cross: MA5 crosses below MA20
        WHEN ma.MA_5 < ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_5_20'
        
        -- Golden Cross: MA20 crosses above MA50
        WHEN ma.MA_20 > ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'GOLDEN_CROSS_20_50'
        
        -- Death Cross: MA20 crosses below MA50
        WHEN ma.MA_20 < ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_20_50'
        
        ELSE 'NO_CROSS'
    END as MA_CROSS_SIGNAL,
    
    -- Price vs MA trend analysis
    CASE 
        WHEN base."CLOSE" > ma.MA_5 AND base."CLOSE" > ma.MA_20 AND base."CLOSE" > ma.MA_50 THEN 'STRONG_UPTREND'
        WHEN base."CLOSE" < ma.MA_5 AND base."CLOSE" < ma.MA_20 AND base."CLOSE" < ma.MA_50 THEN 'STRONG_DOWNTREND'
        WHEN base."CLOSE" > ma.MA_20 THEN 'UPTREND'
        WHEN base."CLOSE" < ma.MA_20 THEN 'DOWNTREND'
        ELSE 'SIDEWAYS'
    END as PRICE_TREND,
    
    -- RSI indicators
    rsi.RSI_14,
    rsi.RSI_SIGNAL,
    
    -- Bollinger Bands
    bollinger.UPPER_BAND,
    bollinger.LOWER_BAND,
    bollinger.MA_20 as BB_MIDDLE,
    bollinger.BAND_WIDTH_PCT,
    bollinger.BAND_POSITION,
    bollinger.PERCENT_B,
    
    -- MACD indicators
    macd.MACD_LINE,
    macd.SIGNAL_LINE,
    macd.MACD_HISTOGRAM,
    macd.MACD_SIGNAL,
    
    -- Volume Analysis
    CASE 
        WHEN base.VOLUME > 1.5 * ma.AVG_VOLUME_20 THEN 'HIGH_VOLUME'
        WHEN base.VOLUME < 0.5 * ma.AVG_VOLUME_20 THEN 'LOW_VOLUME'
        ELSE 'NORMAL_VOLUME'
    END as VOLUME_SIGNAL,
    
    ROUND(base.VOLUME / NULLIF(ma.AVG_VOLUME_20, 0), 2) as VOLUME_RATIO,
    
    -- Volatility (using intraday range as proxy)
    CASE 
        WHEN base.INTRADAY_RANGE_PCT > 5 THEN 'HIGH_VOLATILITY'
        WHEN base.INTRADAY_RANGE_PCT < 1 THEN 'LOW_VOLATILITY'
        ELSE 'NORMAL_VOLATILITY'
    END as VOLATILITY_SIGNAL

FROM base
LEFT JOIN ma 
    ON base.SYMBOL = ma.SYMBOL AND base."DATE" = ma."DATE"
LEFT JOIN rsi 
    ON base.SYMBOL = rsi.SYMBOL AND base."DATE" = rsi."DATE"
LEFT JOIN bollinger 
    ON base.SYMBOL = bollinger.SYMBOL AND base."DATE" = bollinger."DATE"
LEFT JOIN macd 
    ON base.SYMBOL = macd.SYMBOL AND base."DATE" = macd."DATE"
        );
[0m20:46:17.050295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:17.502448 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d3e-0106-eb86-000f-c0df006fa97a
[0m20:46:17.503503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 43 at position 4
invalid identifier 'MA.MA_10'
[0m20:46:17.504431 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: Close
[0m20:46:17.894948 [debug] [Thread-1 (]: Database Error in model mart_stock_daily_metrics (models/marts/mart_stock_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 43 at position 4
  invalid identifier 'MA.MA_10'
  compiled code at target/run/stock_analytics/models/marts/mart_stock_daily_metrics.sql
[0m20:46:17.896313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef4242a-7ab2-43fe-9503-2ea63ca2293f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66bd3f20>]}
[0m20:46:17.897774 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [[31mERROR[0m in 0.86s]
[0m20:46:17.899929 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m20:46:17.905354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:17.906185 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m20:46:17.906746 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m20:46:17.907236 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_daily_metrics' was properly closed.
[0m20:46:17.907712 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m20:46:17.908480 [info ] [MainThread]: 
[0m20:46:17.909435 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m20:46:17.911055 [debug] [MainThread]: Command end result
[0m20:46:18.058489 [info ] [MainThread]: 
[0m20:46:18.059151 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:46:18.059501 [info ] [MainThread]: 
[0m20:46:18.059777 [error] [MainThread]:   Database Error in model mart_stock_daily_metrics (models/marts/mart_stock_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 43 at position 4
  invalid identifier 'MA.MA_10'
  compiled code at target/run/stock_analytics/models/marts/mart_stock_daily_metrics.sql
[0m20:46:18.060082 [info ] [MainThread]: 
[0m20:46:18.060331 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:46:18.061051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.201081, "process_user_time": 2.77991, "process_kernel_time": 0.260962, "process_mem_max_rss": "234816", "process_out_blocks": "3090", "command_success": false, "process_in_blocks": "0"}
[0m20:46:18.061400 [debug] [MainThread]: Command `dbt run` failed at 20:46:18.061356 after 8.20 seconds
[0m20:46:18.061697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889c8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6f0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897c5940>]}
[0m20:46:18.061966 [debug] [MainThread]: Flushing usage events
[0m20:51:20.624689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dfb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8324c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83735460>]}


============================== 20:51:20.628559 | 21945b0f-fde8-4122-9349-8480acdcf284 ==============================
[0m20:51:20.628559 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:51:20.629045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:20.979794 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:51:20.980338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd37560>]}
[0m20:51:21.005456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd5a8a0>]}
[0m20:51:21.025105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b5b470>]}
[0m20:51:21.025672 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:51:21.034059 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m20:51:21.117787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:21.118131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:21.140692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62572930>]}
[0m20:51:21.199491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff624650a0>]}
[0m20:51:21.199824 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m20:51:21.200223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff621e57c0>]}
[0m20:51:21.201275 [info ] [MainThread]: 
[0m20:51:21.201830 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:51:21.203955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:51:21.204292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m20:51:21.210791 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:51:21.212035 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m20:51:21.212307 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:51:21.212539 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m20:51:21.212788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:21.213022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:22.044483 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.831 seconds
[0m20:51:22.048275 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:51:22.082050 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.869 seconds
[0m20:51:22.085448 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m20:51:22.215367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m20:51:22.216586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_analytics)
[0m20:51:22.218286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m20:51:22.219054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m20:51:22.226508 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m20:51:22.228311 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m20:51:22.230025 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m20:51:22.232765 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m20:51:22.233453 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m20:51:22.233911 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m20:51:22.234308 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m20:51:22.234685 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m20:51:22.235055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:22.235449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:22.235821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:22.236189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:22.632119 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.396 seconds
[0m20:51:22.635933 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m20:51:22.704939 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.469 seconds
[0m20:51:22.706172 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m20:51:22.802765 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d43-0106-eb81-000f-c0df006f58ea
[0m20:51:22.803145 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:51:22.803537 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:51:22.803788 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:51:22.805168 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m20:51:22.920795 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.685 seconds
[0m20:51:22.921843 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m20:51:23.068191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6268f0e0>]}
[0m20:51:23.068751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:51:23.069267 [info ] [MainThread]: 
[0m20:51:23.074529 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m20:51:23.074917 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m20:51:23.075327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.stg_stock_daily)
[0m20:51:23.075549 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m20:51:23.079706 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m20:51:23.080748 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m20:51:23.096258 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:51:23.096648 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m20:51:23.096953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:23.490761 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.394 seconds
[0m20:51:23.502003 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m20:51:23.505248 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:51:23.505625 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m20:51:23.905557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m20:51:23.930689 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m20:51:23.931395 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m20:51:24.062539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m20:51:24.074014 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m20:51:24.229061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821f6ea0>]}
[0m20:51:24.229849 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.15s]
[0m20:51:24.230665 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m20:51:24.231575 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m20:51:24.231885 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m20:51:24.232263 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m20:51:24.232614 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m20:51:24.233041 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m20:51:24.233610 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m20:51:24.234144 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m20:51:24.234666 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m20:51:24.235265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_bollinger)
[0m20:51:24.235669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.int_daily_returns)
[0m20:51:24.236267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.int_macd)
[0m20:51:24.236679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m20:51:24.237063 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m20:51:24.237399 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m20:51:24.237737 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m20:51:24.238065 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m20:51:24.240166 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m20:51:24.242317 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m20:51:24.244972 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m20:51:24.246604 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m20:51:24.247998 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m20:51:24.248340 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m20:51:24.259131 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m20:51:24.259438 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m20:51:24.260886 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m20:51:24.261131 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m20:51:24.262546 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m20:51:24.263750 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:51:24.264896 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m20:51:24.265495 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m20:51:24.266329 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:51:24.267372 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:51:24.267673 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:51:24.268741 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:51:24.268989 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc
        );
[0m20:51:24.269335 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m20:51:24.270402 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    -- Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m20:51:24.270873 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:51:24.271230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:24.271557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:26.265620 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.994 seconds
[0m20:51:26.267756 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.000 seconds
[0m20:51:26.272927 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:51:26.273864 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.003 seconds
[0m20:51:26.276768 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:51:26.277401 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m20:51:26.279551 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:51:26.280043 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m20:51:26.281902 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns IS $$Daily returns and volatility metrics$$;
[0m20:51:26.412654 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m20:51:26.414471 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m20:51:26.435497 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:51:26.439784 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:51:26.440442 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m20:51:26.441036 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m20:51:26.448650 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m20:51:26.451106 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:51:26.451626 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
[0m20:51:26.530524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.258 seconds
[0m20:51:26.535562 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:51:26.539599 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m20:51:26.540940 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.099 seconds
[0m20:51:26.542037 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m20:51:26.542611 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages IS $$Moving averages for trend analysis$$;
[0m20:51:26.545840 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m20:51:26.548106 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m20:51:26.550720 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m20:51:26.552104 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m20:51:26.552608 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m20:51:26.553076 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "PREV_ADJ_CLOSE" COMMENT $$$$,
    
        "ADJ_DAILY_CHANGE" COMMENT $$$$,
    
        "ADJ_DAILY_RETURN_PCT" COMMENT $$$$,
    
        "LOG_RETURN" COMMENT $$$$,
    
        "VOLATILITY_20D" COMMENT $$20-day rolling volatility$$,
    
        "CUMULATIVE_RETURN_PCT" COMMENT $$$$;
[0m20:51:26.681516 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m20:51:26.683985 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m20:51:26.692620 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m20:51:26.694769 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m20:51:26.713168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m20:51:26.716290 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:51:26.716789 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
[0m20:51:26.773649 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m20:51:26.775906 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m20:51:26.813315 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fc9580>]}
[0m20:51:26.814607 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 2.58s]
[0m20:51:26.820176 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m20:51:26.820885 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_rsi
[0m20:51:26.821651 [info ] [Thread-2 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m20:51:26.822381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_macd, now model.stock_analytics.int_rsi)
[0m20:51:26.822853 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_rsi
[0m20:51:26.827046 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m20:51:26.828227 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_rsi
[0m20:51:26.830392 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m20:51:26.832566 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:51:26.833045 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m20:51:26.833480 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:51:26.853253 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.136 seconds
[0m20:51:26.855472 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m20:51:26.855861 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "PRICE_VS_MA20_PCT" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$Golden cross or death cross signal$$;
[0m20:51:26.875668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d54200>]}
[0m20:51:26.876254 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 2.64s]
[0m20:51:26.877172 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m20:51:26.893419 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60338260>]}
[0m20:51:26.893964 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_daily_returns .. [[32mSUCCESS 1[0m in 2.66s]
[0m20:51:26.894674 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m20:51:26.983772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m20:51:26.986080 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m20:51:27.106857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603d35f0>]}
[0m20:51:27.108694 [info ] [Thread-1 (]: 5 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[32mSUCCESS 1[0m in 2.87s]
[0m20:51:27.110698 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m20:51:28.111458 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.278 seconds
[0m20:51:28.115819 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:51:28.116863 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m20:51:28.221505 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m20:51:28.228960 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:51:28.230171 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m20:51:28.326064 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.095 seconds
[0m20:51:28.331440 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m20:51:28.332447 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m20:51:28.484817 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m20:51:28.497178 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: Close
[0m20:51:28.802853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60dad8b0>]}
[0m20:51:28.803762 [info ] [Thread-2 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 1.98s]
[0m20:51:28.804662 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_rsi
[0m20:51:28.805718 [debug] [Thread-3 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m20:51:28.806356 [info ] [Thread-3 (]: 7 of 7 START sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [RUN]
[0m20:51:28.806947 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_bollinger, now model.stock_analytics.mart_stock_daily_metrics)
[0m20:51:28.807355 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.mart_stock_daily_metrics
[0m20:51:28.810618 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_daily_metrics"
[0m20:51:28.811852 [debug] [Thread-3 (]: Began executing node model.stock_analytics.mart_stock_daily_metrics
[0m20:51:28.813636 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_daily_metrics"
[0m20:51:28.816207 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m20:51:28.816682 [debug] [Thread-3 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
         as
        (

WITH base AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
),

ma AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
),

rsi AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_rsi
),

bollinger AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
),

macd AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_macd
)

SELECT 
    -- Basic information
    base.SYMBOL,
    base."DATE",
    base."CLOSE",
    base."OPEN",
    base."MAX",
    base."MIN",
    base.VOLUME,
    
    -- Daily changes
    base.DAILY_CHANGE,
    base.DAILY_CHANGE_PCT,
    base.INTRADAY_RANGE,
    base.INTRADAY_RANGE_PCT,
    
    -- Moving Averages
    ma.MA_5,
    ma.MA_10,
    ma.MA_20,
    ma.MA_50,
    ma.MA_100,
    ma.EMA_12,
    ma.EMA_26,
    ma.AVG_VOLUME_20,
    
    -- MA Cross Signals (Golden Cross / Death Cross)
    CASE 
        -- Golden Cross: MA5 crosses above MA20
        WHEN ma.MA_5 > ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") 
        THEN 'GOLDEN_CROSS_5_20'
        
        -- Death Cross: MA5 crosses below MA20
        WHEN ma.MA_5 < ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_5_20'
        
        -- Golden Cross: MA20 crosses above MA50
        WHEN ma.MA_20 > ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'GOLDEN_CROSS_20_50'
        
        -- Death Cross: MA20 crosses below MA50
        WHEN ma.MA_20 < ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_20_50'
        
        ELSE 'NO_CROSS'
    END as MA_CROSS_SIGNAL,
    
    -- Price vs MA trend analysis
    CASE 
        WHEN base."CLOSE" > ma.MA_5 AND base."CLOSE" > ma.MA_20 AND base."CLOSE" > ma.MA_50 THEN 'STRONG_UPTREND'
        WHEN base."CLOSE" < ma.MA_5 AND base."CLOSE" < ma.MA_20 AND base."CLOSE" < ma.MA_50 THEN 'STRONG_DOWNTREND'
        WHEN base."CLOSE" > ma.MA_20 THEN 'UPTREND'
        WHEN base."CLOSE" < ma.MA_20 THEN 'DOWNTREND'
        ELSE 'SIDEWAYS'
    END as PRICE_TREND,
    
    -- RSI indicators
    rsi.RSI_14,
    rsi.RSI_SIGNAL,
    
    -- Bollinger Bands
    bollinger.UPPER_BAND,
    bollinger.LOWER_BAND,
    bollinger.MA_20 as BB_MIDDLE,
    bollinger.BAND_WIDTH_PCT,
    bollinger.BAND_POSITION,
    bollinger.PERCENT_B,
    
    -- MACD indicators
    macd.MACD_LINE,
    macd.SIGNAL_LINE,
    macd.MACD_HISTOGRAM,
    macd.MACD_SIGNAL,
    
    -- Volume Analysis
    CASE 
        WHEN base.VOLUME > 1.5 * ma.AVG_VOLUME_20 THEN 'HIGH_VOLUME'
        WHEN base.VOLUME < 0.5 * ma.AVG_VOLUME_20 THEN 'LOW_VOLUME'
        ELSE 'NORMAL_VOLUME'
    END as VOLUME_SIGNAL,
    
    ROUND(base.VOLUME / NULLIF(ma.AVG_VOLUME_20, 0), 2) as VOLUME_RATIO,
    
    -- Volatility (using intraday range as proxy)
    CASE 
        WHEN base.INTRADAY_RANGE_PCT > 5 THEN 'HIGH_VOLATILITY'
        WHEN base.INTRADAY_RANGE_PCT < 1 THEN 'LOW_VOLATILITY'
        ELSE 'NORMAL_VOLATILITY'
    END as VOLATILITY_SIGNAL

FROM base
LEFT JOIN ma 
    ON base.SYMBOL = ma.SYMBOL AND base."DATE" = ma."DATE"
LEFT JOIN rsi 
    ON base.SYMBOL = rsi.SYMBOL AND base."DATE" = rsi."DATE"
LEFT JOIN bollinger 
    ON base.SYMBOL = bollinger.SYMBOL AND base."DATE" = bollinger."DATE"
LEFT JOIN macd 
    ON base.SYMBOL = macd.SYMBOL AND base."DATE" = macd."DATE"
        );
[0m20:51:28.817166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:51:29.348382 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c03d43-0106-eb87-000f-c0df0070d092
[0m20:51:29.349062 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 43 at position 4
invalid identifier 'MA.MA_10'
[0m20:51:29.349627 [debug] [Thread-3 (]: On model.stock_analytics.mart_stock_daily_metrics: Close
[0m20:51:29.505684 [debug] [Thread-3 (]: Database Error in model mart_stock_daily_metrics (models/marts/mart_stock_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 43 at position 4
  invalid identifier 'MA.MA_10'
  compiled code at target/run/stock_analytics/models/marts/mart_stock_daily_metrics.sql
[0m20:51:29.507140 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21945b0f-fde8-4122-9349-8480acdcf284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603fbcb0>]}
[0m20:51:29.508332 [error] [Thread-3 (]: 7 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [[31mERROR[0m in 0.70s]
[0m20:51:29.509714 [debug] [Thread-3 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m20:51:29.512925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:29.513479 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_daily_metrics' was properly closed.
[0m20:51:29.514023 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m20:51:29.514531 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m20:51:29.514943 [debug] [MainThread]: Connection 'model.stock_analytics.int_moving_averages' was properly closed.
[0m20:51:29.515448 [info ] [MainThread]: 
[0m20:51:29.516186 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m20:51:29.517698 [debug] [MainThread]: Command end result
[0m20:51:29.594394 [info ] [MainThread]: 
[0m20:51:29.595021 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:51:29.595313 [info ] [MainThread]: 
[0m20:51:29.595624 [error] [MainThread]:   Database Error in model mart_stock_daily_metrics (models/marts/mart_stock_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 43 at position 4
  invalid identifier 'MA.MA_10'
  compiled code at target/run/stock_analytics/models/marts/mart_stock_daily_metrics.sql
[0m20:51:29.595936 [info ] [MainThread]: 
[0m20:51:29.596247 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:51:29.596971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.009779, "process_user_time": 2.697538, "process_kernel_time": 0.200262, "process_mem_max_rss": "232856", "process_out_blocks": "3090", "command_success": false, "process_in_blocks": "0"}
[0m20:51:29.597352 [debug] [MainThread]: Command `dbt run` failed at 20:51:29.597304 after 9.01 seconds
[0m20:51:29.597642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e586b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8303a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839e4650>]}
[0m20:51:29.598150 [debug] [MainThread]: Flushing usage events
[0m21:05:32.221213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875cd220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86db0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880cf800>]}


============================== 21:05:32.225253 | e7a615db-542d-4816-9693-c5b5886aad79 ==============================
[0m21:05:32.225253 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:05:32.226066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:05:32.230170 [info ] [MainThread]: dbt version: 1.8.8
[0m21:05:32.230505 [info ] [MainThread]: python version: 3.12.4
[0m21:05:32.230732 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m21:05:32.231016 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m21:05:32.591178 [info ] [MainThread]: Using profiles dir at .
[0m21:05:32.591754 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m21:05:32.592114 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m21:05:32.592491 [info ] [MainThread]: adapter type: snowflake
[0m21:05:32.592797 [info ] [MainThread]: adapter version: 1.8.4
[0m21:05:32.614780 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:05:32.615203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7a615db-542d-4816-9693-c5b5886aad79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69ae16a0>]}
[0m21:05:32.629269 [info ] [MainThread]: Configuration:
[0m21:05:32.629573 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:05:32.629868 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:05:32.630203 [info ] [MainThread]: Required dependencies:
[0m21:05:32.630531 [debug] [MainThread]: Executing "git --help"
[0m21:05:32.632457 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:05:32.632733 [debug] [MainThread]: STDERR: "b''"
[0m21:05:32.632975 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:05:32.633261 [info ] [MainThread]: Connection:
[0m21:05:32.633594 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m21:05:32.633902 [info ] [MainThread]:   user: MALLARD
[0m21:05:32.634168 [info ] [MainThread]:   database: ASH_DB
[0m21:05:32.634440 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m21:05:32.634708 [info ] [MainThread]:   role: TRAINING_ROLE
[0m21:05:32.635031 [info ] [MainThread]:   schema: STOCK_RAW
[0m21:05:32.635278 [info ] [MainThread]:   authenticator: None
[0m21:05:32.635534 [info ] [MainThread]:   oauth_client_id: None
[0m21:05:32.635783 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m21:05:32.636070 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:05:32.636327 [info ] [MainThread]:   host: None
[0m21:05:32.636583 [info ] [MainThread]:   port: None
[0m21:05:32.636882 [info ] [MainThread]:   proxy_host: None
[0m21:05:32.637171 [info ] [MainThread]:   proxy_port: None
[0m21:05:32.637405 [info ] [MainThread]:   protocol: None
[0m21:05:32.637622 [info ] [MainThread]:   connect_retries: 1
[0m21:05:32.637918 [info ] [MainThread]:   connect_timeout: None
[0m21:05:32.638149 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:05:32.638362 [info ] [MainThread]:   retry_all: False
[0m21:05:32.638635 [info ] [MainThread]:   insecure_mode: False
[0m21:05:32.638910 [info ] [MainThread]:   reuse_connections: None
[0m21:05:32.639216 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:05:32.640914 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:05:32.641333 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:05:32.641579 [debug] [MainThread]: On debug: select 1 as id
[0m21:05:32.641834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:33.166886 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.525 seconds
[0m21:05:33.169133 [debug] [MainThread]: On debug: Close
[0m21:05:33.338280 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:05:33.340253 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:05:33.343343 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1601973, "process_user_time": 1.927413, "process_kernel_time": 0.210701, "process_mem_max_rss": "236792", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m21:05:33.344691 [debug] [MainThread]: Command `dbt debug` succeeded at 21:05:33.344508 after 1.16 seconds
[0m21:05:33.345516 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:05:33.346392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869f6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880cf800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b206b0>]}
[0m21:05:33.347233 [debug] [MainThread]: Flushing usage events
[0m21:05:36.430585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986e4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aed4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9823f590>]}


============================== 21:05:36.433976 | 3f351592-e13a-4d11-8ded-8db136553c90 ==============================
[0m21:05:36.433976 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:05:36.434536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:05:36.456699 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:05:36.457107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3f351592-e13a-4d11-8ded-8db136553c90', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9866e810>]}
[0m21:05:36.487549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f351592-e13a-4d11-8ded-8db136553c90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986e5280>]}
[0m21:05:36.530453 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hax8c3pc'
[0m21:05:36.530859 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:05:36.863784 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:05:36.867103 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:05:37.086508 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:05:37.095092 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:05:37.778524 [info ] [MainThread]: Installed from version 1.1.1
[0m21:05:37.779199 [info ] [MainThread]: Updated version available: 1.3.2
[0m21:05:37.779649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3f351592-e13a-4d11-8ded-8db136553c90', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ee2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ee3710>]}
[0m21:05:37.780009 [info ] [MainThread]: 
[0m21:05:37.780314 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:05:37.781067 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3893138, "process_user_time": 1.013528, "process_kernel_time": 0.104157, "process_mem_max_rss": "236796", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m21:05:37.781430 [debug] [MainThread]: Command `dbt deps` succeeded at 21:05:37.781375 after 1.39 seconds
[0m21:05:37.781697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986e4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98056cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b9ac30>]}
[0m21:05:37.781951 [debug] [MainThread]: Flushing usage events
[0m21:05:41.067773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0e98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf70c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0eab40>]}


============================== 21:05:41.071425 | bdeb793f-6da2-43d2-a2d5-f944e7be2d98 ==============================
[0m21:05:41.071425 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:05:41.072086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:05:41.441059 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:05:41.441591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdeb793f-6da2-43d2-a2d5-f944e7be2d98', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee08e00>]}
[0m21:05:41.469467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdeb793f-6da2-43d2-a2d5-f944e7be2d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991728a0>]}
[0m21:05:41.489333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdeb793f-6da2-43d2-a2d5-f944e7be2d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae25b440>]}
[0m21:05:41.489813 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:05:41.497769 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:05:41.582976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:05:41.583481 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/marts/mart_stock_daily_metrics.sql
[0m21:05:41.798005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdeb793f-6da2-43d2-a2d5-f944e7be2d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3ec1a0>]}
[0m21:05:41.866734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdeb793f-6da2-43d2-a2d5-f944e7be2d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2caa20>]}
[0m21:05:41.867170 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:05:41.867935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdeb793f-6da2-43d2-a2d5-f944e7be2d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7f5ac0>]}
[0m21:05:41.869167 [info ] [MainThread]: 
[0m21:05:41.869716 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:05:41.870396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:05:41.878215 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:05:41.878590 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:05:41.878850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:42.321192 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.442 seconds
[0m21:05:42.326868 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:05:42.601193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m21:05:42.602299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m21:05:42.603126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m21:05:42.604713 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m21:05:42.612627 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:05:42.614487 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:05:42.617114 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:05:42.618659 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:05:42.619087 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:05:42.619514 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:05:42.619929 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:05:42.620300 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:05:42.620663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:42.621025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:42.621434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:42.621787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:43.015563 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d51-0106-ec7d-000f-c0df0070c0ee
[0m21:05:43.016203 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:05:43.016815 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:05:43.017259 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:05:43.017764 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:05:43.058567 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.438 seconds
[0m21:05:43.060354 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:05:43.098624 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.477 seconds
[0m21:05:43.101869 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:05:43.132956 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.511 seconds
[0m21:05:43.135392 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:05:43.273772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdeb793f-6da2-43d2-a2d5-f944e7be2d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db8f950>]}
[0m21:05:43.275728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:05:43.277807 [info ] [MainThread]: 
[0m21:05:43.292206 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m21:05:43.293177 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m21:05:43.294365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now snapshot.stock_analytics.stock_price_snapshot)
[0m21:05:43.294888 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m21:05:43.310774 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m21:05:43.341293 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:43.341684 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m21:05:43.342018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:44.120033 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.777 seconds
[0m21:05:44.133516 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:44.134281 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:05:44.265466 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.131 seconds
[0m21:05:44.279875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:44.280461 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:05:44.387731 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.107 seconds
[0m21:05:44.479056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:44.479799 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace temporary table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:05:46.475294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.994 seconds
[0m21:05:46.480974 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:46.481502 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:05:46.584284 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.102 seconds
[0m21:05:46.587653 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:46.588265 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:05:46.674915 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.086 seconds
[0m21:05:46.677097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:46.677392 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:05:46.788250 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.111 seconds
[0m21:05:46.790293 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:46.790589 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:05:46.891361 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.100 seconds
[0m21:05:46.895657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:46.895989 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:05:47.001981 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.106 seconds
[0m21:05:47.012245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:47.012768 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:05:47.573323 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.560 seconds
[0m21:05:47.581045 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:47.581734 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:05:47.658651 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m21:05:47.660430 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:47.667245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:47.668283 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
BEGIN
[0m21:05:47.902045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m21:05:47.902593 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:47.902958 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
merge into "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:05:48.973145 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 1.070 seconds
[0m21:05:48.974497 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:05:48.975344 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
COMMIT
[0m21:05:49.474447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m21:05:49.491117 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m21:05:49.652145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdeb793f-6da2-43d2-a2d5-f944e7be2d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7bdc10>]}
[0m21:05:49.653558 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 8[0m in 6.36s]
[0m21:05:49.658170 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m21:05:49.662182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:49.662523 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_raw' was properly closed.
[0m21:05:49.662766 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_analytics' was properly closed.
[0m21:05:49.663024 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m21:05:49.663267 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m21:05:49.663750 [info ] [MainThread]: 
[0m21:05:49.664192 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m21:05:49.665131 [debug] [MainThread]: Command end result
[0m21:05:49.695123 [info ] [MainThread]: 
[0m21:05:49.695894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:49.696240 [info ] [MainThread]: 
[0m21:05:49.696568 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:05:49.698705 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.667322, "process_user_time": 2.655459, "process_kernel_time": 0.252081, "process_mem_max_rss": "236800", "process_out_blocks": "4237", "process_in_blocks": "0"}
[0m21:05:49.699275 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:05:49.699207 after 8.67 seconds
[0m21:05:49.699720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff64410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2d5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e376480>]}
[0m21:05:49.700002 [debug] [MainThread]: Flushing usage events
[0m21:05:54.349374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ebe180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ebecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812b9e50>]}


============================== 21:05:54.353044 | 8bfe0ac1-1ac1-4774-86a3-e7161beed131 ==============================
[0m21:05:54.353044 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:05:54.353768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:05:54.768265 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:05:54.769121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71f465d0>]}
[0m21:05:54.808032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806d0170>]}
[0m21:05:54.834635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64a437d0>]}
[0m21:05:54.835345 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:05:54.844645 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:05:54.933581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:54.933973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:54.965849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff649c6180>]}
[0m21:05:55.028591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64863da0>]}
[0m21:05:55.028989 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:05:55.029484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64965820>]}
[0m21:05:55.030738 [info ] [MainThread]: 
[0m21:05:55.031528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:05:55.033974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:05:55.034332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:05:55.041398 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:05:55.042931 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:05:55.043204 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:05:55.043472 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:05:55.043733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:55.043997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:55.617980 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.574 seconds
[0m21:05:55.618436 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.574 seconds
[0m21:05:55.619438 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:05:55.620322 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:05:55.854574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m21:05:55.855280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m21:05:55.859846 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:05:55.860284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m21:05:55.860716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m21:05:55.861948 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:05:55.862244 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:05:55.863398 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:05:55.865106 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:05:55.865412 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:05:55.865639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:55.865870 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:05:55.866112 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:05:55.866371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:55.867660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:55.868063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:56.249462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.384 seconds
[0m21:05:56.250526 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:05:56.272967 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.407 seconds
[0m21:05:56.273777 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:05:56.336852 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d51-0106-eb7f-000f-c0df0070a2d6
[0m21:05:56.337215 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:05:56.337524 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:05:56.337827 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:05:56.338253 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:05:56.388492 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.520 seconds
[0m21:05:56.389491 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:05:56.538993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6453d070>]}
[0m21:05:56.539434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:05:56.539971 [info ] [MainThread]: 
[0m21:05:56.546520 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m21:05:56.546968 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m21:05:56.547354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.stg_stock_daily)
[0m21:05:56.547625 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m21:05:56.551802 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m21:05:56.553339 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m21:05:56.568694 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:05:56.569086 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m21:05:56.569355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:56.980846 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.411 seconds
[0m21:05:56.984962 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m21:05:56.986386 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:05:56.986752 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m21:05:57.419535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m21:05:57.432397 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:05:57.432860 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m21:05:57.562321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m21:05:57.566669 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m21:05:57.684770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64caac00>]}
[0m21:05:57.685670 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.14s]
[0m21:05:57.687286 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m21:05:57.688514 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m21:05:57.688863 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m21:05:57.689144 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m21:05:57.689440 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m21:05:57.689890 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m21:05:57.690757 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m21:05:57.691254 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m21:05:57.691793 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m21:05:57.692590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_bollinger)
[0m21:05:57.693357 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.int_daily_returns)
[0m21:05:57.694386 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_macd)
[0m21:05:57.695084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m21:05:57.695601 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m21:05:57.696223 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m21:05:57.697420 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m21:05:57.699261 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m21:05:57.702201 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m21:05:57.706093 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m21:05:57.708551 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m21:05:57.711388 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m21:05:57.714454 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m21:05:57.720885 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m21:05:57.721322 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m21:05:57.728517 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m21:05:57.729088 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m21:05:57.731970 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m21:05:57.734381 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m21:05:57.737431 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m21:05:57.739433 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:05:57.741700 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:05:57.742999 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc
        );
[0m21:05:57.744304 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:05:57.744664 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m21:05:57.746091 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:05:57.746542 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:05:57.747015 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m21:05:57.747501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:05:57.748026 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    -- Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m21:05:57.751172 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:05:57.754159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:59.046585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m21:05:59.051158 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:05:59.051651 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages IS $$Moving averages for trend analysis$$;
[0m21:05:59.206658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m21:05:59.228851 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:05:59.229917 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
[0m21:05:59.263023 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.515 seconds
[0m21:05:59.265635 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:05:59.266910 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.516 seconds
[0m21:05:59.267413 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m21:05:59.271135 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:05:59.272774 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m21:05:59.292713 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.546 seconds
[0m21:05:59.294653 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:05:59.295121 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns IS $$Daily returns and volatility metrics$$;
[0m21:05:59.312352 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.082 seconds
[0m21:05:59.315442 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:05:59.315939 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "PRICE_VS_MA20_PCT" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$Golden cross or death cross signal$$;
[0m21:05:59.372001 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:05:59.375846 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:05:59.376763 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m21:05:59.377501 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m21:05:59.381277 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:05:59.381882 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m21:05:59.402587 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m21:05:59.407812 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:05:59.408583 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
[0m21:05:59.462483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m21:05:59.464551 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m21:05:59.467234 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.089 seconds
[0m21:05:59.468493 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.086 seconds
[0m21:05:59.470287 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:05:59.472142 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:05:59.472535 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m21:05:59.472920 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m21:05:59.551222 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.142 seconds
[0m21:05:59.553935 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:05:59.554419 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "PREV_ADJ_CLOSE" COMMENT $$$$,
    
        "ADJ_DAILY_CHANGE" COMMENT $$$$,
    
        "ADJ_DAILY_RETURN_PCT" COMMENT $$$$,
    
        "LOG_RETURN" COMMENT $$$$,
    
        "VOLATILITY_20D" COMMENT $$20-day rolling volatility$$,
    
        "CUMULATIVE_RETURN_PCT" COMMENT $$$$;
[0m21:05:59.613374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64213b00>]}
[0m21:05:59.615424 [info ] [Thread-1 (]: 5 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[32mSUCCESS 1[0m in 1.92s]
[0m21:05:59.618327 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m21:05:59.619345 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_rsi
[0m21:05:59.620408 [info ] [Thread-1 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m21:05:59.621471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.int_rsi)
[0m21:05:59.622118 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_rsi
[0m21:05:59.626559 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m21:05:59.629050 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_rsi
[0m21:05:59.631851 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m21:05:59.633963 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:05:59.634466 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m21:05:59.634924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:59.643271 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m21:05:59.645647 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m21:05:59.647965 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m21:05:59.649534 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m21:05:59.721076 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.166 seconds
[0m21:05:59.722838 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m21:05:59.787007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643d2d80>]}
[0m21:05:59.787889 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64224140>]}
[0m21:05:59.788715 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 2.09s]
[0m21:05:59.789686 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 2.10s]
[0m21:05:59.790323 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m21:05:59.790869 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m21:05:59.840749 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643a2a50>]}
[0m21:05:59.841542 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_daily_returns .. [[32mSUCCESS 1[0m in 2.15s]
[0m21:05:59.842669 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m21:06:01.556394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.921 seconds
[0m21:06:01.560631 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:06:01.561295 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m21:06:01.701256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m21:06:01.710541 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:06:01.711822 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m21:06:01.820036 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.107 seconds
[0m21:06:01.825319 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:06:01.826348 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m21:06:02.171810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m21:06:02.177442 [debug] [Thread-1 (]: On model.stock_analytics.int_rsi: Close
[0m21:06:02.361944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff642a54f0>]}
[0m21:06:02.363913 [info ] [Thread-1 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 2.74s]
[0m21:06:02.366600 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_rsi
[0m21:06:02.369531 [debug] [Thread-2 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m21:06:02.370996 [info ] [Thread-2 (]: 7 of 7 START sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [RUN]
[0m21:06:02.373601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_macd, now model.stock_analytics.mart_stock_daily_metrics)
[0m21:06:02.374545 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.mart_stock_daily_metrics
[0m21:06:02.382267 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_daily_metrics"
[0m21:06:02.384421 [debug] [Thread-2 (]: Began executing node model.stock_analytics.mart_stock_daily_metrics
[0m21:06:02.386899 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_daily_metrics"
[0m21:06:02.389908 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:06:02.390472 [debug] [Thread-2 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
         as
        (

WITH base AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

ma AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
),

rsi AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_rsi
),

bollinger AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
),

macd AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_macd
)

SELECT 
    -- Basic information
    base.SYMBOL,
    base."DATE",
    base."CLOSE",
    base."OPEN",
    base."MAX",
    base."MIN",
    base.VOLUME,
    
    -- Daily changes
    base.DAILY_CHANGE,
    base.DAILY_CHANGE_PCT,
    base.INTRADAY_RANGE,
    base.INTRADAY_RANGE_PCT,
    
    -- Moving Averages
    ma.MA_5,
    ma.MA_20,
    ma.MA_50,
    ma.EMA_12,
    ma.EMA_26,
    
    -- MA Cross Signals (Golden Cross / Death Cross)
    CASE 
        -- Golden Cross: MA5 crosses above MA20
        WHEN ma.MA_5 > ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") 
        THEN 'GOLDEN_CROSS_5_20'
        
        -- Death Cross: MA5 crosses below MA20
        WHEN ma.MA_5 < ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_5_20'
        
        -- Golden Cross: MA20 crosses above MA50
        WHEN ma.MA_20 > ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'GOLDEN_CROSS_20_50'
        
        -- Death Cross: MA20 crosses below MA50
        WHEN ma.MA_20 < ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_20_50'
        
        ELSE 'NO_CROSS'
    END as MA_CROSS_SIGNAL,
    
    -- Price vs MA trend analysis
    CASE 
        WHEN base."CLOSE" > ma.MA_5 AND base."CLOSE" > ma.MA_20 AND base."CLOSE" > ma.MA_50 THEN 'STRONG_UPTREND'
        WHEN base."CLOSE" < ma.MA_5 AND base."CLOSE" < ma.MA_20 AND base."CLOSE" < ma.MA_50 THEN 'STRONG_DOWNTREND'
        WHEN base."CLOSE" > ma.MA_20 THEN 'UPTREND'
        WHEN base."CLOSE" < ma.MA_20 THEN 'DOWNTREND'
        ELSE 'SIDEWAYS'
    END as PRICE_TREND,
    
    -- RSI indicators
    rsi.RSI_14,
    rsi.RSI_SIGNAL,
    
    -- Bollinger Bands
    bollinger.UPPER_BAND,
    bollinger.LOWER_BAND,
    bollinger.MA_20 as BB_MIDDLE,
    bollinger.BAND_WIDTH_PCT,
    bollinger.BAND_POSITION,
    bollinger.PERCENT_B,
    
    -- MACD indicators
    macd.MACD_LINE,
    macd.SIGNAL_LINE,
    macd.MACD_HISTOGRAM,
    macd.MACD_SIGNAL,
    
    -- Volatility (using intraday range as proxy)
    CASE 
        WHEN base.INTRADAY_RANGE_PCT > 5 THEN 'HIGH_VOLATILITY'
        WHEN base.INTRADAY_RANGE_PCT < 1 THEN 'LOW_VOLATILITY'
        ELSE 'NORMAL_VOLATILITY'
    END as VOLATILITY_SIGNAL

FROM base
LEFT JOIN ma 
    ON base.SYMBOL = ma.SYMBOL AND base."DATE" = ma."DATE"
LEFT JOIN rsi 
    ON base.SYMBOL = rsi.SYMBOL AND base."DATE" = rsi."DATE"
LEFT JOIN bollinger 
    ON base.SYMBOL = bollinger.SYMBOL AND base."DATE" = bollinger."DATE"
LEFT JOIN macd 
    ON base.SYMBOL = macd.SYMBOL AND base."DATE" = macd."DATE"
        );
[0m21:06:02.391027 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:02.993293 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c03d52-0106-eb87-000f-c0df0070d116
[0m21:06:02.994824 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 88 at position 4
invalid identifier 'BOLLINGER.UPPER_BAND'
[0m21:06:02.996231 [debug] [Thread-2 (]: On model.stock_analytics.mart_stock_daily_metrics: Close
[0m21:06:03.156042 [debug] [Thread-2 (]: Database Error in model mart_stock_daily_metrics (models/marts/mart_stock_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 88 at position 4
  invalid identifier 'BOLLINGER.UPPER_BAND'
  compiled code at target/run/stock_analytics/models/marts/mart_stock_daily_metrics.sql
[0m21:06:03.157433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfe0ac1-1ac1-4774-86a3-e7161beed131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643a3440>]}
[0m21:06:03.158314 [error] [Thread-2 (]: 7 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [[31mERROR[0m in 0.78s]
[0m21:06:03.159289 [debug] [Thread-2 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m21:06:03.161433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:03.161750 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m21:06:03.161971 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m21:06:03.162198 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m21:06:03.162413 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_daily_metrics' was properly closed.
[0m21:06:03.162762 [info ] [MainThread]: 
[0m21:06:03.163164 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m21:06:03.163973 [debug] [MainThread]: Command end result
[0m21:06:03.283251 [info ] [MainThread]: 
[0m21:06:03.283964 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:06:03.284307 [info ] [MainThread]: 
[0m21:06:03.284659 [error] [MainThread]:   Database Error in model mart_stock_daily_metrics (models/marts/mart_stock_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 88 at position 4
  invalid identifier 'BOLLINGER.UPPER_BAND'
  compiled code at target/run/stock_analytics/models/marts/mart_stock_daily_metrics.sql
[0m21:06:03.284905 [info ] [MainThread]: 
[0m21:06:03.285170 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:06:03.286079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.973715, "process_user_time": 2.734213, "process_kernel_time": 0.282642, "process_mem_max_rss": "236796", "process_out_blocks": "3084", "command_success": false, "process_in_blocks": "0"}
[0m21:06:03.286430 [debug] [MainThread]: Command `dbt run` failed at 21:06:03.286388 after 8.97 seconds
[0m21:06:03.286735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643ca780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643c8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643ca5a0>]}
[0m21:06:03.287026 [debug] [MainThread]: Flushing usage events
[0m21:11:06.727699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ddcf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ddc7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d8aa80>]}


============================== 21:11:06.732027 | e83f1d8f-e52a-4cc5-a615-4922204b71ce ==============================
[0m21:11:06.732027 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:11:06.732650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:07.119457 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:11:07.120262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9419b4a0>]}
[0m21:11:07.149514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7856b2f0>]}
[0m21:11:07.170515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78760230>]}
[0m21:11:07.171153 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:11:07.180291 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:11:07.269255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:11:07.269648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:11:07.292968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff784b21b0>]}
[0m21:11:07.357990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783d9c70>]}
[0m21:11:07.358464 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:11:07.359175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d19c70>]}
[0m21:11:07.360415 [info ] [MainThread]: 
[0m21:11:07.360918 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:11:07.363203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:11:07.363585 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:11:07.370968 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:11:07.372440 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:11:07.372692 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:11:07.372920 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:11:07.373154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:07.373394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:08.287593 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.914 seconds
[0m21:11:08.291382 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:11:08.305607 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.932 seconds
[0m21:11:08.307458 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:11:08.464245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m21:11:08.466618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m21:11:08.469411 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m21:11:08.479356 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:11:08.480266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m21:11:08.482246 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:11:08.484248 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:11:08.484726 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:11:08.487878 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:11:08.488306 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:11:08.488747 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:11:08.489197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:08.489640 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:11:08.490087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:08.490482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:08.492084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:08.941130 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.449 seconds
[0m21:11:08.943478 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:11:08.989831 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.499 seconds
[0m21:11:08.993226 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:11:09.046250 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d57-0106-ec6f-000f-c0df007077f6
[0m21:11:09.047074 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:11:09.047742 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:11:09.048202 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:11:09.048717 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:11:09.060356 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.570 seconds
[0m21:11:09.062181 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:11:09.647670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff784da1e0>]}
[0m21:11:09.649368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:11:09.651856 [info ] [MainThread]: 
[0m21:11:09.662857 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m21:11:09.663639 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m21:11:09.664454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.stg_stock_daily)
[0m21:11:09.664954 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m21:11:09.672453 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m21:11:09.675081 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m21:11:09.701897 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:11:09.702371 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m21:11:09.702709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:10.094390 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.391 seconds
[0m21:11:10.106389 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m21:11:10.111308 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:11:10.112028 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m21:11:10.601909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m21:11:10.628735 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:11:10.629555 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m21:11:10.760635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m21:11:10.766816 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m21:11:11.097402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff787c2c60>]}
[0m21:11:11.099475 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.43s]
[0m21:11:11.102113 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m21:11:11.105677 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m21:11:11.106375 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m21:11:11.107126 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m21:11:11.107893 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m21:11:11.108751 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m21:11:11.110049 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m21:11:11.111079 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m21:11:11.111981 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m21:11:11.112906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.int_bollinger)
[0m21:11:11.113612 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_daily_returns)
[0m21:11:11.114555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_macd)
[0m21:11:11.115211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m21:11:11.115884 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m21:11:11.116454 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m21:11:11.116963 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m21:11:11.117451 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m21:11:11.121149 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m21:11:11.125343 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m21:11:11.127680 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m21:11:11.129857 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m21:11:11.133333 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m21:11:11.133776 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m21:11:11.146537 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m21:11:11.146856 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m21:11:11.148318 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m21:11:11.148854 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m21:11:11.150551 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m21:11:11.152092 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:11:11.153413 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m21:11:11.154536 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:11:11.154835 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m21:11:11.155966 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:11:11.156300 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc
        );
[0m21:11:11.156676 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:11:11.157758 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:11:11.158080 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m21:11:11.158375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:11:11.159409 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    -- Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m21:11:11.159934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:11:11.161342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:13.124165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.962 seconds
[0m21:11:13.126606 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.970 seconds
[0m21:11:13.131498 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:11:13.135253 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:11:13.136313 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages IS $$Moving averages for trend analysis$$;
[0m21:11:13.137262 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m21:11:13.203790 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.045 seconds
[0m21:11:13.208429 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:11:13.209626 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns IS $$Daily returns and volatility metrics$$;
[0m21:11:13.247789 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m21:11:13.270563 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:11:13.271438 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m21:11:13.304857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m21:11:13.306292 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.146 seconds
[0m21:11:13.309904 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:11:13.311878 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:11:13.312487 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
[0m21:11:13.313085 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m21:11:13.332057 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m21:11:13.334780 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:11:13.335307 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
[0m21:11:13.350341 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.078 seconds
[0m21:11:13.353068 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:11:13.353543 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m21:11:13.428794 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.115 seconds
[0m21:11:13.433121 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:11:13.434401 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.099 seconds
[0m21:11:13.435215 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "PRICE_VS_MA20_PCT" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$Golden cross or death cross signal$$;
[0m21:11:13.438013 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:11:13.440021 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "PREV_ADJ_CLOSE" COMMENT $$$$,
    
        "ADJ_DAILY_CHANGE" COMMENT $$$$,
    
        "ADJ_DAILY_RETURN_PCT" COMMENT $$$$,
    
        "LOG_RETURN" COMMENT $$$$,
    
        "VOLATILITY_20D" COMMENT $$20-day rolling volatility$$,
    
        "CUMULATIVE_RETURN_PCT" COMMENT $$$$;
[0m21:11:13.470025 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m21:11:13.473886 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:11:13.474596 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m21:11:13.543587 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m21:11:13.547405 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m21:11:13.586258 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m21:11:13.590276 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m21:11:13.603297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m21:11:13.607957 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m21:11:13.610065 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.135 seconds
[0m21:11:13.614433 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:11:13.615077 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m21:11:13.692649 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b3f290>]}
[0m21:11:13.694285 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 2.58s]
[0m21:11:13.695518 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m21:11:13.696321 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b3de50>]}
[0m21:11:13.696935 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_rsi
[0m21:11:13.697759 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_daily_returns .. [[32mSUCCESS 1[0m in 2.58s]
[0m21:11:13.698582 [info ] [Thread-3 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m21:11:13.699473 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m21:11:13.700024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_bollinger, now model.stock_analytics.int_rsi)
[0m21:11:13.700869 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_rsi
[0m21:11:13.704559 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m21:11:13.705709 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_rsi
[0m21:11:13.707907 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m21:11:13.710302 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:11:13.712796 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m21:11:13.713397 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:11:13.740149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f18950>]}
[0m21:11:13.741044 [info ] [Thread-1 (]: 5 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[32mSUCCESS 1[0m in 2.62s]
[0m21:11:13.742347 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m21:11:13.899415 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.284 seconds
[0m21:11:13.902001 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m21:11:14.032121 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff735e3050>]}
[0m21:11:14.034419 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 2.92s]
[0m21:11:14.038048 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m21:11:15.005923 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m21:11:15.011652 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:11:15.012961 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m21:11:15.162399 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m21:11:15.172889 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:11:15.174443 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m21:11:15.268214 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.092 seconds
[0m21:11:15.274916 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:11:15.276699 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m21:11:15.459824 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m21:11:15.465343 [debug] [Thread-3 (]: On model.stock_analytics.int_rsi: Close
[0m21:11:15.604398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f199d0>]}
[0m21:11:15.606650 [info ] [Thread-3 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 1.90s]
[0m21:11:15.609805 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_rsi
[0m21:11:15.611542 [debug] [Thread-4 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m21:11:15.612526 [info ] [Thread-4 (]: 7 of 7 START sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [RUN]
[0m21:11:15.613696 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_daily_returns, now model.stock_analytics.mart_stock_daily_metrics)
[0m21:11:15.614325 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.mart_stock_daily_metrics
[0m21:11:15.619441 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_daily_metrics"
[0m21:11:15.621526 [debug] [Thread-4 (]: Began executing node model.stock_analytics.mart_stock_daily_metrics
[0m21:11:15.625692 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_daily_metrics"
[0m21:11:15.628544 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:11:15.629032 [debug] [Thread-4 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
         as
        (

WITH base AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

ma AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
),

rsi AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_rsi
),

bollinger AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
),

macd AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_macd
)

SELECT 
    -- Basic information
    base.SYMBOL,
    base."DATE",
    base."CLOSE",
    base."OPEN",
    base."MAX",
    base."MIN",
    base.VOLUME,
    
    -- Daily changes
    base.DAILY_CHANGE,
    base.DAILY_CHANGE_PCT,
    base.INTRADAY_RANGE,
    base.INTRADAY_RANGE_PCT,
    
    -- Moving Averages
    ma.MA_5,
    ma.MA_20,
    ma.MA_50,
    ma.EMA_12,
    ma.EMA_26,
    
    -- MA Cross Signals (Golden Cross / Death Cross)
    CASE 
        -- Golden Cross: MA5 crosses above MA20
        WHEN ma.MA_5 > ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") 
        THEN 'GOLDEN_CROSS_5_20'
        
        -- Death Cross: MA5 crosses below MA20
        WHEN ma.MA_5 < ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_5_20'
        
        -- Golden Cross: MA20 crosses above MA50
        WHEN ma.MA_20 > ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'GOLDEN_CROSS_20_50'
        
        -- Death Cross: MA20 crosses below MA50
        WHEN ma.MA_20 < ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_20_50'
        
        ELSE 'NO_CROSS'
    END as MA_CROSS_SIGNAL,
    
    -- Price vs MA trend analysis
    CASE 
        WHEN base."CLOSE" > ma.MA_5 AND base."CLOSE" > ma.MA_20 AND base."CLOSE" > ma.MA_50 THEN 'STRONG_UPTREND'
        WHEN base."CLOSE" < ma.MA_5 AND base."CLOSE" < ma.MA_20 AND base."CLOSE" < ma.MA_50 THEN 'STRONG_DOWNTREND'
        WHEN base."CLOSE" > ma.MA_20 THEN 'UPTREND'
        WHEN base."CLOSE" < ma.MA_20 THEN 'DOWNTREND'
        ELSE 'SIDEWAYS'
    END as PRICE_TREND,
    
    -- RSI indicators
    rsi.RSI_14,
    rsi.RSI_SIGNAL,
    
    -- Bollinger Bands
    bollinger.UPPER_BAND,
    bollinger.LOWER_BAND,
    bollinger.MA_20 as BB_MIDDLE,
    bollinger.BAND_WIDTH_PCT,
    bollinger.BAND_POSITION,
    bollinger.PERCENT_B,
    
    -- MACD indicators
    macd.MACD_LINE,
    macd.SIGNAL_LINE,
    macd.MACD_HISTOGRAM,
    macd.MACD_SIGNAL,
    
    -- Volatility (using intraday range as proxy)
    CASE 
        WHEN base.INTRADAY_RANGE_PCT > 5 THEN 'HIGH_VOLATILITY'
        WHEN base.INTRADAY_RANGE_PCT < 1 THEN 'LOW_VOLATILITY'
        ELSE 'NORMAL_VOLATILITY'
    END as VOLATILITY_SIGNAL

FROM base
LEFT JOIN ma 
    ON base.SYMBOL = ma.SYMBOL AND base."DATE" = ma."DATE"
LEFT JOIN rsi 
    ON base.SYMBOL = rsi.SYMBOL AND base."DATE" = rsi."DATE"
LEFT JOIN bollinger 
    ON base.SYMBOL = bollinger.SYMBOL AND base."DATE" = bollinger."DATE"
LEFT JOIN macd 
    ON base.SYMBOL = macd.SYMBOL AND base."DATE" = macd."DATE"
        );
[0m21:11:15.629565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:11:16.337861 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03d57-0106-eb85-000f-c0df0070b19e
[0m21:11:16.339412 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 88 at position 4
invalid identifier 'BOLLINGER.UPPER_BAND'
[0m21:11:16.341200 [debug] [Thread-4 (]: On model.stock_analytics.mart_stock_daily_metrics: Close
[0m21:11:16.479095 [debug] [Thread-4 (]: Database Error in model mart_stock_daily_metrics (models/marts/mart_stock_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 88 at position 4
  invalid identifier 'BOLLINGER.UPPER_BAND'
  compiled code at target/run/stock_analytics/models/marts/mart_stock_daily_metrics.sql
[0m21:11:16.480938 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83f1d8f-e52a-4cc5-a615-4922204b71ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72bc91c0>]}
[0m21:11:16.482192 [error] [Thread-4 (]: 7 of 7 ERROR creating sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [[31mERROR[0m in 0.87s]
[0m21:11:16.483835 [debug] [Thread-4 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m21:11:16.487142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:16.487748 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m21:11:16.488152 [debug] [MainThread]: Connection 'model.stock_analytics.int_moving_averages' was properly closed.
[0m21:11:16.488551 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m21:11:16.488945 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_daily_metrics' was properly closed.
[0m21:11:16.489646 [info ] [MainThread]: 
[0m21:11:16.490422 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m21:11:16.491677 [debug] [MainThread]: Command end result
[0m21:11:16.604098 [info ] [MainThread]: 
[0m21:11:16.604895 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:11:16.605370 [info ] [MainThread]: 
[0m21:11:16.605785 [error] [MainThread]:   Database Error in model mart_stock_daily_metrics (models/marts/mart_stock_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 88 at position 4
  invalid identifier 'BOLLINGER.UPPER_BAND'
  compiled code at target/run/stock_analytics/models/marts/mart_stock_daily_metrics.sql
[0m21:11:16.606031 [info ] [MainThread]: 
[0m21:11:16.606376 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:11:16.607309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.916231, "process_user_time": 2.891893, "process_kernel_time": 0.30092, "process_mem_max_rss": "236804", "process_out_blocks": "3085", "command_success": false, "process_in_blocks": "0"}
[0m21:11:16.607727 [debug] [MainThread]: Command `dbt run` failed at 21:11:16.607670 after 9.92 seconds
[0m21:11:16.608017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95950830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff786e1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94873380>]}
[0m21:11:16.608288 [debug] [MainThread]: Flushing usage events
[0m21:12:31.549290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e27560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08dc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb187d4c0>]}


============================== 21:12:31.554056 | 2000532d-09ef-4f6b-8d44-b7d80857e19e ==============================
[0m21:12:31.554056 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:12:31.554746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:12:31.558064 [info ] [MainThread]: dbt version: 1.8.8
[0m21:12:31.558411 [info ] [MainThread]: python version: 3.12.4
[0m21:12:31.558674 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m21:12:31.558989 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m21:12:31.912732 [info ] [MainThread]: Using profiles dir at .
[0m21:12:31.913302 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m21:12:31.913660 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m21:12:31.914075 [info ] [MainThread]: adapter type: snowflake
[0m21:12:31.914359 [info ] [MainThread]: adapter version: 1.8.4
[0m21:12:31.936801 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:12:31.937203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2000532d-09ef-4f6b-8d44-b7d80857e19e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b9a8d0>]}
[0m21:12:31.951975 [info ] [MainThread]: Configuration:
[0m21:12:31.952271 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:12:31.952541 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:12:31.952817 [info ] [MainThread]: Required dependencies:
[0m21:12:31.953119 [debug] [MainThread]: Executing "git --help"
[0m21:12:31.954908 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:12:31.955170 [debug] [MainThread]: STDERR: "b''"
[0m21:12:31.955386 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:12:31.955650 [info ] [MainThread]: Connection:
[0m21:12:31.955910 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m21:12:31.956237 [info ] [MainThread]:   user: MALLARD
[0m21:12:31.956498 [info ] [MainThread]:   database: ASH_DB
[0m21:12:31.956748 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m21:12:31.956988 [info ] [MainThread]:   role: TRAINING_ROLE
[0m21:12:31.957216 [info ] [MainThread]:   schema: STOCK_RAW
[0m21:12:31.957447 [info ] [MainThread]:   authenticator: None
[0m21:12:31.957668 [info ] [MainThread]:   oauth_client_id: None
[0m21:12:31.957908 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m21:12:31.958348 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:12:31.958589 [info ] [MainThread]:   host: None
[0m21:12:31.958811 [info ] [MainThread]:   port: None
[0m21:12:31.959066 [info ] [MainThread]:   proxy_host: None
[0m21:12:31.959304 [info ] [MainThread]:   proxy_port: None
[0m21:12:31.959545 [info ] [MainThread]:   protocol: None
[0m21:12:31.959789 [info ] [MainThread]:   connect_retries: 1
[0m21:12:31.960074 [info ] [MainThread]:   connect_timeout: None
[0m21:12:31.960327 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:12:31.960554 [info ] [MainThread]:   retry_all: False
[0m21:12:31.960779 [info ] [MainThread]:   insecure_mode: False
[0m21:12:31.961022 [info ] [MainThread]:   reuse_connections: None
[0m21:12:31.961343 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:12:31.962883 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:12:31.963364 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:12:31.963666 [debug] [MainThread]: On debug: select 1 as id
[0m21:12:31.963912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:32.581149 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.617 seconds
[0m21:12:32.582834 [debug] [MainThread]: On debug: Close
[0m21:12:32.804012 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:12:32.805831 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:12:32.807836 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2942047, "process_user_time": 1.881374, "process_kernel_time": 0.171492, "process_mem_max_rss": "236808", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m21:12:32.808997 [debug] [MainThread]: Command `dbt debug` succeeded at 21:12:32.808876 after 1.30 seconds
[0m21:12:32.809788 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:12:32.810574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e27560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2705c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdd2e70>]}
[0m21:12:32.811330 [debug] [MainThread]: Flushing usage events
[0m21:12:35.382674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6761cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6df08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6714500>]}


============================== 21:12:35.386027 | eb0fab0f-95c1-44d6-8bf9-b0fe1be9c4cf ==============================
[0m21:12:35.386027 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:12:35.386806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:12:35.409147 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:12:35.409555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb0fab0f-95c1-44d6-8bf9-b0fe1be9c4cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb671b620>]}
[0m21:12:35.438264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb0fab0f-95c1-44d6-8bf9-b0fe1be9c4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69fef30>]}
[0m21:12:35.486123 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1fgxgia9'
[0m21:12:35.486498 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:12:35.769812 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:12:35.772523 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:12:35.986044 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:12:35.988388 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:12:37.202640 [info ] [MainThread]: Installed from version 1.1.1
[0m21:12:37.204128 [info ] [MainThread]: Updated version available: 1.3.2
[0m21:12:37.205080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'eb0fab0f-95c1-44d6-8bf9-b0fe1be9c4cf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb627cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65327b0>]}
[0m21:12:37.205990 [info ] [MainThread]: 
[0m21:12:37.210785 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:12:37.213243 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8671334, "process_user_time": 1.044843, "process_kernel_time": 0.17448, "process_mem_max_rss": "236796", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m21:12:37.214243 [debug] [MainThread]: Command `dbt deps` succeeded at 21:12:37.214037 after 1.87 seconds
[0m21:12:37.215282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb93b1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa2b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6396e40>]}
[0m21:12:37.216103 [debug] [MainThread]: Flushing usage events
[0m21:12:40.535939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa317530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1f2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaaf9790>]}


============================== 21:12:40.539410 | 19dceb54-5265-4672-8699-6075340ee971 ==============================
[0m21:12:40.539410 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:12:40.540025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:12:40.903163 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:12:40.903677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '19dceb54-5265-4672-8699-6075340ee971', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a662540>]}
[0m21:12:40.929788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19dceb54-5265-4672-8699-6075340ee971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bc7350>]}
[0m21:12:40.950086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19dceb54-5265-4672-8699-6075340ee971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bafda00>]}
[0m21:12:40.950541 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:12:40.958518 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:12:41.041838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:12:41.042334 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/marts/mart_stock_daily_metrics.sql
[0m21:12:41.206391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19dceb54-5265-4672-8699-6075340ee971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d99130>]}
[0m21:12:41.265913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19dceb54-5265-4672-8699-6075340ee971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89932600>]}
[0m21:12:41.266265 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:12:41.266659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19dceb54-5265-4672-8699-6075340ee971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab609e0>]}
[0m21:12:41.267683 [info ] [MainThread]: 
[0m21:12:41.268194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:12:41.268827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:12:41.274890 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:12:41.275152 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:12:41.275384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:41.764961 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.489 seconds
[0m21:12:41.768454 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:12:41.892317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m21:12:41.893633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m21:12:41.895400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m21:12:41.904432 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:12:41.906781 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:12:41.907262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m21:12:41.910108 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:12:41.910599 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:12:41.911191 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:12:41.912924 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:12:41.913354 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:12:41.913794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:41.914177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:41.914547 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:12:41.914987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:41.918198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:42.309224 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d58-0106-ed95-000f-c0df0070940a
[0m21:12:42.310581 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:12:42.311930 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:12:42.312796 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:12:42.313664 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:12:42.319926 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.406 seconds
[0m21:12:42.322499 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:12:42.324305 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.409 seconds
[0m21:12:42.327939 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:12:42.358636 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.440 seconds
[0m21:12:42.360380 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:12:42.536902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19dceb54-5265-4672-8699-6075340ee971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab9a8a40>]}
[0m21:12:42.537603 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:12:42.538373 [info ] [MainThread]: 
[0m21:12:42.544438 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m21:12:42.544934 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m21:12:42.545458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now snapshot.stock_analytics.stock_price_snapshot)
[0m21:12:42.545752 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m21:12:42.555885 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m21:12:42.583954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:42.584465 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m21:12:42.584893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:43.375689 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.790 seconds
[0m21:12:43.387840 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:43.388763 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:12:43.488801 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.099 seconds
[0m21:12:43.501938 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:43.502385 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:12:43.585013 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.082 seconds
[0m21:12:43.669169 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:43.669764 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace temporary table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:12:45.376602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.706 seconds
[0m21:12:45.384765 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:45.386141 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:12:45.479699 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.092 seconds
[0m21:12:45.488297 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:45.489836 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:12:45.630661 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.140 seconds
[0m21:12:45.639246 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:45.640697 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:12:45.790347 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.148 seconds
[0m21:12:45.798398 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:45.799992 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:12:45.882415 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.081 seconds
[0m21:12:45.897196 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:45.898602 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:12:46.004322 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.104 seconds
[0m21:12:46.029928 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:46.030741 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:12:46.654075 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.622 seconds
[0m21:12:46.661207 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:46.662397 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:12:46.763211 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.100 seconds
[0m21:12:46.764916 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:46.769153 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:46.770132 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
BEGIN
[0m21:12:46.882611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m21:12:46.884141 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:46.885285 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
merge into "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:12:47.572348 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.686 seconds
[0m21:12:47.572782 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:12:47.573059 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
COMMIT
[0m21:12:47.982643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m21:12:47.996652 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m21:12:48.099875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19dceb54-5265-4672-8699-6075340ee971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1eb830>]}
[0m21:12:48.101065 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 0[0m in 5.55s]
[0m21:12:48.103489 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m21:12:48.106148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:48.106767 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m21:12:48.107240 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_raw' was properly closed.
[0m21:12:48.107665 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_analytics' was properly closed.
[0m21:12:48.108156 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m21:12:48.108809 [info ] [MainThread]: 
[0m21:12:48.109542 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m21:12:48.110435 [debug] [MainThread]: Command end result
[0m21:12:48.144642 [info ] [MainThread]: 
[0m21:12:48.145260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:12:48.145499 [info ] [MainThread]: 
[0m21:12:48.145773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:12:48.146871 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.6516027, "process_user_time": 2.612878, "process_kernel_time": 0.218156, "process_mem_max_rss": "236804", "process_out_blocks": "4237", "process_in_blocks": "0"}
[0m21:12:48.147271 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:12:48.147218 after 7.65 seconds
[0m21:12:48.147603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4c6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4c5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f35910>]}
[0m21:12:48.147902 [debug] [MainThread]: Flushing usage events
[0m21:12:51.484132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942e7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9602f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94940ef0>]}


============================== 21:12:51.487400 | bf5f04e8-fa27-4d55-84e9-caf27a99bba4 ==============================
[0m21:12:51.487400 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:12:51.487955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:12:51.852255 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:12:51.856258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1d7560>]}
[0m21:12:51.882350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78201130>]}
[0m21:12:51.902132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79622330>]}
[0m21:12:51.902590 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:12:51.909856 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:12:51.990611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:12:51.991016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:12:52.013269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73b1ee70>]}
[0m21:12:52.070833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73af4080>]}
[0m21:12:52.071183 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:12:52.071641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7377e7e0>]}
[0m21:12:52.072684 [info ] [MainThread]: 
[0m21:12:52.073075 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:12:52.075316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:12:52.075674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:12:52.082193 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:12:52.083488 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:12:52.083752 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:12:52.084017 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:12:52.084319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:52.084539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:52.692486 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.608 seconds
[0m21:12:52.696148 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:12:52.741783 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.657 seconds
[0m21:12:52.743132 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:12:52.859617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m21:12:52.860672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_analytics)
[0m21:12:52.868790 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:12:52.869344 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m21:12:52.871065 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:12:52.871512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m21:12:52.872012 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:12:52.873623 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:12:52.874041 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:12:52.876262 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:12:52.876642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:52.877027 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:12:52.877359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:52.877661 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:12:52.879175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:52.881022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:53.321168 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.444 seconds
[0m21:12:53.326397 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:12:53.329534 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03d58-0106-eb7f-000f-c0df0070a33a
[0m21:12:53.331983 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:12:53.332707 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:12:53.333183 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:12:53.333636 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:12:53.450445 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.571 seconds
[0m21:12:53.454255 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:12:53.496858 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.616 seconds
[0m21:12:53.503377 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:12:54.029126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7337ddc0>]}
[0m21:12:54.031055 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:12:54.033118 [info ] [MainThread]: 
[0m21:12:54.048370 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m21:12:54.049921 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m21:12:54.050921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.stg_stock_daily)
[0m21:12:54.051411 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m21:12:54.059478 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m21:12:54.061317 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m21:12:54.082663 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:12:54.083095 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m21:12:54.083418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:54.834658 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.751 seconds
[0m21:12:54.845537 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m21:12:54.848212 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:12:54.848773 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m21:12:55.051565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m21:12:55.078751 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:12:55.079350 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m21:12:55.190499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:12:55.202877 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m21:12:55.316817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73af6f00>]}
[0m21:12:55.319067 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.26s]
[0m21:12:55.322301 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m21:12:55.325085 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m21:12:55.325867 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m21:12:55.326546 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m21:12:55.327343 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m21:12:55.328051 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m21:12:55.329334 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m21:12:55.330280 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m21:12:55.331255 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m21:12:55.332486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_bollinger)
[0m21:12:55.333338 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_daily_returns)
[0m21:12:55.334225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.int_macd)
[0m21:12:55.334798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m21:12:55.335355 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m21:12:55.336080 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m21:12:55.336747 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m21:12:55.337320 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m21:12:55.341187 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m21:12:55.345467 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m21:12:55.347652 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m21:12:55.350010 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m21:12:55.352001 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m21:12:55.352416 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m21:12:55.364076 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m21:12:55.365757 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m21:12:55.367263 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m21:12:55.368780 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m21:12:55.369010 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m21:12:55.370651 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:12:55.371988 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m21:12:55.372907 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:12:55.373967 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:12:55.374254 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m21:12:55.374922 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc
        );
[0m21:12:55.375303 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m21:12:55.376417 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:12:55.376682 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:12:55.376991 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:12:55.377281 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:12:55.377582 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    -- Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m21:12:55.381085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:56.685561 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.307 seconds
[0m21:12:56.692260 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:12:56.694122 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m21:12:56.695585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.314 seconds
[0m21:12:56.701530 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:12:56.702450 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages IS $$Moving averages for trend analysis$$;
[0m21:12:56.750382 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.373 seconds
[0m21:12:56.752622 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:12:56.753151 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m21:12:56.850987 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m21:12:56.865847 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:12:56.866641 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m21:12:56.867202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m21:12:56.870365 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:12:56.870800 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
[0m21:12:56.872640 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m21:12:56.874725 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:12:56.875137 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m21:12:56.941536 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.074 seconds
[0m21:12:56.944320 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:12:56.944795 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m21:12:56.958186 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m21:12:56.960602 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:12:56.961204 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "PRICE_VS_MA20_PCT" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$Golden cross or death cross signal$$;
[0m21:12:57.053947 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m21:12:57.057836 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m21:12:57.113113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m21:12:57.117201 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m21:12:57.178671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff729f2de0>]}
[0m21:12:57.180534 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 1.84s]
[0m21:12:57.182046 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m21:12:57.183207 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_rsi
[0m21:12:57.184245 [info ] [Thread-2 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m21:12:57.185781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_macd, now model.stock_analytics.int_rsi)
[0m21:12:57.187585 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_rsi
[0m21:12:57.192372 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m21:12:57.193406 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_rsi
[0m21:12:57.194921 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m21:12:57.197043 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:12:57.197521 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m21:12:57.197927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:12:57.297686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff729d3ef0>]}
[0m21:12:57.299279 [info ] [Thread-1 (]: 5 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[32mSUCCESS 1[0m in 1.96s]
[0m21:12:57.300675 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m21:12:57.458722 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.081 seconds
[0m21:12:57.460986 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.585 seconds
[0m21:12:57.465155 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:12:57.469269 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:12:57.470248 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns IS $$Daily returns and volatility metrics$$;
[0m21:12:57.471124 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m21:12:57.612646 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m21:12:57.619401 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:12:57.620683 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
[0m21:12:57.621643 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m21:12:57.625117 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m21:12:57.716249 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.094 seconds
[0m21:12:57.721404 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:12:57.722497 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "PREV_ADJ_CLOSE" COMMENT $$$$,
    
        "ADJ_DAILY_CHANGE" COMMENT $$$$,
    
        "ADJ_DAILY_RETURN_PCT" COMMENT $$$$,
    
        "LOG_RETURN" COMMENT $$$$,
    
        "VOLATILITY_20D" COMMENT $$20-day rolling volatility$$,
    
        "CUMULATIVE_RETURN_PCT" COMMENT $$$$;
[0m21:12:57.827294 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7295be00>]}
[0m21:12:57.828084 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 2.49s]
[0m21:12:57.828974 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m21:12:57.905528 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m21:12:57.906753 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m21:12:58.014203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7297f1a0>]}
[0m21:12:58.014862 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_daily_returns .. [[32mSUCCESS 1[0m in 2.68s]
[0m21:12:58.015816 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m21:12:58.604423 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.406 seconds
[0m21:12:58.609239 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:12:58.610470 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m21:12:58.730706 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m21:12:58.739697 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:12:58.741397 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m21:12:58.864929 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.122 seconds
[0m21:12:58.867093 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:12:58.867486 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m21:12:59.024466 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m21:12:59.028579 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: Close
[0m21:12:59.212449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7294d790>]}
[0m21:12:59.214049 [info ] [Thread-2 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 2.03s]
[0m21:12:59.215445 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_rsi
[0m21:12:59.216889 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m21:12:59.217832 [info ] [Thread-1 (]: 7 of 7 START sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [RUN]
[0m21:12:59.218955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.mart_stock_daily_metrics)
[0m21:12:59.219771 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_daily_metrics
[0m21:12:59.224945 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_daily_metrics"
[0m21:12:59.226261 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_daily_metrics
[0m21:12:59.228565 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_daily_metrics"
[0m21:12:59.230261 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:12:59.230594 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
         as
        (

WITH base AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

ma AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
),

rsi AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_rsi
),

bollinger AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
),

macd AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_macd
)

SELECT 
    -- Basic information
    base.SYMBOL,
    base."DATE",
    base."CLOSE",
    base."OPEN",
    base."MAX",
    base."MIN",
    base.VOLUME,
    
    -- Daily changes
    base.DAILY_CHANGE,
    base.DAILY_CHANGE_PCT,
    base.INTRADAY_RANGE,
    base.INTRADAY_RANGE_PCT,
    
    -- Moving Averages
    ma.MA_5,
    ma.MA_20,
    ma.MA_50,
    ma.EMA_12,
    ma.EMA_26,
    
    -- MA Cross Signals (Golden Cross / Death Cross)
    CASE 
        -- Golden Cross: MA5 crosses above MA20
        WHEN ma.MA_5 > ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") 
        THEN 'GOLDEN_CROSS_5_20'
        
        -- Death Cross: MA5 crosses below MA20
        WHEN ma.MA_5 < ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_5_20'
        
        -- Golden Cross: MA20 crosses above MA50
        WHEN ma.MA_20 > ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'GOLDEN_CROSS_20_50'
        
        -- Death Cross: MA20 crosses below MA50
        WHEN ma.MA_20 < ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_20_50'
        
        ELSE 'NO_CROSS'
    END as MA_CROSS_SIGNAL,
    
    -- Price vs MA trend analysis
    CASE 
        WHEN base."CLOSE" > ma.MA_5 AND base."CLOSE" > ma.MA_20 AND base."CLOSE" > ma.MA_50 THEN 'STRONG_UPTREND'
        WHEN base."CLOSE" < ma.MA_5 AND base."CLOSE" < ma.MA_20 AND base."CLOSE" < ma.MA_50 THEN 'STRONG_DOWNTREND'
        WHEN base."CLOSE" > ma.MA_20 THEN 'UPTREND'
        WHEN base."CLOSE" < ma.MA_20 THEN 'DOWNTREND'
        ELSE 'SIDEWAYS'
    END as PRICE_TREND,
    
    -- RSI indicators
    rsi.RSI_14,
    rsi.RSI_SIGNAL,
    
    -- Bollinger Bands
    bollinger.BB_UPPER,
    bollinger.BB_LOWER,
    bollinger.BB_MIDDLE,
    bollinger.BB_WIDTH_PCT,
    bollinger.BB_PERCENT_B,
    bollinger.BB_SIGNAL,
    bollinger.BB_SQUEEZE,
    
    -- MACD indicators
    macd.MACD_LINE,
    macd.SIGNAL_LINE,
    macd.MACD_HISTOGRAM,
    macd.MACD_SIGNAL,
    
    -- Volatility (using intraday range as proxy)
    CASE 
        WHEN base.INTRADAY_RANGE_PCT > 5 THEN 'HIGH_VOLATILITY'
        WHEN base.INTRADAY_RANGE_PCT < 1 THEN 'LOW_VOLATILITY'
        ELSE 'NORMAL_VOLATILITY'
    END as VOLATILITY_SIGNAL

FROM base
LEFT JOIN ma 
    ON base.SYMBOL = ma.SYMBOL AND base."DATE" = ma."DATE"
LEFT JOIN rsi 
    ON base.SYMBOL = rsi.SYMBOL AND base."DATE" = rsi."DATE"
LEFT JOIN bollinger 
    ON base.SYMBOL = bollinger.SYMBOL AND base."DATE" = bollinger."DATE"
LEFT JOIN macd 
    ON base.SYMBOL = macd.SYMBOL AND base."DATE" = macd."DATE"
        );
[0m21:12:59.230925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:01.163435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.932 seconds
[0m21:13:01.168012 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:13:01.168771 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics IS $$Daily stock metrics with all technical indicators$$;
[0m21:13:01.317577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m21:13:01.325260 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:13:01.326885 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
[0m21:13:01.436373 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.108 seconds
[0m21:13:01.444954 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:13:01.446180 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "OPEN" COMMENT $$$$,
    
        "MAX" COMMENT $$$$,
    
        "MIN" COMMENT $$$$,
    
        "VOLUME" COMMENT $$$$,
    
        "DAILY_CHANGE" COMMENT $$$$,
    
        "DAILY_CHANGE_PCT" COMMENT $$$$,
    
        "INTRADAY_RANGE" COMMENT $$$$,
    
        "INTRADAY_RANGE_PCT" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$$$,
    
        "PRICE_TREND" COMMENT $$Overall price trend$$,
    
        "RSI_14" COMMENT $$$$,
    
        "RSI_SIGNAL" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$$$,
    
        "BB_LOWER" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$$$,
    
        "VOLATILITY_SIGNAL" COMMENT $$$$;
[0m21:13:01.712804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m21:13:01.717499 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: Close
[0m21:13:01.852844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5f04e8-fa27-4d55-84e9-caf27a99bba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71fc8aa0>]}
[0m21:13:01.854049 [info ] [Thread-1 (]: 7 of 7 OK created sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [[32mSUCCESS 1[0m in 2.63s]
[0m21:13:01.855590 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m21:13:01.857955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:01.858633 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_daily_metrics' was properly closed.
[0m21:13:01.859187 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m21:13:01.859641 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m21:13:01.860164 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m21:13:01.860910 [info ] [MainThread]: 
[0m21:13:01.861835 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 9.79 seconds (9.79s).
[0m21:13:01.863903 [debug] [MainThread]: Command end result
[0m21:13:01.967387 [info ] [MainThread]: 
[0m21:13:01.968077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:01.968416 [info ] [MainThread]: 
[0m21:13:01.968718 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:13:01.969533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.520556, "process_user_time": 2.800597, "process_kernel_time": 0.186706, "process_mem_max_rss": "236804", "process_out_blocks": "3088", "process_in_blocks": "0"}
[0m21:13:01.969929 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:01.969869 after 10.52 seconds
[0m21:13:01.970208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9731dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9731ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71f9dcd0>]}
[0m21:13:01.970471 [debug] [MainThread]: Flushing usage events
[0m21:13:04.676771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3591730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb37c0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39ff020>]}


============================== 21:13:04.680370 | b9189312-e1a6-45c7-b88d-2ee7a85b7691 ==============================
[0m21:13:04.680370 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:13:04.680863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:13:05.118452 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:13:05.119024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9189312-e1a6-45c7-b88d-2ee7a85b7691', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9336fce0>]}
[0m21:13:05.148958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9189312-e1a6-45c7-b88d-2ee7a85b7691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93143e00>]}
[0m21:13:05.175540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9189312-e1a6-45c7-b88d-2ee7a85b7691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d9b75f0>]}
[0m21:13:05.176350 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:13:05.187921 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:13:05.288962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:05.289386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:05.321501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9189312-e1a6-45c7-b88d-2ee7a85b7691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93000ef0>]}
[0m21:13:05.391293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9189312-e1a6-45c7-b88d-2ee7a85b7691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d2fb90>]}
[0m21:13:05.391623 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:13:05.391862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9189312-e1a6-45c7-b88d-2ee7a85b7691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931150d0>]}
[0m21:13:05.393442 [info ] [MainThread]: 
[0m21:13:05.393926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:13:05.396795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:13:05.403292 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:13:05.403558 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:13:05.403750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:05.804044 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.400 seconds
[0m21:13:05.807796 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:13:05.965138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_RAW_test_failures)
[0m21:13:05.966058 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_RAW_test_failures"
"
[0m21:13:05.971799 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_RAW_test_failures"
[0m21:13:05.972262 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_RAW_test_failures"} */
create schema if not exists ASH_DB.STOCK_RAW_test_failures
[0m21:13:05.972660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:06.469257 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.497 seconds
[0m21:13:06.472331 [debug] [ThreadPool]: On create_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:13:06.588979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m21:13:06.589412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_RAW_test_failures, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m21:13:06.594506 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:13:06.594931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m21:13:06.595424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m21:13:06.597173 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:13:06.597561 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:13:06.598754 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:13:06.599950 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:13:06.600271 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:13:06.600554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:06.600818 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:13:06.601076 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:13:06.601314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:06.602873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:06.603276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:06.970498 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.369 seconds
[0m21:13:06.971557 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:13:06.988639 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.385 seconds
[0m21:13:06.989698 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:13:07.019939 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.417 seconds
[0m21:13:07.020877 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:13:07.040294 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.440 seconds
[0m21:13:07.041348 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:13:07.168494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9189312-e1a6-45c7-b88d-2ee7a85b7691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93672180>]}
[0m21:13:07.169004 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:13:07.169316 [info ] [MainThread]: 
[0m21:13:07.175486 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:13:07.176188 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:13:07.176712 [debug] [Thread-3 (]: Began running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:13:07.177154 [debug] [Thread-4 (]: Began running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:13:07.177417 [info ] [Thread-1 (]: 1 of 35 START test accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [RUN]
[0m21:13:07.177908 [info ] [Thread-2 (]: 2 of 35 START test accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [RUN]
[0m21:13:07.178365 [info ] [Thread-3 (]: 3 of 35 START test accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL  [RUN]
[0m21:13:07.178724 [info ] [Thread-4 (]: 4 of 35 START test accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [RUN]
[0m21:13:07.179179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6)
[0m21:13:07.179487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef)
[0m21:13:07.179769 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859)
[0m21:13:07.180064 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a)
[0m21:13:07.180795 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:13:07.181089 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:13:07.181390 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:13:07.181718 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:13:07.191182 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:13:07.194815 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:13:07.197747 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:13:07.201159 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:13:07.202762 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:13:07.209095 [debug] [Thread-3 (]: Began executing node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:13:07.209385 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:13:07.213304 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
[0m21:13:07.214770 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
[0m21:13:07.215015 [debug] [Thread-4 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:13:07.216170 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
[0m21:13:07.225925 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:13:07.227067 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:13:07.228505 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
[0m21:13:07.229447 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:13:07.229752 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
         as
        (
    
    

with all_values as (

    select
        MACD_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_macd where MACD_SIGNAL IS NOT NULL) dbt_subquery
    group by MACD_SIGNAL

)

select *
from all_values
where value_field not in (
    'BULLISH_CROSSOVER','BEARISH_CROSSOVER','BULLISH','BEARISH','NEUTRAL'
)



        );
[0m21:13:07.230939 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
         as
        (
    
    

with all_values as (

    select
        RSI_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_rsi where RSI_SIGNAL IS NOT NULL) dbt_subquery
    group by RSI_SIGNAL

)

select *
from all_values
where value_field not in (
    'OVERBOUGHT','OVERSOLD','NEUTRAL'
)



        );
[0m21:13:07.232422 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:13:07.232718 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
         as
        (
    
    

with all_values as (

    select
        MA_CROSS_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages where MA_CROSS_SIGNAL IS NOT NULL) dbt_subquery
    group by MA_CROSS_SIGNAL

)

select *
from all_values
where value_field not in (
    'GOLDEN_CROSS','DEATH_CROSS','NEUTRAL'
)



        );
[0m21:13:07.232999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:07.233251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:07.233519 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
         as
        (
    
    

with all_values as (

    select
        PRICE_TREND as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by PRICE_TREND

)

select *
from all_values
where value_field not in (
    'STRONG_UPTREND','UPTREND','SIDEWAYS','DOWNTREND','STRONG_DOWNTREND'
)



        );
[0m21:13:07.233777 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:07.237203 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:08.017017 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m21:13:08.019578 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:13:08.020738 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:13:08.021043 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
    
      
    ) dbt_internal_test
[0m21:13:08.032985 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m21:13:08.033868 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:13:08.034911 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:13:08.035251 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
    
      
    ) dbt_internal_test
[0m21:13:08.073969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.841 seconds
[0m21:13:08.075002 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:13:08.075932 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:13:08.076203 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
    
      
    ) dbt_internal_test
[0m21:13:08.148486 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m21:13:08.153183 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: Close
[0m21:13:08.196782 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m21:13:08.197995 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: Close
[0m21:13:08.221073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m21:13:08.222339 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: Close
[0m21:13:08.272183 [info ] [Thread-4 (]: 4 of 35 PASS accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [[32mPASS[0m in 1.09s]
[0m21:13:08.272756 [debug] [Thread-4 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:13:08.273128 [debug] [Thread-4 (]: Began running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31
[0m21:13:08.273537 [info ] [Thread-4 (]: 5 of 35 START test accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL  [RUN]
[0m21:13:08.274616 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a, now test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31)
[0m21:13:08.274998 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31
[0m21:13:08.278614 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31"
[0m21:13:08.280126 [debug] [Thread-4 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31
[0m21:13:08.281351 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_fc1680f73a04372ce9c25cfa3498d480
[0m21:13:08.282269 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31"
[0m21:13:08.282539 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_fc1680f73a04372ce9c25cfa3498d480
         as
        (
    
    

with all_values as (

    select
        TRADING_SIGNAL as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by TRADING_SIGNAL

)

select *
from all_values
where value_field not in (
    'STRONG_BUY','BUY','HOLD','SELL','STRONG_SELL'
)



        );
[0m21:13:08.282760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:08.339654 [info ] [Thread-2 (]: 2 of 35 PASS accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [[32mPASS[0m in 1.16s]
[0m21:13:08.341033 [info ] [Thread-1 (]: 1 of 35 PASS accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [[32mPASS[0m in 1.16s]
[0m21:13:08.341511 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:13:08.341937 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:13:08.342276 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:13:08.342646 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:13:08.342968 [info ] [Thread-2 (]: 6 of 35 START test accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [RUN]
[0m21:13:08.343360 [info ] [Thread-1 (]: 7 of 35 START test dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE  [RUN]
[0m21:13:08.343789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef, now test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987)
[0m21:13:08.344138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1)
[0m21:13:08.344426 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:13:08.344689 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:13:08.348199 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:13:08.352244 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:13:08.353487 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:13:08.353702 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:13:08.354968 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
[0m21:13:08.356139 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
[0m21:13:08.358134 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:13:08.358390 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
         as
        (
    
    

with all_values as (

    select
        DATA_QUALITY_FLAG as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    group by DATA_QUALITY_FLAG

)

select *
from all_values
where value_field not in (
    'VALID','INVALID','ANOMALY','MISSING','NO_TRADING'
)



        );
[0m21:13:08.358641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:08.357296 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:13:08.360036 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger where BB_LOWER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_LOWER < BB_MIDDLE)


        );
[0m21:13:08.360426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:08.459747 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.226 seconds
[0m21:13:08.460859 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:13:08.461970 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:13:08.462289 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
    
      
    ) dbt_internal_test
[0m21:13:08.638038 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c03d59-0106-eb7f-000f-c0df0070a356
[0m21:13:08.638459 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 8
invalid identifier 'TRADING_SIGNAL'
[0m21:13:08.638802 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31: Close
[0m21:13:08.653422 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m21:13:08.654643 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: Close
[0m21:13:08.755168 [debug] [Thread-4 (]: Database Error in test accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'TRADING_SIGNAL'
[0m21:13:08.755648 [error] [Thread-4 (]: 5 of 35 ERROR accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL  [[31mERROR[0m in 0.48s]
[0m21:13:08.756124 [debug] [Thread-4 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31
[0m21:13:08.756477 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:13:08.757169 [info ] [Thread-4 (]: 8 of 35 START test dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE  [RUN]
[0m21:13:08.757502 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c)
[0m21:13:08.757797 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:13:08.760737 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:13:08.761456 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:13:08.763583 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
[0m21:13:08.764487 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:13:08.764749 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger where BB_UPPER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_UPPER > BB_MIDDLE)


        );
[0m21:13:08.765003 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:08.812312 [info ] [Thread-3 (]: 3 of 35 PASS accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL . [[32mPASS[0m in 1.63s]
[0m21:13:08.815096 [debug] [Thread-3 (]: Finished running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:13:08.815362 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:13:08.815615 [info ] [Thread-3 (]: 9 of 35 START test dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0  [RUN]
[0m21:13:08.815987 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859, now test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d)
[0m21:13:08.816242 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:13:08.820162 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:13:08.823132 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:13:08.824284 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
[0m21:13:08.825122 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:13:08.825347 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns where VOLATILITY_20D IS NOT NULL) dbt_subquery

where not(VOLATILITY_20D >= 0)


        );
[0m21:13:08.825586 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:09.369333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.008 seconds
[0m21:13:09.374233 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:13:09.378457 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:13:09.379535 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m21:13:09.536247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m21:13:09.541977 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: Close
[0m21:13:09.795452 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.030 seconds
[0m21:13:09.799076 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:13:09.801981 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:13:09.802886 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m21:13:09.865632 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.507 seconds
[0m21:13:09.867622 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:13:09.869754 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:13:09.870229 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
    
      
    ) dbt_internal_test
[0m21:13:10.032274 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m21:13:10.036390 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: Close
[0m21:13:10.050181 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m21:13:10.053528 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: Close
[0m21:13:10.181644 [info ] [Thread-4 (]: 8 of 35 PASS dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE ... [[32mPASS[0m in 1.42s]
[0m21:13:10.183257 [info ] [Thread-1 (]: 7 of 35 PASS dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE ... [[32mPASS[0m in 1.84s]
[0m21:13:10.184731 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:13:10.185699 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:13:10.187743 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:13:10.186709 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:13:10.189301 [info ] [Thread-4 (]: 10 of 35 START test dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100  [RUN]
[0m21:13:10.190134 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c, now test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb)
[0m21:13:10.190713 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:13:10.188455 [info ] [Thread-1 (]: 11 of 35 START test dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [RUN]
[0m21:13:10.196638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1, now test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12)
[0m21:13:10.197060 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:13:10.196205 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:13:10.204413 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:13:10.206072 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:13:10.207679 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
[0m21:13:10.207949 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:13:10.211314 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
[0m21:13:10.212434 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:13:10.212720 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m21:13:10.213188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:10.209375 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:13:10.215317 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_rsi where RSI_14 IS NOT NULL) dbt_subquery

where not(RSI_14 BETWEEN 0 AND 100)


        );
[0m21:13:10.215719 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:10.223175 [info ] [Thread-2 (]: 6 of 35 PASS accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [[32mPASS[0m in 1.88s]
[0m21:13:10.224446 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:13:10.225043 [debug] [Thread-2 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:13:10.225989 [info ] [Thread-2 (]: 12 of 35 START test dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [RUN]
[0m21:13:10.226551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987, now test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b)
[0m21:13:10.226878 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:13:10.229671 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:13:10.230591 [debug] [Thread-2 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:13:10.232699 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
[0m21:13:10.291761 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:13:10.292375 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.467 seconds
[0m21:13:10.296459 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:13:10.294999 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m21:13:10.299351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:10.300983 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:13:10.301307 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
    
      
    ) dbt_internal_test
[0m21:13:10.513321 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m21:13:10.515534 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: Close
[0m21:13:10.778889 [info ] [Thread-3 (]: 9 of 35 PASS dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0 . [[32mPASS[0m in 1.96s]
[0m21:13:10.780696 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:13:10.781768 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:13:10.782609 [info ] [Thread-3 (]: 13 of 35 START test not_null_int_bollinger_DATE ................................ [RUN]
[0m21:13:10.783831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d, now test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac)
[0m21:13:10.784589 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:13:10.792358 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:13:10.793730 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:13:10.796017 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
[0m21:13:10.797479 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:13:10.797861 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
where DATE is null



        );
[0m21:13:10.798239 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:11.202019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.988 seconds
[0m21:13:11.205609 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:13:11.210793 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:13:11.212443 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.997 seconds
[0m21:13:11.213324 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
    
      
    ) dbt_internal_test
[0m21:13:11.215633 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:13:11.219647 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:13:11.220444 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
    
      
    ) dbt_internal_test
[0m21:13:11.335689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.036 seconds
[0m21:13:11.338700 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:13:11.341486 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:13:11.342324 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
    
      
    ) dbt_internal_test
[0m21:13:11.409826 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m21:13:11.414301 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: Close
[0m21:13:11.480386 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m21:13:11.484759 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: Close
[0m21:13:11.557342 [info ] [Thread-4 (]: 10 of 35 PASS dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100 ... [[32mPASS[0m in 1.37s]
[0m21:13:11.559351 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:13:11.560579 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:13:11.561612 [info ] [Thread-4 (]: 14 of 35 START test not_null_int_bollinger_SYMBOL .............................. [RUN]
[0m21:13:11.563327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb, now test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443)
[0m21:13:11.564151 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:13:11.571502 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:13:11.573051 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:13:11.575770 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
[0m21:13:11.577611 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:13:11.578141 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
where SYMBOL is null



        );
[0m21:13:11.578596 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:11.594538 [info ] [Thread-2 (]: 12 of 35 PASS dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [[32mPASS[0m in 1.37s]
[0m21:13:11.595360 [debug] [Thread-2 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:13:11.595995 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:13:11.596524 [info ] [Thread-2 (]: 15 of 35 START test not_null_int_daily_returns_DATE ............................ [RUN]
[0m21:13:11.597221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b, now test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54)
[0m21:13:11.597664 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:13:11.601161 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:13:11.602168 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:13:11.603759 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
[0m21:13:11.604843 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:13:11.605184 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
where DATE is null



        );
[0m21:13:11.605471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:11.612987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m21:13:11.614669 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: Close
[0m21:13:11.650979 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m21:13:11.651848 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:13:11.652788 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:13:11.653122 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
    
      
    ) dbt_internal_test
[0m21:13:11.752107 [info ] [Thread-1 (]: 11 of 35 PASS dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [[32mPASS[0m in 1.56s]
[0m21:13:11.753219 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:13:11.753941 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:13:11.754472 [info ] [Thread-1 (]: 16 of 35 START test not_null_int_daily_returns_SYMBOL .......................... [RUN]
[0m21:13:11.755078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12, now test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2)
[0m21:13:11.755525 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:13:11.759011 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:13:11.760163 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:13:11.763276 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
[0m21:13:11.764349 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:13:11.764674 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
where SYMBOL is null



        );
[0m21:13:11.765016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:11.979886 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m21:13:11.982484 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: Close
[0m21:13:12.073337 [info ] [Thread-3 (]: 13 of 35 PASS not_null_int_bollinger_DATE ...................................... [[32mPASS[0m in 1.29s]
[0m21:13:12.075218 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:13:12.076069 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:13:12.076813 [info ] [Thread-3 (]: 17 of 35 START test not_null_int_macd_DATE ..................................... [RUN]
[0m21:13:12.077785 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac, now test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b)
[0m21:13:12.078368 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:13:12.082963 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:13:12.084318 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:13:12.086412 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
[0m21:13:12.087807 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:13:12.088223 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_macd
where DATE is null



        );
[0m21:13:12.088600 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:12.521681 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.943 seconds
[0m21:13:12.525258 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:13:12.529026 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:13:12.529961 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
    
      
    ) dbt_internal_test
[0m21:13:12.575688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m21:13:12.578535 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m21:13:12.583237 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:13:12.586373 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:13:12.588778 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:13:12.589610 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
    
      
    ) dbt_internal_test
[0m21:13:12.590515 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:13:12.593004 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
    
      
    ) dbt_internal_test
[0m21:13:12.679626 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m21:13:12.680865 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: Close
[0m21:13:12.715287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m21:13:12.718122 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: Close
[0m21:13:12.751151 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m21:13:12.752484 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: Close
[0m21:13:12.805152 [info ] [Thread-4 (]: 14 of 35 PASS not_null_int_bollinger_SYMBOL .................................... [[32mPASS[0m in 1.24s]
[0m21:13:12.805780 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:13:12.806127 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:13:12.806432 [info ] [Thread-4 (]: 18 of 35 START test not_null_int_macd_SYMBOL ................................... [RUN]
[0m21:13:12.806770 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443, now test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2)
[0m21:13:12.807079 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:13:12.809595 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:13:12.810407 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:13:12.811737 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
[0m21:13:12.812550 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:13:12.812823 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_macd
where SYMBOL is null



        );
[0m21:13:12.813084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:12.866318 [info ] [Thread-2 (]: 15 of 35 PASS not_null_int_daily_returns_DATE .................................. [[32mPASS[0m in 1.27s]
[0m21:13:12.866933 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:13:12.867256 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:13:12.867556 [info ] [Thread-2 (]: 19 of 35 START test not_null_int_moving_averages_DATE .......................... [RUN]
[0m21:13:12.867962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54, now test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4)
[0m21:13:12.868207 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:13:12.870287 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:13:12.870909 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:13:12.871947 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
[0m21:13:12.872656 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:13:12.872869 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
where DATE is null



        );
[0m21:13:12.873105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:12.879831 [info ] [Thread-1 (]: 16 of 35 PASS not_null_int_daily_returns_SYMBOL ................................ [[32mPASS[0m in 1.12s]
[0m21:13:12.880326 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:13:12.880609 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:13:12.880872 [info ] [Thread-1 (]: 20 of 35 START test not_null_int_moving_averages_SYMBOL ........................ [RUN]
[0m21:13:12.881261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2, now test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a)
[0m21:13:12.881506 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:13:12.883764 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:13:12.884498 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:13:12.886429 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
[0m21:13:12.887352 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:13:12.887734 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
where SYMBOL is null



        );
[0m21:13:12.888094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:12.942722 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.854 seconds
[0m21:13:12.943622 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:13:12.944464 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:13:12.944720 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
    
      
    ) dbt_internal_test
[0m21:13:13.074074 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m21:13:13.076510 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: Close
[0m21:13:13.229806 [info ] [Thread-3 (]: 17 of 35 PASS not_null_int_macd_DATE ........................................... [[32mPASS[0m in 1.15s]
[0m21:13:13.231138 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:13:13.231796 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:13:13.232401 [info ] [Thread-3 (]: 21 of 35 START test not_null_int_rsi_DATE ...................................... [RUN]
[0m21:13:13.233165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b, now test.stock_analytics.not_null_int_rsi_DATE.1856743a58)
[0m21:13:13.233631 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:13:13.237584 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:13:13.238700 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:13:13.240596 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
[0m21:13:13.241807 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:13:13.242231 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_rsi
where DATE is null



        );
[0m21:13:13.242610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:13.810717 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.997 seconds
[0m21:13:13.813116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.925 seconds
[0m21:13:13.815645 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:13:13.818213 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:13:13.822834 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:13:13.823816 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:13:13.824631 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
    
      
    ) dbt_internal_test
[0m21:13:13.825421 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
    
      
    ) dbt_internal_test
[0m21:13:13.848515 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.975 seconds
[0m21:13:13.850392 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:13:13.852302 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:13:13.852921 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
    
      
    ) dbt_internal_test
[0m21:13:13.947788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m21:13:13.949788 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m21:13:13.953433 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: Close
[0m21:13:13.957425 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: Close
[0m21:13:14.003834 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m21:13:14.005520 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: Close
[0m21:13:14.100384 [info ] [Thread-1 (]: 20 of 35 PASS not_null_int_moving_averages_SYMBOL .............................. [[32mPASS[0m in 1.22s]
[0m21:13:14.101384 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:13:14.101767 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:13:14.102179 [info ] [Thread-1 (]: 22 of 35 START test not_null_int_rsi_SYMBOL .................................... [RUN]
[0m21:13:14.102750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a, now test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035)
[0m21:13:14.103084 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:13:14.106061 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:13:14.106855 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:13:14.108580 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
[0m21:13:14.109468 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:13:14.109981 [info ] [Thread-4 (]: 18 of 35 PASS not_null_int_macd_SYMBOL ......................................... [[32mPASS[0m in 1.30s]
[0m21:13:14.110408 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_rsi
where SYMBOL is null



        );
[0m21:13:14.110797 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:13:14.111069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:14.111376 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:13:14.112833 [info ] [Thread-4 (]: 23 of 35 START test not_null_mart_stock_daily_metrics_CLOSE .................... [RUN]
[0m21:13:14.113432 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2, now test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9)
[0m21:13:14.113766 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:13:14.116412 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:13:14.117332 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:13:14.119188 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
[0m21:13:14.120131 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:13:14.120385 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where CLOSE is null



        );
[0m21:13:14.120603 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:14.134953 [info ] [Thread-2 (]: 19 of 35 PASS not_null_int_moving_averages_DATE ................................ [[32mPASS[0m in 1.27s]
[0m21:13:14.135708 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:13:14.136010 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:13:14.136295 [info ] [Thread-2 (]: 24 of 35 START test not_null_mart_stock_daily_metrics_DATE ..................... [RUN]
[0m21:13:14.136654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4, now test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510)
[0m21:13:14.136889 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:13:14.139207 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:13:14.139885 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:13:14.141865 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
[0m21:13:14.142598 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:13:14.142812 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where DATE is null



        );
[0m21:13:14.143025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:14.342882 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m21:13:14.345871 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:13:14.347707 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:13:14.348261 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
    
      
    ) dbt_internal_test
[0m21:13:14.631534 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m21:13:14.636880 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: Close
[0m21:13:14.789668 [info ] [Thread-3 (]: 21 of 35 PASS not_null_int_rsi_DATE ............................................ [[32mPASS[0m in 1.56s]
[0m21:13:14.793621 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:13:14.795156 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:13:14.796422 [info ] [Thread-3 (]: 25 of 35 START test not_null_mart_stock_daily_metrics_PRICE_TREND .............. [RUN]
[0m21:13:14.798187 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_DATE.1856743a58, now test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200)
[0m21:13:14.798925 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:13:14.805275 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:13:14.806724 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:13:14.809125 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
[0m21:13:14.810717 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:13:14.811131 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where PRICE_TREND is null



        );
[0m21:13:14.811590 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:14.963766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m21:13:14.965482 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:13:14.966943 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:13:14.967361 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
    
      
    ) dbt_internal_test
[0m21:13:15.111097 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m21:13:15.113952 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:13:15.116094 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:13:15.116804 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
    
      
    ) dbt_internal_test
[0m21:13:15.132541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m21:13:15.135500 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: Close
[0m21:13:15.186033 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.043 seconds
[0m21:13:15.188998 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:13:15.191233 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:13:15.192022 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
    
      
    ) dbt_internal_test
[0m21:13:15.236226 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m21:13:15.240213 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: Close
[0m21:13:15.281263 [info ] [Thread-1 (]: 22 of 35 PASS not_null_int_rsi_SYMBOL .......................................... [[32mPASS[0m in 1.18s]
[0m21:13:15.283230 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:13:15.284268 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:13:15.285078 [info ] [Thread-1 (]: 26 of 35 START test not_null_mart_stock_daily_metrics_SYMBOL ................... [RUN]
[0m21:13:15.286128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035, now test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435)
[0m21:13:15.287061 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:13:15.296662 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:13:15.297988 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:13:15.299417 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
[0m21:13:15.300323 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:13:15.300563 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where SYMBOL is null



        );
[0m21:13:15.300789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:15.330128 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m21:13:15.331448 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: Close
[0m21:13:15.461263 [info ] [Thread-2 (]: 24 of 35 PASS not_null_mart_stock_daily_metrics_DATE ........................... [[32mPASS[0m in 1.32s]
[0m21:13:15.462993 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:13:15.463841 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571
[0m21:13:15.464667 [info ] [Thread-2 (]: 27 of 35 START test not_null_mart_stock_daily_metrics_TRADING_SIGNAL ........... [RUN]
[0m21:13:15.465545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510, now test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571)
[0m21:13:15.466308 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571
[0m21:13:15.471783 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571"
[0m21:13:15.473320 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571
[0m21:13:15.474681 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_TRADING_SIGNAL
[0m21:13:15.475517 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571"
[0m21:13:15.475754 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_TRADING_SIGNAL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where TRADING_SIGNAL is null



        );
[0m21:13:15.475963 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:15.486038 [info ] [Thread-4 (]: 23 of 35 PASS not_null_mart_stock_daily_metrics_CLOSE .......................... [[32mPASS[0m in 1.37s]
[0m21:13:15.486732 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:13:15.487093 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:13:15.487403 [info ] [Thread-4 (]: 28 of 35 START test not_null_stg_stock_daily_CLOSE ............................. [RUN]
[0m21:13:15.487757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9, now test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75)
[0m21:13:15.488005 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:13:15.490155 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:13:15.490962 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:13:15.493150 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
[0m21:13:15.493874 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:13:15.494128 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where CLOSE is null



        );
[0m21:13:15.494349 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:15.593935 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m21:13:15.594938 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:13:15.595852 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:13:15.596158 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
    
      
    ) dbt_internal_test
[0m21:13:15.728636 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m21:13:15.733088 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: Close
[0m21:13:15.849215 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c03d59-0106-ec42-000f-c0df0070e14e
[0m21:13:15.852508 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 6
invalid identifier 'TRADING_SIGNAL'
[0m21:13:15.854933 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571: Close
[0m21:13:15.882735 [info ] [Thread-3 (]: 25 of 35 PASS not_null_mart_stock_daily_metrics_PRICE_TREND .................... [[32mPASS[0m in 1.08s]
[0m21:13:15.885097 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:13:15.885994 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:13:15.886832 [info ] [Thread-3 (]: 29 of 35 START test not_null_stg_stock_daily_DAILY_CHANGE_PCT .................. [RUN]
[0m21:13:15.887941 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200, now test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285)
[0m21:13:15.888579 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:13:15.893582 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:13:15.894830 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:13:15.896949 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
[0m21:13:15.898277 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:13:15.898645 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DAILY_CHANGE_PCT is null



        );
[0m21:13:15.898967 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:15.969804 [debug] [Thread-2 (]: Database Error in test not_null_mart_stock_daily_metrics_TRADING_SIGNAL (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 6
  invalid identifier 'TRADING_SIGNAL'
[0m21:13:15.970444 [error] [Thread-2 (]: 27 of 35 ERROR not_null_mart_stock_daily_metrics_TRADING_SIGNAL ................ [[31mERROR[0m in 0.51s]
[0m21:13:15.971210 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571
[0m21:13:15.971617 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:13:15.972096 [info ] [Thread-2 (]: 30 of 35 START test not_null_stg_stock_daily_DATA_QUALITY_FLAG ................. [RUN]
[0m21:13:15.972597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571, now test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291)
[0m21:13:15.972973 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:13:15.975760 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:13:15.976720 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:13:15.978170 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
[0m21:13:15.979151 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:13:15.979415 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DATA_QUALITY_FLAG is null



        );
[0m21:13:15.979677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:16.015887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m21:13:16.019761 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:13:16.020931 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:13:16.023034 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
    
      
    ) dbt_internal_test
[0m21:13:16.176854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m21:13:16.180778 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: Close
[0m21:13:16.256513 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m21:13:16.265053 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:13:16.267320 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:13:16.267970 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
    
      
    ) dbt_internal_test
[0m21:13:16.321239 [info ] [Thread-1 (]: 26 of 35 PASS not_null_mart_stock_daily_metrics_SYMBOL ......................... [[32mPASS[0m in 1.03s]
[0m21:13:16.323391 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:13:16.324757 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:13:16.325614 [info ] [Thread-1 (]: 31 of 35 START test not_null_stg_stock_daily_DATE .............................. [RUN]
[0m21:13:16.326809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435, now test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022)
[0m21:13:16.327445 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:13:16.334039 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:13:16.336028 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:13:16.338548 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
[0m21:13:16.340185 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:13:16.340664 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DATE is null



        );
[0m21:13:16.341086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:16.399442 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m21:13:16.401662 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: Close
[0m21:13:16.571650 [info ] [Thread-4 (]: 28 of 35 PASS not_null_stg_stock_daily_CLOSE ................................... [[32mPASS[0m in 1.08s]
[0m21:13:16.575080 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:13:16.576517 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:13:16.577575 [info ] [Thread-4 (]: 32 of 35 START test not_null_stg_stock_daily_SYMBOL ............................ [RUN]
[0m21:13:16.579004 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75, now test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0)
[0m21:13:16.579986 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:13:16.587782 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:13:16.589603 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:13:16.594379 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
[0m21:13:16.596064 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:13:16.596581 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where SYMBOL is null



        );
[0m21:13:16.597069 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:16.672006 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m21:13:16.673728 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:13:16.675352 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:13:16.675808 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
    
      
    ) dbt_internal_test
[0m21:13:16.818145 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m21:13:16.822462 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: Close
[0m21:13:16.984611 [info ] [Thread-3 (]: 29 of 35 PASS not_null_stg_stock_daily_DAILY_CHANGE_PCT ........................ [[32mPASS[0m in 1.10s]
[0m21:13:16.986521 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:13:16.987484 [debug] [Thread-3 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:13:16.989180 [info ] [Thread-3 (]: 33 of 35 START test source_not_null_raw_fact_stock_price_daily_CLOSE ........... [RUN]
[0m21:13:16.992195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178)
[0m21:13:16.993266 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:13:17.006477 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:13:17.008478 [debug] [Thread-3 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:13:17.011171 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
[0m21:13:17.012642 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:13:17.013033 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where CLOSE is null



        );
[0m21:13:17.013314 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:17.096647 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m21:13:17.098602 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:13:17.100100 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:13:17.100574 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
    
      
    ) dbt_internal_test
[0m21:13:17.238417 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m21:13:17.241988 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: Close
[0m21:13:17.367507 [info ] [Thread-2 (]: 30 of 35 PASS not_null_stg_stock_daily_DATA_QUALITY_FLAG ....................... [[32mPASS[0m in 1.39s]
[0m21:13:17.369143 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:13:17.370114 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:13:17.370945 [info ] [Thread-2 (]: 34 of 35 START test source_not_null_raw_fact_stock_price_daily_DATE ............ [RUN]
[0m21:13:17.372410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198)
[0m21:13:17.373058 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:13:17.379148 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:13:17.381151 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:13:17.383779 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
[0m21:13:17.385426 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:13:17.385988 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where DATE is null



        );
[0m21:13:17.386503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:17.439610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.098 seconds
[0m21:13:17.441737 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:13:17.443429 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:13:17.443912 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
    
      
    ) dbt_internal_test
[0m21:13:17.498988 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.902 seconds
[0m21:13:17.500712 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:13:17.503313 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:13:17.503794 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m21:13:17.611635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m21:13:17.616132 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: Close
[0m21:13:17.642569 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m21:13:17.644907 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: Close
[0m21:13:17.763624 [info ] [Thread-1 (]: 31 of 35 PASS not_null_stg_stock_daily_DATE .................................... [[32mPASS[0m in 1.44s]
[0m21:13:17.766003 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:13:17.767329 [debug] [Thread-1 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:13:17.767990 [info ] [Thread-1 (]: 35 of 35 START test source_not_null_raw_fact_stock_price_daily_SYMBOL .......... [RUN]
[0m21:13:17.769143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a)
[0m21:13:17.770058 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:13:17.777508 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:13:17.779525 [debug] [Thread-1 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:13:17.783627 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
[0m21:13:17.787038 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:13:17.788210 [info ] [Thread-4 (]: 32 of 35 PASS not_null_stg_stock_daily_SYMBOL .................................. [[32mPASS[0m in 1.21s]
[0m21:13:17.789475 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where SYMBOL is null



        );
[0m21:13:17.791883 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:13:17.792721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:17.978041 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.965 seconds
[0m21:13:17.979511 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:13:17.982090 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:13:17.982427 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
    
      
    ) dbt_internal_test
[0m21:13:18.151646 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m21:13:18.156388 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: Close
[0m21:13:18.165055 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m21:13:18.166962 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:13:18.169765 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:13:18.170404 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
    
      
    ) dbt_internal_test
[0m21:13:18.255357 [info ] [Thread-3 (]: 33 of 35 PASS source_not_null_raw_fact_stock_price_daily_CLOSE ................. [[32mPASS[0m in 1.26s]
[0m21:13:18.257333 [debug] [Thread-3 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:13:18.317175 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m21:13:18.322248 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: Close
[0m21:13:18.487488 [info ] [Thread-2 (]: 34 of 35 PASS source_not_null_raw_fact_stock_price_daily_DATE .................. [[32mPASS[0m in 1.11s]
[0m21:13:18.490457 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:13:18.666114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.873 seconds
[0m21:13:18.669814 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:13:18.672436 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:13:18.673305 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m21:13:18.839596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m21:13:18.843973 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: Close
[0m21:13:18.984855 [info ] [Thread-1 (]: 35 of 35 PASS source_not_null_raw_fact_stock_price_daily_SYMBOL ................ [[32mPASS[0m in 1.22s]
[0m21:13:18.987637 [debug] [Thread-1 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:13:18.993008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:18.993939 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178' was properly closed.
[0m21:13:18.994562 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a' was properly closed.
[0m21:13:18.995079 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198' was properly closed.
[0m21:13:18.995548 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0' was properly closed.
[0m21:13:18.996142 [info ] [MainThread]: 
[0m21:13:18.997214 [info ] [MainThread]: Finished running 35 data tests in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m21:13:19.001914 [debug] [MainThread]: Command end result
[0m21:13:19.044156 [info ] [MainThread]: 
[0m21:13:19.044914 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:13:19.045311 [info ] [MainThread]: 
[0m21:13:19.045697 [error] [MainThread]:   Database Error in test accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'TRADING_SIGNAL'
[0m21:13:19.046098 [info ] [MainThread]: 
[0m21:13:19.046426 [error] [MainThread]:   Database Error in test not_null_mart_stock_daily_metrics_TRADING_SIGNAL (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 6
  invalid identifier 'TRADING_SIGNAL'
[0m21:13:19.046864 [info ] [MainThread]: 
[0m21:13:19.047488 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=2 SKIP=0 TOTAL=35
[0m21:13:19.049056 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 14.408852, "process_user_time": 3.952607, "process_kernel_time": 0.368249, "process_mem_max_rss": "236828", "process_in_blocks": "1200", "process_out_blocks": "3235", "command_success": false}
[0m21:13:19.049520 [debug] [MainThread]: Command `dbt test` failed at 21:13:19.049445 after 14.41 seconds
[0m21:13:19.049872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f03380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb464d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d81eb0>]}
[0m21:13:19.050206 [debug] [MainThread]: Flushing usage events
[0m21:18:22.648110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad014560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb50bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0153a0>]}


============================== 21:18:22.652897 | cace3c4e-f649-47ec-82e5-696964752d5b ==============================
[0m21:18:22.652897 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:18:22.653611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:23.088209 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:18:23.089021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cace3c4e-f649-47ec-82e5-696964752d5b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9677a1e0>]}
[0m21:18:23.120590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cace3c4e-f649-47ec-82e5-696964752d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91aa12e0>]}
[0m21:18:23.144453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cace3c4e-f649-47ec-82e5-696964752d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9677a120>]}
[0m21:18:23.145123 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:18:23.160931 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:18:23.311740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:23.312278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:23.340803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cace3c4e-f649-47ec-82e5-696964752d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be0c410>]}
[0m21:18:23.423060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cace3c4e-f649-47ec-82e5-696964752d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9029ac30>]}
[0m21:18:23.423500 [info ] [MainThread]: Found 35 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:18:23.424302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cace3c4e-f649-47ec-82e5-696964752d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9677aae0>]}
[0m21:18:23.426059 [info ] [MainThread]: 
[0m21:18:23.426717 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:23.429831 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:18:23.437319 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:18:23.437738 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:18:23.438055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:24.098447 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.660 seconds
[0m21:18:24.102939 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:18:24.277463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m21:18:24.279024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m21:18:24.283129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m21:18:24.292792 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:18:24.293640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m21:18:24.295786 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:18:24.297897 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:18:24.298470 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:18:24.300252 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:18:24.300697 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:18:24.301132 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:18:24.301586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:24.302009 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:18:24.302419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:24.302810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:24.304531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:24.770609 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.468 seconds
[0m21:18:24.774864 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:18:24.779705 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.477 seconds
[0m21:18:24.782983 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:18:24.788075 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.486 seconds
[0m21:18:24.789752 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:18:24.805027 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 0.500 seconds
[0m21:18:24.808348 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:18:24.934148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cace3c4e-f649-47ec-82e5-696964752d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be8ee70>]}
[0m21:18:24.935968 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:18:24.937837 [info ] [MainThread]: 
[0m21:18:24.950874 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:18:24.951625 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:18:24.952316 [debug] [Thread-3 (]: Began running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:18:24.953077 [debug] [Thread-4 (]: Began running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:18:24.953567 [info ] [Thread-1 (]: 1 of 35 START test accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [RUN]
[0m21:18:24.954470 [info ] [Thread-2 (]: 2 of 35 START test accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [RUN]
[0m21:18:24.955082 [info ] [Thread-3 (]: 3 of 35 START test accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL  [RUN]
[0m21:18:24.955686 [info ] [Thread-4 (]: 4 of 35 START test accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [RUN]
[0m21:18:24.956420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6)
[0m21:18:24.956935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef)
[0m21:18:24.957429 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859)
[0m21:18:24.957877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a)
[0m21:18:24.958302 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:18:24.958868 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:18:24.959268 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:18:24.959687 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:18:24.971743 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:18:24.974823 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:18:24.978445 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:18:24.981781 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:18:24.984571 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:18:24.984922 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:18:25.018956 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MOVING_AVE_6CA08515D89550A8F253DD31743BCB67"
[0m21:18:25.019323 [debug] [Thread-3 (]: Began executing node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:18:25.019683 [debug] [Thread-4 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:18:25.021949 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MACD_03D76AC49786AFFDB0C9DCED06432A11"
[0m21:18:25.025358 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:18:25.027462 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_RSI_E03F19197F66DE5A3784EE911F15DCB3"
[0m21:18:25.030136 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_MART_STOCK_DAI_7F3B5CE4F2B7B009A1EB3E6E2DF356F8"
[0m21:18:25.030778 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:18:25.031067 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MOVING_AVE_6CA08515D89550A8F253DD31743BCB67" cascade
[0m21:18:25.031650 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:18:25.032242 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:18:25.032549 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MACD_03D76AC49786AFFDB0C9DCED06432A11" cascade
[0m21:18:25.032867 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:25.033149 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_RSI_E03F19197F66DE5A3784EE911F15DCB3" cascade
[0m21:18:25.033462 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_MART_STOCK_DAI_7F3B5CE4F2B7B009A1EB3E6E2DF356F8" cascade
[0m21:18:25.033748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:25.035338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:25.035692 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:25.424796 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m21:18:25.427078 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
[0m21:18:25.437759 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:18:25.438144 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
         as
        (
    
    

with all_values as (

    select
        PRICE_TREND as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by PRICE_TREND

)

select *
from all_values
where value_field not in (
    'STRONG_UPTREND','UPTREND','SIDEWAYS','DOWNTREND','STRONG_DOWNTREND'
)



        );
[0m21:18:25.537760 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m21:18:25.538975 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m21:18:25.540260 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
[0m21:18:25.541384 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
[0m21:18:25.543029 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:18:25.544705 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:18:25.545275 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
         as
        (
    
    

with all_values as (

    select
        RSI_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_rsi where RSI_SIGNAL IS NOT NULL) dbt_subquery
    group by RSI_SIGNAL

)

select *
from all_values
where value_field not in (
    'OVERBOUGHT','OVERSOLD','NEUTRAL'
)



        );
[0m21:18:25.545794 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
         as
        (
    
    

with all_values as (

    select
        MA_CROSS_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages where MA_CROSS_SIGNAL IS NOT NULL) dbt_subquery
    group by MA_CROSS_SIGNAL

)

select *
from all_values
where value_field not in (
    'GOLDEN_CROSS','DEATH_CROSS','NEUTRAL'
)



        );
[0m21:18:25.657904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m21:18:25.658823 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
[0m21:18:25.660088 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:18:25.660507 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
         as
        (
    
    

with all_values as (

    select
        MACD_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_macd where MACD_SIGNAL IS NOT NULL) dbt_subquery
    group by MACD_SIGNAL

)

select *
from all_values
where value_field not in (
    'BULLISH_CROSSOVER','BEARISH_CROSSOVER','BULLISH','BEARISH','NEUTRAL'
)



        );
[0m21:18:26.777746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.118 seconds
[0m21:18:26.779423 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.235 seconds
[0m21:18:26.787783 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:18:26.790470 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:18:26.795868 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:18:26.796750 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:18:26.797366 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
    
      
    ) dbt_internal_test
[0m21:18:26.797965 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
    
      
    ) dbt_internal_test
[0m21:18:26.839078 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.293 seconds
[0m21:18:26.840883 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:18:26.842491 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:18:26.843067 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
    
      
    ) dbt_internal_test
[0m21:18:26.971504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m21:18:26.973208 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m21:18:26.988585 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: Close
[0m21:18:26.991118 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: Close
[0m21:18:27.006663 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.570 seconds
[0m21:18:27.008370 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:18:27.010241 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:18:27.010762 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
    
      
    ) dbt_internal_test
[0m21:18:27.029159 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m21:18:27.031324 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: Close
[0m21:18:27.112663 [info ] [Thread-3 (]: 3 of 35 PASS accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL . [[32mPASS[0m in 2.15s]
[0m21:18:27.114793 [debug] [Thread-3 (]: Finished running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:18:27.115658 [debug] [Thread-3 (]: Began running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31
[0m21:18:27.116460 [info ] [Thread-3 (]: 5 of 35 START test accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL  [RUN]
[0m21:18:27.117439 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859, now test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31)
[0m21:18:27.118169 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31
[0m21:18:27.125692 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31"
[0m21:18:27.127063 [debug] [Thread-3 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31
[0m21:18:27.129403 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_fc1680f73a04372ce9c25cfa3498d480
[0m21:18:27.130909 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31"
[0m21:18:27.131339 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_fc1680f73a04372ce9c25cfa3498d480
         as
        (
    
    

with all_values as (

    select
        TRADING_SIGNAL as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by TRADING_SIGNAL

)

select *
from all_values
where value_field not in (
    'STRONG_BUY','BUY','HOLD','SELL','STRONG_SELL'
)



        );
[0m21:18:27.131774 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:27.137947 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m21:18:27.139992 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: Close
[0m21:18:27.150279 [info ] [Thread-1 (]: 1 of 35 PASS accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [[32mPASS[0m in 2.19s]
[0m21:18:27.151245 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:18:27.151876 [info ] [Thread-2 (]: 2 of 35 PASS accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [[32mPASS[0m in 2.19s]
[0m21:18:27.152436 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:18:27.153011 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:18:27.153443 [info ] [Thread-1 (]: 6 of 35 START test accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [RUN]
[0m21:18:27.153937 [debug] [Thread-2 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:18:27.154366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6, now test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987)
[0m21:18:27.154783 [info ] [Thread-2 (]: 7 of 35 START test dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE  [RUN]
[0m21:18:27.155243 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:18:27.155654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1)
[0m21:18:27.160243 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:18:27.160687 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:18:27.165494 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:18:27.166541 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:18:27.166918 [debug] [Thread-2 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:18:27.170010 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_STG_STOCK_DAIL_56D0AB7DE46C8DB0B014849697C2711B"
[0m21:18:27.172273 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_LOWER___BB_MIDDLE"
[0m21:18:27.173022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:18:27.174070 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:18:27.174382 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_STG_STOCK_DAIL_56D0AB7DE46C8DB0B014849697C2711B" cascade
[0m21:18:27.174696 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_LOWER___BB_MIDDLE" cascade
[0m21:18:27.174996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:27.175275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:27.289771 [info ] [Thread-4 (]: 4 of 35 PASS accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [[32mPASS[0m in 2.33s]
[0m21:18:27.290541 [debug] [Thread-4 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:18:27.290957 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:18:27.291346 [info ] [Thread-4 (]: 8 of 35 START test dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE  [RUN]
[0m21:18:27.291804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c)
[0m21:18:27.292178 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:18:27.295298 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:18:27.296184 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:18:27.298455 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_UPPER___BB_MIDDLE"
[0m21:18:27.299134 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:18:27.299429 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_UPPER___BB_MIDDLE" cascade
[0m21:18:27.299732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:27.485366 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c03d5e-0106-eb86-000f-c0df006faa82
[0m21:18:27.485887 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 8
invalid identifier 'TRADING_SIGNAL'
[0m21:18:27.486373 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31: Close
[0m21:18:27.604801 [debug] [Thread-3 (]: Database Error in test accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'TRADING_SIGNAL'
[0m21:18:27.605730 [error] [Thread-3 (]: 5 of 35 ERROR accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL  [[31mERROR[0m in 0.49s]
[0m21:18:27.606837 [debug] [Thread-3 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31
[0m21:18:27.607397 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:18:27.608560 [info ] [Thread-3 (]: 9 of 35 START test dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0  [RUN]
[0m21:18:27.609216 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL.a577608c31, now test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d)
[0m21:18:27.609726 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:18:27.614347 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:18:27.616916 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:18:27.619921 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_I_073ECBDFB3F8461B722A2236FFC246EF"
[0m21:18:27.621948 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:18:27.622334 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_I_073ECBDFB3F8461B722A2236FFC246EF" cascade
[0m21:18:27.622707 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:27.628543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m21:18:27.629818 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
[0m21:18:27.630995 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:18:27.631344 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
         as
        (
    
    

with all_values as (

    select
        DATA_QUALITY_FLAG as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    group by DATA_QUALITY_FLAG

)

select *
from all_values
where value_field not in (
    'VALID','INVALID','ANOMALY','MISSING','NO_TRADING'
)



        );
[0m21:18:27.797870 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m21:18:27.799997 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
[0m21:18:27.802825 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:18:27.803854 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m21:18:27.804590 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger where BB_UPPER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_UPPER > BB_MIDDLE)


        );
[0m21:18:27.806029 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
[0m21:18:27.809222 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:18:27.809866 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger where BB_LOWER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_LOWER < BB_MIDDLE)


        );
[0m21:18:28.309613 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m21:18:28.313767 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
[0m21:18:28.375474 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:18:28.376010 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns where VOLATILITY_20D IS NOT NULL) dbt_subquery

where not(VOLATILITY_20D >= 0)


        );
[0m21:18:28.822758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.191 seconds
[0m21:18:28.826401 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:18:28.832266 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:18:28.833400 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
    
      
    ) dbt_internal_test
[0m21:18:28.950312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m21:18:28.954922 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: Close
[0m21:18:29.071642 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m21:18:29.073591 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:18:29.076533 [info ] [Thread-1 (]: 6 of 35 PASS accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [[32mPASS[0m in 1.92s]
[0m21:18:29.077874 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:18:29.078498 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:18:29.079035 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:18:29.079552 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m21:18:29.080077 [info ] [Thread-1 (]: 10 of 35 START test dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100  [RUN]
[0m21:18:29.081939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987, now test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb)
[0m21:18:29.082442 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:18:29.083410 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.277 seconds
[0m21:18:29.087150 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:18:29.088319 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:18:29.089457 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:18:29.090056 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:18:29.092758 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_RSI_RSI_14__BETWEEN_0_AND_100"
[0m21:18:29.093128 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m21:18:29.093944 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:18:29.095023 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_RSI_RSI_14__BETWEEN_0_AND_100" cascade
[0m21:18:29.095392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:29.113011 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m21:18:29.114046 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:18:29.115964 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:18:29.116307 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
    
      
    ) dbt_internal_test
[0m21:18:29.200936 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m21:18:29.202892 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: Close
[0m21:18:29.238435 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m21:18:29.239500 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m21:18:29.241139 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: Close
[0m21:18:29.242793 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: Close
[0m21:18:29.348503 [info ] [Thread-4 (]: 8 of 35 PASS dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE ... [[32mPASS[0m in 2.06s]
[0m21:18:29.349304 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:18:29.349627 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:18:29.349946 [info ] [Thread-4 (]: 11 of 35 START test dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [RUN]
[0m21:18:29.350269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c, now test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12)
[0m21:18:29.350501 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:18:29.357651 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:18:29.359824 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:18:29.364237 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_C9286FF21D21C3798E9AC65985930CF6"
[0m21:18:29.365182 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:18:29.365570 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_C9286FF21D21C3798E9AC65985930CF6" cascade
[0m21:18:29.365970 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:29.530565 [info ] [Thread-2 (]: 7 of 35 PASS dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE ... [[32mPASS[0m in 2.37s]
[0m21:18:29.532206 [debug] [Thread-2 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:18:29.532899 [debug] [Thread-2 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:18:29.533505 [info ] [Thread-2 (]: 12 of 35 START test dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [RUN]
[0m21:18:29.534300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1, now test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b)
[0m21:18:29.534938 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:18:29.539216 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:18:29.541933 [debug] [Thread-2 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:18:29.546321 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_1CD5BBDAE1662B4E1877B262934E23BF"
[0m21:18:29.547266 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:18:29.547673 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_1CD5BBDAE1662B4E1877B262934E23BF" cascade
[0m21:18:29.548088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:29.621812 [info ] [Thread-3 (]: 9 of 35 PASS dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0 . [[32mPASS[0m in 2.01s]
[0m21:18:29.622854 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:18:29.623294 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:18:29.623702 [info ] [Thread-3 (]: 13 of 35 START test not_null_int_bollinger_DATE ................................ [RUN]
[0m21:18:29.624160 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d, now test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac)
[0m21:18:29.624473 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:18:29.628734 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:18:29.629610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m21:18:29.632594 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
[0m21:18:29.633578 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:18:29.633829 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:18:29.634119 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_rsi where RSI_14 IS NOT NULL) dbt_subquery

where not(RSI_14 BETWEEN 0 AND 100)


        );
[0m21:18:29.636319 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_DATE"
[0m21:18:29.637602 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:18:29.637964 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_DATE" cascade
[0m21:18:29.638235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:29.941307 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m21:18:29.944390 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
[0m21:18:29.947960 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:18:29.949004 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m21:18:30.113123 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m21:18:30.115907 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
[0m21:18:30.118804 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:18:30.119818 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m21:18:30.170996 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m21:18:30.173826 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
[0m21:18:30.176929 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:18:30.177763 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
where DATE is null



        );
[0m21:18:30.496881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m21:18:30.500308 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:18:30.502302 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:18:30.502851 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
    
      
    ) dbt_internal_test
[0m21:18:30.641972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m21:18:30.644840 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: Close
[0m21:18:30.651636 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m21:18:30.652776 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:18:30.654098 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:18:30.654477 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
    
      
    ) dbt_internal_test
[0m21:18:30.723229 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m21:18:30.725119 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:18:30.727189 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:18:30.727814 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
    
      
    ) dbt_internal_test
[0m21:18:30.761713 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m21:18:30.764178 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: Close
[0m21:18:30.788436 [info ] [Thread-1 (]: 10 of 35 PASS dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100 ... [[32mPASS[0m in 1.71s]
[0m21:18:30.791010 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:18:30.791706 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:18:30.792280 [info ] [Thread-1 (]: 14 of 35 START test not_null_int_bollinger_SYMBOL .............................. [RUN]
[0m21:18:30.792992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb, now test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443)
[0m21:18:30.793516 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:18:30.798728 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:18:30.799965 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:18:30.803378 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_SYMBOL"
[0m21:18:30.804386 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:18:30.805700 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_SYMBOL" cascade
[0m21:18:30.806393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:30.849221 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m21:18:30.851412 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: Close
[0m21:18:30.893458 [info ] [Thread-4 (]: 11 of 35 PASS dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [[32mPASS[0m in 1.54s]
[0m21:18:30.894509 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:18:30.895020 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:18:30.895455 [info ] [Thread-4 (]: 15 of 35 START test not_null_int_daily_returns_DATE ............................ [RUN]
[0m21:18:30.896544 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m21:18:30.896940 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12, now test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54)
[0m21:18:30.898174 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:18:30.898566 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:18:30.901914 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:18:30.902873 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:18:30.903705 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
    
      
    ) dbt_internal_test
[0m21:18:30.903982 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:18:30.908536 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_DATE"
[0m21:18:30.909598 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:18:30.910144 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_DATE" cascade
[0m21:18:30.910558 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:30.990325 [info ] [Thread-3 (]: 13 of 35 PASS not_null_int_bollinger_DATE ...................................... [[32mPASS[0m in 1.37s]
[0m21:18:30.991297 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:18:30.991758 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:18:30.992202 [info ] [Thread-3 (]: 16 of 35 START test not_null_int_daily_returns_SYMBOL .......................... [RUN]
[0m21:18:30.992749 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac, now test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2)
[0m21:18:30.993113 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:18:30.996054 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:18:30.997020 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:18:30.999439 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_SYMBOL"
[0m21:18:31.000161 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:18:31.000467 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_SYMBOL" cascade
[0m21:18:31.000752 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:31.021220 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m21:18:31.022752 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: Close
[0m21:18:31.140756 [info ] [Thread-2 (]: 12 of 35 PASS dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [[32mPASS[0m in 1.61s]
[0m21:18:31.141628 [debug] [Thread-2 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:18:31.142088 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:18:31.142488 [info ] [Thread-2 (]: 17 of 35 START test not_null_int_macd_DATE ..................................... [RUN]
[0m21:18:31.143106 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b, now test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b)
[0m21:18:31.143523 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:18:31.146690 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:18:31.148467 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:18:31.151148 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_DATE"
[0m21:18:31.151913 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:18:31.152228 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_DATE" cascade
[0m21:18:31.152536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:31.234440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m21:18:31.235560 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
[0m21:18:31.236922 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:18:31.237378 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
where SYMBOL is null



        );
[0m21:18:31.338305 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m21:18:31.340060 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
[0m21:18:31.341979 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:18:31.342566 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
where DATE is null



        );
[0m21:18:31.561173 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m21:18:31.562012 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
[0m21:18:31.562857 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:18:31.563128 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
where SYMBOL is null



        );
[0m21:18:31.665932 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m21:18:31.666722 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
[0m21:18:31.667509 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:18:31.667775 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_macd
where DATE is null



        );
[0m21:18:32.096916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m21:18:32.099135 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:18:32.100405 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:18:32.100770 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
    
      
    ) dbt_internal_test
[0m21:18:32.210609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:18:32.212086 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: Close
[0m21:18:32.288770 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.946 seconds
[0m21:18:32.289688 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:18:32.290610 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:18:32.290944 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
    
      
    ) dbt_internal_test
[0m21:18:32.299889 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m21:18:32.300895 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:18:32.302084 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:18:32.302392 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
    
      
    ) dbt_internal_test
[0m21:18:32.316090 [info ] [Thread-1 (]: 14 of 35 PASS not_null_int_bollinger_SYMBOL .................................... [[32mPASS[0m in 1.52s]
[0m21:18:32.316898 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:18:32.317278 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:18:32.317642 [info ] [Thread-1 (]: 18 of 35 START test not_null_int_macd_SYMBOL ................................... [RUN]
[0m21:18:32.318091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443, now test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2)
[0m21:18:32.318380 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:18:32.322599 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:18:32.323439 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:18:32.325550 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_SYMBOL"
[0m21:18:32.326335 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:18:32.326595 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_SYMBOL" cascade
[0m21:18:32.326860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:32.354079 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m21:18:32.354973 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:18:32.355827 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:18:32.356084 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
    
      
    ) dbt_internal_test
[0m21:18:32.425777 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m21:18:32.427015 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: Close
[0m21:18:32.459873 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m21:18:32.461076 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: Close
[0m21:18:32.477531 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m21:18:32.478722 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: Close
[0m21:18:32.557307 [info ] [Thread-2 (]: 17 of 35 PASS not_null_int_macd_DATE ........................................... [[32mPASS[0m in 1.41s]
[0m21:18:32.557985 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:18:32.558349 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:18:32.558698 [info ] [Thread-2 (]: 19 of 35 START test not_null_int_moving_averages_DATE .......................... [RUN]
[0m21:18:32.559074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b, now test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4)
[0m21:18:32.559350 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:18:32.561563 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:18:32.562319 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:18:32.564285 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_DATE"
[0m21:18:32.564924 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:18:32.565184 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_DATE" cascade
[0m21:18:32.565427 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:32.621556 [info ] [Thread-4 (]: 15 of 35 PASS not_null_int_daily_returns_DATE .................................. [[32mPASS[0m in 1.72s]
[0m21:18:32.622088 [info ] [Thread-3 (]: 16 of 35 PASS not_null_int_daily_returns_SYMBOL ................................ [[32mPASS[0m in 1.63s]
[0m21:18:32.622523 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:18:32.622917 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:18:32.623260 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:18:32.623632 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:18:32.623945 [info ] [Thread-4 (]: 20 of 35 START test not_null_int_moving_averages_SYMBOL ........................ [RUN]
[0m21:18:32.624312 [info ] [Thread-3 (]: 21 of 35 START test not_null_int_rsi_DATE ...................................... [RUN]
[0m21:18:32.624725 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54, now test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a)
[0m21:18:32.625025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2, now test.stock_analytics.not_null_int_rsi_DATE.1856743a58)
[0m21:18:32.625363 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:18:32.625643 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:18:32.627960 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:18:32.631025 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:18:32.632332 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:18:32.635234 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_SYMBOL"
[0m21:18:32.635510 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:18:32.636127 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:18:32.637913 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_DATE"
[0m21:18:32.638190 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_SYMBOL" cascade
[0m21:18:32.638828 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:18:32.639091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:32.639338 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_DATE" cascade
[0m21:18:32.640474 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:32.901155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:18:32.902360 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
[0m21:18:32.903204 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:18:32.903486 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_macd
where SYMBOL is null



        );
[0m21:18:33.113369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m21:18:33.114107 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
[0m21:18:33.114923 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:18:33.115181 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
where DATE is null



        );
[0m21:18:33.145233 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m21:18:33.145997 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
[0m21:18:33.146957 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:18:33.147207 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_rsi
where DATE is null



        );
[0m21:18:33.174655 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m21:18:33.175478 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
[0m21:18:33.176330 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:18:33.176601 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
where SYMBOL is null



        );
[0m21:18:33.736288 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m21:18:33.736868 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m21:18:33.737330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m21:18:33.738319 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:18:33.739149 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:18:33.740001 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:18:33.741230 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:18:33.742867 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:18:33.743207 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
    
      
    ) dbt_internal_test
[0m21:18:33.743614 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:18:33.743927 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
    
      
    ) dbt_internal_test
[0m21:18:33.744832 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
    
      
    ) dbt_internal_test
[0m21:18:33.819626 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m21:18:33.820767 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:18:33.821848 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:18:33.822209 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
    
      
    ) dbt_internal_test
[0m21:18:33.871885 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m21:18:33.874232 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: Close
[0m21:18:33.883743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m21:18:33.885920 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: Close
[0m21:18:33.944518 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m21:18:33.948171 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m21:18:33.951992 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: Close
[0m21:18:33.954438 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: Close
[0m21:18:33.989521 [info ] [Thread-2 (]: 19 of 35 PASS not_null_int_moving_averages_DATE ................................ [[32mPASS[0m in 1.43s]
[0m21:18:33.990431 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:18:33.991046 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:18:33.991656 [info ] [Thread-2 (]: 22 of 35 START test not_null_int_rsi_SYMBOL .................................... [RUN]
[0m21:18:33.992579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4, now test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035)
[0m21:18:33.993142 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:18:33.997347 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:18:34.000803 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:18:34.003617 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_SYMBOL"
[0m21:18:34.004470 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:18:34.004805 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_SYMBOL" cascade
[0m21:18:34.005075 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:34.024046 [info ] [Thread-1 (]: 18 of 35 PASS not_null_int_macd_SYMBOL ......................................... [[32mPASS[0m in 1.71s]
[0m21:18:34.024784 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:18:34.025240 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:18:34.025644 [info ] [Thread-1 (]: 23 of 35 START test not_null_mart_stock_daily_metrics_CLOSE .................... [RUN]
[0m21:18:34.026096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2, now test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9)
[0m21:18:34.026433 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:18:34.028936 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:18:34.029805 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:18:34.033079 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_CLOSE"
[0m21:18:34.033781 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:18:34.034101 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_CLOSE" cascade
[0m21:18:34.034386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:34.097829 [info ] [Thread-4 (]: 20 of 35 PASS not_null_int_moving_averages_SYMBOL .............................. [[32mPASS[0m in 1.47s]
[0m21:18:34.098635 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:18:34.099029 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:18:34.099390 [info ] [Thread-4 (]: 24 of 35 START test not_null_mart_stock_daily_metrics_DATE ..................... [RUN]
[0m21:18:34.099900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a, now test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510)
[0m21:18:34.100627 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:18:34.101179 [info ] [Thread-3 (]: 21 of 35 PASS not_null_int_rsi_DATE ............................................ [[32mPASS[0m in 1.48s]
[0m21:18:34.103825 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:18:34.104271 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:18:34.104873 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:18:34.105206 [info ] [Thread-3 (]: 25 of 35 START test not_null_mart_stock_daily_metrics_PRICE_TREND .............. [RUN]
[0m21:18:34.105691 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:18:34.105939 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_DATE.1856743a58, now test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200)
[0m21:18:34.108247 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_DATE"
[0m21:18:34.108542 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:18:34.109197 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:18:34.111106 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:18:34.111449 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_DATE" cascade
[0m21:18:34.111945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:34.113317 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:18:34.116156 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_PRICE_TREND"
[0m21:18:34.116841 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:18:34.117118 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_PRICE_TREND" cascade
[0m21:18:34.117366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:34.438815 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m21:18:34.441138 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
[0m21:18:34.442862 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:18:34.443287 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_rsi
where SYMBOL is null



        );
[0m21:18:34.537506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m21:18:34.538931 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
[0m21:18:34.540288 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:18:34.540715 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where CLOSE is null



        );
[0m21:18:34.664362 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m21:18:34.666481 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m21:18:34.668898 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
[0m21:18:34.670882 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
[0m21:18:34.674195 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:18:34.676380 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:18:34.677355 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where PRICE_TREND is null



        );
[0m21:18:34.678240 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where DATE is null



        );
[0m21:18:35.018388 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:18:35.021283 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:18:35.023764 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:18:35.024606 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
    
      
    ) dbt_internal_test
[0m21:18:35.200534 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m21:18:35.202142 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: Close
[0m21:18:35.317929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m21:18:35.318724 [info ] [Thread-2 (]: 22 of 35 PASS not_null_int_rsi_SYMBOL .......................................... [[32mPASS[0m in 1.33s]
[0m21:18:35.320331 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:18:35.320790 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:18:35.321415 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:18:35.321838 [info ] [Thread-2 (]: 26 of 35 START test not_null_mart_stock_daily_metrics_SYMBOL ................... [RUN]
[0m21:18:35.322422 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:18:35.322664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035, now test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435)
[0m21:18:35.322976 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
    
      
    ) dbt_internal_test
[0m21:18:35.323273 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:18:35.326911 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:18:35.327554 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:18:35.330669 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_SYMBOL"
[0m21:18:35.331344 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:18:35.331610 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_SYMBOL" cascade
[0m21:18:35.331883 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:35.436597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m21:18:35.437933 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: Close
[0m21:18:35.533789 [info ] [Thread-1 (]: 23 of 35 PASS not_null_mart_stock_daily_metrics_CLOSE .......................... [[32mPASS[0m in 1.51s]
[0m21:18:35.534517 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:18:35.534871 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571
[0m21:18:35.535176 [info ] [Thread-1 (]: 27 of 35 START test not_null_mart_stock_daily_metrics_TRADING_SIGNAL ........... [RUN]
[0m21:18:35.535591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9, now test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571)
[0m21:18:35.535894 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571
[0m21:18:35.538053 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571"
[0m21:18:35.538826 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571
[0m21:18:35.539951 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_TRADING_SIGNAL
[0m21:18:35.540741 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571"
[0m21:18:35.541021 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_TRADING_SIGNAL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where TRADING_SIGNAL is null



        );
[0m21:18:35.541280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:35.561952 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.882 seconds
[0m21:18:35.563038 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:18:35.564147 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:18:35.564552 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
    
      
    ) dbt_internal_test
[0m21:18:35.577082 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.898 seconds
[0m21:18:35.577973 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:18:35.582418 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:18:35.582703 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
    
      
    ) dbt_internal_test
[0m21:18:35.683072 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m21:18:35.685204 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: Close
[0m21:18:35.756837 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m21:18:35.760090 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: Close
[0m21:18:35.810355 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m21:18:35.813805 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
[0m21:18:35.817072 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:18:35.820270 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where SYMBOL is null



        );
[0m21:18:35.849886 [info ] [Thread-4 (]: 24 of 35 PASS not_null_mart_stock_daily_metrics_DATE ........................... [[32mPASS[0m in 1.75s]
[0m21:18:35.851638 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:18:35.852510 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:18:35.853391 [info ] [Thread-4 (]: 28 of 35 START test not_null_stg_stock_daily_CLOSE ............................. [RUN]
[0m21:18:35.854483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510, now test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75)
[0m21:18:35.855100 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:18:35.860236 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:18:35.862662 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:18:35.866351 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_CLOSE"
[0m21:18:35.867373 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:18:35.867787 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_CLOSE" cascade
[0m21:18:35.868255 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:35.884482 [info ] [Thread-3 (]: 25 of 35 PASS not_null_mart_stock_daily_metrics_PRICE_TREND .................... [[32mPASS[0m in 1.78s]
[0m21:18:35.885440 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:18:35.885945 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:18:35.886387 [info ] [Thread-3 (]: 29 of 35 START test not_null_stg_stock_daily_DAILY_CHANGE_PCT .................. [RUN]
[0m21:18:35.886874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200, now test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285)
[0m21:18:35.887292 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:18:35.890361 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:18:35.891529 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:18:35.895155 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DAILY_CHANGE_PCT"
[0m21:18:35.895926 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:18:35.896274 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DAILY_CHANGE_PCT" cascade
[0m21:18:35.896616 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:35.933729 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d5e-0106-eb87-000f-c0df0070d1b6
[0m21:18:35.934176 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 6
invalid identifier 'TRADING_SIGNAL'
[0m21:18:35.934794 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571: Close
[0m21:18:36.077597 [debug] [Thread-1 (]: Database Error in test not_null_mart_stock_daily_metrics_TRADING_SIGNAL (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 6
  invalid identifier 'TRADING_SIGNAL'
[0m21:18:36.078525 [error] [Thread-1 (]: 27 of 35 ERROR not_null_mart_stock_daily_metrics_TRADING_SIGNAL ................ [[31mERROR[0m in 0.54s]
[0m21:18:36.079797 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571
[0m21:18:36.080326 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:18:36.081012 [info ] [Thread-1 (]: 30 of 35 START test not_null_stg_stock_daily_DATA_QUALITY_FLAG ................. [RUN]
[0m21:18:36.081719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_TRADING_SIGNAL.1c14bfd571, now test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291)
[0m21:18:36.082182 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:18:36.085913 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:18:36.086936 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:18:36.089972 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATA_QUALITY_FLAG"
[0m21:18:36.090844 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:18:36.091185 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATA_QUALITY_FLAG" cascade
[0m21:18:36.091473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:36.423222 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m21:18:36.425013 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
[0m21:18:36.426627 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:18:36.427153 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where CLOSE is null



        );
[0m21:18:36.469351 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m21:18:36.470632 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
[0m21:18:36.472195 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:18:36.473362 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m21:18:36.473895 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DAILY_CHANGE_PCT is null



        );
[0m21:18:36.475203 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:18:36.477735 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:18:36.478151 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
    
      
    ) dbt_internal_test
[0m21:18:36.499858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m21:18:36.500907 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
[0m21:18:36.502437 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:18:36.502849 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DATA_QUALITY_FLAG is null



        );
[0m21:18:36.587279 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m21:18:36.589760 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: Close
[0m21:18:36.716871 [info ] [Thread-2 (]: 26 of 35 PASS not_null_mart_stock_daily_metrics_SYMBOL ......................... [[32mPASS[0m in 1.39s]
[0m21:18:36.718825 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:18:36.720061 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:18:36.721004 [info ] [Thread-2 (]: 31 of 35 START test not_null_stg_stock_daily_DATE .............................. [RUN]
[0m21:18:36.722060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435, now test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022)
[0m21:18:36.722943 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:18:36.730568 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:18:36.732489 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:18:36.737425 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATE"
[0m21:18:36.738728 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:18:36.739235 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATE" cascade
[0m21:18:36.739735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:37.085525 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m21:18:37.087530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m21:18:37.090238 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:18:37.092183 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:18:37.096560 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:18:37.097351 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:18:37.097937 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
    
      
    ) dbt_internal_test
[0m21:18:37.098554 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
    
      
    ) dbt_internal_test
[0m21:18:37.235293 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m21:18:37.239458 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: Close
[0m21:18:37.249644 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m21:18:37.251942 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:18:37.253871 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:18:37.254427 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
    
      
    ) dbt_internal_test
[0m21:18:37.267215 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m21:18:37.268555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m21:18:37.269899 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
[0m21:18:37.272205 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: Close
[0m21:18:37.273762 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:18:37.275307 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DATE is null



        );
[0m21:18:37.374406 [info ] [Thread-3 (]: 29 of 35 PASS not_null_stg_stock_daily_DAILY_CHANGE_PCT ........................ [[32mPASS[0m in 1.49s]
[0m21:18:37.377248 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m21:18:37.378617 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:18:37.382163 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: Close
[0m21:18:37.383078 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:18:37.385826 [info ] [Thread-3 (]: 32 of 35 START test not_null_stg_stock_daily_SYMBOL ............................ [RUN]
[0m21:18:37.386895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285, now test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0)
[0m21:18:37.387479 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:18:37.392371 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:18:37.395055 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:18:37.400567 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_SYMBOL"
[0m21:18:37.401314 [info ] [Thread-1 (]: 30 of 35 PASS not_null_stg_stock_daily_DATA_QUALITY_FLAG ....................... [[32mPASS[0m in 1.32s]
[0m21:18:37.402441 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:18:37.403032 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:18:37.403454 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_SYMBOL" cascade
[0m21:18:37.403949 [debug] [Thread-1 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:18:37.404442 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:37.404929 [info ] [Thread-1 (]: 33 of 35 START test source_not_null_raw_fact_stock_price_daily_CLOSE ........... [RUN]
[0m21:18:37.406654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178)
[0m21:18:37.407166 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:18:37.410208 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:18:37.411379 [debug] [Thread-1 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:18:37.413933 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_CLOSE"
[0m21:18:37.414668 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:18:37.414976 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_CLOSE" cascade
[0m21:18:37.415261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:37.537321 [info ] [Thread-4 (]: 28 of 35 PASS not_null_stg_stock_daily_CLOSE ................................... [[32mPASS[0m in 1.68s]
[0m21:18:37.538160 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:18:37.538600 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:18:37.539034 [info ] [Thread-4 (]: 34 of 35 START test source_not_null_raw_fact_stock_price_daily_DATE ............ [RUN]
[0m21:18:37.539584 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198)
[0m21:18:37.539998 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:18:37.542834 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:18:37.544666 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:18:37.547133 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_DATE"
[0m21:18:37.547814 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:18:37.548173 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_DATE" cascade
[0m21:18:37.548468 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:37.971312 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m21:18:37.972477 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
[0m21:18:37.973695 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:18:37.974188 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where SYMBOL is null



        );
[0m21:18:38.057907 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m21:18:38.058932 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
[0m21:18:38.060044 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:18:38.060409 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where DATE is null



        );
[0m21:18:38.320458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.905 seconds
[0m21:18:38.323175 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
[0m21:18:38.326672 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:18:38.327730 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where CLOSE is null



        );
[0m21:18:38.469810 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.193 seconds
[0m21:18:38.472957 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:18:38.476668 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:18:38.477836 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
    
      
    ) dbt_internal_test
[0m21:18:38.620114 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m21:18:38.622310 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: Close
[0m21:18:38.721317 [info ] [Thread-2 (]: 31 of 35 PASS not_null_stg_stock_daily_DATE .................................... [[32mPASS[0m in 2.00s]
[0m21:18:38.723250 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:18:38.724144 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:18:38.724882 [info ] [Thread-2 (]: 35 of 35 START test source_not_null_raw_fact_stock_price_daily_SYMBOL .......... [RUN]
[0m21:18:38.725900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a)
[0m21:18:38.726497 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:18:38.733179 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:18:38.734459 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m21:18:38.737908 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:18:38.739077 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:18:38.742341 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_SYMBOL"
[0m21:18:38.742880 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:18:38.743705 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:18:38.744156 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m21:18:38.744602 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_SYMBOL" cascade
[0m21:18:38.745862 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:38.849585 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m21:18:38.851251 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:18:38.853069 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:18:38.853549 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
    
      
    ) dbt_internal_test
[0m21:18:38.878205 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m21:18:38.879825 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: Close
[0m21:18:38.979869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m21:18:38.982802 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:18:38.984891 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:18:38.985554 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
    
      
    ) dbt_internal_test
[0m21:18:38.997455 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m21:18:38.999927 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: Close
[0m21:18:39.005967 [info ] [Thread-3 (]: 32 of 35 PASS not_null_stg_stock_daily_SYMBOL .................................. [[32mPASS[0m in 1.62s]
[0m21:18:39.007378 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:18:39.135510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m21:18:39.140828 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: Close
[0m21:18:39.143325 [info ] [Thread-4 (]: 34 of 35 PASS source_not_null_raw_fact_stock_price_daily_DATE .................. [[32mPASS[0m in 1.60s]
[0m21:18:39.148891 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:18:39.266718 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m21:18:39.270012 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
[0m21:18:39.273924 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:18:39.274952 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where SYMBOL is null



        );
[0m21:18:39.277101 [info ] [Thread-1 (]: 33 of 35 PASS source_not_null_raw_fact_stock_price_daily_CLOSE ................. [[32mPASS[0m in 1.87s]
[0m21:18:39.279207 [debug] [Thread-1 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:18:39.984997 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m21:18:39.988864 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:18:39.993507 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:18:39.994904 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m21:18:40.115310 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m21:18:40.119534 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: Close
[0m21:18:40.246372 [info ] [Thread-2 (]: 35 of 35 PASS source_not_null_raw_fact_stock_price_daily_SYMBOL ................ [[32mPASS[0m in 1.52s]
[0m21:18:40.248645 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:18:40.253407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:40.254362 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178' was properly closed.
[0m21:18:40.255195 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a' was properly closed.
[0m21:18:40.255894 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0' was properly closed.
[0m21:18:40.256501 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198' was properly closed.
[0m21:18:40.257449 [info ] [MainThread]: 
[0m21:18:40.258723 [info ] [MainThread]: Finished running 35 data tests in 0 hours 0 minutes and 16.83 seconds (16.83s).
[0m21:18:40.263736 [debug] [MainThread]: Command end result
[0m21:18:40.308268 [info ] [MainThread]: 
[0m21:18:40.308904 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:18:40.309341 [info ] [MainThread]: 
[0m21:18:40.309766 [error] [MainThread]:   Database Error in test accepted_values_mart_stock_daily_metrics_TRADING_SIGNAL__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'TRADING_SIGNAL'
[0m21:18:40.310116 [info ] [MainThread]: 
[0m21:18:40.311947 [error] [MainThread]:   Database Error in test not_null_mart_stock_daily_metrics_TRADING_SIGNAL (models/marts/schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 6
  invalid identifier 'TRADING_SIGNAL'
[0m21:18:40.312376 [info ] [MainThread]: 
[0m21:18:40.312716 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=2 SKIP=0 TOTAL=35
[0m21:18:40.314022 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 17.71713, "process_user_time": 4.036626, "process_kernel_time": 0.393322, "process_mem_max_rss": "234808", "process_out_blocks": "3286", "command_success": false, "process_in_blocks": "0"}
[0m21:18:40.314494 [debug] [MainThread]: Command `dbt test` failed at 21:18:40.314432 after 17.72 seconds
[0m21:18:40.314906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc109b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2d5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac69c7a0>]}
[0m21:18:40.315260 [debug] [MainThread]: Flushing usage events
[0m21:22:26.604349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9c6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebe0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9c6540>]}


============================== 21:22:26.608201 | 1c8e581d-c569-4e31-a026-b05bd9afa531 ==============================
[0m21:22:26.608201 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:22:26.609132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:22:27.025488 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:22:27.026378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1c8e581d-c569-4e31-a026-b05bd9afa531', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ebb52e0>]}
[0m21:22:27.060520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c8e581d-c569-4e31-a026-b05bd9afa531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ee2b6b0>]}
[0m21:22:27.091705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c8e581d-c569-4e31-a026-b05bd9afa531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ebb5970>]}
[0m21:22:27.092472 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:22:27.102535 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:22:27.223804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:22:27.224468 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/marts/schema.yml
[0m21:22:27.398313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8e581d-c569-4e31-a026-b05bd9afa531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e6de7b0>]}
[0m21:22:27.462627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8e581d-c569-4e31-a026-b05bd9afa531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5db1a8d0>]}
[0m21:22:27.462989 [info ] [MainThread]: Found 33 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:22:27.463490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8e581d-c569-4e31-a026-b05bd9afa531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e70bb00>]}
[0m21:22:27.464927 [info ] [MainThread]: 
[0m21:22:27.465422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:22:27.468014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:22:27.473744 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:22:27.474009 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:22:27.474234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:27.986461 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.512 seconds
[0m21:22:27.989540 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:22:28.185388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m21:22:28.186061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m21:22:28.192177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m21:22:28.191893 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:22:28.192699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m21:22:28.194067 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:22:28.195379 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:22:28.195678 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:22:28.196897 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:22:28.197200 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:22:28.197489 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:22:28.197729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:22:28.198007 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:22:28.198260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:28.198512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:28.199926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:28.678470 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.480 seconds
[0m21:22:28.683150 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:22:28.689051 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.489 seconds
[0m21:22:28.693251 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:22:28.702082 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.504 seconds
[0m21:22:28.704302 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:22:28.742321 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 0.544 seconds
[0m21:22:28.746449 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:22:28.864101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8e581d-c569-4e31-a026-b05bd9afa531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5df7e7e0>]}
[0m21:22:28.865641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:22:28.867241 [info ] [MainThread]: 
[0m21:22:28.881188 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:22:28.882054 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:22:28.882884 [debug] [Thread-3 (]: Began running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:22:28.883680 [debug] [Thread-4 (]: Began running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:22:28.884076 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [RUN]
[0m21:22:28.885001 [info ] [Thread-2 (]: 2 of 33 START test accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [RUN]
[0m21:22:28.885616 [info ] [Thread-3 (]: 3 of 33 START test accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL  [RUN]
[0m21:22:28.886369 [info ] [Thread-4 (]: 4 of 33 START test accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [RUN]
[0m21:22:28.887123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6)
[0m21:22:28.887549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef)
[0m21:22:28.887985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859)
[0m21:22:28.888451 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a)
[0m21:22:28.888887 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:22:28.889293 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:22:28.889714 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:22:28.890171 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:22:28.898982 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:22:28.955801 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:22:28.958167 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:22:28.960108 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:22:28.961856 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:22:28.962084 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:22:28.972156 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MACD_03D76AC49786AFFDB0C9DCED06432A11"
[0m21:22:28.972366 [debug] [Thread-3 (]: Began executing node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:22:28.972666 [debug] [Thread-4 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:22:28.974735 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MOVING_AVE_6CA08515D89550A8F253DD31743BCB67"
[0m21:22:28.978323 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:22:28.980356 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_RSI_E03F19197F66DE5A3784EE911F15DCB3"
[0m21:22:28.982793 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_MART_STOCK_DAI_7F3B5CE4F2B7B009A1EB3E6E2DF356F8"
[0m21:22:28.983423 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:22:28.983725 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MACD_03D76AC49786AFFDB0C9DCED06432A11" cascade
[0m21:22:28.984404 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:22:28.985008 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:22:28.985301 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MOVING_AVE_6CA08515D89550A8F253DD31743BCB67" cascade
[0m21:22:28.985595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:28.985881 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_RSI_E03F19197F66DE5A3784EE911F15DCB3" cascade
[0m21:22:28.986141 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_MART_STOCK_DAI_7F3B5CE4F2B7B009A1EB3E6E2DF356F8" cascade
[0m21:22:28.986407 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:28.987713 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:22:28.988111 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:22:29.415404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m21:22:29.418743 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
[0m21:22:29.430311 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:22:29.431351 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m21:22:29.431638 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
         as
        (
    
    

with all_values as (

    select
        MACD_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_macd where MACD_SIGNAL IS NOT NULL) dbt_subquery
    group by MACD_SIGNAL

)

select *
from all_values
where value_field not in (
    'BULLISH_CROSSOVER','BEARISH_CROSSOVER','BULLISH','BEARISH','NEUTRAL'
)



        );
[0m21:22:29.432662 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
[0m21:22:29.434549 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:22:29.435191 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
         as
        (
    
    

with all_values as (

    select
        PRICE_TREND as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by PRICE_TREND

)

select *
from all_values
where value_field not in (
    'STRONG_UPTREND','UPTREND','SIDEWAYS','DOWNTREND','STRONG_DOWNTREND'
)



        );
[0m21:22:29.467981 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m21:22:29.468879 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
[0m21:22:29.469808 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:22:29.470124 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
         as
        (
    
    

with all_values as (

    select
        RSI_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_rsi where RSI_SIGNAL IS NOT NULL) dbt_subquery
    group by RSI_SIGNAL

)

select *
from all_values
where value_field not in (
    'OVERBOUGHT','OVERSOLD','NEUTRAL'
)



        );
[0m21:22:29.560674 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:22:29.561858 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
[0m21:22:29.563511 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:22:29.564249 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
         as
        (
    
    

with all_values as (

    select
        MA_CROSS_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages where MA_CROSS_SIGNAL IS NOT NULL) dbt_subquery
    group by MA_CROSS_SIGNAL

)

select *
from all_values
where value_field not in (
    'GOLDEN_CROSS','DEATH_CROSS','NEUTRAL'
)



        );
[0m21:22:30.488886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.056 seconds
[0m21:22:30.494954 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:22:30.498251 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:22:30.498879 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
    
      
    ) dbt_internal_test
[0m21:22:30.514612 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.079 seconds
[0m21:22:30.516090 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:22:30.517228 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m21:22:30.518336 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:22:30.519145 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:22:30.519592 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
    
      
    ) dbt_internal_test
[0m21:22:30.520453 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:22:30.521327 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
    
      
    ) dbt_internal_test
[0m21:22:30.582511 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.112 seconds
[0m21:22:30.583856 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:22:30.585257 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:22:30.585795 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
    
      
    ) dbt_internal_test
[0m21:22:30.643207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m21:22:30.654237 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: Close
[0m21:22:30.664291 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m21:22:30.666246 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: Close
[0m21:22:30.673604 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m21:22:30.675179 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: Close
[0m21:22:30.720421 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m21:22:30.722733 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: Close
[0m21:22:30.757808 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [[32mPASS[0m in 1.87s]
[0m21:22:30.759685 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:22:30.760372 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:22:30.761030 [info ] [Thread-1 (]: 5 of 33 START test accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [RUN]
[0m21:22:30.761844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6, now test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987)
[0m21:22:30.762375 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:22:30.769498 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:22:30.772138 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:22:30.775503 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_STG_STOCK_DAIL_56D0AB7DE46C8DB0B014849697C2711B"
[0m21:22:30.776475 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:22:30.776883 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_STG_STOCK_DAIL_56D0AB7DE46C8DB0B014849697C2711B" cascade
[0m21:22:30.777266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:30.782885 [info ] [Thread-4 (]: 4 of 33 PASS accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [[32mPASS[0m in 1.89s]
[0m21:22:30.784002 [debug] [Thread-4 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:22:30.785172 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:22:30.785624 [info ] [Thread-4 (]: 6 of 33 START test dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE  [RUN]
[0m21:22:30.786232 [info ] [Thread-2 (]: 2 of 33 PASS accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [[32mPASS[0m in 1.90s]
[0m21:22:30.786687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1)
[0m21:22:30.787192 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:22:30.787567 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:22:30.788040 [debug] [Thread-2 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:22:30.793331 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:22:30.793733 [info ] [Thread-2 (]: 7 of 33 START test dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE  [RUN]
[0m21:22:30.794405 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c)
[0m21:22:30.794754 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:22:30.798522 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:22:30.798786 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:22:30.801299 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_LOWER___BB_MIDDLE"
[0m21:22:30.801982 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:22:30.802267 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_LOWER___BB_MIDDLE" cascade
[0m21:22:30.802491 [debug] [Thread-2 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:22:30.802738 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:22:30.804886 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_UPPER___BB_MIDDLE"
[0m21:22:30.806691 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:22:30.807140 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_UPPER___BB_MIDDLE" cascade
[0m21:22:30.807482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:30.824117 [info ] [Thread-3 (]: 3 of 33 PASS accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL . [[32mPASS[0m in 1.94s]
[0m21:22:30.824861 [debug] [Thread-3 (]: Finished running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:22:30.825188 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:22:30.825484 [info ] [Thread-3 (]: 8 of 33 START test dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0  [RUN]
[0m21:22:30.825894 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859, now test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d)
[0m21:22:30.826167 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:22:30.828882 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:22:30.830120 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:22:30.832105 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_I_073ECBDFB3F8461B722A2236FFC246EF"
[0m21:22:30.832686 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:22:30.832931 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_I_073ECBDFB3F8461B722A2236FFC246EF" cascade
[0m21:22:30.833204 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:22:31.153047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m21:22:31.155830 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
[0m21:22:31.159072 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:22:31.160389 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
         as
        (
    
    

with all_values as (

    select
        DATA_QUALITY_FLAG as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    group by DATA_QUALITY_FLAG

)

select *
from all_values
where value_field not in (
    'VALID','INVALID','ANOMALY','MISSING','NO_TRADING'
)



        );
[0m21:22:31.188727 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.381 seconds
[0m21:22:31.191841 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
[0m21:22:31.195337 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:22:31.196960 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger where BB_UPPER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_UPPER > BB_MIDDLE)


        );
[0m21:22:31.232225 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m21:22:31.235147 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
[0m21:22:31.241297 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:22:31.242522 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger where BB_LOWER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_LOWER < BB_MIDDLE)


        );
[0m21:22:31.712936 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m21:22:31.715904 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
[0m21:22:31.718421 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:22:31.719504 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns where VOLATILITY_20D IS NOT NULL) dbt_subquery

where not(VOLATILITY_20D >= 0)


        );
[0m21:22:31.785900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m21:22:31.789697 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:22:31.794388 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:22:31.795308 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
    
      
    ) dbt_internal_test
[0m21:22:31.997744 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m21:22:31.999538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m21:22:32.002202 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:22:32.005571 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: Close
[0m21:22:32.010546 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:22:32.011350 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m21:22:32.113000 [info ] [Thread-1 (]: 5 of 33 PASS accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [[32mPASS[0m in 1.35s]
[0m21:22:32.115434 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:22:32.116357 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:22:32.117284 [info ] [Thread-1 (]: 9 of 33 START test dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100  [RUN]
[0m21:22:32.118572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987, now test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb)
[0m21:22:32.119532 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:22:32.126987 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:22:32.129044 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:22:32.133292 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_RSI_RSI_14__BETWEEN_0_AND_100"
[0m21:22:32.134883 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:22:32.136337 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m21:22:32.136693 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_RSI_RSI_14__BETWEEN_0_AND_100" cascade
[0m21:22:32.138665 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: Close
[0m21:22:32.139190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:32.157000 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.959 seconds
[0m21:22:32.158453 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:22:32.159829 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:22:32.160258 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m21:22:32.260680 [info ] [Thread-4 (]: 6 of 33 PASS dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE ... [[32mPASS[0m in 1.47s]
[0m21:22:32.261784 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:22:32.262309 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:22:32.262774 [info ] [Thread-4 (]: 10 of 33 START test dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [RUN]
[0m21:22:32.263364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1, now test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12)
[0m21:22:32.263785 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:22:32.267477 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:22:32.269432 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:22:32.272229 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_C9286FF21D21C3798E9AC65985930CF6"
[0m21:22:32.273491 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:22:32.274111 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m21:22:32.274484 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_C9286FF21D21C3798E9AC65985930CF6" cascade
[0m21:22:32.275956 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: Close
[0m21:22:32.276341 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:22:32.491506 [info ] [Thread-2 (]: 7 of 33 PASS dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE ... [[32mPASS[0m in 1.70s]
[0m21:22:32.493270 [debug] [Thread-2 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:22:32.495394 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m21:22:32.496215 [debug] [Thread-2 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:22:32.499117 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:22:32.499981 [info ] [Thread-2 (]: 11 of 33 START test dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [RUN]
[0m21:22:32.502153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c, now test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b)
[0m21:22:32.502940 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:22:32.508984 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:22:32.509846 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:22:32.510940 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
    
      
    ) dbt_internal_test
[0m21:22:32.512005 [debug] [Thread-2 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:22:32.517685 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_1CD5BBDAE1662B4E1877B262934E23BF"
[0m21:22:32.520536 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:22:32.521005 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_1CD5BBDAE1662B4E1877B262934E23BF" cascade
[0m21:22:32.521348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:32.647645 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m21:22:32.649335 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: Close
[0m21:22:32.686126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m21:22:32.687151 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
[0m21:22:32.688492 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:22:32.688921 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_rsi where RSI_14 IS NOT NULL) dbt_subquery

where not(RSI_14 BETWEEN 0 AND 100)


        );
[0m21:22:32.827164 [info ] [Thread-3 (]: 8 of 33 PASS dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0 . [[32mPASS[0m in 2.00s]
[0m21:22:32.829389 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:22:32.830484 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:22:32.831513 [info ] [Thread-3 (]: 12 of 33 START test not_null_int_bollinger_DATE ................................ [RUN]
[0m21:22:32.832621 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d, now test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac)
[0m21:22:32.833401 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:22:32.841077 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:22:32.842443 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:22:32.846341 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_DATE"
[0m21:22:32.847375 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:22:32.847770 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_DATE" cascade
[0m21:22:32.848169 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:22:32.967417 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m21:22:32.969387 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
[0m21:22:32.970188 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m21:22:32.971655 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:22:32.972720 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
[0m21:22:32.973264 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m21:22:32.974713 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:22:32.976315 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m21:22:33.345133 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m21:22:33.346413 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
[0m21:22:33.347732 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:22:33.348193 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
where DATE is null



        );
[0m21:22:33.500564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m21:22:33.503676 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:22:33.507111 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:22:33.508222 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
    
      
    ) dbt_internal_test
[0m21:22:33.548311 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m21:22:33.551362 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:22:33.555761 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:22:33.557130 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
    
      
    ) dbt_internal_test
[0m21:22:33.581859 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m21:22:33.584788 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:22:33.587182 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:22:33.587902 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
    
      
    ) dbt_internal_test
[0m21:22:33.617361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m21:22:33.620120 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: Close
[0m21:22:33.710202 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m21:22:33.713937 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: Close
[0m21:22:33.721438 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m21:22:33.724145 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: Close
[0m21:22:33.730796 [info ] [Thread-1 (]: 9 of 33 PASS dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100 .... [[32mPASS[0m in 1.61s]
[0m21:22:33.732639 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:22:33.733455 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:22:33.734100 [info ] [Thread-1 (]: 13 of 33 START test not_null_int_bollinger_SYMBOL .............................. [RUN]
[0m21:22:33.734969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb, now test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443)
[0m21:22:33.735522 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:22:33.739589 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:22:33.741252 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:22:33.744943 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_SYMBOL"
[0m21:22:33.745909 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:22:33.746275 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_SYMBOL" cascade
[0m21:22:33.746584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:33.842960 [info ] [Thread-2 (]: 11 of 33 PASS dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [[32mPASS[0m in 1.34s]
[0m21:22:33.843946 [debug] [Thread-2 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:22:33.844404 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:22:33.844847 [info ] [Thread-2 (]: 14 of 33 START test not_null_int_daily_returns_DATE ............................ [RUN]
[0m21:22:33.845622 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b, now test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54)
[0m21:22:33.846099 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:22:33.849444 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:22:33.856055 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:22:33.860031 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_DATE"
[0m21:22:33.860778 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:22:33.861075 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_DATE" cascade
[0m21:22:33.861327 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:33.878686 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m21:22:33.879843 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:22:33.880916 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:22:33.881238 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
    
      
    ) dbt_internal_test
[0m21:22:33.887531 [info ] [Thread-4 (]: 10 of 33 PASS dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [[32mPASS[0m in 1.62s]
[0m21:22:33.888346 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:22:33.888695 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:22:33.889065 [info ] [Thread-4 (]: 15 of 33 START test not_null_int_daily_returns_SYMBOL .......................... [RUN]
[0m21:22:33.889556 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12, now test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2)
[0m21:22:33.889852 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:22:33.892569 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:22:33.893260 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:22:33.895419 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_SYMBOL"
[0m21:22:33.896082 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:22:33.896335 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_SYMBOL" cascade
[0m21:22:33.896565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:22:33.994861 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m21:22:34.001238 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: Close
[0m21:22:34.117437 [info ] [Thread-3 (]: 12 of 33 PASS not_null_int_bollinger_DATE ...................................... [[32mPASS[0m in 1.28s]
[0m21:22:34.118238 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:22:34.118580 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:22:34.118945 [info ] [Thread-3 (]: 16 of 33 START test not_null_int_macd_DATE ..................................... [RUN]
[0m21:22:34.119355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac, now test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b)
[0m21:22:34.119655 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:22:34.122087 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:22:34.122920 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:22:34.124854 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_DATE"
[0m21:22:34.125487 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:22:34.125751 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_DATE" cascade
[0m21:22:34.126002 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:22:34.189599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m21:22:34.190951 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
[0m21:22:34.191862 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:22:34.192175 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
where SYMBOL is null



        );
[0m21:22:34.266434 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m21:22:34.267549 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
[0m21:22:34.268524 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:22:34.268807 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
where DATE is null



        );
[0m21:22:34.331171 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.434 seconds
[0m21:22:34.332795 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
[0m21:22:34.334202 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:22:34.335117 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
where SYMBOL is null



        );
[0m21:22:34.595857 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m21:22:34.596866 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
[0m21:22:34.598106 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:22:34.598431 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_macd
where DATE is null



        );
[0m21:22:34.774354 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m21:22:34.776105 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:22:34.777128 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:22:34.777438 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
    
      
    ) dbt_internal_test
[0m21:22:34.843682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m21:22:34.844991 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:22:34.845973 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:22:34.846255 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
    
      
    ) dbt_internal_test
[0m21:22:34.891221 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m21:22:34.892869 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: Close
[0m21:22:34.954091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m21:22:34.955610 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: Close
[0m21:22:34.997888 [info ] [Thread-2 (]: 14 of 33 PASS not_null_int_daily_returns_DATE .................................. [[32mPASS[0m in 1.15s]
[0m21:22:34.999321 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:22:34.999843 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:22:35.000373 [info ] [Thread-2 (]: 17 of 33 START test not_null_int_macd_SYMBOL ................................... [RUN]
[0m21:22:35.001000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54, now test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2)
[0m21:22:35.001366 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:22:35.004728 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:22:35.006876 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:22:35.010818 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_SYMBOL"
[0m21:22:35.011620 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:22:35.011953 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_SYMBOL" cascade
[0m21:22:35.012215 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:35.037684 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m21:22:35.038965 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:22:35.042848 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:22:35.045022 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
    
      
    ) dbt_internal_test
[0m21:22:35.055288 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m21:22:35.057113 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:22:35.064394 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:22:35.065655 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
    
      
    ) dbt_internal_test
[0m21:22:35.070406 [info ] [Thread-1 (]: 13 of 33 PASS not_null_int_bollinger_SYMBOL .................................... [[32mPASS[0m in 1.33s]
[0m21:22:35.071780 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:22:35.072632 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:22:35.075017 [info ] [Thread-1 (]: 18 of 33 START test not_null_int_moving_averages_DATE .......................... [RUN]
[0m21:22:35.076093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443, now test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4)
[0m21:22:35.076688 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:22:35.080959 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:22:35.083243 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:22:35.088245 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_DATE"
[0m21:22:35.089332 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:22:35.090473 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_DATE" cascade
[0m21:22:35.091459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:35.182864 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m21:22:35.186913 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: Close
[0m21:22:35.200270 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m21:22:35.201855 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: Close
[0m21:22:35.307989 [info ] [Thread-3 (]: 16 of 33 PASS not_null_int_macd_DATE ........................................... [[32mPASS[0m in 1.19s]
[0m21:22:35.310074 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:22:35.311374 [info ] [Thread-4 (]: 15 of 33 PASS not_null_int_daily_returns_SYMBOL ................................ [[32mPASS[0m in 1.42s]
[0m21:22:35.312752 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:22:35.317269 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:22:35.320159 [info ] [Thread-3 (]: 19 of 33 START test not_null_int_moving_averages_SYMBOL ........................ [RUN]
[0m21:22:35.321080 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:22:35.321643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b, now test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a)
[0m21:22:35.322046 [info ] [Thread-4 (]: 20 of 33 START test not_null_int_rsi_DATE ...................................... [RUN]
[0m21:22:35.322559 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:22:35.322979 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2, now test.stock_analytics.not_null_int_rsi_DATE.1856743a58)
[0m21:22:35.326149 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:22:35.326709 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:22:35.329833 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:22:35.330619 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:22:35.333240 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_SYMBOL"
[0m21:22:35.334176 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:22:35.334933 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:22:35.339350 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_SYMBOL" cascade
[0m21:22:35.338661 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_DATE"
[0m21:22:35.339794 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:22:35.340547 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:22:35.343124 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_DATE" cascade
[0m21:22:35.343684 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:22:35.463310 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m21:22:35.464324 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
[0m21:22:35.465246 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:22:35.465516 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_macd
where SYMBOL is null



        );
[0m21:22:35.494151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m21:22:35.495924 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
[0m21:22:35.497384 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:22:35.498086 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
where DATE is null



        );
[0m21:22:35.753430 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m21:22:35.754603 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
[0m21:22:35.755652 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:22:35.756002 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_rsi
where DATE is null



        );
[0m21:22:35.837465 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m21:22:35.838385 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
[0m21:22:35.839695 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:22:35.840077 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
where SYMBOL is null



        );
[0m21:22:36.011187 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m21:22:36.013344 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:22:36.016447 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:22:36.016997 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
    
      
    ) dbt_internal_test
[0m21:22:36.019624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m21:22:36.022023 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:22:36.023712 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:22:36.024185 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
    
      
    ) dbt_internal_test
[0m21:22:36.136283 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m21:22:36.137375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m21:22:36.139063 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: Close
[0m21:22:36.141211 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: Close
[0m21:22:36.238215 [info ] [Thread-1 (]: 18 of 33 PASS not_null_int_moving_averages_DATE ................................ [[32mPASS[0m in 1.16s]
[0m21:22:36.239868 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:22:36.240330 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:22:36.240785 [info ] [Thread-1 (]: 21 of 33 START test not_null_int_rsi_SYMBOL .................................... [RUN]
[0m21:22:36.241259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4, now test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035)
[0m21:22:36.241519 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:22:36.245049 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:22:36.246251 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:22:36.249134 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_SYMBOL"
[0m21:22:36.250018 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:22:36.250400 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_SYMBOL" cascade
[0m21:22:36.250801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:36.260409 [info ] [Thread-2 (]: 17 of 33 PASS not_null_int_macd_SYMBOL ......................................... [[32mPASS[0m in 1.26s]
[0m21:22:36.261611 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:22:36.262206 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:22:36.262874 [info ] [Thread-2 (]: 22 of 33 START test not_null_mart_stock_daily_metrics_CLOSE .................... [RUN]
[0m21:22:36.263570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2, now test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9)
[0m21:22:36.263996 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:22:36.266922 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:22:36.267870 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:22:36.270848 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_CLOSE"
[0m21:22:36.272892 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:22:36.273777 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_CLOSE" cascade
[0m21:22:36.274317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:36.514934 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m21:22:36.517165 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:22:36.519151 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:22:36.519749 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
    
      
    ) dbt_internal_test
[0m21:22:36.595848 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m21:22:36.598438 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:22:36.600364 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:22:36.600954 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
    
      
    ) dbt_internal_test
[0m21:22:36.732691 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m21:22:36.737536 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: Close
[0m21:22:36.752057 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m21:22:36.756045 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: Close
[0m21:22:36.769173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m21:22:36.770894 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
[0m21:22:36.772973 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:22:36.773568 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_rsi
where SYMBOL is null



        );
[0m21:22:36.807706 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m21:22:36.809882 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
[0m21:22:36.811797 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:22:36.812427 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where CLOSE is null



        );
[0m21:22:36.850374 [info ] [Thread-4 (]: 20 of 33 PASS not_null_int_rsi_DATE ............................................ [[32mPASS[0m in 1.53s]
[0m21:22:36.852191 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:22:36.853011 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:22:36.853634 [info ] [Thread-4 (]: 23 of 33 START test not_null_mart_stock_daily_metrics_DATE ..................... [RUN]
[0m21:22:36.854550 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_DATE.1856743a58, now test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510)
[0m21:22:36.855119 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:22:36.862022 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:22:36.863446 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:22:36.866684 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_DATE"
[0m21:22:36.868225 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:22:36.868980 [info ] [Thread-3 (]: 19 of 33 PASS not_null_int_moving_averages_SYMBOL .............................. [[32mPASS[0m in 1.55s]
[0m21:22:36.869572 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_DATE" cascade
[0m21:22:36.870171 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:22:36.870611 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:22:36.871080 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:22:36.872594 [info ] [Thread-3 (]: 24 of 33 START test not_null_mart_stock_daily_metrics_PRICE_TREND .............. [RUN]
[0m21:22:36.873210 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a, now test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200)
[0m21:22:36.873693 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:22:36.877165 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:22:36.878342 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:22:36.881176 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_PRICE_TREND"
[0m21:22:36.881968 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:22:36.882300 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_PRICE_TREND" cascade
[0m21:22:36.882610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:22:37.394235 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m21:22:37.395937 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
[0m21:22:37.397500 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:22:37.397962 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where PRICE_TREND is null



        );
[0m21:22:37.435564 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m21:22:37.438283 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
[0m21:22:37.440907 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:22:37.441835 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where DATE is null



        );
[0m21:22:37.603719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m21:22:37.607018 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:22:37.610421 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:22:37.611582 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
    
      
    ) dbt_internal_test
[0m21:22:37.647173 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m21:22:37.651490 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:22:37.655321 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:22:37.656331 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
    
      
    ) dbt_internal_test
[0m21:22:37.740744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m21:22:37.747710 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: Close
[0m21:22:37.779176 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m21:22:37.782980 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: Close
[0m21:22:37.939068 [info ] [Thread-2 (]: 22 of 33 PASS not_null_mart_stock_daily_metrics_CLOSE .......................... [[32mPASS[0m in 1.67s]
[0m21:22:37.944023 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:22:37.946169 [info ] [Thread-1 (]: 21 of 33 PASS not_null_int_rsi_SYMBOL .......................................... [[32mPASS[0m in 1.70s]
[0m21:22:37.948099 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:22:37.949367 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:22:37.950392 [info ] [Thread-2 (]: 25 of 33 START test not_null_mart_stock_daily_metrics_SYMBOL ................... [RUN]
[0m21:22:37.952330 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:22:37.953444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9, now test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435)
[0m21:22:37.954364 [info ] [Thread-1 (]: 26 of 33 START test not_null_stg_stock_daily_CLOSE ............................. [RUN]
[0m21:22:37.955519 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:22:37.956232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035, now test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75)
[0m21:22:37.961794 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:22:37.962362 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:22:37.966558 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:22:37.968636 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:22:37.973703 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_SYMBOL"
[0m21:22:37.974019 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:22:37.975475 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:22:37.976360 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m21:22:37.979114 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_CLOSE"
[0m21:22:37.979515 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_SYMBOL" cascade
[0m21:22:37.980626 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:22:37.981444 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:22:37.981848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:37.982688 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_CLOSE" cascade
[0m21:22:37.984827 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:22:37.985136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:37.985608 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
    
      
    ) dbt_internal_test
[0m21:22:38.004231 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m21:22:38.005390 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:22:38.006632 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:22:38.007019 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
    
      
    ) dbt_internal_test
[0m21:22:38.119254 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m21:22:38.120850 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: Close
[0m21:22:38.148374 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m21:22:38.150104 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: Close
[0m21:22:38.243520 [info ] [Thread-4 (]: 23 of 33 PASS not_null_mart_stock_daily_metrics_DATE ........................... [[32mPASS[0m in 1.39s]
[0m21:22:38.248479 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:22:38.249283 [info ] [Thread-3 (]: 24 of 33 PASS not_null_mart_stock_daily_metrics_PRICE_TREND .................... [[32mPASS[0m in 1.38s]
[0m21:22:38.250121 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:22:38.250696 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:22:38.251134 [info ] [Thread-4 (]: 27 of 33 START test not_null_stg_stock_daily_DAILY_CHANGE_PCT .................. [RUN]
[0m21:22:38.251687 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:22:38.252148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510, now test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285)
[0m21:22:38.252542 [info ] [Thread-3 (]: 28 of 33 START test not_null_stg_stock_daily_DATA_QUALITY_FLAG ................. [RUN]
[0m21:22:38.253072 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:22:38.253461 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200, now test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291)
[0m21:22:38.257262 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:22:38.257847 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:22:38.261036 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:22:38.261856 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:22:38.264379 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DAILY_CHANGE_PCT"
[0m21:22:38.264647 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:22:38.265519 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:22:38.269160 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATA_QUALITY_FLAG"
[0m21:22:38.270931 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DAILY_CHANGE_PCT" cascade
[0m21:22:38.272633 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:22:38.273068 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:22:38.273387 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATA_QUALITY_FLAG" cascade
[0m21:22:38.274865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:22:38.450291 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m21:22:38.451788 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
[0m21:22:38.453178 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:22:38.453729 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where SYMBOL is null



        );
[0m21:22:38.499687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m21:22:38.501166 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
[0m21:22:38.502707 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:22:38.503246 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where CLOSE is null



        );
[0m21:22:38.697353 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m21:22:38.700571 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
[0m21:22:38.703521 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:22:38.704670 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DAILY_CHANGE_PCT is null



        );
[0m21:22:38.721928 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m21:22:38.724607 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
[0m21:22:38.727772 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:22:38.728743 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DATA_QUALITY_FLAG is null



        );
[0m21:22:39.001316 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m21:22:39.005074 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:22:39.008028 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:22:39.008776 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
    
      
    ) dbt_internal_test
[0m21:22:39.056298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m21:22:39.057719 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:22:39.059158 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:22:39.059432 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
    
      
    ) dbt_internal_test
[0m21:22:39.144845 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m21:22:39.147621 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: Close
[0m21:22:39.166974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m21:22:39.168943 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: Close
[0m21:22:39.177271 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m21:22:39.178485 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:22:39.180852 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:22:39.181282 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
    
      
    ) dbt_internal_test
[0m21:22:39.266903 [info ] [Thread-2 (]: 25 of 33 PASS not_null_mart_stock_daily_metrics_SYMBOL ......................... [[32mPASS[0m in 1.31s]
[0m21:22:39.269398 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:22:39.270132 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:22:39.270961 [info ] [Thread-2 (]: 29 of 33 START test not_null_stg_stock_daily_DATE .............................. [RUN]
[0m21:22:39.271690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435, now test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022)
[0m21:22:39.272544 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:22:39.279499 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:22:39.283523 [info ] [Thread-1 (]: 26 of 33 PASS not_null_stg_stock_daily_CLOSE ................................... [[32mPASS[0m in 1.33s]
[0m21:22:39.284156 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:22:39.288490 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:22:39.293142 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATE"
[0m21:22:39.293772 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:22:39.295086 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:22:39.295482 [info ] [Thread-1 (]: 30 of 33 START test not_null_stg_stock_daily_SYMBOL ............................ [RUN]
[0m21:22:39.296167 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATE" cascade
[0m21:22:39.296593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75, now test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0)
[0m21:22:39.297352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:39.297896 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:22:39.303139 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:22:39.304991 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:22:39.309681 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_SYMBOL"
[0m21:22:39.311097 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:22:39.311513 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_SYMBOL" cascade
[0m21:22:39.311849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:39.333888 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m21:22:39.337156 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: Close
[0m21:22:39.339022 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m21:22:39.340717 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:22:39.343225 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:22:39.343723 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
    
      
    ) dbt_internal_test
[0m21:22:39.459416 [info ] [Thread-4 (]: 27 of 33 PASS not_null_stg_stock_daily_DAILY_CHANGE_PCT ........................ [[32mPASS[0m in 1.21s]
[0m21:22:39.460784 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:22:39.461396 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:22:39.461876 [info ] [Thread-4 (]: 31 of 33 START test source_not_null_raw_fact_stock_price_daily_CLOSE ........... [RUN]
[0m21:22:39.462378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178)
[0m21:22:39.462725 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:22:39.466112 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:22:39.467440 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:22:39.470774 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_CLOSE"
[0m21:22:39.471477 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:22:39.471728 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_CLOSE" cascade
[0m21:22:39.472040 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:22:39.503321 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m21:22:39.506654 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: Close
[0m21:22:39.613847 [info ] [Thread-3 (]: 28 of 33 PASS not_null_stg_stock_daily_DATA_QUALITY_FLAG ....................... [[32mPASS[0m in 1.36s]
[0m21:22:39.614712 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:22:39.615169 [debug] [Thread-3 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:22:39.615572 [info ] [Thread-3 (]: 32 of 33 START test source_not_null_raw_fact_stock_price_daily_DATE ............ [RUN]
[0m21:22:39.616079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198)
[0m21:22:39.616406 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:22:39.619238 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:22:39.620176 [debug] [Thread-3 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:22:39.622372 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_DATE"
[0m21:22:39.623092 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:22:39.623390 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_DATE" cascade
[0m21:22:39.623658 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:22:39.764909 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m21:22:39.766145 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
[0m21:22:39.767427 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:22:39.788001 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DATE is null



        );
[0m21:22:39.791238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m21:22:39.796441 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
[0m21:22:39.801141 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:22:39.801802 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where SYMBOL is null



        );
[0m21:22:40.018073 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m21:22:40.019871 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
[0m21:22:40.021870 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:22:40.022422 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where CLOSE is null



        );
[0m21:22:40.314416 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m21:22:40.316910 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
[0m21:22:40.319864 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:22:40.320724 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where DATE is null



        );
[0m21:22:40.723617 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m21:22:40.726151 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:22:40.728756 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:22:40.729681 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
    
      
    ) dbt_internal_test
[0m21:22:40.782723 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m21:22:40.786539 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:22:40.790264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.988 seconds
[0m21:22:40.793105 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:22:40.794779 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:22:40.795465 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
    
      
    ) dbt_internal_test
[0m21:22:40.796573 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:22:40.798051 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m21:22:40.853375 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m21:22:40.857610 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: Close
[0m21:22:40.949102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m21:22:40.953311 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: Close
[0m21:22:40.983499 [info ] [Thread-2 (]: 29 of 33 PASS not_null_stg_stock_daily_DATE .................................... [[32mPASS[0m in 1.71s]
[0m21:22:40.986238 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:22:40.987659 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:22:40.988877 [info ] [Thread-2 (]: 33 of 33 START test source_not_null_raw_fact_stock_price_daily_SYMBOL .......... [RUN]
[0m21:22:40.990294 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a)
[0m21:22:40.991506 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:22:40.999330 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:22:41.001090 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:22:41.005236 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_SYMBOL"
[0m21:22:41.006437 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:22:41.006950 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_SYMBOL" cascade
[0m21:22:41.007463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:22:41.087091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m21:22:41.089029 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:22:41.090831 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:22:41.091355 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
    
      
    ) dbt_internal_test
[0m21:22:41.149662 [info ] [Thread-1 (]: 30 of 33 PASS not_null_stg_stock_daily_SYMBOL .................................. [[32mPASS[0m in 1.85s]
[0m21:22:41.150848 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:22:41.175956 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m21:22:41.178252 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: Close
[0m21:22:41.209490 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m21:22:41.211924 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: Close
[0m21:22:41.316511 [info ] [Thread-4 (]: 31 of 33 PASS source_not_null_raw_fact_stock_price_daily_CLOSE ................. [[32mPASS[0m in 1.85s]
[0m21:22:41.318680 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:22:41.366397 [info ] [Thread-3 (]: 32 of 33 PASS source_not_null_raw_fact_stock_price_daily_DATE .................. [[32mPASS[0m in 1.75s]
[0m21:22:41.368990 [debug] [Thread-3 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:22:41.534732 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m21:22:41.537284 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
[0m21:22:41.540001 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:22:41.541016 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where SYMBOL is null



        );
[0m21:22:42.232187 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m21:22:42.236205 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:22:42.240704 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:22:42.241944 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m21:22:42.390617 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m21:22:42.394890 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: Close
[0m21:22:42.511469 [info ] [Thread-2 (]: 33 of 33 PASS source_not_null_raw_fact_stock_price_daily_SYMBOL ................ [[32mPASS[0m in 1.52s]
[0m21:22:42.513896 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:22:42.521333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:42.522667 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178' was properly closed.
[0m21:22:42.523916 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a' was properly closed.
[0m21:22:42.524619 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0' was properly closed.
[0m21:22:42.525259 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198' was properly closed.
[0m21:22:42.526134 [info ] [MainThread]: 
[0m21:22:42.527419 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 15.06 seconds (15.06s).
[0m21:22:42.532455 [debug] [MainThread]: Command end result
[0m21:22:42.659375 [info ] [MainThread]: 
[0m21:22:42.659990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:22:42.660316 [info ] [MainThread]: 
[0m21:22:42.660628 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m21:22:42.661588 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 16.098726, "process_user_time": 4.579561, "process_kernel_time": 0.360587, "process_mem_max_rss": "236784", "process_out_blocks": "4558", "process_in_blocks": "0"}
[0m21:22:42.661951 [debug] [MainThread]: Command `dbt test` succeeded at 21:22:42.661898 after 16.10 seconds
[0m21:22:42.662227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f459730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eeb3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5cb87350>]}
[0m21:22:42.662502 [debug] [MainThread]: Flushing usage events
[0m21:23:01.571341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f29310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95114b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951177a0>]}


============================== 21:23:01.575451 | 5f9f2313-f69d-48d0-82bb-64d1a16eb104 ==============================
[0m21:23:01.575451 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:23:01.576268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:23:01.579851 [info ] [MainThread]: dbt version: 1.8.8
[0m21:23:01.580229 [info ] [MainThread]: python version: 3.12.4
[0m21:23:01.580606 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m21:23:01.580973 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m21:23:01.968539 [info ] [MainThread]: Using profiles dir at .
[0m21:23:01.969211 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m21:23:01.969578 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m21:23:01.969974 [info ] [MainThread]: adapter type: snowflake
[0m21:23:01.970238 [info ] [MainThread]: adapter version: 1.8.4
[0m21:23:01.992925 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:23:01.993506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f9f2313-f69d-48d0-82bb-64d1a16eb104', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a94eb10>]}
[0m21:23:02.008311 [info ] [MainThread]: Configuration:
[0m21:23:02.008691 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:23:02.009009 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:23:02.009318 [info ] [MainThread]: Required dependencies:
[0m21:23:02.009586 [debug] [MainThread]: Executing "git --help"
[0m21:23:02.011637 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:23:02.011944 [debug] [MainThread]: STDERR: "b''"
[0m21:23:02.012174 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:23:02.012439 [info ] [MainThread]: Connection:
[0m21:23:02.012732 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m21:23:02.013011 [info ] [MainThread]:   user: MALLARD
[0m21:23:02.013308 [info ] [MainThread]:   database: ASH_DB
[0m21:23:02.013548 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m21:23:02.013810 [info ] [MainThread]:   role: TRAINING_ROLE
[0m21:23:02.014040 [info ] [MainThread]:   schema: STOCK_RAW
[0m21:23:02.014321 [info ] [MainThread]:   authenticator: None
[0m21:23:02.014561 [info ] [MainThread]:   oauth_client_id: None
[0m21:23:02.014803 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m21:23:02.015317 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:23:02.015568 [info ] [MainThread]:   host: None
[0m21:23:02.015825 [info ] [MainThread]:   port: None
[0m21:23:02.016074 [info ] [MainThread]:   proxy_host: None
[0m21:23:02.016375 [info ] [MainThread]:   proxy_port: None
[0m21:23:02.016621 [info ] [MainThread]:   protocol: None
[0m21:23:02.016851 [info ] [MainThread]:   connect_retries: 1
[0m21:23:02.017103 [info ] [MainThread]:   connect_timeout: None
[0m21:23:02.017388 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:23:02.017635 [info ] [MainThread]:   retry_all: False
[0m21:23:02.017862 [info ] [MainThread]:   insecure_mode: False
[0m21:23:02.018151 [info ] [MainThread]:   reuse_connections: None
[0m21:23:02.018490 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:23:02.020198 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:23:02.020633 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:23:02.020882 [debug] [MainThread]: On debug: select 1 as id
[0m21:23:02.021121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:02.483910 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.462 seconds
[0m21:23:02.486343 [debug] [MainThread]: On debug: Close
[0m21:23:02.619751 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:23:02.622537 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:23:02.625303 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0981326, "process_user_time": 1.883715, "process_kernel_time": 0.218794, "process_mem_max_rss": "236780", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m21:23:02.626599 [debug] [MainThread]: Command `dbt debug` succeeded at 21:23:02.626451 after 1.10 seconds
[0m21:23:02.627849 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:23:02.628819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f29310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9949e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799f3440>]}
[0m21:23:02.629963 [debug] [MainThread]: Flushing usage events
[0m21:23:05.815549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ccf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91552c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a4c530>]}


============================== 21:23:05.820424 | 1b06f34f-2925-4f2e-a514-2ea9d2320a5a ==============================
[0m21:23:05.820424 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:23:05.821228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:23:05.861012 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:23:05.861665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b06f34f-2925-4f2e-a514-2ea9d2320a5a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91362db0>]}
[0m21:23:05.904483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b06f34f-2925-4f2e-a514-2ea9d2320a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a8f530>]}
[0m21:23:05.994911 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t_0ln9kd'
[0m21:23:05.995299 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:23:06.311782 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:23:06.312732 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:23:06.488780 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:23:06.492295 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:23:07.222154 [info ] [MainThread]: Installed from version 1.1.1
[0m21:23:07.223657 [info ] [MainThread]: Updated version available: 1.3.2
[0m21:23:07.224167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1b06f34f-2925-4f2e-a514-2ea9d2320a5a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912648c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e9e6f0>]}
[0m21:23:07.224543 [info ] [MainThread]: 
[0m21:23:07.224937 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:23:07.226255 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4741921, "process_user_time": 1.014379, "process_kernel_time": 0.122617, "process_mem_max_rss": "232844", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m21:23:07.226778 [debug] [MainThread]: Command `dbt deps` succeeded at 21:23:07.226725 after 1.47 seconds
[0m21:23:07.227198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f05b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916f3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916f0e60>]}
[0m21:23:07.227680 [debug] [MainThread]: Flushing usage events
[0m21:23:11.423296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf0cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eae0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c97d610>]}


============================== 21:23:11.427256 | f4c70bc8-4f35-4c39-92c5-5edf5135b291 ==============================
[0m21:23:11.427256 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:23:11.427930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:23:11.858955 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:23:11.859664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4c70bc8-4f35-4c39-92c5-5edf5135b291', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf04170>]}
[0m21:23:11.894126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c70bc8-4f35-4c39-92c5-5edf5135b291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7a73b0>]}
[0m21:23:11.915390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c70bc8-4f35-4c39-92c5-5edf5135b291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd31460>]}
[0m21:23:11.915900 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:23:11.924828 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:23:12.013031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:12.013385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:12.035635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c70bc8-4f35-4c39-92c5-5edf5135b291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86737cb0>]}
[0m21:23:12.093431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c70bc8-4f35-4c39-92c5-5edf5135b291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7baee870>]}
[0m21:23:12.093789 [info ] [MainThread]: Found 33 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:23:12.094265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c70bc8-4f35-4c39-92c5-5edf5135b291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb8dee0>]}
[0m21:23:12.095299 [info ] [MainThread]: 
[0m21:23:12.095738 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:12.096558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:23:12.103187 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:23:12.103487 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:23:12.103751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:12.504925 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.401 seconds
[0m21:23:12.508592 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:23:12.678269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_analytics)
[0m21:23:12.679692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m21:23:12.681599 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m21:23:12.690552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m21:23:12.691467 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:23:12.693614 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:23:12.695561 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:23:12.697307 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:23:12.697744 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:23:12.698217 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:23:12.698662 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:23:12.699114 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:23:12.699514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:12.699889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:12.700259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:12.700619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:13.058013 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.358 seconds
[0m21:23:13.060237 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:23:13.102671 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 0.403 seconds
[0m21:23:13.106927 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:23:13.148630 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.448 seconds
[0m21:23:13.149649 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.450 seconds
[0m21:23:13.151606 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:23:13.153528 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:23:13.348064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c70bc8-4f35-4c39-92c5-5edf5135b291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce7b0b0>]}
[0m21:23:13.349844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:13.352488 [info ] [MainThread]: 
[0m21:23:13.365551 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m21:23:13.366638 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m21:23:13.367560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now snapshot.stock_analytics.stock_price_snapshot)
[0m21:23:13.368009 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m21:23:13.382110 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m21:23:13.412386 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:13.412738 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m21:23:13.413059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:13.826132 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.413 seconds
[0m21:23:13.841543 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:13.842582 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:23:13.935219 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.092 seconds
[0m21:23:13.941601 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:13.942090 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:23:14.020288 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m21:23:14.048300 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:14.048908 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace temporary table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:23:15.266305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.216 seconds
[0m21:23:15.273932 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:15.275136 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:23:15.379698 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.103 seconds
[0m21:23:15.386814 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:15.387823 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:23:15.485188 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m21:23:15.493605 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:15.495121 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:23:15.591909 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.096 seconds
[0m21:23:15.595313 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:15.595772 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m21:23:15.662985 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.067 seconds
[0m21:23:15.670749 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:15.671375 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m21:23:15.745840 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.074 seconds
[0m21:23:15.759757 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:15.760319 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:23:16.363623 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.602 seconds
[0m21:23:16.372355 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:16.374259 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:23:16.473923 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m21:23:16.474677 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:16.477165 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:16.477583 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
BEGIN
[0m21:23:16.635995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m21:23:16.637139 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:16.637997 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
merge into "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:23:17.266471 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.627 seconds
[0m21:23:17.268754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m21:23:17.270184 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
COMMIT
[0m21:23:17.587243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m21:23:17.600029 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m21:23:17.784051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c70bc8-4f35-4c39-92c5-5edf5135b291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf070e0>]}
[0m21:23:17.786591 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 6[0m in 4.41s]
[0m21:23:17.792022 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m21:23:17.795037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:17.795673 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_stock_analytics' was properly closed.
[0m21:23:17.796145 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_RAW_test_failures' was properly closed.
[0m21:23:17.796570 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m21:23:17.796981 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m21:23:17.797522 [info ] [MainThread]: 
[0m21:23:17.798387 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m21:23:17.799319 [debug] [MainThread]: Command end result
[0m21:23:17.834943 [info ] [MainThread]: 
[0m21:23:17.835612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:17.835997 [info ] [MainThread]: 
[0m21:23:17.836397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:23:17.837484 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.4540606, "process_user_time": 2.503903, "process_kernel_time": 0.310334, "process_mem_max_rss": "232852", "process_out_blocks": "2880", "process_in_blocks": "0"}
[0m21:23:17.837985 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:23:17.837919 after 6.45 seconds
[0m21:23:17.838360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d025160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d025e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c04c500>]}
[0m21:23:17.838624 [debug] [MainThread]: Flushing usage events
[0m21:23:21.228983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada97ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1d8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaecfb320>]}


============================== 21:23:21.232743 | fa57739b-6741-4757-aa20-d70b239034e3 ==============================
[0m21:23:21.232743 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:23:21.233572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:23:21.649477 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:23:21.650239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92283020>]}
[0m21:23:21.680172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ffff50>]}
[0m21:23:21.702746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadaf95b0>]}
[0m21:23:21.703306 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:23:21.711840 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:23:21.798438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:21.798826 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:21.821532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d71f40>]}
[0m21:23:21.882199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cc4fb0>]}
[0m21:23:21.882566 [info ] [MainThread]: Found 33 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:23:21.883053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac78b800>]}
[0m21:23:21.884190 [info ] [MainThread]: 
[0m21:23:21.884769 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:21.886883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:23:21.887264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:23:21.893930 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:23:21.895347 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:23:21.895625 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:23:21.895886 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:23:21.896154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:21.896404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:22.350061 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.454 seconds
[0m21:23:22.359876 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:23:22.444403 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.548 seconds
[0m21:23:22.453633 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:23:22.586707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_raw)
[0m21:23:22.589420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_stock_analytics)
[0m21:23:22.592225 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_test_failures'
[0m21:23:22.605082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m21:23:22.605792 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:23:22.607801 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:23:22.609562 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:23:22.612290 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:23:22.612774 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:23:22.613204 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:23:22.613606 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:23:22.614108 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:23:22.614529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:22.614947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:22.615302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:22.615670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:23.006003 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.391 seconds
[0m21:23:23.007647 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:23:23.082340 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 0.467 seconds
[0m21:23:23.084303 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:23:23.087868 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.472 seconds
[0m21:23:23.088758 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:23:23.135833 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.521 seconds
[0m21:23:23.137070 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:23:23.254503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b3d280>]}
[0m21:23:23.256031 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:23.258074 [info ] [MainThread]: 
[0m21:23:23.267682 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m21:23:23.268205 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_RAW_stock_raw.stg_stock_daily ................ [RUN]
[0m21:23:23.268753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now model.stock_analytics.stg_stock_daily)
[0m21:23:23.269031 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m21:23:23.273137 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m21:23:23.274125 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m21:23:23.289795 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:23:23.290243 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m21:23:23.290520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:23.719908 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.429 seconds
[0m21:23:23.726233 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m21:23:23.728232 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:23:23.728658 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m21:23:24.094088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m21:23:24.114225 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m21:23:24.114740 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m21:23:24.219746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m21:23:24.231700 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m21:23:24.389521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ebea20>]}
[0m21:23:24.391002 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_RAW_stock_raw.stg_stock_daily ........... [[32mSUCCESS 1[0m in 1.12s]
[0m21:23:24.392611 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m21:23:24.393916 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m21:23:24.394535 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m21:23:24.394848 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m21:23:24.395173 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m21:23:24.395514 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_RAW_stock_analytics.int_bollinger ........... [RUN]
[0m21:23:24.396119 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_RAW_stock_analytics.int_daily_returns ....... [RUN]
[0m21:23:24.396698 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_RAW_stock_analytics.int_macd ................ [RUN]
[0m21:23:24.397207 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_RAW_stock_analytics.int_moving_averages ..... [RUN]
[0m21:23:24.397775 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now model.stock_analytics.int_bollinger)
[0m21:23:24.398244 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now model.stock_analytics.int_daily_returns)
[0m21:23:24.398816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_macd)
[0m21:23:24.399208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m21:23:24.399555 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m21:23:24.399881 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m21:23:24.400225 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m21:23:24.400675 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m21:23:24.403722 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m21:23:24.405742 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m21:23:24.407461 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m21:23:24.409243 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m21:23:24.410519 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m21:23:24.410813 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m21:23:24.411188 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m21:23:24.418414 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m21:23:24.422087 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m21:23:24.423712 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m21:23:24.425063 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m21:23:24.426383 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m21:23:24.428406 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:23:24.429247 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:23:24.429657 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
         as
        (-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc
        );
[0m21:23:24.430621 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:23:24.431794 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:23:24.432056 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m21:23:24.432366 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:24.432638 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m21:23:24.432945 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    -- Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m21:23:24.433217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:24.434265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:24.434683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:25.704196 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m21:23:25.707297 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:23:25.707845 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_macd IS $$MACD indicator$$;
[0m21:23:25.783472 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.351 seconds
[0m21:23:25.787172 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:23:25.787783 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m21:23:25.790918 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.359 seconds
[0m21:23:25.793064 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:23:25.793594 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns IS $$Daily returns and volatility metrics$$;
[0m21:23:25.812185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.378 seconds
[0m21:23:25.813407 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m21:23:25.817012 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:23:25.827607 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:23:25.828190 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages IS $$Moving averages for trend analysis$$;
[0m21:23:25.828631 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_macd
[0m21:23:25.921792 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.092 seconds
[0m21:23:25.923821 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m21:23:25.924315 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m21:23:25.924738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m21:23:25.927230 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:23:25.927610 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
[0m21:23:25.938827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:23:25.940668 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:23:25.940988 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
[0m21:23:25.963536 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m21:23:25.965465 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:23:25.965812 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
[0m21:23:26.005933 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.078 seconds
[0m21:23:26.007671 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m21:23:26.007984 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m21:23:26.045465 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.104 seconds
[0m21:23:26.047399 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m21:23:26.047714 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "PRICE_VS_MA20_PCT" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$Golden cross or death cross signal$$;
[0m21:23:26.064210 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m21:23:26.065742 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m21:23:26.066045 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "PREV_ADJ_CLOSE" COMMENT $$$$,
    
        "ADJ_DAILY_CHANGE" COMMENT $$$$,
    
        "ADJ_DAILY_RETURN_PCT" COMMENT $$$$,
    
        "LOG_RETURN" COMMENT $$$$,
    
        "VOLATILITY_20D" COMMENT $$20-day rolling volatility$$,
    
        "CUMULATIVE_RETURN_PCT" COMMENT $$$$;
[0m21:23:26.075677 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m21:23:26.077013 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m21:23:26.185101 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m21:23:26.186537 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m21:23:26.187283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m21:23:26.189514 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m21:23:26.221748 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905f2b70>]}
[0m21:23:26.222451 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_macd ........... [[32mSUCCESS 1[0m in 1.82s]
[0m21:23:26.223359 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m21:23:26.223742 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_rsi
[0m21:23:26.224135 [info ] [Thread-2 (]: 6 of 7 START sql table model STOCK_RAW_stock_analytics.int_rsi ................. [RUN]
[0m21:23:26.224571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_macd, now model.stock_analytics.int_rsi)
[0m21:23:26.224859 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_rsi
[0m21:23:26.227298 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m21:23:26.228186 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m21:23:26.230250 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m21:23:26.231659 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_rsi
[0m21:23:26.234093 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m21:23:26.235991 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:23:26.236337 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m21:23:26.236630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:26.354460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905f40b0>]}
[0m21:23:26.355218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905af140>]}
[0m21:23:26.355811 [info ] [Thread-1 (]: 5 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_moving_averages  [[32mSUCCESS 1[0m in 1.96s]
[0m21:23:26.356692 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905c70b0>]}
[0m21:23:26.357012 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_daily_returns .. [[32mSUCCESS 1[0m in 1.96s]
[0m21:23:26.357497 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m21:23:26.357877 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_bollinger ...... [[32mSUCCESS 1[0m in 1.96s]
[0m21:23:26.358333 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m21:23:26.358872 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m21:23:27.562961 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.326 seconds
[0m21:23:27.573404 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:23:27.574025 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m21:23:27.730664 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m21:23:27.736066 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:23:27.736908 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.int_rsi
[0m21:23:27.819938 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.082 seconds
[0m21:23:27.823471 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m21:23:27.823886 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m21:23:27.967172 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m21:23:27.968633 [debug] [Thread-2 (]: On model.stock_analytics.int_rsi: Close
[0m21:23:28.098725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90437a40>]}
[0m21:23:28.100172 [info ] [Thread-2 (]: 6 of 7 OK created sql table model STOCK_RAW_stock_analytics.int_rsi ............ [[32mSUCCESS 1[0m in 1.87s]
[0m21:23:28.101719 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_rsi
[0m21:23:28.104325 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m21:23:28.105211 [info ] [Thread-1 (]: 7 of 7 START sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [RUN]
[0m21:23:28.106165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_moving_averages, now model.stock_analytics.mart_stock_daily_metrics)
[0m21:23:28.106682 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_daily_metrics
[0m21:23:28.110342 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_daily_metrics"
[0m21:23:28.112951 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_daily_metrics
[0m21:23:28.115649 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_daily_metrics"
[0m21:23:28.118679 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:23:28.119990 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
create or replace transient table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
         as
        (

WITH base AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

ma AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
),

rsi AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_rsi
),

bollinger AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
),

macd AS (
    SELECT * FROM ASH_DB.STOCK_RAW_stock_analytics.int_macd
)

SELECT 
    -- Basic information
    base.SYMBOL,
    base."DATE",
    base."CLOSE",
    base."OPEN",
    base."MAX",
    base."MIN",
    base.VOLUME,
    
    -- Daily changes
    base.DAILY_CHANGE,
    base.DAILY_CHANGE_PCT,
    base.INTRADAY_RANGE,
    base.INTRADAY_RANGE_PCT,
    
    -- Moving Averages
    ma.MA_5,
    ma.MA_20,
    ma.MA_50,
    ma.EMA_12,
    ma.EMA_26,
    
    -- MA Cross Signals (Golden Cross / Death Cross)
    CASE 
        -- Golden Cross: MA5 crosses above MA20
        WHEN ma.MA_5 > ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") 
        THEN 'GOLDEN_CROSS_5_20'
        
        -- Death Cross: MA5 crosses below MA20
        WHEN ma.MA_5 < ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_5_20'
        
        -- Golden Cross: MA20 crosses above MA50
        WHEN ma.MA_20 > ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'GOLDEN_CROSS_20_50'
        
        -- Death Cross: MA20 crosses below MA50
        WHEN ma.MA_20 < ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_20_50'
        
        ELSE 'NO_CROSS'
    END as MA_CROSS_SIGNAL,
    
    -- Price vs MA trend analysis
    CASE 
        WHEN base."CLOSE" > ma.MA_5 AND base."CLOSE" > ma.MA_20 AND base."CLOSE" > ma.MA_50 THEN 'STRONG_UPTREND'
        WHEN base."CLOSE" < ma.MA_5 AND base."CLOSE" < ma.MA_20 AND base."CLOSE" < ma.MA_50 THEN 'STRONG_DOWNTREND'
        WHEN base."CLOSE" > ma.MA_20 THEN 'UPTREND'
        WHEN base."CLOSE" < ma.MA_20 THEN 'DOWNTREND'
        ELSE 'SIDEWAYS'
    END as PRICE_TREND,
    
    -- RSI indicators
    rsi.RSI_14,
    rsi.RSI_SIGNAL,
    
    -- Bollinger Bands
    bollinger.BB_UPPER,
    bollinger.BB_LOWER,
    bollinger.BB_MIDDLE,
    bollinger.BB_WIDTH_PCT,
    bollinger.BB_PERCENT_B,
    bollinger.BB_SIGNAL,
    bollinger.BB_SQUEEZE,
    
    -- MACD indicators
    macd.MACD_LINE,
    macd.SIGNAL_LINE,
    macd.MACD_HISTOGRAM,
    macd.MACD_SIGNAL,
    
    -- Volatility (using intraday range as proxy)
    CASE 
        WHEN base.INTRADAY_RANGE_PCT > 5 THEN 'HIGH_VOLATILITY'
        WHEN base.INTRADAY_RANGE_PCT < 1 THEN 'LOW_VOLATILITY'
        ELSE 'NORMAL_VOLATILITY'
    END as VOLATILITY_SIGNAL

FROM base
LEFT JOIN ma 
    ON base.SYMBOL = ma.SYMBOL AND base."DATE" = ma."DATE"
LEFT JOIN rsi 
    ON base.SYMBOL = rsi.SYMBOL AND base."DATE" = rsi."DATE"
LEFT JOIN bollinger 
    ON base.SYMBOL = bollinger.SYMBOL AND base."DATE" = bollinger."DATE"
LEFT JOIN macd 
    ON base.SYMBOL = macd.SYMBOL AND base."DATE" = macd."DATE"
        );
[0m21:23:28.120686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:29.963261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.842 seconds
[0m21:23:29.972741 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:23:29.973898 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
comment on table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics IS $$Daily stock metrics with all technical indicators$$;
[0m21:23:30.110710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m21:23:30.116713 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:23:30.117296 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
describe table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
[0m21:23:30.310089 [debug] [Thread-1 (]: SQL status: SUCCESS 32 in 0.192 seconds
[0m21:23:30.313363 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m21:23:30.313846 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
alter table ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "OPEN" COMMENT $$$$,
    
        "MAX" COMMENT $$$$,
    
        "MIN" COMMENT $$$$,
    
        "VOLUME" COMMENT $$$$,
    
        "DAILY_CHANGE" COMMENT $$$$,
    
        "DAILY_CHANGE_PCT" COMMENT $$$$,
    
        "INTRADAY_RANGE" COMMENT $$$$,
    
        "INTRADAY_RANGE_PCT" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$$$,
    
        "PRICE_TREND" COMMENT $$Overall price trend$$,
    
        "RSI_14" COMMENT $$$$,
    
        "RSI_SIGNAL" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$$$,
    
        "BB_LOWER" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$$$,
    
        "VOLATILITY_SIGNAL" COMMENT $$$$;
[0m21:23:30.516514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m21:23:30.519915 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_daily_metrics: Close
[0m21:23:30.661162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa57739b-6741-4757-aa20-d70b239034e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90437ef0>]}
[0m21:23:30.665412 [info ] [Thread-1 (]: 7 of 7 OK created sql table model STOCK_RAW_stock_analytics.mart_stock_daily_metrics  [[32mSUCCESS 1[0m in 2.54s]
[0m21:23:30.670998 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m21:23:30.676526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:30.677276 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_daily_metrics' was properly closed.
[0m21:23:30.677795 [debug] [MainThread]: Connection 'model.stock_analytics.int_daily_returns' was properly closed.
[0m21:23:30.678223 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m21:23:30.678618 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m21:23:30.679406 [info ] [MainThread]: 
[0m21:23:30.680314 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m21:23:30.682120 [debug] [MainThread]: Command end result
[0m21:23:30.830741 [info ] [MainThread]: 
[0m21:23:30.831385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:30.831711 [info ] [MainThread]: 
[0m21:23:30.832031 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:23:30.833081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.642537, "process_user_time": 2.873826, "process_kernel_time": 0.281113, "process_mem_max_rss": "232848", "process_out_blocks": "3059", "process_in_blocks": "0"}
[0m21:23:30.833453 [debug] [MainThread]: Command `dbt run` succeeded at 21:23:30.833406 after 9.64 seconds
[0m21:23:30.833743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae18d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafce1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae880440>]}
[0m21:23:30.834014 [debug] [MainThread]: Flushing usage events
[0m21:23:34.204872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ecb560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85d88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ba3470>]}


============================== 21:23:34.210158 | 32cefd99-b7e4-41df-a44a-f3e026e70708 ==============================
[0m21:23:34.210158 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:23:34.211005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:23:34.667312 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:23:34.668259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '32cefd99-b7e4-41df-a44a-f3e026e70708', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2d6cf0>]}
[0m21:23:34.697024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32cefd99-b7e4-41df-a44a-f3e026e70708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb949b680>]}
[0m21:23:34.717335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32cefd99-b7e4-41df-a44a-f3e026e70708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7fefe30>]}
[0m21:23:34.717804 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:23:34.726428 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m21:23:34.812447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:34.812829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:34.834978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32cefd99-b7e4-41df-a44a-f3e026e70708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e20770>]}
[0m21:23:34.906505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32cefd99-b7e4-41df-a44a-f3e026e70708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979b3380>]}
[0m21:23:34.906861 [info ] [MainThread]: Found 33 data tests, 1 snapshot, 7 models, 1 source, 568 macros
[0m21:23:34.907423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32cefd99-b7e4-41df-a44a-f3e026e70708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97af7770>]}
[0m21:23:34.908852 [info ] [MainThread]: 
[0m21:23:34.909303 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:34.911941 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m21:23:34.918895 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m21:23:34.919164 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m21:23:34.919395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:35.392042 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.472 seconds
[0m21:23:35.396450 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m21:23:35.512667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_RAW_test_failures)
[0m21:23:35.514272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m21:23:35.515499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_analytics'
[0m21:23:35.524619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_RAW_stock_raw'
[0m21:23:35.529309 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_test_failures"
[0m21:23:35.531403 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m21:23:35.533375 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_analytics"
[0m21:23:35.535231 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_RAW_stock_raw"
[0m21:23:35.535717 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_test_failures"} */
show objects in ASH_DB.STOCK_RAW_test_failures limit 10000
[0m21:23:35.536153 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m21:23:35.536552 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_analytics"} */
show objects in ASH_DB.STOCK_RAW_stock_analytics limit 10000
[0m21:23:35.536910 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_RAW_stock_raw"} */
show objects in ASH_DB.STOCK_RAW_stock_raw limit 10000
[0m21:23:35.537311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:35.537695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:35.538120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:35.538438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:35.924829 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.387 seconds
[0m21:23:35.927616 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m21:23:35.953492 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 0.416 seconds
[0m21:23:35.957450 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_test_failures: Close
[0m21:23:35.965531 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.427 seconds
[0m21:23:35.967590 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_analytics: Close
[0m21:23:35.988840 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.450 seconds
[0m21:23:35.990590 [debug] [ThreadPool]: On list_ASH_DB_STOCK_RAW_stock_raw: Close
[0m21:23:36.101557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32cefd99-b7e4-41df-a44a-f3e026e70708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb955cb90>]}
[0m21:23:36.102266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:36.103861 [info ] [MainThread]: 
[0m21:23:36.112248 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:23:36.112822 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:23:36.113331 [debug] [Thread-3 (]: Began running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:23:36.113888 [debug] [Thread-4 (]: Began running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:23:36.114175 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [RUN]
[0m21:23:36.114747 [info ] [Thread-2 (]: 2 of 33 START test accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [RUN]
[0m21:23:36.115214 [info ] [Thread-3 (]: 3 of 33 START test accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL  [RUN]
[0m21:23:36.115602 [info ] [Thread-4 (]: 4 of 33 START test accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [RUN]
[0m21:23:36.116078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_raw, now test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6)
[0m21:23:36.116452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_stock_analytics, now test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef)
[0m21:23:36.116803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859)
[0m21:23:36.117147 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_RAW_test_failures, now test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a)
[0m21:23:36.117469 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:23:36.117795 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:23:36.118125 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:23:36.118473 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:23:36.128006 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:23:36.130712 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:23:36.133795 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:23:36.136712 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:23:36.138137 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:23:36.138568 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:23:36.145866 [debug] [Thread-3 (]: Began executing node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:23:36.149499 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MACD_03D76AC49786AFFDB0C9DCED06432A11"
[0m21:23:36.151658 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MOVING_AVE_6CA08515D89550A8F253DD31743BCB67"
[0m21:23:36.151880 [debug] [Thread-4 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:23:36.153746 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_RSI_E03F19197F66DE5A3784EE911F15DCB3"
[0m21:23:36.157377 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:23:36.157987 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:23:36.160583 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_MART_STOCK_DAI_7F3B5CE4F2B7B009A1EB3E6E2DF356F8"
[0m21:23:36.161511 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:23:36.161900 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MACD_03D76AC49786AFFDB0C9DCED06432A11" cascade
[0m21:23:36.162270 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_MOVING_AVE_6CA08515D89550A8F253DD31743BCB67" cascade
[0m21:23:36.162963 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:23:36.163305 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_INT_RSI_E03F19197F66DE5A3784EE911F15DCB3" cascade
[0m21:23:36.163619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:36.163891 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:36.164223 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_MART_STOCK_DAI_7F3B5CE4F2B7B009A1EB3E6E2DF356F8" cascade
[0m21:23:36.164787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:36.167165 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:36.673340 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m21:23:36.674790 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m21:23:36.679667 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
[0m21:23:36.682585 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
[0m21:23:36.695331 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:23:36.696402 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:23:36.696752 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
         as
        (
    
    

with all_values as (

    select
        PRICE_TREND as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by PRICE_TREND

)

select *
from all_values
where value_field not in (
    'STRONG_UPTREND','UPTREND','SIDEWAYS','DOWNTREND','STRONG_DOWNTREND'
)



        );
[0m21:23:36.697063 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
         as
        (
    
    

with all_values as (

    select
        RSI_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_rsi where RSI_SIGNAL IS NOT NULL) dbt_subquery
    group by RSI_SIGNAL

)

select *
from all_values
where value_field not in (
    'OVERBOUGHT','OVERSOLD','NEUTRAL'
)



        );
[0m21:23:36.729587 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m21:23:36.730393 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
[0m21:23:36.731297 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:23:36.731556 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
         as
        (
    
    

with all_values as (

    select
        MA_CROSS_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages where MA_CROSS_SIGNAL IS NOT NULL) dbt_subquery
    group by MA_CROSS_SIGNAL

)

select *
from all_values
where value_field not in (
    'GOLDEN_CROSS','DEATH_CROSS','NEUTRAL'
)



        );
[0m21:23:36.740895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m21:23:36.741616 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
[0m21:23:36.742507 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:23:36.742761 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
         as
        (
    
    

with all_values as (

    select
        MACD_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_macd where MACD_SIGNAL IS NOT NULL) dbt_subquery
    group by MACD_SIGNAL

)

select *
from all_values
where value_field not in (
    'BULLISH_CROSSOVER','BEARISH_CROSSOVER','BULLISH','BEARISH','NEUTRAL'
)



        );
[0m21:23:37.350610 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m21:23:37.354183 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:23:37.355445 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m21:23:37.355764 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
    
      
    ) dbt_internal_test
[0m21:23:37.362722 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m21:23:37.363485 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:23:37.364633 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m21:23:37.364909 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
    
      
    ) dbt_internal_test
[0m21:23:37.388077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m21:23:37.389475 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:23:37.390749 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m21:23:37.391188 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
    
      
    ) dbt_internal_test
[0m21:23:37.458026 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m21:23:37.458887 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:23:37.459812 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m21:23:37.460089 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
    
      
    ) dbt_internal_test
[0m21:23:37.513586 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m21:23:37.518537 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: Close
[0m21:23:37.523138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m21:23:37.524195 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: Close
[0m21:23:37.546901 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m21:23:37.548612 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: Close
[0m21:23:37.598291 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m21:23:37.599569 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: Close
[0m21:23:37.700369 [info ] [Thread-2 (]: 2 of 33 PASS accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [[32mPASS[0m in 1.58s]
[0m21:23:37.702677 [info ] [Thread-4 (]: 4 of 33 PASS accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [[32mPASS[0m in 1.59s]
[0m21:23:37.703940 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [[32mPASS[0m in 1.59s]
[0m21:23:37.704825 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m21:23:37.705728 [info ] [Thread-3 (]: 3 of 33 PASS accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL . [[32mPASS[0m in 1.59s]
[0m21:23:37.708417 [debug] [Thread-4 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m21:23:37.711059 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m21:23:37.712728 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:23:37.714283 [debug] [Thread-3 (]: Finished running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m21:23:37.716625 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:23:37.717367 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:23:37.717719 [info ] [Thread-2 (]: 5 of 33 START test accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [RUN]
[0m21:23:37.718306 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:23:37.718608 [info ] [Thread-4 (]: 6 of 33 START test dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE  [RUN]
[0m21:23:37.718969 [info ] [Thread-1 (]: 7 of 33 START test dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE  [RUN]
[0m21:23:37.719441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef, now test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987)
[0m21:23:37.719739 [info ] [Thread-3 (]: 8 of 33 START test dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0  [RUN]
[0m21:23:37.720275 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1)
[0m21:23:37.720747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c)
[0m21:23:37.721297 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:23:37.721905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859, now test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d)
[0m21:23:37.722306 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:23:37.722634 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:23:37.726611 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:23:37.727041 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:23:37.731396 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:23:37.734037 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:23:37.737200 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:23:37.738172 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:23:37.742290 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_STG_STOCK_DAIL_56D0AB7DE46C8DB0B014849697C2711B"
[0m21:23:37.742553 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:23:37.743409 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:23:37.743624 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:23:37.743808 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:23:37.745941 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_LOWER___BB_MIDDLE"
[0m21:23:37.746436 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."ACCEPTED_VALUES_STG_STOCK_DAIL_56D0AB7DE46C8DB0B014849697C2711B" cascade
[0m21:23:37.748390 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_UPPER___BB_MIDDLE"
[0m21:23:37.750380 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_I_073ECBDFB3F8461B722A2236FFC246EF"
[0m21:23:37.751039 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:23:37.751395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:37.751910 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:23:37.752524 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:23:37.752784 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_LOWER___BB_MIDDLE" cascade
[0m21:23:37.754065 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_UPPER___BB_MIDDLE" cascade
[0m21:23:37.754628 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_I_073ECBDFB3F8461B722A2236FFC246EF" cascade
[0m21:23:37.755056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:37.755353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:37.755641 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:38.268929 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m21:23:38.269952 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
[0m21:23:38.271015 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:23:38.271292 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger where BB_LOWER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_LOWER < BB_MIDDLE)


        );
[0m21:23:38.323359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m21:23:38.324651 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
[0m21:23:38.325724 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:23:38.326041 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger where BB_UPPER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_UPPER > BB_MIDDLE)


        );
[0m21:23:38.363347 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m21:23:38.364186 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
[0m21:23:38.365434 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:23:38.365734 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
         as
        (
    
    

with all_values as (

    select
        DATA_QUALITY_FLAG as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    group by DATA_QUALITY_FLAG

)

select *
from all_values
where value_field not in (
    'VALID','INVALID','ANOMALY','MISSING','NO_TRADING'
)



        );
[0m21:23:38.372154 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m21:23:38.372908 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
[0m21:23:38.373784 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:23:38.374058 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns where VOLATILITY_20D IS NOT NULL) dbt_subquery

where not(VOLATILITY_20D >= 0)


        );
[0m21:23:38.914422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m21:23:38.915798 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:23:38.917363 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m21:23:38.917762 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m21:23:38.951617 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m21:23:38.952699 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:23:38.953874 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m21:23:38.954195 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
    
      
    ) dbt_internal_test
[0m21:23:39.004452 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m21:23:39.005533 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:23:39.006401 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m21:23:39.006653 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m21:23:39.033438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m21:23:39.033924 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m21:23:39.036205 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: Close
[0m21:23:39.037635 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:23:39.040594 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m21:23:39.041194 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
    
      
    ) dbt_internal_test
[0m21:23:39.069404 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m21:23:39.070695 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: Close
[0m21:23:39.133124 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m21:23:39.134326 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: Close
[0m21:23:39.136454 [info ] [Thread-1 (]: 7 of 33 PASS dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE ... [[32mPASS[0m in 1.42s]
[0m21:23:39.137525 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m21:23:39.137818 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:23:39.138101 [info ] [Thread-1 (]: 9 of 33 START test dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100  [RUN]
[0m21:23:39.138434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c, now test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb)
[0m21:23:39.138679 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:23:39.142005 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:23:39.143006 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:23:39.250664 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_RSI_RSI_14__BETWEEN_0_AND_100"
[0m21:23:39.252761 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:23:39.253458 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m21:23:39.254065 [info ] [Thread-3 (]: 8 of 33 PASS dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0 . [[32mPASS[0m in 1.53s]
[0m21:23:39.254392 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_RSI_RSI_14__BETWEEN_0_AND_100" cascade
[0m21:23:39.255656 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: Close
[0m21:23:39.256061 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m21:23:39.256368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:39.257208 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:23:39.259061 [info ] [Thread-3 (]: 10 of 33 START test dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [RUN]
[0m21:23:39.260257 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d, now test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12)
[0m21:23:39.260826 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:23:39.266884 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:23:39.267918 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:23:39.269995 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_C9286FF21D21C3798E9AC65985930CF6"
[0m21:23:39.270618 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:23:39.270887 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_C9286FF21D21C3798E9AC65985930CF6" cascade
[0m21:23:39.271131 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:39.326989 [info ] [Thread-4 (]: 6 of 33 PASS dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE ... [[32mPASS[0m in 1.61s]
[0m21:23:39.328101 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m21:23:39.328463 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:23:39.328891 [info ] [Thread-4 (]: 11 of 33 START test dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [RUN]
[0m21:23:39.329640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1, now test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b)
[0m21:23:39.330027 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:23:39.333673 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:23:39.334767 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:23:39.338398 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_1CD5BBDAE1662B4E1877B262934E23BF"
[0m21:23:39.339406 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:23:39.339798 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_1CD5BBDAE1662B4E1877B262934E23BF" cascade
[0m21:23:39.340152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:39.545717 [info ] [Thread-2 (]: 5 of 33 PASS accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [[32mPASS[0m in 1.83s]
[0m21:23:39.546673 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m21:23:39.547102 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:23:39.547499 [info ] [Thread-2 (]: 12 of 33 START test not_null_int_bollinger_DATE ................................ [RUN]
[0m21:23:39.547951 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987, now test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac)
[0m21:23:39.548312 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:23:39.552005 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:23:39.553303 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:23:39.556568 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_DATE"
[0m21:23:39.557409 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:23:39.557773 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_DATE" cascade
[0m21:23:39.558117 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:39.736848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m21:23:39.738356 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
[0m21:23:39.740005 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:23:39.740536 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
         as
        (



select
    *
from (select * from ASH_DB.STOCK_RAW_stock_analytics.int_rsi where RSI_14 IS NOT NULL) dbt_subquery

where not(RSI_14 BETWEEN 0 AND 100)


        );
[0m21:23:39.780540 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m21:23:39.781965 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
[0m21:23:39.783968 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:23:39.785210 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m21:23:39.785698 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m21:23:39.787056 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
[0m21:23:39.790040 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:23:39.790830 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m21:23:39.942034 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m21:23:39.944699 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
[0m21:23:39.947237 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:23:39.947831 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
where DATE is null



        );
[0m21:23:40.539768 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m21:23:40.543834 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:23:40.546961 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m21:23:40.551927 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:23:40.554459 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m21:23:40.555712 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m21:23:40.556345 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
    
      
    ) dbt_internal_test
[0m21:23:40.556960 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
    
      
    ) dbt_internal_test
[0m21:23:40.564635 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m21:23:40.566320 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:23:40.567563 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m21:23:40.568041 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_DATE
    
      
    ) dbt_internal_test
[0m21:23:40.698179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.957 seconds
[0m21:23:40.705450 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:23:40.706592 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m21:23:40.709541 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: Close
[0m21:23:40.711314 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m21:23:40.713821 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m21:23:40.715800 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: Close
[0m21:23:40.716475 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m21:23:40.717038 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
    
      
    ) dbt_internal_test
[0m21:23:40.720190 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: Close
[0m21:23:40.836172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m21:23:40.840317 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: Close
[0m21:23:40.849045 [info ] [Thread-3 (]: 10 of 33 PASS dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [[32mPASS[0m in 1.59s]
[0m21:23:40.850611 [info ] [Thread-4 (]: 11 of 33 PASS dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [[32mPASS[0m in 1.52s]
[0m21:23:40.851867 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m21:23:40.853255 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m21:23:40.854116 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:23:40.854920 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:23:40.855671 [info ] [Thread-3 (]: 13 of 33 START test not_null_int_bollinger_SYMBOL .............................. [RUN]
[0m21:23:40.856469 [info ] [Thread-4 (]: 14 of 33 START test not_null_int_daily_returns_DATE ............................ [RUN]
[0m21:23:40.857285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12, now test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443)
[0m21:23:40.857841 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b, now test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54)
[0m21:23:40.858362 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:23:40.858930 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:23:40.863448 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:23:40.866726 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:23:40.868920 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:23:40.869344 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:23:40.872255 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_SYMBOL"
[0m21:23:40.875044 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_DATE"
[0m21:23:40.875915 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:23:40.876773 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:23:40.877155 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_SYMBOL" cascade
[0m21:23:40.877521 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_DATE" cascade
[0m21:23:40.877875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:40.878224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:40.915659 [info ] [Thread-2 (]: 12 of 33 PASS not_null_int_bollinger_DATE ...................................... [[32mPASS[0m in 1.37s]
[0m21:23:40.916623 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m21:23:40.917740 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:23:40.918203 [info ] [Thread-2 (]: 15 of 33 START test not_null_int_daily_returns_SYMBOL .......................... [RUN]
[0m21:23:40.918770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac, now test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2)
[0m21:23:40.919156 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:23:40.923177 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:23:40.925051 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:23:40.927730 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_SYMBOL"
[0m21:23:40.928615 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:23:40.928921 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_SYMBOL" cascade
[0m21:23:40.929224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:41.021932 [info ] [Thread-1 (]: 9 of 33 PASS dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100 .... [[32mPASS[0m in 1.88s]
[0m21:23:41.022813 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m21:23:41.023251 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:23:41.023667 [info ] [Thread-1 (]: 16 of 33 START test not_null_int_macd_DATE ..................................... [RUN]
[0m21:23:41.024192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb, now test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b)
[0m21:23:41.024577 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:23:41.027363 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:23:41.032914 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:23:41.035428 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_DATE"
[0m21:23:41.036106 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:23:41.036373 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_DATE" cascade
[0m21:23:41.036614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:41.317875 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m21:23:41.319700 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
[0m21:23:41.321513 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:23:41.322013 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
where DATE is null



        );
[0m21:23:41.325717 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m21:23:41.327219 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
[0m21:23:41.328659 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:23:41.329166 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_bollinger
where SYMBOL is null



        );
[0m21:23:41.331985 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m21:23:41.333057 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
[0m21:23:41.334631 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:23:41.335117 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_daily_returns
where SYMBOL is null



        );
[0m21:23:41.526767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m21:23:41.529851 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
[0m21:23:41.533950 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:23:41.535806 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_macd
where DATE is null



        );
[0m21:23:41.911816 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m21:23:41.915590 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m21:23:41.918873 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:23:41.921270 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:23:41.926158 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m21:23:41.927505 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m21:23:41.928065 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_SYMBOL
    
      
    ) dbt_internal_test
[0m21:23:41.928716 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_daily_returns_DATE
    
      
    ) dbt_internal_test
[0m21:23:42.047304 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m21:23:42.050551 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:23:42.053790 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m21:23:42.054681 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_bollinger_SYMBOL
    
      
    ) dbt_internal_test
[0m21:23:42.061246 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m21:23:42.065200 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: Close
[0m21:23:42.086083 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m21:23:42.088650 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: Close
[0m21:23:42.140261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m21:23:42.143584 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:23:42.147989 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m21:23:42.148947 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_DATE
    
      
    ) dbt_internal_test
[0m21:23:42.167459 [info ] [Thread-2 (]: 15 of 33 PASS not_null_int_daily_returns_SYMBOL ................................ [[32mPASS[0m in 1.25s]
[0m21:23:42.168900 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m21:23:42.169745 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:23:42.170478 [info ] [Thread-2 (]: 17 of 33 START test not_null_int_macd_SYMBOL ................................... [RUN]
[0m21:23:42.171377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2, now test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2)
[0m21:23:42.171955 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:23:42.176669 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:23:42.177991 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:23:42.183474 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_SYMBOL"
[0m21:23:42.184418 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:23:42.184787 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MACD_SYMBOL" cascade
[0m21:23:42.185150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:42.203117 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m21:23:42.204755 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: Close
[0m21:23:42.244887 [info ] [Thread-4 (]: 14 of 33 PASS not_null_int_daily_returns_DATE .................................. [[32mPASS[0m in 1.39s]
[0m21:23:42.245920 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m21:23:42.246728 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:23:42.247268 [info ] [Thread-4 (]: 18 of 33 START test not_null_int_moving_averages_DATE .......................... [RUN]
[0m21:23:42.248049 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54, now test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4)
[0m21:23:42.250159 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:23:42.253721 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:23:42.256474 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:23:42.259441 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_DATE"
[0m21:23:42.260222 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:23:42.260584 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_DATE" cascade
[0m21:23:42.260967 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:42.281511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m21:23:42.286310 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: Close
[0m21:23:42.341515 [info ] [Thread-3 (]: 13 of 33 PASS not_null_int_bollinger_SYMBOL .................................... [[32mPASS[0m in 1.48s]
[0m21:23:42.342100 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m21:23:42.342515 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:23:42.342909 [info ] [Thread-3 (]: 19 of 33 START test not_null_int_moving_averages_SYMBOL ........................ [RUN]
[0m21:23:42.343417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443, now test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a)
[0m21:23:42.343779 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:23:42.346528 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:23:42.348451 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:23:42.350881 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_SYMBOL"
[0m21:23:42.352339 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:23:42.352654 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_SYMBOL" cascade
[0m21:23:42.352957 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:42.413518 [info ] [Thread-1 (]: 16 of 33 PASS not_null_int_macd_DATE ........................................... [[32mPASS[0m in 1.39s]
[0m21:23:42.414088 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m21:23:42.414511 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:23:42.414897 [info ] [Thread-1 (]: 20 of 33 START test not_null_int_rsi_DATE ...................................... [RUN]
[0m21:23:42.415418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b, now test.stock_analytics.not_null_int_rsi_DATE.1856743a58)
[0m21:23:42.415752 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:23:42.418274 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:23:42.419963 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:23:42.422219 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_DATE"
[0m21:23:42.422866 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:23:42.423154 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_DATE" cascade
[0m21:23:42.423433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:42.811710 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m21:23:42.815213 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
[0m21:23:42.817778 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m21:23:42.822905 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:23:42.825543 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
[0m21:23:42.826457 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
where DATE is null



        );
[0m21:23:42.828619 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:23:42.830659 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_macd
where SYMBOL is null



        );
[0m21:23:42.916479 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m21:23:42.919526 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
[0m21:23:42.922790 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:23:42.923915 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_moving_averages
where SYMBOL is null



        );
[0m21:23:42.938196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m21:23:42.940728 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
[0m21:23:42.944425 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:23:42.945198 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_rsi
where DATE is null



        );
[0m21:23:43.391283 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m21:23:43.393441 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:23:43.395275 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m21:23:43.395854 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_macd_SYMBOL
    
      
    ) dbt_internal_test
[0m21:23:43.418958 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m21:23:43.420606 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:23:43.421793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m21:23:43.422979 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m21:23:43.424212 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:23:43.424957 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m21:23:43.426099 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:23:43.426857 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_SYMBOL
    
      
    ) dbt_internal_test
[0m21:23:43.427740 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m21:23:43.429000 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_DATE
    
      
    ) dbt_internal_test
[0m21:23:43.429937 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m21:23:43.431002 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_moving_averages_DATE
    
      
    ) dbt_internal_test
[0m21:23:43.508900 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m21:23:43.511426 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: Close
[0m21:23:43.553515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m21:23:43.557640 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: Close
[0m21:23:43.564476 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m21:23:43.566472 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m21:23:43.569445 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: Close
[0m21:23:43.571492 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: Close
[0m21:23:43.622583 [info ] [Thread-2 (]: 17 of 33 PASS not_null_int_macd_SYMBOL ......................................... [[32mPASS[0m in 1.45s]
[0m21:23:43.623770 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m21:23:43.624414 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:23:43.625063 [info ] [Thread-2 (]: 21 of 33 START test not_null_int_rsi_SYMBOL .................................... [RUN]
[0m21:23:43.625919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2, now test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035)
[0m21:23:43.626386 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:23:43.630522 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:23:43.631632 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:23:43.634755 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_SYMBOL"
[0m21:23:43.635637 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:23:43.635984 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_INT_RSI_SYMBOL" cascade
[0m21:23:43.636330 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:43.676035 [info ] [Thread-3 (]: 19 of 33 PASS not_null_int_moving_averages_SYMBOL .............................. [[32mPASS[0m in 1.33s]
[0m21:23:43.676873 [info ] [Thread-4 (]: 18 of 33 PASS not_null_int_moving_averages_DATE ................................ [[32mPASS[0m in 1.43s]
[0m21:23:43.679386 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m21:23:43.679895 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m21:23:43.680360 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:23:43.680817 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:23:43.681241 [info ] [Thread-3 (]: 22 of 33 START test not_null_mart_stock_daily_metrics_CLOSE .................... [RUN]
[0m21:23:43.681700 [info ] [Thread-4 (]: 23 of 33 START test not_null_mart_stock_daily_metrics_DATE ..................... [RUN]
[0m21:23:43.682173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a, now test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9)
[0m21:23:43.682611 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4, now test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510)
[0m21:23:43.683121 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:23:43.683518 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:23:43.686504 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:23:43.688919 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:23:43.690355 [info ] [Thread-1 (]: 20 of 33 PASS not_null_int_rsi_DATE ............................................ [[32mPASS[0m in 1.27s]
[0m21:23:43.690997 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:23:43.691354 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m21:23:43.693899 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_CLOSE"
[0m21:23:43.694301 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:23:43.694581 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:23:43.695362 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:23:43.698500 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_DATE"
[0m21:23:43.698836 [info ] [Thread-1 (]: 24 of 33 START test not_null_mart_stock_daily_metrics_PRICE_TREND .............. [RUN]
[0m21:23:43.699248 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_CLOSE" cascade
[0m21:23:43.699910 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:23:43.700235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_DATE.1856743a58, now test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200)
[0m21:23:43.700537 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:43.700845 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_DATE" cascade
[0m21:23:43.701150 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:23:43.702667 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:43.704977 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:23:43.707342 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:23:43.709695 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_PRICE_TREND"
[0m21:23:43.710412 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:23:43.710659 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_PRICE_TREND" cascade
[0m21:23:43.710881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:44.052459 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m21:23:44.055402 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
[0m21:23:44.058343 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:23:44.059260 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.int_rsi
where SYMBOL is null



        );
[0m21:23:44.173158 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m21:23:44.176280 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
[0m21:23:44.182835 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:23:44.184686 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where CLOSE is null



        );
[0m21:23:44.186769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m21:23:44.189886 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
[0m21:23:44.192393 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:23:44.193082 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where PRICE_TREND is null



        );
[0m21:23:44.209983 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m21:23:44.211318 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
[0m21:23:44.212987 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:23:44.213571 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where DATE is null



        );
[0m21:23:44.740774 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m21:23:44.742208 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:23:44.743182 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m21:23:44.743632 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_int_rsi_SYMBOL
    
      
    ) dbt_internal_test
[0m21:23:44.789249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m21:23:44.790275 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:23:44.791391 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m21:23:44.791697 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
    
      
    ) dbt_internal_test
[0m21:23:44.855680 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m21:23:44.857250 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: Close
[0m21:23:44.917188 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m21:23:44.918121 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:23:44.918913 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m21:23:44.919185 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_CLOSE
    
      
    ) dbt_internal_test
[0m21:23:44.921040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m21:23:44.922057 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: Close
[0m21:23:44.965266 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m21:23:44.966010 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:23:44.967013 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m21:23:44.967359 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_DATE
    
      
    ) dbt_internal_test
[0m21:23:44.984743 [info ] [Thread-2 (]: 21 of 33 PASS not_null_int_rsi_SYMBOL .......................................... [[32mPASS[0m in 1.36s]
[0m21:23:44.985779 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m21:23:44.986154 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:23:44.986506 [info ] [Thread-2 (]: 25 of 33 START test not_null_mart_stock_daily_metrics_SYMBOL ................... [RUN]
[0m21:23:44.986926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035, now test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435)
[0m21:23:44.987404 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:23:44.991113 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:23:44.992051 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:23:44.994251 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_SYMBOL"
[0m21:23:44.994862 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:23:44.995118 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_SYMBOL" cascade
[0m21:23:44.995333 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:45.035145 [info ] [Thread-1 (]: 24 of 33 PASS not_null_mart_stock_daily_metrics_PRICE_TREND .................... [[32mPASS[0m in 1.33s]
[0m21:23:45.035827 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m21:23:45.036222 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:23:45.036570 [info ] [Thread-1 (]: 26 of 33 START test not_null_stg_stock_daily_CLOSE ............................. [RUN]
[0m21:23:45.036997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200, now test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75)
[0m21:23:45.037299 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:23:45.039640 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:23:45.040515 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:23:45.043492 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_CLOSE"
[0m21:23:45.044136 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:23:45.044374 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_CLOSE" cascade
[0m21:23:45.044596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:45.093029 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m21:23:45.094390 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: Close
[0m21:23:45.101500 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m21:23:45.102576 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: Close
[0m21:23:45.205653 [info ] [Thread-4 (]: 23 of 33 PASS not_null_mart_stock_daily_metrics_DATE ........................... [[32mPASS[0m in 1.52s]
[0m21:23:45.206608 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m21:23:45.207100 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:23:45.207576 [info ] [Thread-4 (]: 27 of 33 START test not_null_stg_stock_daily_DAILY_CHANGE_PCT .................. [RUN]
[0m21:23:45.208356 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510, now test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285)
[0m21:23:45.208836 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:23:45.212902 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:23:45.214733 [info ] [Thread-3 (]: 22 of 33 PASS not_null_mart_stock_daily_metrics_CLOSE .......................... [[32mPASS[0m in 1.53s]
[0m21:23:45.215679 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m21:23:45.216242 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:23:45.216716 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:23:45.217027 [info ] [Thread-3 (]: 28 of 33 START test not_null_stg_stock_daily_DATA_QUALITY_FLAG ................. [RUN]
[0m21:23:45.220900 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DAILY_CHANGE_PCT"
[0m21:23:45.221358 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9, now test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291)
[0m21:23:45.222514 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:23:45.223082 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:23:45.223509 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DAILY_CHANGE_PCT" cascade
[0m21:23:45.226511 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:23:45.227160 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:45.229821 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:23:45.232645 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATA_QUALITY_FLAG"
[0m21:23:45.233690 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:23:45.234170 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATA_QUALITY_FLAG" cascade
[0m21:23:45.234484 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:45.461213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m21:23:45.462682 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
[0m21:23:45.464290 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:23:45.464770 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where CLOSE is null



        );
[0m21:23:45.477607 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m21:23:45.478643 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
[0m21:23:45.479929 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:23:45.480354 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_analytics.mart_stock_daily_metrics
where SYMBOL is null



        );
[0m21:23:45.652632 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m21:23:45.656551 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
[0m21:23:45.663866 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:23:45.665823 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DATA_QUALITY_FLAG is null



        );
[0m21:23:45.677564 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m21:23:45.679909 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
[0m21:23:45.682328 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:23:45.682890 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DAILY_CHANGE_PCT is null



        );
[0m21:23:46.125365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m21:23:46.128868 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:23:46.133990 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m21:23:46.135391 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_CLOSE
    
      
    ) dbt_internal_test
[0m21:23:46.158716 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m21:23:46.161125 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:23:46.163041 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m21:23:46.163696 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
    
      
    ) dbt_internal_test
[0m21:23:46.235366 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m21:23:46.238820 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:23:46.243373 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m21:23:46.244429 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
    
      
    ) dbt_internal_test
[0m21:23:46.328715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m21:23:46.330670 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.166 seconds
[0m21:23:46.335580 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: Close
[0m21:23:46.341002 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: Close
[0m21:23:46.370617 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m21:23:46.373309 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: Close
[0m21:23:46.427386 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m21:23:46.428958 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:23:46.431061 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m21:23:46.431675 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
    
      
    ) dbt_internal_test
[0m21:23:46.501475 [info ] [Thread-1 (]: 26 of 33 PASS not_null_stg_stock_daily_CLOSE ................................... [[32mPASS[0m in 1.46s]
[0m21:23:46.502683 [info ] [Thread-3 (]: 28 of 33 PASS not_null_stg_stock_daily_DATA_QUALITY_FLAG ....................... [[32mPASS[0m in 1.28s]
[0m21:23:46.503695 [info ] [Thread-2 (]: 25 of 33 PASS not_null_mart_stock_daily_metrics_SYMBOL ......................... [[32mPASS[0m in 1.52s]
[0m21:23:46.505100 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m21:23:46.505815 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m21:23:46.506545 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m21:23:46.507220 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:23:46.507813 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:23:46.508455 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:23:46.508940 [info ] [Thread-1 (]: 29 of 33 START test not_null_stg_stock_daily_DATE .............................. [RUN]
[0m21:23:46.509475 [info ] [Thread-3 (]: 30 of 33 START test not_null_stg_stock_daily_SYMBOL ............................ [RUN]
[0m21:23:46.510052 [info ] [Thread-2 (]: 31 of 33 START test source_not_null_raw_fact_stock_price_daily_CLOSE ........... [RUN]
[0m21:23:46.510689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75, now test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022)
[0m21:23:46.511209 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291, now test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0)
[0m21:23:46.511708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178)
[0m21:23:46.512159 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:23:46.512598 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:23:46.513035 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:23:46.518032 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:23:46.520952 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:23:46.523561 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:23:46.524886 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:23:46.525247 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:23:46.527597 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATE"
[0m21:23:46.528002 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:23:46.530062 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_SYMBOL"
[0m21:23:46.530835 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:23:46.532907 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_CLOSE"
[0m21:23:46.533600 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:23:46.533910 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATE" cascade
[0m21:23:46.534619 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:23:46.534950 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_SYMBOL" cascade
[0m21:23:46.535283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:46.535634 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_CLOSE" cascade
[0m21:23:46.536281 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:46.537785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:46.541886 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:23:46.546955 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: Close
[0m21:23:46.665919 [info ] [Thread-4 (]: 27 of 33 PASS not_null_stg_stock_daily_DAILY_CHANGE_PCT ........................ [[32mPASS[0m in 1.46s]
[0m21:23:46.666559 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m21:23:46.667002 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:23:46.667404 [info ] [Thread-4 (]: 32 of 33 START test source_not_null_raw_fact_stock_price_daily_DATE ............ [RUN]
[0m21:23:46.667822 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198)
[0m21:23:46.668148 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:23:46.671501 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:23:46.673155 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:23:46.675241 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_DATE"
[0m21:23:46.675858 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:23:46.676144 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_DATE" cascade
[0m21:23:46.676417 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:46.998245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m21:23:47.001800 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m21:23:47.003681 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m21:23:47.006580 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
[0m21:23:47.008566 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
[0m21:23:47.010388 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
[0m21:23:47.013414 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:23:47.015611 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:23:47.017532 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:23:47.018394 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where DATE is null



        );
[0m21:23:47.019218 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where CLOSE is null



        );
[0m21:23:47.019949 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW_stock_raw.stg_stock_daily
where SYMBOL is null



        );
[0m21:23:47.159302 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m21:23:47.163732 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
[0m21:23:47.167136 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:23:47.168250 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where DATE is null



        );
[0m21:23:47.491015 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m21:23:47.496230 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:23:47.499904 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m21:23:47.500957 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
    
      
    ) dbt_internal_test
[0m21:23:47.503957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m21:23:47.507300 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:23:47.509447 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m21:23:47.510435 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_DATE
    
      
    ) dbt_internal_test
[0m21:23:47.543810 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m21:23:47.545709 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:23:47.547466 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m21:23:47.548115 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
    
      
    ) dbt_internal_test
[0m21:23:47.622302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m21:23:47.625247 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: Close
[0m21:23:47.627061 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m21:23:47.629085 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: Close
[0m21:23:47.646475 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m21:23:47.648055 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: Close
[0m21:23:47.691761 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m21:23:47.693158 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:23:47.694948 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m21:23:47.695372 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.not_null_stg_stock_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m21:23:47.737564 [info ] [Thread-1 (]: 29 of 33 PASS not_null_stg_stock_daily_DATE .................................... [[32mPASS[0m in 1.23s]
[0m21:23:47.738903 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m21:23:47.739445 [debug] [Thread-1 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:23:47.739962 [info ] [Thread-1 (]: 33 of 33 START test source_not_null_raw_fact_stock_price_daily_SYMBOL .......... [RUN]
[0m21:23:47.740648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a)
[0m21:23:47.741090 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:23:47.745042 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:23:47.746981 [debug] [Thread-1 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:23:47.749420 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_SYMBOL"
[0m21:23:47.750221 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:23:47.750922 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
drop table if exists "ASH_DB"."STOCK_RAW_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_SYMBOL" cascade
[0m21:23:47.751217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:47.752349 [info ] [Thread-2 (]: 31 of 33 PASS source_not_null_raw_fact_stock_price_daily_CLOSE ................. [[32mPASS[0m in 1.24s]
[0m21:23:47.753690 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m21:23:47.755369 [info ] [Thread-4 (]: 32 of 33 PASS source_not_null_raw_fact_stock_price_daily_DATE .................. [[32mPASS[0m in 1.09s]
[0m21:23:47.755822 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m21:23:47.826106 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m21:23:47.827751 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: Close
[0m21:23:47.945988 [info ] [Thread-3 (]: 30 of 33 PASS not_null_stg_stock_daily_SYMBOL .................................. [[32mPASS[0m in 1.43s]
[0m21:23:47.947053 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m21:23:48.253779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m21:23:48.255263 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
[0m21:23:48.256701 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:23:48.257172 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
create or replace transient table ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_RAW.fact_stock_price_daily
where SYMBOL is null



        );
[0m21:23:49.026844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m21:23:49.031256 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:23:49.036344 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m21:23:49.037391 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_RAW_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m21:23:49.157596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m21:23:49.160694 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: Close
[0m21:23:49.764214 [info ] [Thread-1 (]: 33 of 33 PASS source_not_null_raw_fact_stock_price_daily_SYMBOL ................ [[32mPASS[0m in 2.02s]
[0m21:23:49.767359 [debug] [Thread-1 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m21:23:49.777212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:49.778400 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198' was properly closed.
[0m21:23:49.779037 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0' was properly closed.
[0m21:23:49.779568 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178' was properly closed.
[0m21:23:49.780053 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a' was properly closed.
[0m21:23:49.780732 [info ] [MainThread]: 
[0m21:23:49.781808 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 14.87 seconds (14.87s).
[0m21:23:49.791260 [debug] [MainThread]: Command end result
[0m21:23:49.830643 [info ] [MainThread]: 
[0m21:23:49.831253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:49.831542 [info ] [MainThread]: 
[0m21:23:49.831824 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m21:23:49.833195 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 15.666023, "process_user_time": 4.062114, "process_kernel_time": 0.336033, "process_mem_max_rss": "236788", "process_out_blocks": "3236", "process_in_blocks": "0"}
[0m21:23:49.833635 [debug] [MainThread]: Command `dbt test` succeeded at 21:23:49.833564 after 15.67 seconds
[0m21:23:49.834030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b9c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9659df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fea750>]}
[0m21:23:49.834378 [debug] [MainThread]: Flushing usage events
[0m23:42:55.973827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8331d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa781a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ae08c0>]}


============================== 23:42:55.977492 | 2a0d90a0-91e4-4e28-8b8d-f07cd81b0320 ==============================
[0m23:42:55.977492 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:42:55.978386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:42:55.981918 [info ] [MainThread]: dbt version: 1.8.8
[0m23:42:55.982237 [info ] [MainThread]: python version: 3.12.4
[0m23:42:55.982454 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m23:42:55.982692 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m23:42:56.390237 [info ] [MainThread]: Using profiles dir at .
[0m23:42:56.390771 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m23:42:56.391133 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m23:42:56.391523 [info ] [MainThread]: adapter type: snowflake
[0m23:42:56.391866 [info ] [MainThread]: adapter version: 1.8.4
[0m23:42:56.414150 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:42:56.414523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a0d90a0-91e4-4e28-8b8d-f07cd81b0320', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c166cf0>]}
[0m23:42:56.428855 [info ] [MainThread]: Configuration:
[0m23:42:56.429209 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:42:56.429493 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:42:56.429770 [info ] [MainThread]: Required dependencies:
[0m23:42:56.430079 [debug] [MainThread]: Executing "git --help"
[0m23:42:56.434750 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:42:56.435019 [debug] [MainThread]: STDERR: "b''"
[0m23:42:56.435223 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:42:56.435450 [info ] [MainThread]: Connection:
[0m23:42:56.435639 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m23:42:56.435815 [info ] [MainThread]:   user: MALLARD
[0m23:42:56.436000 [info ] [MainThread]:   database: ASH_DB
[0m23:42:56.436187 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m23:42:56.436362 [info ] [MainThread]:   role: TRAINING_ROLE
[0m23:42:56.436530 [info ] [MainThread]:   schema: STOCK
[0m23:42:56.436744 [info ] [MainThread]:   authenticator: None
[0m23:42:56.436941 [info ] [MainThread]:   oauth_client_id: None
[0m23:42:56.437134 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m23:42:56.437640 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:42:56.437825 [info ] [MainThread]:   host: None
[0m23:42:56.438003 [info ] [MainThread]:   port: None
[0m23:42:56.438206 [info ] [MainThread]:   proxy_host: None
[0m23:42:56.438387 [info ] [MainThread]:   proxy_port: None
[0m23:42:56.438583 [info ] [MainThread]:   protocol: None
[0m23:42:56.438850 [info ] [MainThread]:   connect_retries: 1
[0m23:42:56.439088 [info ] [MainThread]:   connect_timeout: None
[0m23:42:56.439307 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:42:56.439504 [info ] [MainThread]:   retry_all: False
[0m23:42:56.439676 [info ] [MainThread]:   insecure_mode: False
[0m23:42:56.439858 [info ] [MainThread]:   reuse_connections: None
[0m23:42:56.440146 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:42:56.441866 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:42:56.442454 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:42:56.442792 [debug] [MainThread]: On debug: select 1 as id
[0m23:42:56.443046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:56.917479 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.474 seconds
[0m23:42:56.919219 [debug] [MainThread]: On debug: Close
[0m23:42:57.080138 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:42:57.084502 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:42:57.086937 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.153844, "process_user_time": 1.929842, "process_kernel_time": 0.207939, "process_mem_max_rss": "234796", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m23:42:57.088348 [debug] [MainThread]: Command `dbt debug` succeeded at 23:42:57.088159 after 1.16 seconds
[0m23:42:57.089149 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:42:57.090070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8331d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b33ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c0eea0>]}
[0m23:42:57.090912 [debug] [MainThread]: Flushing usage events
[0m23:42:59.893769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a54920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a55b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d33800>]}


============================== 23:42:59.897148 | 26570b2e-0985-4276-a3d1-c6c1330b196f ==============================
[0m23:42:59.897148 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:42:59.897729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:42:59.920016 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:42:59.920420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26570b2e-0985-4276-a3d1-c6c1330b196f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22b8680>]}
[0m23:42:59.950009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26570b2e-0985-4276-a3d1-c6c1330b196f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29995e0>]}
[0m23:42:59.994274 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bg4oeh0n'
[0m23:42:59.994643 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:43:00.316177 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:43:00.317579 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:43:00.512395 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:43:00.520742 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:43:01.144702 [info ] [MainThread]: Installed from version 1.1.1
[0m23:43:01.145457 [info ] [MainThread]: Updated version available: 1.3.2
[0m23:43:01.145870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26570b2e-0985-4276-a3d1-c6c1330b196f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22037d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2203980>]}
[0m23:43:01.146257 [info ] [MainThread]: 
[0m23:43:01.146553 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:43:01.147322 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2893535, "process_user_time": 0.921754, "process_kernel_time": 0.121835, "process_mem_max_rss": "236824", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m23:43:01.147652 [debug] [MainThread]: Command `dbt deps` succeeded at 23:43:01.147607 after 1.29 seconds
[0m23:43:01.147905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b67620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2456720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30db170>]}
[0m23:43:01.148237 [debug] [MainThread]: Flushing usage events
[0m23:43:03.827229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c29e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6fb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb018e0>]}


============================== 23:43:03.831177 | 1c0fc357-7620-4c22-a08a-93517326107e ==============================
[0m23:43:03.831177 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:43:03.831902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:04.261794 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:43:04.262371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6be2a540>]}
[0m23:43:04.288788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc3fda0>]}
[0m23:43:04.309121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cae55b0>]}
[0m23:43:04.309618 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:43:04.317853 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m23:43:04.370171 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:43:04.370737 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:43:04.371141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8d2f60>]}
[0m23:43:05.124709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b3e0620>]}
[0m23:43:05.189146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ab41820>]}
[0m23:43:05.189588 [info ] [MainThread]: Found 7 models, 1 snapshot, 33 data tests, 1 source, 568 macros
[0m23:43:05.190201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6afe10d0>]}
[0m23:43:05.191392 [info ] [MainThread]: 
[0m23:43:05.191924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:43:05.192520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m23:43:05.198764 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m23:43:05.199151 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m23:43:05.199395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:05.618923 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.419 seconds
[0m23:43:05.622750 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m23:43:05.840975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_raw)
[0m23:43:05.842143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_test_failures'
[0m23:43:05.844363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_analytics'
[0m23:43:05.853918 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_raw"
[0m23:43:05.856417 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_test_failures"
[0m23:43:05.857003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m23:43:05.860149 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_analytics"
[0m23:43:05.860640 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_raw"} */
show objects in ASH_DB.STOCK_raw limit 10000
[0m23:43:05.861136 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_test_failures"} */
show objects in ASH_DB.STOCK_test_failures limit 10000
[0m23:43:05.863059 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m23:43:05.863576 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_analytics"} */
show objects in ASH_DB.STOCK_analytics limit 10000
[0m23:43:05.864013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:05.864391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:05.864775 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m23:43:05.865165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:05.868397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:06.308212 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03def-0106-eb81-000f-c0df006f5e5e
[0m23:43:06.310244 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03def-0106-eb81-000f-c0df006f5e5a
[0m23:43:06.311110 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03def-0106-ec6f-000f-c0df00707dde
[0m23:43:06.311923 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:43:06.312724 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:43:06.313352 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:43:06.314119 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:43:06.314841 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:43:06.315533 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:43:06.316067 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:43:06.316621 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:43:06.317277 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:43:06.317996 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: Close
[0m23:43:06.318586 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: Close
[0m23:43:06.319141 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: Close
[0m23:43:06.325305 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.457 seconds
[0m23:43:06.327872 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m23:43:06.469337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6af41bb0>]}
[0m23:43:06.471567 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:06.473757 [info ] [MainThread]: 
[0m23:43:06.488167 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m23:43:06.489004 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m23:43:06.490227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_analytics, now snapshot.stock_analytics.stock_price_snapshot)
[0m23:43:06.490664 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m23:43:06.498674 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m23:43:06.530545 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:43:06.530914 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m23:43:06.531224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:06.893809 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03def-0106-ed95-000f-c0df0070983a
[0m23:43:06.895509 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASH_DB.STOCK_RAW' does not exist or not authorized.
[0m23:43:06.897117 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m23:43:07.033077 [debug] [Thread-1 (]: Database Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASH_DB.STOCK_RAW' does not exist or not authorized.
[0m23:43:07.034897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c0fc357-7620-4c22-a08a-93517326107e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a7e19a0>]}
[0m23:43:07.035844 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stock_price_snapshot ....................... [[31mERROR[0m in 0.54s]
[0m23:43:07.036963 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m23:43:07.039308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:07.039719 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_raw' was properly closed.
[0m23:43:07.040063 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_test_failures' was properly closed.
[0m23:43:07.040386 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m23:43:07.040688 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m23:43:07.041036 [info ] [MainThread]: 
[0m23:43:07.041574 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m23:43:07.042218 [debug] [MainThread]: Command end result
[0m23:43:07.073551 [info ] [MainThread]: 
[0m23:43:07.074122 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:43:07.074416 [info ] [MainThread]: 
[0m23:43:07.074693 [error] [MainThread]:   Database Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASH_DB.STOCK_RAW' does not exist or not authorized.
[0m23:43:07.074936 [info ] [MainThread]: 
[0m23:43:07.075305 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:43:07.075963 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.2893212, "process_user_time": 3.049317, "process_kernel_time": 0.198329, "process_mem_max_rss": "236788", "process_out_blocks": "4151", "command_success": false, "process_in_blocks": "0"}
[0m23:43:07.076356 [debug] [MainThread]: Command `dbt snapshot` failed at 23:43:07.076288 after 3.29 seconds
[0m23:43:07.076645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2dfd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b71d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b71c9e0>]}
[0m23:43:07.076916 [debug] [MainThread]: Flushing usage events
[0m23:48:10.228883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c9d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45837d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5688920>]}


============================== 23:48:10.232809 | b3e227c4-1a4f-455c-bc96-a9db8c5d2531 ==============================
[0m23:48:10.232809 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:48:10.233669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:48:10.630727 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:48:10.631374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b3e227c4-1a4f-455c-bc96-a9db8c5d2531', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e47230>]}
[0m23:48:10.659542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3e227c4-1a4f-455c-bc96-a9db8c5d2531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45a91c0>]}
[0m23:48:10.683253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3e227c4-1a4f-455c-bc96-a9db8c5d2531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ee5f70>]}
[0m23:48:10.683859 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:48:10.692465 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m23:48:10.772442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:48:10.772804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:48:10.794815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3e227c4-1a4f-455c-bc96-a9db8c5d2531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f45910>]}
[0m23:48:10.857213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3e227c4-1a4f-455c-bc96-a9db8c5d2531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93db7860>]}
[0m23:48:10.857657 [info ] [MainThread]: Found 7 models, 1 snapshot, 33 data tests, 1 source, 568 macros
[0m23:48:10.858094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3e227c4-1a4f-455c-bc96-a9db8c5d2531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4086720>]}
[0m23:48:10.859439 [info ] [MainThread]: 
[0m23:48:10.859939 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:10.860545 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m23:48:10.867820 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m23:48:10.868226 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m23:48:10.868550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:11.500633 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.632 seconds
[0m23:48:11.504281 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m23:48:11.755705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m23:48:11.756325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_analytics'
[0m23:48:11.757413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_raw'
[0m23:48:11.762875 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m23:48:11.763513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_test_failures'
[0m23:48:11.764744 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_analytics"
[0m23:48:11.766092 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_raw"
[0m23:48:11.766422 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m23:48:11.767580 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_test_failures"
[0m23:48:11.767875 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_analytics"} */
show objects in ASH_DB.STOCK_analytics limit 10000
[0m23:48:11.768154 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_raw"} */
show objects in ASH_DB.STOCK_raw limit 10000
[0m23:48:11.768446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:11.768723 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_test_failures"} */
show objects in ASH_DB.STOCK_test_failures limit 10000
[0m23:48:11.768992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:11.769229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:11.770416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:12.159796 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03df4-0106-eb87-000f-c0df0070d616
[0m23:48:12.161038 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:48:12.161953 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:48:12.162612 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:48:12.163356 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: Close
[0m23:48:12.187817 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03df4-0106-eb87-000f-c0df0070d61a
[0m23:48:12.188961 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03df4-0106-eb85-000f-c0df0070b612
[0m23:48:12.189733 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:48:12.190992 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:48:12.192213 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:48:12.193118 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:48:12.193801 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:48:12.194461 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:48:12.195080 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: Close
[0m23:48:12.195642 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: Close
[0m23:48:12.202617 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.434 seconds
[0m23:48:12.204750 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m23:48:12.365372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3e227c4-1a4f-455c-bc96-a9db8c5d2531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ceedb0>]}
[0m23:48:12.368703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:12.370865 [info ] [MainThread]: 
[0m23:48:12.384282 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m23:48:12.385211 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m23:48:12.386310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_analytics, now snapshot.stock_analytics.stock_price_snapshot)
[0m23:48:12.386804 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m23:48:12.402085 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m23:48:12.432157 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:48:12.432600 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK_RAW.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m23:48:12.432930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:12.823763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03df4-0106-eb85-000f-c0df0070b616
[0m23:48:12.824334 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASH_DB.STOCK_RAW' does not exist or not authorized.
[0m23:48:12.824766 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m23:48:12.937093 [debug] [Thread-1 (]: Database Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASH_DB.STOCK_RAW' does not exist or not authorized.
[0m23:48:12.938774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3e227c4-1a4f-455c-bc96-a9db8c5d2531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981c2f00>]}
[0m23:48:12.939471 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stock_price_snapshot ....................... [[31mERROR[0m in 0.55s]
[0m23:48:12.940499 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m23:48:12.942611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:12.943007 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m23:48:12.943357 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m23:48:12.943664 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_raw' was properly closed.
[0m23:48:12.943967 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_test_failures' was properly closed.
[0m23:48:12.944319 [info ] [MainThread]: 
[0m23:48:12.944798 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m23:48:12.945581 [debug] [MainThread]: Command end result
[0m23:48:12.975389 [info ] [MainThread]: 
[0m23:48:12.976039 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:48:12.976371 [info ] [MainThread]: 
[0m23:48:12.976661 [error] [MainThread]:   Database Error in snapshot stock_price_snapshot (snapshots/snapshot_price_corrections.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASH_DB.STOCK_RAW' does not exist or not authorized.
[0m23:48:12.976940 [info ] [MainThread]: 
[0m23:48:12.977191 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:48:12.977883 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 2.7914705, "process_user_time": 2.301135, "process_kernel_time": 0.218526, "process_mem_max_rss": "236784", "process_out_blocks": "2848", "command_success": false, "process_in_blocks": "0"}
[0m23:48:12.978248 [debug] [MainThread]: Command `dbt snapshot` failed at 23:48:12.978201 after 2.79 seconds
[0m23:48:12.978541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c9d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4a4d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c46b40>]}
[0m23:48:12.978825 [debug] [MainThread]: Flushing usage events
[0m23:53:46.236722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12f0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb040d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb151b1a0>]}


============================== 23:53:46.240655 | 168ef88f-7fc3-4dac-95f6-005d8fa66d30 ==============================
[0m23:53:46.240655 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:53:46.241224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:53:46.244480 [info ] [MainThread]: dbt version: 1.8.8
[0m23:53:46.244768 [info ] [MainThread]: python version: 3.12.4
[0m23:53:46.244994 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m23:53:46.245222 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m23:53:46.603310 [info ] [MainThread]: Using profiles dir at .
[0m23:53:46.603861 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m23:53:46.604204 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m23:53:46.604617 [info ] [MainThread]: adapter type: snowflake
[0m23:53:46.604886 [info ] [MainThread]: adapter version: 1.8.4
[0m23:53:46.627594 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:53:46.627965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '168ef88f-7fc3-4dac-95f6-005d8fa66d30', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab82420>]}
[0m23:53:46.642275 [info ] [MainThread]: Configuration:
[0m23:53:46.642672 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:53:46.643005 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:53:46.643302 [info ] [MainThread]: Required dependencies:
[0m23:53:46.643607 [debug] [MainThread]: Executing "git --help"
[0m23:53:46.645438 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:53:46.645722 [debug] [MainThread]: STDERR: "b''"
[0m23:53:46.645951 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:53:46.646225 [info ] [MainThread]: Connection:
[0m23:53:46.646503 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m23:53:46.646798 [info ] [MainThread]:   user: MALLARD
[0m23:53:46.647070 [info ] [MainThread]:   database: ASH_DB
[0m23:53:46.647361 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m23:53:46.647633 [info ] [MainThread]:   role: TRAINING_ROLE
[0m23:53:46.647882 [info ] [MainThread]:   schema: STOCK
[0m23:53:46.648119 [info ] [MainThread]:   authenticator: None
[0m23:53:46.648386 [info ] [MainThread]:   oauth_client_id: None
[0m23:53:46.648621 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m23:53:46.649147 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:53:46.649398 [info ] [MainThread]:   host: None
[0m23:53:46.649712 [info ] [MainThread]:   port: None
[0m23:53:46.649956 [info ] [MainThread]:   proxy_host: None
[0m23:53:46.650207 [info ] [MainThread]:   proxy_port: None
[0m23:53:46.650448 [info ] [MainThread]:   protocol: None
[0m23:53:46.650691 [info ] [MainThread]:   connect_retries: 1
[0m23:53:46.650934 [info ] [MainThread]:   connect_timeout: None
[0m23:53:46.651169 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:53:46.651410 [info ] [MainThread]:   retry_all: False
[0m23:53:46.651685 [info ] [MainThread]:   insecure_mode: False
[0m23:53:46.651974 [info ] [MainThread]:   reuse_connections: None
[0m23:53:46.652279 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:53:46.653884 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:53:46.654329 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:53:46.654603 [debug] [MainThread]: On debug: select 1 as id
[0m23:53:46.654851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:46.996257 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.341 seconds
[0m23:53:46.999175 [debug] [MainThread]: On debug: Close
[0m23:53:47.212757 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:53:47.214249 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:53:47.215944 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0187626, "process_user_time": 1.82625, "process_kernel_time": 0.121951, "process_mem_max_rss": "236776", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m23:53:47.217019 [debug] [MainThread]: Command `dbt debug` succeeded at 23:53:47.216830 after 1.02 seconds
[0m23:53:47.217801 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:53:47.218462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb47bb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb44242f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1395970>]}
[0m23:53:47.219300 [debug] [MainThread]: Flushing usage events
[0m23:53:50.189098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ce9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ce81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7551e80>]}


============================== 23:53:50.192480 | 080cd2ca-9979-4ba5-b077-4f5cbd873a54 ==============================
[0m23:53:50.192480 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:53:50.193044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:53:50.215190 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:53:50.215593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '080cd2ca-9979-4ba5-b077-4f5cbd873a54', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb46d3e00>]}
[0m23:53:50.241269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '080cd2ca-9979-4ba5-b077-4f5cbd873a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb60e3290>]}
[0m23:53:50.284161 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d81ub6s_'
[0m23:53:50.284516 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:53:50.589745 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:53:50.590542 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:53:50.781093 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:53:50.790003 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:53:51.427488 [info ] [MainThread]: Installed from version 1.1.1
[0m23:53:51.428117 [info ] [MainThread]: Updated version available: 1.3.2
[0m23:53:51.428454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '080cd2ca-9979-4ba5-b077-4f5cbd873a54', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ceb140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb444a570>]}
[0m23:53:51.428802 [info ] [MainThread]: 
[0m23:53:51.429208 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:53:51.430108 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2773207, "process_user_time": 0.924888, "process_kernel_time": 0.085637, "process_mem_max_rss": "236788", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m23:53:51.430454 [debug] [MainThread]: Command `dbt deps` succeeded at 23:53:51.430407 after 1.28 seconds
[0m23:53:51.430740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6752c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4591970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb46d27b0>]}
[0m23:53:51.430984 [debug] [MainThread]: Flushing usage events
[0m23:53:54.162326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c83b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c300aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1c98e0>]}


============================== 23:53:54.166145 | 13dd9f07-fe56-4d55-a794-eea5743b5b44 ==============================
[0m23:53:54.166145 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:53:54.166830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:54.524527 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:53:54.525258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '13dd9f07-fe56-4d55-a794-eea5743b5b44', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6038dd30>]}
[0m23:53:54.548792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13dd9f07-fe56-4d55-a794-eea5743b5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc59d00>]}
[0m23:53:54.568599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13dd9f07-fe56-4d55-a794-eea5743b5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6011bd70>]}
[0m23:53:54.569059 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:53:54.576956 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m23:53:54.659945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:53:54.660757 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/sources.yml
[0m23:53:54.960857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13dd9f07-fe56-4d55-a794-eea5743b5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b7bb8f0>]}
[0m23:53:55.059168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13dd9f07-fe56-4d55-a794-eea5743b5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5af80380>]}
[0m23:53:55.059651 [info ] [MainThread]: Found 7 models, 1 snapshot, 33 data tests, 1 source, 568 macros
[0m23:53:55.060254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13dd9f07-fe56-4d55-a794-eea5743b5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bd9fd40>]}
[0m23:53:55.061297 [info ] [MainThread]: 
[0m23:53:55.061737 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:53:55.062295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m23:53:55.067989 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m23:53:55.068237 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m23:53:55.068462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:55.494102 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.426 seconds
[0m23:53:55.496562 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m23:53:55.615823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_analytics)
[0m23:53:55.616612 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_raw'
[0m23:53:55.617833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_test_failures'
[0m23:53:55.624688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m23:53:55.625361 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_analytics"
[0m23:53:55.627077 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_raw"
[0m23:53:55.628740 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_test_failures"
[0m23:53:55.630885 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m23:53:55.631273 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_analytics"} */
show objects in ASH_DB.STOCK_analytics limit 10000
[0m23:53:55.631694 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_raw"} */
show objects in ASH_DB.STOCK_raw limit 10000
[0m23:53:55.632088 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_test_failures"} */
show objects in ASH_DB.STOCK_test_failures limit 10000
[0m23:53:55.632483 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m23:53:55.632851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:55.633262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:55.633642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:55.634011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:56.042479 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03df9-0106-ebe6-000f-c0df00701ec2
[0m23:53:56.043692 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03df9-0106-ec41-000f-c0df00704c4a
[0m23:53:56.044699 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:53:56.045719 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:53:56.048331 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:53:56.049284 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03df9-0106-eb87-000f-c0df0070d62a
[0m23:53:56.050159 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:53:56.050879 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:53:56.051558 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:53:56.052134 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:53:56.052764 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: Close
[0m23:53:56.053470 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:53:56.054047 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: Close
[0m23:53:56.055894 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:53:56.058403 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: Close
[0m23:53:56.062206 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.428 seconds
[0m23:53:56.063997 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m23:53:56.376248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13dd9f07-fe56-4d55-a794-eea5743b5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5af80890>]}
[0m23:53:56.376979 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:53:56.377753 [info ] [MainThread]: 
[0m23:53:56.384776 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m23:53:56.385323 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m23:53:56.386456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_analytics, now snapshot.stock_analytics.stock_price_snapshot)
[0m23:53:56.386893 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m23:53:56.394177 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m23:53:56.431544 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:56.431955 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m23:53:56.432336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:56.895264 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.463 seconds
[0m23:53:56.899888 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:56.900320 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m23:53:56.996795 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m23:53:57.000936 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:57.001243 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m23:53:57.086671 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.085 seconds
[0m23:53:57.105269 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:57.105714 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace temporary table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:53:59.023453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.917 seconds
[0m23:53:59.029249 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:59.030360 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m23:53:59.106297 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.075 seconds
[0m23:53:59.114123 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:59.115818 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m23:53:59.238787 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.122 seconds
[0m23:53:59.247129 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:59.250655 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m23:53:59.350833 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.098 seconds
[0m23:53:59.360545 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:59.362122 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m23:53:59.432358 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.069 seconds
[0m23:53:59.445933 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:59.446981 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m23:53:59.573328 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.126 seconds
[0m23:53:59.587398 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:53:59.588018 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m23:54:00.355084 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.766 seconds
[0m23:54:00.362505 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:54:00.363602 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m23:54:00.436443 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m23:54:00.438384 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m23:54:00.444145 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:54:00.445179 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
BEGIN
[0m23:54:00.591649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m23:54:00.592417 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:54:00.592968 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
merge into "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m23:54:01.683274 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 1.090 seconds
[0m23:54:01.684474 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m23:54:01.685245 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
COMMIT
[0m23:54:02.078672 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m23:54:02.104611 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m23:54:02.224973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dd9f07-fe56-4d55-a794-eea5743b5b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60086cf0>]}
[0m23:54:02.227043 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 6[0m in 5.84s]
[0m23:54:02.228565 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m23:54:02.231586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:02.232469 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m23:54:02.233151 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_raw' was properly closed.
[0m23:54:02.233744 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_test_failures' was properly closed.
[0m23:54:02.234480 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m23:54:02.235345 [info ] [MainThread]: 
[0m23:54:02.236521 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.17 seconds (7.17s).
[0m23:54:02.237964 [debug] [MainThread]: Command end result
[0m23:54:02.278204 [info ] [MainThread]: 
[0m23:54:02.278937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:02.279332 [info ] [MainThread]: 
[0m23:54:02.279801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:54:02.280731 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.158186, "process_user_time": 2.73768, "process_kernel_time": 0.156468, "process_mem_max_rss": "236800", "process_out_blocks": "4183", "process_in_blocks": "0"}
[0m23:54:02.281215 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:54:02.281149 after 8.16 seconds
[0m23:54:02.281878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c19c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6ac6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4c1310>]}
[0m23:54:02.282231 [debug] [MainThread]: Flushing usage events
[0m23:54:05.556400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828db950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b71a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b707a0>]}


============================== 23:54:05.560263 | d1201d92-e717-41bf-a4b8-19b1fb603301 ==============================
[0m23:54:05.560263 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:54:05.561284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:54:05.960694 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:54:05.961237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff623f68a0>]}
[0m23:54:05.987152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ecbbc0>]}
[0m23:54:06.006964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ed2510>]}
[0m23:54:06.007409 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:54:06.015731 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m23:54:06.111740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:06.112114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:06.136076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62010320>]}
[0m23:54:06.198670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61f11010>]}
[0m23:54:06.199020 [info ] [MainThread]: Found 7 models, 1 snapshot, 33 data tests, 1 source, 568 macros
[0m23:54:06.199464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83218620>]}
[0m23:54:06.200626 [info ] [MainThread]: 
[0m23:54:06.201198 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:06.203455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m23:54:06.203792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m23:54:06.210703 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m23:54:06.212186 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m23:54:06.212496 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m23:54:06.212755 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m23:54:06.213048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:06.213290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:06.744167 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.531 seconds
[0m23:54:06.746051 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m23:54:06.900767 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.688 seconds
[0m23:54:06.904046 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m23:54:07.032015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_analytics)
[0m23:54:07.033701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_raw)
[0m23:54:07.036177 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_analytics"
"
[0m23:54:07.037248 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_raw"
"
[0m23:54:07.044902 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_analytics"
[0m23:54:07.047564 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_raw"
[0m23:54:07.048229 [debug] [ThreadPool]: On create_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_analytics"} */
create schema if not exists ASH_DB.STOCK_analytics
[0m23:54:07.048845 [debug] [ThreadPool]: On create_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_raw"} */
create schema if not exists ASH_DB.STOCK_raw
[0m23:54:07.049377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:07.049887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:07.421546 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.372 seconds
[0m23:54:07.423917 [debug] [ThreadPool]: On create_ASH_DB_STOCK_analytics: Close
[0m23:54:07.507550 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.457 seconds
[0m23:54:07.510240 [debug] [ThreadPool]: On create_ASH_DB_STOCK_raw: Close
[0m23:54:07.621147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_analytics, now list_ASH_DB_STOCK_analytics)
[0m23:54:07.622089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_raw, now list_ASH_DB_snapshots)
[0m23:54:07.623282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_test_failures'
[0m23:54:07.631900 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m23:54:07.632172 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_analytics"
[0m23:54:07.632533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_raw'
[0m23:54:07.634082 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_test_failures"
[0m23:54:07.634474 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m23:54:07.634859 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_analytics"} */
show objects in ASH_DB.STOCK_analytics limit 10000
[0m23:54:07.636219 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_raw"
[0m23:54:07.636614 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_test_failures"} */
show objects in ASH_DB.STOCK_test_failures limit 10000
[0m23:54:07.636951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:07.637302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:07.637645 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_raw"} */
show objects in ASH_DB.STOCK_raw limit 10000
[0m23:54:07.638006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:07.640807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:07.949461 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.309 seconds
[0m23:54:07.951775 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: Close
[0m23:54:08.009183 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.372 seconds
[0m23:54:08.013262 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: Close
[0m23:54:08.054149 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c03dfa-0106-ec6f-000f-c0df00707e06
[0m23:54:08.057759 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:54:08.058795 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:54:08.059678 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:54:08.060560 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: Close
[0m23:54:08.088629 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.452 seconds
[0m23:54:08.091354 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m23:54:08.220195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837544d0>]}
[0m23:54:08.221905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:08.223552 [info ] [MainThread]: 
[0m23:54:08.236933 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m23:54:08.237793 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_raw.stg_stock_daily .......................... [RUN]
[0m23:54:08.238949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_test_failures, now model.stock_analytics.stg_stock_daily)
[0m23:54:08.239581 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m23:54:08.247329 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m23:54:08.251319 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m23:54:08.272207 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m23:54:08.272600 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m23:54:08.272983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:08.874473 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.601 seconds
[0m23:54:08.885365 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m23:54:08.888531 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m23:54:08.889183 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m23:54:09.262406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m23:54:09.288136 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m23:54:09.288837 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m23:54:09.435022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m23:54:09.442251 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m23:54:09.540574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829141a0>]}
[0m23:54:09.542302 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_raw.stg_stock_daily ..................... [[32mSUCCESS 1[0m in 1.30s]
[0m23:54:09.544256 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m23:54:09.547102 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m23:54:09.548507 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m23:54:09.549040 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m23:54:09.549789 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m23:54:09.550574 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_analytics.int_bollinger ..................... [RUN]
[0m23:54:09.551851 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_analytics.int_daily_returns ................. [RUN]
[0m23:54:09.552859 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_analytics.int_macd .......................... [RUN]
[0m23:54:09.553752 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_analytics.int_moving_averages ............... [RUN]
[0m23:54:09.554637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_analytics, now model.stock_analytics.int_bollinger)
[0m23:54:09.555289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_raw, now model.stock_analytics.int_daily_returns)
[0m23:54:09.555964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_macd)
[0m23:54:09.556586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m23:54:09.557175 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m23:54:09.557772 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m23:54:09.558333 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m23:54:09.558927 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m23:54:09.562078 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m23:54:09.565063 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m23:54:09.567464 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m23:54:09.569668 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m23:54:09.573226 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m23:54:09.573515 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m23:54:09.573967 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m23:54:09.586785 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m23:54:09.587091 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m23:54:09.588542 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m23:54:09.589926 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m23:54:09.591553 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m23:54:09.592969 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m23:54:09.594445 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m23:54:09.594839 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_analytics.int_daily_returns
         as
        (-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc
        );
[0m23:54:09.595297 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m23:54:09.596279 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m23:54:09.597380 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m23:54:09.597692 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:09.598019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:09.598345 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m23:54:09.598839 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    -- Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m23:54:09.601549 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:09.602507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:10.798874 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.197 seconds
[0m23:54:10.805560 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m23:54:10.808276 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_analytics.int_macd IS $$MACD indicator$$;
[0m23:54:10.855968 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.258 seconds
[0m23:54:10.860522 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m23:54:10.861512 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
comment on table ASH_DB.STOCK_analytics.int_daily_returns IS $$Daily returns and volatility metrics$$;
[0m23:54:10.912909 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.315 seconds
[0m23:54:10.914983 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m23:54:10.916104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.314 seconds
[0m23:54:10.919653 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m23:54:10.936951 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m23:54:10.939321 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m23:54:10.939933 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m23:54:10.940537 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_analytics.int_macd
[0m23:54:10.941096 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
comment on table ASH_DB.STOCK_analytics.int_moving_averages IS $$Moving averages for trend analysis$$;
[0m23:54:10.957473 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m23:54:10.960127 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m23:54:10.960614 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
describe table ASH_DB.STOCK_analytics.int_daily_returns
[0m23:54:11.018998 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.076 seconds
[0m23:54:11.022096 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m23:54:11.022670 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m23:54:11.038190 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.077 seconds
[0m23:54:11.041194 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m23:54:11.041807 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
alter table ASH_DB.STOCK_analytics.int_daily_returns alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "PREV_ADJ_CLOSE" COMMENT $$$$,
    
        "ADJ_DAILY_CHANGE" COMMENT $$$$,
    
        "ADJ_DAILY_RETURN_PCT" COMMENT $$$$,
    
        "LOG_RETURN" COMMENT $$$$,
    
        "VOLATILITY_20D" COMMENT $$20-day rolling volatility$$,
    
        "CUMULATIVE_RETURN_PCT" COMMENT $$$$;
[0m23:54:11.058212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m23:54:11.061665 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m23:54:11.062325 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
describe table ASH_DB.STOCK_analytics.int_moving_averages
[0m23:54:11.082192 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m23:54:11.085583 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m23:54:11.086154 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_analytics.int_bollinger
[0m23:54:11.151710 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m23:54:11.154196 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m23:54:11.154693 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
alter table ASH_DB.STOCK_analytics.int_moving_averages alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "PRICE_VS_MA20_PCT" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$Golden cross or death cross signal$$;
[0m23:54:11.162445 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.076 seconds
[0m23:54:11.164924 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m23:54:11.165346 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m23:54:11.182884 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m23:54:11.184360 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m23:54:11.208450 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m23:54:11.210029 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m23:54:11.293926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m23:54:11.297757 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m23:54:11.304746 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6070a5d0>]}
[0m23:54:11.306021 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STOCK_analytics.int_daily_returns ............ [[32mSUCCESS 1[0m in 1.75s]
[0m23:54:11.307135 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m23:54:11.308374 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_rsi
[0m23:54:11.309279 [info ] [Thread-4 (]: 6 of 7 START sql table model STOCK_analytics.int_rsi ........................... [RUN]
[0m23:54:11.310323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60733080>]}
[0m23:54:11.311486 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m23:54:11.311960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_daily_returns, now model.stock_analytics.int_rsi)
[0m23:54:11.312786 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_analytics.int_macd ..................... [[32mSUCCESS 1[0m in 1.75s]
[0m23:54:11.314781 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m23:54:11.315293 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_rsi
[0m23:54:11.315966 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m23:54:11.320651 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m23:54:11.323284 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_rsi
[0m23:54:11.325346 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m23:54:11.327166 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m23:54:11.327574 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m23:54:11.328010 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:11.435844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60739910>]}
[0m23:54:11.436809 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff611ec140>]}
[0m23:54:11.441196 [info ] [Thread-1 (]: 5 of 7 OK created sql table model STOCK_analytics.int_moving_averages .......... [[32mSUCCESS 1[0m in 1.88s]
[0m23:54:11.444451 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_analytics.int_bollinger ................ [[32mSUCCESS 1[0m in 1.88s]
[0m23:54:11.445111 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m23:54:11.445695 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m23:54:12.640616 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.312 seconds
[0m23:54:12.643313 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m23:54:12.643910 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m23:54:12.761803 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m23:54:12.774363 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m23:54:12.776239 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_analytics.int_rsi
[0m23:54:12.865771 [debug] [Thread-4 (]: SQL status: SUCCESS 8 in 0.088 seconds
[0m23:54:12.870275 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m23:54:12.871029 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m23:54:12.990285 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m23:54:12.991864 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: Close
[0m23:54:13.106371 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6073aa80>]}
[0m23:54:13.108046 [info ] [Thread-4 (]: 6 of 7 OK created sql table model STOCK_analytics.int_rsi ...................... [[32mSUCCESS 1[0m in 1.79s]
[0m23:54:13.110002 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_rsi
[0m23:54:13.111616 [debug] [Thread-2 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m23:54:13.112552 [info ] [Thread-2 (]: 7 of 7 START sql table model STOCK_analytics.mart_stock_daily_metrics .......... [RUN]
[0m23:54:13.114023 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_macd, now model.stock_analytics.mart_stock_daily_metrics)
[0m23:54:13.114887 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.mart_stock_daily_metrics
[0m23:54:13.120015 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_daily_metrics"
[0m23:54:13.123548 [debug] [Thread-2 (]: Began executing node model.stock_analytics.mart_stock_daily_metrics
[0m23:54:13.125937 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_daily_metrics"
[0m23:54:13.128928 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m23:54:13.129451 [debug] [Thread-2 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
create or replace transient table ASH_DB.STOCK_analytics.mart_stock_daily_metrics
         as
        (

WITH base AS (
    SELECT * FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

ma AS (
    SELECT * FROM ASH_DB.STOCK_analytics.int_moving_averages
),

rsi AS (
    SELECT * FROM ASH_DB.STOCK_analytics.int_rsi
),

bollinger AS (
    SELECT * FROM ASH_DB.STOCK_analytics.int_bollinger
),

macd AS (
    SELECT * FROM ASH_DB.STOCK_analytics.int_macd
)

SELECT 
    -- Basic information
    base.SYMBOL,
    base."DATE",
    base."CLOSE",
    base."OPEN",
    base."MAX",
    base."MIN",
    base.VOLUME,
    
    -- Daily changes
    base.DAILY_CHANGE,
    base.DAILY_CHANGE_PCT,
    base.INTRADAY_RANGE,
    base.INTRADAY_RANGE_PCT,
    
    -- Moving Averages
    ma.MA_5,
    ma.MA_20,
    ma.MA_50,
    ma.EMA_12,
    ma.EMA_26,
    
    -- MA Cross Signals (Golden Cross / Death Cross)
    CASE 
        -- Golden Cross: MA5 crosses above MA20
        WHEN ma.MA_5 > ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") 
        THEN 'GOLDEN_CROSS_5_20'
        
        -- Death Cross: MA5 crosses below MA20
        WHEN ma.MA_5 < ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_5_20'
        
        -- Golden Cross: MA20 crosses above MA50
        WHEN ma.MA_20 > ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'GOLDEN_CROSS_20_50'
        
        -- Death Cross: MA20 crosses below MA50
        WHEN ma.MA_20 < ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_20_50'
        
        ELSE 'NO_CROSS'
    END as MA_CROSS_SIGNAL,
    
    -- Price vs MA trend analysis
    CASE 
        WHEN base."CLOSE" > ma.MA_5 AND base."CLOSE" > ma.MA_20 AND base."CLOSE" > ma.MA_50 THEN 'STRONG_UPTREND'
        WHEN base."CLOSE" < ma.MA_5 AND base."CLOSE" < ma.MA_20 AND base."CLOSE" < ma.MA_50 THEN 'STRONG_DOWNTREND'
        WHEN base."CLOSE" > ma.MA_20 THEN 'UPTREND'
        WHEN base."CLOSE" < ma.MA_20 THEN 'DOWNTREND'
        ELSE 'SIDEWAYS'
    END as PRICE_TREND,
    
    -- RSI indicators
    rsi.RSI_14,
    rsi.RSI_SIGNAL,
    
    -- Bollinger Bands
    bollinger.BB_UPPER,
    bollinger.BB_LOWER,
    bollinger.BB_MIDDLE,
    bollinger.BB_WIDTH_PCT,
    bollinger.BB_PERCENT_B,
    bollinger.BB_SIGNAL,
    bollinger.BB_SQUEEZE,
    
    -- MACD indicators
    macd.MACD_LINE,
    macd.SIGNAL_LINE,
    macd.MACD_HISTOGRAM,
    macd.MACD_SIGNAL,
    
    -- Volatility (using intraday range as proxy)
    CASE 
        WHEN base.INTRADAY_RANGE_PCT > 5 THEN 'HIGH_VOLATILITY'
        WHEN base.INTRADAY_RANGE_PCT < 1 THEN 'LOW_VOLATILITY'
        ELSE 'NORMAL_VOLATILITY'
    END as VOLATILITY_SIGNAL

FROM base
LEFT JOIN ma 
    ON base.SYMBOL = ma.SYMBOL AND base."DATE" = ma."DATE"
LEFT JOIN rsi 
    ON base.SYMBOL = rsi.SYMBOL AND base."DATE" = rsi."DATE"
LEFT JOIN bollinger 
    ON base.SYMBOL = bollinger.SYMBOL AND base."DATE" = bollinger."DATE"
LEFT JOIN macd 
    ON base.SYMBOL = macd.SYMBOL AND base."DATE" = macd."DATE"
        );
[0m23:54:13.130000 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:15.100391 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.970 seconds
[0m23:54:15.105618 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m23:54:15.106902 [debug] [Thread-2 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
comment on table ASH_DB.STOCK_analytics.mart_stock_daily_metrics IS $$Daily stock metrics with all technical indicators$$;
[0m23:54:15.275356 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m23:54:15.284514 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m23:54:15.286155 [debug] [Thread-2 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
describe table ASH_DB.STOCK_analytics.mart_stock_daily_metrics
[0m23:54:15.373594 [debug] [Thread-2 (]: SQL status: SUCCESS 32 in 0.086 seconds
[0m23:54:15.382684 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m23:54:15.384173 [debug] [Thread-2 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
alter table ASH_DB.STOCK_analytics.mart_stock_daily_metrics alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "OPEN" COMMENT $$$$,
    
        "MAX" COMMENT $$$$,
    
        "MIN" COMMENT $$$$,
    
        "VOLUME" COMMENT $$$$,
    
        "DAILY_CHANGE" COMMENT $$$$,
    
        "DAILY_CHANGE_PCT" COMMENT $$$$,
    
        "INTRADAY_RANGE" COMMENT $$$$,
    
        "INTRADAY_RANGE_PCT" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$$$,
    
        "PRICE_TREND" COMMENT $$Overall price trend$$,
    
        "RSI_14" COMMENT $$$$,
    
        "RSI_SIGNAL" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$$$,
    
        "BB_LOWER" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$$$,
    
        "VOLATILITY_SIGNAL" COMMENT $$$$;
[0m23:54:15.566806 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m23:54:15.571126 [debug] [Thread-2 (]: On model.stock_analytics.mart_stock_daily_metrics: Close
[0m23:54:15.975278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1201d92-e717-41bf-a4b8-19b1fb603301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff607748f0>]}
[0m23:54:15.976914 [info ] [Thread-2 (]: 7 of 7 OK created sql table model STOCK_analytics.mart_stock_daily_metrics ..... [[32mSUCCESS 1[0m in 2.86s]
[0m23:54:15.979984 [debug] [Thread-2 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m23:54:15.983322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:15.984251 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_daily_metrics' was properly closed.
[0m23:54:15.985031 [debug] [MainThread]: Connection 'model.stock_analytics.int_bollinger' was properly closed.
[0m23:54:15.985713 [debug] [MainThread]: Connection 'model.stock_analytics.int_moving_averages' was properly closed.
[0m23:54:15.986398 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m23:54:15.987341 [info ] [MainThread]: 
[0m23:54:15.988969 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 9.79 seconds (9.79s).
[0m23:54:15.989899 [debug] [MainThread]: Command end result
[0m23:54:16.064912 [info ] [MainThread]: 
[0m23:54:16.065411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:16.065713 [info ] [MainThread]: 
[0m23:54:16.066074 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:54:16.066746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.552914, "process_user_time": 2.932029, "process_kernel_time": 0.277272, "process_mem_max_rss": "236796", "process_out_blocks": "3059", "process_in_blocks": "0"}
[0m23:54:16.067061 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:16.067017 after 10.55 seconds
[0m23:54:16.067297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865bb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821dbec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85abdc40>]}
[0m23:54:16.067510 [debug] [MainThread]: Flushing usage events
[0m23:54:19.436499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831182c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9b3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0bcbf0>]}


============================== 23:54:19.440245 | ccce02a6-335d-42a3-8e7c-1c9950c37f14 ==============================
[0m23:54:19.440245 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:54:19.441077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:54:19.867399 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:54:19.868005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ccce02a6-335d-42a3-8e7c-1c9950c37f14', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f437470>]}
[0m23:54:19.894703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccce02a6-335d-42a3-8e7c-1c9950c37f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f8e1460>]}
[0m23:54:19.917088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccce02a6-335d-42a3-8e7c-1c9950c37f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e957740>]}
[0m23:54:19.917653 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:54:19.925518 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m23:54:20.006224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:20.006612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:20.033326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccce02a6-335d-42a3-8e7c-1c9950c37f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64cf23c0>]}
[0m23:54:20.103358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccce02a6-335d-42a3-8e7c-1c9950c37f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0c24e0>]}
[0m23:54:20.103758 [info ] [MainThread]: Found 7 models, 1 snapshot, 33 data tests, 1 source, 568 macros
[0m23:54:20.104329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccce02a6-335d-42a3-8e7c-1c9950c37f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7253a9c0>]}
[0m23:54:20.105972 [info ] [MainThread]: 
[0m23:54:20.106496 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:20.109308 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m23:54:20.116420 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m23:54:20.116744 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m23:54:20.116976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:20.484516 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.367 seconds
[0m23:54:20.485892 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m23:54:20.609394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now create_ASH_DB_STOCK_test_failures)
[0m23:54:20.609938 [debug] [ThreadPool]: Creating schema "database: "ASH_DB"
schema: "STOCK_test_failures"
"
[0m23:54:20.613376 [debug] [ThreadPool]: Using snowflake connection "create_ASH_DB_STOCK_test_failures"
[0m23:54:20.613761 [debug] [ThreadPool]: On create_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_ASH_DB_STOCK_test_failures"} */
create schema if not exists ASH_DB.STOCK_test_failures
[0m23:54:20.614061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:21.090165 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.476 seconds
[0m23:54:21.093331 [debug] [ThreadPool]: On create_ASH_DB_STOCK_test_failures: Close
[0m23:54:21.256359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ASH_DB_STOCK_test_failures, now list_ASH_DB_STOCK_raw)
[0m23:54:21.257886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_analytics'
[0m23:54:21.269972 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_raw"
[0m23:54:21.270734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_test_failures'
[0m23:54:21.273226 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_analytics"
[0m23:54:21.273806 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m23:54:21.274386 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_raw"} */
show objects in ASH_DB.STOCK_raw limit 10000
[0m23:54:21.276476 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_test_failures"
[0m23:54:21.277036 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_analytics"} */
show objects in ASH_DB.STOCK_analytics limit 10000
[0m23:54:21.278822 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m23:54:21.279242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:21.279675 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_test_failures"} */
show objects in ASH_DB.STOCK_test_failures limit 10000
[0m23:54:21.280089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:21.280507 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m23:54:21.282198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:21.283990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:21.613042 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.331 seconds
[0m23:54:21.615557 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: Close
[0m23:54:21.632398 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.348 seconds
[0m23:54:21.634054 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m23:54:21.689831 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.411 seconds
[0m23:54:21.691328 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: Close
[0m23:54:21.788536 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.508 seconds
[0m23:54:21.791639 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: Close
[0m23:54:21.900136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccce02a6-335d-42a3-8e7c-1c9950c37f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff648f6570>]}
[0m23:54:21.901418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:21.902621 [info ] [MainThread]: 
[0m23:54:21.913894 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m23:54:21.914686 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m23:54:21.915352 [debug] [Thread-3 (]: Began running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m23:54:21.916331 [debug] [Thread-4 (]: Began running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m23:54:21.916876 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [RUN]
[0m23:54:21.917550 [info ] [Thread-2 (]: 2 of 33 START test accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [RUN]
[0m23:54:21.918190 [info ] [Thread-3 (]: 3 of 33 START test accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL  [RUN]
[0m23:54:21.918827 [info ] [Thread-4 (]: 4 of 33 START test accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [RUN]
[0m23:54:21.919483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_analytics, now test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6)
[0m23:54:21.919939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_raw, now test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef)
[0m23:54:21.920343 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859)
[0m23:54:21.920798 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_test_failures, now test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a)
[0m23:54:21.921204 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m23:54:21.921605 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m23:54:21.921995 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m23:54:21.922378 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m23:54:21.934113 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m23:54:21.938193 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m23:54:21.941064 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m23:54:21.944333 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m23:54:21.947997 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m23:54:21.948247 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m23:54:21.948480 [debug] [Thread-3 (]: Began executing node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m23:54:21.957892 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
[0m23:54:21.959049 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
[0m23:54:21.959303 [debug] [Thread-4 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m23:54:21.960514 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
[0m23:54:21.969302 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m23:54:21.970186 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m23:54:21.971256 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
[0m23:54:21.972090 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m23:54:21.972362 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
         as
        (
    
    

with all_values as (

    select
        MACD_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_analytics.int_macd where MACD_SIGNAL IS NOT NULL) dbt_subquery
    group by MACD_SIGNAL

)

select *
from all_values
where value_field not in (
    'BULLISH_CROSSOVER','BEARISH_CROSSOVER','BULLISH','BEARISH','NEUTRAL'
)



        );
[0m23:54:21.972671 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
         as
        (
    
    

with all_values as (

    select
        MA_CROSS_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_analytics.int_moving_averages where MA_CROSS_SIGNAL IS NOT NULL) dbt_subquery
    group by MA_CROSS_SIGNAL

)

select *
from all_values
where value_field not in (
    'GOLDEN_CROSS','DEATH_CROSS','NEUTRAL'
)



        );
[0m23:54:21.973448 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m23:54:21.973720 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
         as
        (
    
    

with all_values as (

    select
        RSI_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_analytics.int_rsi where RSI_SIGNAL IS NOT NULL) dbt_subquery
    group by RSI_SIGNAL

)

select *
from all_values
where value_field not in (
    'OVERBOUGHT','OVERSOLD','NEUTRAL'
)



        );
[0m23:54:21.973982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:21.974228 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:21.974495 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
         as
        (
    
    

with all_values as (

    select
        PRICE_TREND as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
    group by PRICE_TREND

)

select *
from all_values
where value_field not in (
    'STRONG_UPTREND','UPTREND','SIDEWAYS','DOWNTREND','STRONG_DOWNTREND'
)



        );
[0m23:54:21.974801 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:21.976961 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:22.881636 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.907 seconds
[0m23:54:22.886688 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m23:54:22.891807 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m23:54:22.892259 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
    
      
    ) dbt_internal_test
[0m23:54:23.015415 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m23:54:23.021505 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: Close
[0m23:54:23.171838 [info ] [Thread-2 (]: 2 of 33 PASS accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [[32mPASS[0m in 1.25s]
[0m23:54:23.173849 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m23:54:23.175018 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m23:54:23.176636 [info ] [Thread-2 (]: 5 of 33 START test accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [RUN]
[0m23:54:23.179107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef, now test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987)
[0m23:54:23.180172 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m23:54:23.186995 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m23:54:23.188560 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m23:54:23.190556 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
[0m23:54:23.192546 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m23:54:23.192863 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
         as
        (
    
    

with all_values as (

    select
        DATA_QUALITY_FLAG as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_raw.stg_stock_daily
    group by DATA_QUALITY_FLAG

)

select *
from all_values
where value_field not in (
    'VALID','INVALID','ANOMALY','MISSING','NO_TRADING'
)



        );
[0m23:54:23.193324 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:23.442093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.467 seconds
[0m23:54:23.445461 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m23:54:23.447677 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m23:54:23.448210 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
    
      
    ) dbt_internal_test
[0m23:54:23.611825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m23:54:23.618137 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: Close
[0m23:54:23.726822 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [[32mPASS[0m in 1.81s]
[0m23:54:23.730414 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.755 seconds
[0m23:54:23.731884 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m23:54:23.735003 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m23:54:23.736879 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m23:54:23.738677 [info ] [Thread-1 (]: 6 of 33 START test dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE  [RUN]
[0m23:54:23.740487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1)
[0m23:54:23.741579 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m23:54:23.742554 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m23:54:23.753119 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m23:54:23.753771 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
    
      
    ) dbt_internal_test
[0m23:54:23.757084 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m23:54:23.759612 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
[0m23:54:23.761193 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m23:54:23.761631 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_analytics.int_bollinger where BB_LOWER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_LOWER < BB_MIDDLE)


        );
[0m23:54:23.762059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:23.914174 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m23:54:23.917562 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: Close
[0m23:54:24.012685 [info ] [Thread-3 (]: 3 of 33 PASS accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL . [[32mPASS[0m in 2.09s]
[0m23:54:24.013800 [debug] [Thread-3 (]: Finished running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m23:54:24.014503 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m23:54:24.015231 [info ] [Thread-3 (]: 7 of 33 START test dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE  [RUN]
[0m23:54:24.016125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c)
[0m23:54:24.016737 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m23:54:24.021943 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m23:54:24.023233 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m23:54:24.025337 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
[0m23:54:24.026703 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m23:54:24.027154 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_analytics.int_bollinger where BB_UPPER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_UPPER > BB_MIDDLE)


        );
[0m23:54:24.027578 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:24.030881 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m23:54:24.032065 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m23:54:24.033844 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m23:54:24.034522 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
    
      
    ) dbt_internal_test
[0m23:54:24.196732 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m23:54:24.199840 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: Close
[0m23:54:24.372004 [info ] [Thread-2 (]: 5 of 33 PASS accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [[32mPASS[0m in 1.19s]
[0m23:54:24.374492 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m23:54:24.375560 [debug] [Thread-2 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m23:54:24.376580 [info ] [Thread-2 (]: 8 of 33 START test dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0  [RUN]
[0m23:54:24.378328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987, now test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d)
[0m23:54:24.379360 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m23:54:24.386951 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m23:54:24.388871 [debug] [Thread-2 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m23:54:24.393461 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
[0m23:54:24.395103 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m23:54:24.395640 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
         as
        (



select
    *
from (select * from ASH_DB.STOCK_analytics.int_daily_returns where VOLATILITY_20D IS NOT NULL) dbt_subquery

where not(VOLATILITY_20D >= 0)


        );
[0m23:54:24.396363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:24.529606 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.552 seconds
[0m23:54:24.531582 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m23:54:24.533467 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m23:54:24.534007 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
    
      
    ) dbt_internal_test
[0m23:54:24.929747 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m23:54:24.933776 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: Close
[0m23:54:25.087193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.325 seconds
[0m23:54:25.088540 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m23:54:25.089708 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m23:54:25.090031 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m23:54:25.183150 [info ] [Thread-4 (]: 4 of 33 PASS accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [[32mPASS[0m in 3.26s]
[0m23:54:25.184793 [debug] [Thread-4 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m23:54:25.185579 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m23:54:25.186278 [info ] [Thread-4 (]: 9 of 33 START test dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100  [RUN]
[0m23:54:25.187128 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a, now test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb)
[0m23:54:25.187725 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m23:54:25.192933 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m23:54:25.194262 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m23:54:25.196307 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
[0m23:54:25.197633 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m23:54:25.198111 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
         as
        (



select
    *
from (select * from ASH_DB.STOCK_analytics.int_rsi where RSI_14 IS NOT NULL) dbt_subquery

where not(RSI_14 BETWEEN 0 AND 100)


        );
[0m23:54:25.198534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:25.223779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m23:54:25.225901 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: Close
[0m23:54:25.325649 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.298 seconds
[0m23:54:25.327275 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m23:54:25.328877 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m23:54:25.329394 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m23:54:25.346261 [info ] [Thread-1 (]: 6 of 33 PASS dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE ... [[32mPASS[0m in 1.61s]
[0m23:54:25.347376 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m23:54:25.348007 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m23:54:25.348575 [info ] [Thread-1 (]: 10 of 33 START test dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [RUN]
[0m23:54:25.349327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1, now test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12)
[0m23:54:25.349821 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m23:54:25.358176 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m23:54:25.359203 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m23:54:25.360862 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
[0m23:54:25.362143 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m23:54:25.362509 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m23:54:25.362834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:25.375887 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m23:54:25.377034 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m23:54:25.378047 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m23:54:25.378371 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
    
      
    ) dbt_internal_test
[0m23:54:25.491744 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m23:54:25.493599 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: Close
[0m23:54:25.578754 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m23:54:25.582318 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: Close
[0m23:54:25.639216 [info ] [Thread-2 (]: 8 of 33 PASS dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0 . [[32mPASS[0m in 1.26s]
[0m23:54:25.641297 [debug] [Thread-2 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m23:54:25.642409 [debug] [Thread-2 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m23:54:25.644566 [info ] [Thread-2 (]: 11 of 33 START test dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [RUN]
[0m23:54:25.646396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d, now test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b)
[0m23:54:25.647221 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m23:54:25.652825 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m23:54:25.654413 [debug] [Thread-2 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m23:54:25.656733 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
[0m23:54:25.658371 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m23:54:25.658897 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_raw.stg_stock_daily
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m23:54:25.659387 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:25.748118 [info ] [Thread-3 (]: 7 of 33 PASS dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE ... [[32mPASS[0m in 1.73s]
[0m23:54:25.749357 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m23:54:25.749906 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m23:54:25.750425 [info ] [Thread-3 (]: 12 of 33 START test not_null_int_bollinger_DATE ................................ [RUN]
[0m23:54:25.751110 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c, now test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac)
[0m23:54:25.751588 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m23:54:25.757539 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m23:54:25.759602 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m23:54:25.762948 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_bollinger_DATE
[0m23:54:25.764113 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m23:54:25.822857 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_bollinger_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_bollinger
where DATE is null



        );
[0m23:54:25.828185 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:25.944370 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m23:54:25.945538 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m23:54:25.947788 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m23:54:25.948156 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
    
      
    ) dbt_internal_test
[0m23:54:26.066821 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m23:54:26.069484 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: Close
[0m23:54:26.225948 [info ] [Thread-4 (]: 9 of 33 PASS dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100 .... [[32mPASS[0m in 1.04s]
[0m23:54:26.228565 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m23:54:26.229682 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m23:54:26.230563 [info ] [Thread-4 (]: 13 of 33 START test not_null_int_bollinger_SYMBOL .............................. [RUN]
[0m23:54:26.233597 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb, now test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443)
[0m23:54:26.234308 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m23:54:26.238936 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m23:54:26.241074 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m23:54:26.243274 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_bollinger_SYMBOL
[0m23:54:26.244686 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m23:54:26.245174 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_bollinger_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_bollinger
where SYMBOL is null



        );
[0m23:54:26.245618 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:26.375268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.012 seconds
[0m23:54:26.377036 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m23:54:26.378799 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m23:54:26.379362 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
    
      
    ) dbt_internal_test
[0m23:54:26.553416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m23:54:26.557405 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: Close
[0m23:54:26.681751 [info ] [Thread-1 (]: 10 of 33 PASS dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [[32mPASS[0m in 1.33s]
[0m23:54:26.684234 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.025 seconds
[0m23:54:26.686753 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m23:54:26.687644 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m23:54:26.690056 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m23:54:26.692080 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m23:54:26.692992 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m23:54:26.694901 [info ] [Thread-1 (]: 14 of 33 START test not_null_int_daily_returns_DATE ............................ [RUN]
[0m23:54:26.696279 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m23:54:26.697008 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m23:54:26.697500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12, now test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54)
[0m23:54:26.698150 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
    
      
    ) dbt_internal_test
[0m23:54:26.698794 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_bollinger_DATE
    
      
    ) dbt_internal_test
[0m23:54:26.699372 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m23:54:26.705977 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m23:54:26.707243 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m23:54:26.709210 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_daily_returns_DATE
[0m23:54:26.710584 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m23:54:26.711018 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_daily_returns_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_daily_returns
where DATE is null



        );
[0m23:54:26.711449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:26.836101 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m23:54:26.838446 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: Close
[0m23:54:26.862204 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m23:54:26.864051 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: Close
[0m23:54:26.939827 [info ] [Thread-2 (]: 11 of 33 PASS dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [[32mPASS[0m in 1.29s]
[0m23:54:26.940811 [debug] [Thread-2 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m23:54:26.941276 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m23:54:26.941717 [info ] [Thread-2 (]: 15 of 33 START test not_null_int_daily_returns_SYMBOL .......................... [RUN]
[0m23:54:26.942267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b, now test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2)
[0m23:54:26.942683 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m23:54:26.945956 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m23:54:26.947023 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m23:54:26.948575 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_daily_returns_SYMBOL
[0m23:54:26.949626 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m23:54:26.949994 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_daily_returns_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_daily_returns
where SYMBOL is null



        );
[0m23:54:26.950332 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:26.957540 [info ] [Thread-3 (]: 12 of 33 PASS not_null_int_bollinger_DATE ...................................... [[32mPASS[0m in 1.21s]
[0m23:54:26.958489 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m23:54:26.958984 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m23:54:26.959375 [info ] [Thread-3 (]: 16 of 33 START test not_null_int_macd_DATE ..................................... [RUN]
[0m23:54:26.959863 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac, now test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b)
[0m23:54:26.960217 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m23:54:26.962832 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m23:54:26.963626 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m23:54:26.966069 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_macd_DATE
[0m23:54:26.967043 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m23:54:26.967375 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_macd_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_macd
where DATE is null



        );
[0m23:54:26.967671 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:26.993098 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m23:54:26.994109 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m23:54:26.995552 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m23:54:26.995875 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_bollinger_SYMBOL
    
      
    ) dbt_internal_test
[0m23:54:27.115073 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m23:54:27.116941 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: Close
[0m23:54:27.239046 [info ] [Thread-4 (]: 13 of 33 PASS not_null_int_bollinger_SYMBOL .................................... [[32mPASS[0m in 1.00s]
[0m23:54:27.241312 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m23:54:27.242373 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m23:54:27.243413 [info ] [Thread-4 (]: 17 of 33 START test not_null_int_macd_SYMBOL ................................... [RUN]
[0m23:54:27.244993 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443, now test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2)
[0m23:54:27.245933 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m23:54:27.252022 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m23:54:27.254535 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m23:54:27.257157 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_macd_SYMBOL
[0m23:54:27.258758 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m23:54:27.259245 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_macd_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_macd
where SYMBOL is null



        );
[0m23:54:27.259726 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:27.469821 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m23:54:27.474250 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m23:54:27.479879 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m23:54:27.481249 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_daily_returns_DATE
    
      
    ) dbt_internal_test
[0m23:54:27.624044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m23:54:27.626678 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: Close
[0m23:54:27.735326 [info ] [Thread-1 (]: 14 of 33 PASS not_null_int_daily_returns_DATE .................................. [[32mPASS[0m in 1.04s]
[0m23:54:27.736799 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m23:54:27.737599 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m23:54:27.739145 [info ] [Thread-1 (]: 18 of 33 START test not_null_int_moving_averages_DATE .......................... [RUN]
[0m23:54:27.740235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54, now test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4)
[0m23:54:27.740927 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m23:54:27.744383 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m23:54:27.745844 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m23:54:27.747522 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_moving_averages_DATE
[0m23:54:27.748528 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m23:54:27.748873 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_moving_averages_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_moving_averages
where DATE is null



        );
[0m23:54:27.749173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:27.880994 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.913 seconds
[0m23:54:27.882580 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m23:54:27.884083 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m23:54:27.884565 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_macd_DATE
    
      
    ) dbt_internal_test
[0m23:54:27.898349 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m23:54:27.900043 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m23:54:27.901686 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m23:54:27.902227 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_daily_returns_SYMBOL
    
      
    ) dbt_internal_test
[0m23:54:28.030907 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m23:54:28.032252 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: Close
[0m23:54:28.053889 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m23:54:28.054966 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m23:54:28.057073 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m23:54:28.057374 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_macd_SYMBOL
    
      
    ) dbt_internal_test
[0m23:54:28.121447 [info ] [Thread-2 (]: 15 of 33 PASS not_null_int_daily_returns_SYMBOL ................................ [[32mPASS[0m in 1.18s]
[0m23:54:28.122230 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m23:54:28.122601 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m23:54:28.122962 [info ] [Thread-2 (]: 19 of 33 START test not_null_int_moving_averages_SYMBOL ........................ [RUN]
[0m23:54:28.123384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2, now test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a)
[0m23:54:28.123671 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m23:54:28.126089 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m23:54:28.127761 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m23:54:28.128909 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_moving_averages_SYMBOL
[0m23:54:28.129815 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m23:54:28.130089 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_moving_averages_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_moving_averages
where SYMBOL is null



        );
[0m23:54:28.130347 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:28.138795 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m23:54:28.140244 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: Close
[0m23:54:28.180219 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m23:54:28.181771 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: Close
[0m23:54:28.259436 [info ] [Thread-3 (]: 16 of 33 PASS not_null_int_macd_DATE ........................................... [[32mPASS[0m in 1.30s]
[0m23:54:28.260244 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m23:54:28.260627 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m23:54:28.260978 [info ] [Thread-3 (]: 20 of 33 START test not_null_int_rsi_DATE ...................................... [RUN]
[0m23:54:28.261442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b, now test.stock_analytics.not_null_int_rsi_DATE.1856743a58)
[0m23:54:28.261763 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m23:54:28.264446 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m23:54:28.265281 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m23:54:28.267587 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_rsi_DATE
[0m23:54:28.268411 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m23:54:28.268684 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_rsi_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_rsi
where DATE is null



        );
[0m23:54:28.268954 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:28.306965 [info ] [Thread-4 (]: 17 of 33 PASS not_null_int_macd_SYMBOL ......................................... [[32mPASS[0m in 1.06s]
[0m23:54:28.309978 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m23:54:28.310345 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m23:54:28.310690 [info ] [Thread-4 (]: 21 of 33 START test not_null_int_rsi_SYMBOL .................................... [RUN]
[0m23:54:28.311062 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2, now test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035)
[0m23:54:28.311373 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m23:54:28.314018 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m23:54:28.315403 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m23:54:28.316669 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_rsi_SYMBOL
[0m23:54:28.317535 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m23:54:28.317824 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_rsi_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_rsi
where SYMBOL is null



        );
[0m23:54:28.318096 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:28.548843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m23:54:28.551081 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m23:54:28.553243 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m23:54:28.555189 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_moving_averages_DATE
    
      
    ) dbt_internal_test
[0m23:54:28.717314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m23:54:28.721339 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: Close
[0m23:54:28.840685 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m23:54:28.842963 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m23:54:28.844931 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m23:54:28.845590 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_moving_averages_SYMBOL
    
      
    ) dbt_internal_test
[0m23:54:28.855456 [info ] [Thread-1 (]: 18 of 33 PASS not_null_int_moving_averages_DATE ................................ [[32mPASS[0m in 1.11s]
[0m23:54:28.857156 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m23:54:28.857856 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m23:54:28.858537 [info ] [Thread-1 (]: 22 of 33 START test not_null_mart_stock_daily_metrics_CLOSE .................... [RUN]
[0m23:54:28.859370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4, now test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9)
[0m23:54:28.859884 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m23:54:28.863946 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m23:54:28.865356 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m23:54:28.867265 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_CLOSE
[0m23:54:28.868442 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m23:54:28.868820 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
where CLOSE is null



        );
[0m23:54:28.869174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:28.992333 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m23:54:28.994299 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: Close
[0m23:54:29.044557 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m23:54:29.046350 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m23:54:29.049362 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m23:54:29.049958 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_rsi_SYMBOL
    
      
    ) dbt_internal_test
[0m23:54:29.083196 [info ] [Thread-2 (]: 19 of 33 PASS not_null_int_moving_averages_SYMBOL .............................. [[32mPASS[0m in 0.96s]
[0m23:54:29.084378 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m23:54:29.085049 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m23:54:29.085717 [info ] [Thread-2 (]: 23 of 33 START test not_null_mart_stock_daily_metrics_DATE ..................... [RUN]
[0m23:54:29.086492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a, now test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510)
[0m23:54:29.087082 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m23:54:29.091653 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m23:54:29.093085 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m23:54:29.095505 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_DATE
[0m23:54:29.097049 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m23:54:29.097515 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
where DATE is null



        );
[0m23:54:29.097945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:29.120080 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.851 seconds
[0m23:54:29.122092 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m23:54:29.123546 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m23:54:29.123976 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_rsi_DATE
    
      
    ) dbt_internal_test
[0m23:54:29.206988 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m23:54:29.208807 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: Close
[0m23:54:29.295954 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m23:54:29.303103 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: Close
[0m23:54:29.337107 [info ] [Thread-4 (]: 21 of 33 PASS not_null_int_rsi_SYMBOL .......................................... [[32mPASS[0m in 1.02s]
[0m23:54:29.343529 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m23:54:29.344387 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m23:54:29.345026 [info ] [Thread-4 (]: 24 of 33 START test not_null_mart_stock_daily_metrics_PRICE_TREND .............. [RUN]
[0m23:54:29.346013 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035, now test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200)
[0m23:54:29.346605 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m23:54:29.351016 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m23:54:29.353436 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m23:54:29.357199 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
[0m23:54:29.358503 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m23:54:29.358955 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
where PRICE_TREND is null



        );
[0m23:54:29.359535 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:29.444499 [info ] [Thread-3 (]: 20 of 33 PASS not_null_int_rsi_DATE ............................................ [[32mPASS[0m in 1.18s]
[0m23:54:29.445626 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m23:54:29.446255 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m23:54:29.446843 [info ] [Thread-3 (]: 25 of 33 START test not_null_mart_stock_daily_metrics_SYMBOL ................... [RUN]
[0m23:54:29.447634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_DATE.1856743a58, now test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435)
[0m23:54:29.448252 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m23:54:29.452014 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m23:54:29.453611 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m23:54:29.457253 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
[0m23:54:29.458533 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m23:54:29.458939 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
where SYMBOL is null



        );
[0m23:54:29.459335 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:30.154310 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.056 seconds
[0m23:54:30.155826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.287 seconds
[0m23:54:30.158503 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m23:54:30.161323 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m23:54:30.165352 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m23:54:30.166268 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m23:54:30.166927 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_DATE
    
      
    ) dbt_internal_test
[0m23:54:30.167682 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_CLOSE
    
      
    ) dbt_internal_test
[0m23:54:30.230057 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.870 seconds
[0m23:54:30.232911 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m23:54:30.235278 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m23:54:30.236195 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
    
      
    ) dbt_internal_test
[0m23:54:30.301597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m23:54:30.305893 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: Close
[0m23:54:30.333897 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m23:54:30.338680 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: Close
[0m23:54:30.346967 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.887 seconds
[0m23:54:30.353629 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m23:54:30.359927 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m23:54:30.362947 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
    
      
    ) dbt_internal_test
[0m23:54:30.365404 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m23:54:30.372595 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: Close
[0m23:54:30.449220 [info ] [Thread-1 (]: 22 of 33 PASS not_null_mart_stock_daily_metrics_CLOSE .......................... [[32mPASS[0m in 1.59s]
[0m23:54:30.450058 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m23:54:30.450453 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m23:54:30.450812 [info ] [Thread-1 (]: 26 of 33 START test not_null_stg_stock_daily_CLOSE ............................. [RUN]
[0m23:54:30.451270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9, now test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75)
[0m23:54:30.451592 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m23:54:30.454326 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m23:54:30.455146 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m23:54:30.456419 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_CLOSE
[0m23:54:30.457335 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m23:54:30.457619 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where CLOSE is null



        );
[0m23:54:30.457912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:30.493656 [info ] [Thread-4 (]: 24 of 33 PASS not_null_mart_stock_daily_metrics_PRICE_TREND .................... [[32mPASS[0m in 1.15s]
[0m23:54:30.494524 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m23:54:30.494897 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m23:54:30.495244 [info ] [Thread-4 (]: 27 of 33 START test not_null_stg_stock_daily_DAILY_CHANGE_PCT .................. [RUN]
[0m23:54:30.495690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200, now test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285)
[0m23:54:30.496014 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m23:54:30.498532 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m23:54:30.499668 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m23:54:30.500971 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
[0m23:54:30.501838 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m23:54:30.502120 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where DAILY_CHANGE_PCT is null



        );
[0m23:54:30.502398 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:30.541167 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m23:54:30.542589 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: Close
[0m23:54:30.664976 [info ] [Thread-3 (]: 25 of 33 PASS not_null_mart_stock_daily_metrics_SYMBOL ......................... [[32mPASS[0m in 1.22s]
[0m23:54:30.665988 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m23:54:30.666455 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m23:54:30.666937 [info ] [Thread-3 (]: 28 of 33 START test not_null_stg_stock_daily_DATA_QUALITY_FLAG ................. [RUN]
[0m23:54:30.667585 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435, now test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291)
[0m23:54:30.668008 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m23:54:30.671078 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m23:54:30.672053 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m23:54:30.674719 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
[0m23:54:30.675682 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m23:54:30.676031 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where DATA_QUALITY_FLAG is null



        );
[0m23:54:30.676310 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:30.793640 [info ] [Thread-2 (]: 23 of 33 PASS not_null_mart_stock_daily_metrics_DATE ........................... [[32mPASS[0m in 1.71s]
[0m23:54:30.794549 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m23:54:30.795047 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m23:54:30.795499 [info ] [Thread-2 (]: 29 of 33 START test not_null_stg_stock_daily_DATE .............................. [RUN]
[0m23:54:30.796115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510, now test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022)
[0m23:54:30.796523 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m23:54:30.799797 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m23:54:30.800819 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m23:54:30.802414 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATE
[0m23:54:30.803528 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m23:54:30.803884 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where DATE is null



        );
[0m23:54:30.804188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:31.302566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m23:54:31.303856 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m23:54:31.305025 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m23:54:31.305338 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_CLOSE
    
      
    ) dbt_internal_test
[0m23:54:31.437884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m23:54:31.439189 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: Close
[0m23:54:31.498663 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m23:54:31.499764 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m23:54:31.500770 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m23:54:31.501100 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
    
      
    ) dbt_internal_test
[0m23:54:31.540006 [info ] [Thread-1 (]: 26 of 33 PASS not_null_stg_stock_daily_CLOSE ................................... [[32mPASS[0m in 1.09s]
[0m23:54:31.540792 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m23:54:31.541076 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m23:54:31.541392 [info ] [Thread-1 (]: 30 of 33 START test not_null_stg_stock_daily_SYMBOL ............................ [RUN]
[0m23:54:31.541759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75, now test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0)
[0m23:54:31.542005 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m23:54:31.544453 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m23:54:31.545081 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m23:54:31.546190 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_SYMBOL
[0m23:54:31.546962 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m23:54:31.547269 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where SYMBOL is null



        );
[0m23:54:31.547550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:31.554907 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m23:54:31.555894 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m23:54:31.556683 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m23:54:31.557057 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATE
    
      
    ) dbt_internal_test
[0m23:54:31.623186 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m23:54:31.624557 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: Close
[0m23:54:31.646083 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.144 seconds
[0m23:54:31.647198 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m23:54:31.648024 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m23:54:31.648310 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
    
      
    ) dbt_internal_test
[0m23:54:31.680941 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m23:54:31.682013 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: Close
[0m23:54:31.766021 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m23:54:31.769046 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: Close
[0m23:54:31.775231 [info ] [Thread-3 (]: 28 of 33 PASS not_null_stg_stock_daily_DATA_QUALITY_FLAG ....................... [[32mPASS[0m in 1.11s]
[0m23:54:31.775909 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m23:54:31.776230 [debug] [Thread-3 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m23:54:31.776537 [info ] [Thread-3 (]: 31 of 33 START test source_not_null_raw_fact_stock_price_daily_CLOSE ........... [RUN]
[0m23:54:31.776929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178)
[0m23:54:31.777165 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m23:54:31.779455 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m23:54:31.780512 [info ] [Thread-2 (]: 29 of 33 PASS not_null_stg_stock_daily_DATE .................................... [[32mPASS[0m in 0.98s]
[0m23:54:31.781087 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m23:54:31.781389 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m23:54:31.781733 [info ] [Thread-2 (]: 32 of 33 START test source_not_null_raw_fact_stock_price_daily_DATE ............ [RUN]
[0m23:54:31.781963 [debug] [Thread-3 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m23:54:31.782216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198)
[0m23:54:31.783459 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
[0m23:54:31.783752 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m23:54:31.784553 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m23:54:31.786357 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m23:54:31.786631 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
create or replace transient table ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK.fact_stock_price_daily
where CLOSE is null



        );
[0m23:54:31.787062 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:31.788173 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m23:54:31.790440 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
[0m23:54:31.791195 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m23:54:31.791662 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
create or replace transient table ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK.fact_stock_price_daily
where DATE is null



        );
[0m23:54:31.792051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:31.911437 [info ] [Thread-4 (]: 27 of 33 PASS not_null_stg_stock_daily_DAILY_CHANGE_PCT ........................ [[32mPASS[0m in 1.42s]
[0m23:54:31.912280 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m23:54:31.912642 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m23:54:31.913002 [info ] [Thread-4 (]: 33 of 33 START test source_not_null_raw_fact_stock_price_daily_SYMBOL .......... [RUN]
[0m23:54:31.913445 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a)
[0m23:54:31.913773 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m23:54:31.916287 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m23:54:31.917034 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m23:54:31.918211 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
[0m23:54:31.919071 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m23:54:31.919331 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
create or replace transient table ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK.fact_stock_price_daily
where SYMBOL is null



        );
[0m23:54:31.919568 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:32.441198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.893 seconds
[0m23:54:32.443973 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m23:54:32.447318 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m23:54:32.447962 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m23:54:32.612010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m23:54:32.613590 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: Close
[0m23:54:32.670603 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.883 seconds
[0m23:54:32.671556 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m23:54:32.672560 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m23:54:32.672874 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
    
      
    ) dbt_internal_test
[0m23:54:32.725347 [info ] [Thread-1 (]: 30 of 33 PASS not_null_stg_stock_daily_SYMBOL .................................. [[32mPASS[0m in 1.18s]
[0m23:54:32.726155 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m23:54:32.811101 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m23:54:32.812893 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: Close
[0m23:54:32.843352 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.051 seconds
[0m23:54:32.844650 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m23:54:32.846006 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m23:54:32.846494 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
    
      
    ) dbt_internal_test
[0m23:54:32.899501 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m23:54:32.900715 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m23:54:32.902185 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m23:54:32.902531 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m23:54:32.943850 [info ] [Thread-3 (]: 31 of 33 PASS source_not_null_raw_fact_stock_price_daily_CLOSE ................. [[32mPASS[0m in 1.17s]
[0m23:54:32.944632 [debug] [Thread-3 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m23:54:32.982943 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m23:54:32.984366 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: Close
[0m23:54:33.029994 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m23:54:33.031559 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: Close
[0m23:54:33.087735 [info ] [Thread-2 (]: 32 of 33 PASS source_not_null_raw_fact_stock_price_daily_DATE .................. [[32mPASS[0m in 1.31s]
[0m23:54:33.088734 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m23:54:33.146573 [info ] [Thread-4 (]: 33 of 33 PASS source_not_null_raw_fact_stock_price_daily_SYMBOL ................ [[32mPASS[0m in 1.23s]
[0m23:54:33.149042 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m23:54:33.154187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:33.155610 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198' was properly closed.
[0m23:54:33.156351 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0' was properly closed.
[0m23:54:33.156910 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a' was properly closed.
[0m23:54:33.157466 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178' was properly closed.
[0m23:54:33.158079 [info ] [MainThread]: 
[0m23:54:33.158780 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 13.05 seconds (13.05s).
[0m23:54:33.163143 [debug] [MainThread]: Command end result
[0m23:54:33.202603 [info ] [MainThread]: 
[0m23:54:33.203203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:33.203525 [info ] [MainThread]: 
[0m23:54:33.203846 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m23:54:33.204906 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.821894, "process_user_time": 3.678747, "process_kernel_time": 0.295758, "process_mem_max_rss": "236808", "process_out_blocks": "3180", "process_in_blocks": "0"}
[0m23:54:33.205293 [debug] [MainThread]: Command `dbt test` succeeded at 23:54:33.205241 after 13.82 seconds
[0m23:54:33.205589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa2be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f518d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f519760>]}
[0m23:54:33.205905 [debug] [MainThread]: Flushing usage events
[0m00:00:12.174669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bccbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb37ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecf51f0>]}


============================== 00:00:12.178481 | 5a5f78e1-55b2-45ac-9f93-7551f2327019 ==============================
[0m00:00:12.178481 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:00:12.179098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:00:12.182974 [info ] [MainThread]: dbt version: 1.8.8
[0m00:00:12.183355 [info ] [MainThread]: python version: 3.12.4
[0m00:00:12.183640 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m00:00:12.184074 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m00:00:12.541142 [info ] [MainThread]: Using profiles dir at .
[0m00:00:12.541754 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m00:00:12.542111 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m00:00:12.542526 [info ] [MainThread]: adapter type: snowflake
[0m00:00:12.542803 [info ] [MainThread]: adapter version: 1.8.4
[0m00:00:12.565585 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:00:12.565941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5a5f78e1-55b2-45ac-9f93-7551f2327019', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb35790>]}
[0m00:00:12.580259 [info ] [MainThread]: Configuration:
[0m00:00:12.580622 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:00:12.580960 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:00:12.585123 [info ] [MainThread]: Required dependencies:
[0m00:00:12.585428 [debug] [MainThread]: Executing "git --help"
[0m00:00:12.587574 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:00:12.587886 [debug] [MainThread]: STDERR: "b''"
[0m00:00:12.588127 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:00:12.588398 [info ] [MainThread]: Connection:
[0m00:00:12.588695 [info ] [MainThread]:   account: SFEDU02-LVB17920
[0m00:00:12.588962 [info ] [MainThread]:   user: MALLARD
[0m00:00:12.589219 [info ] [MainThread]:   database: ASH_DB
[0m00:00:12.589476 [info ] [MainThread]:   warehouse: BEETLE_QUERY_WH
[0m00:00:12.589734 [info ] [MainThread]:   role: TRAINING_ROLE
[0m00:00:12.590003 [info ] [MainThread]:   schema: STOCK
[0m00:00:12.590259 [info ] [MainThread]:   authenticator: None
[0m00:00:12.590482 [info ] [MainThread]:   oauth_client_id: None
[0m00:00:12.590726 [info ] [MainThread]:   query_tag: dbt_stock_analytics
[0m00:00:12.590984 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:00:12.591214 [info ] [MainThread]:   host: None
[0m00:00:12.591451 [info ] [MainThread]:   port: None
[0m00:00:12.591694 [info ] [MainThread]:   proxy_host: None
[0m00:00:12.591936 [info ] [MainThread]:   proxy_port: None
[0m00:00:12.592198 [info ] [MainThread]:   protocol: None
[0m00:00:12.592456 [info ] [MainThread]:   connect_retries: 1
[0m00:00:12.592704 [info ] [MainThread]:   connect_timeout: None
[0m00:00:12.592945 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:00:12.593199 [info ] [MainThread]:   retry_all: False
[0m00:00:12.593438 [info ] [MainThread]:   insecure_mode: False
[0m00:00:12.593675 [info ] [MainThread]:   reuse_connections: None
[0m00:00:12.594009 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:00:12.595607 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:00:12.596063 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:00:12.596306 [debug] [MainThread]: On debug: select 1 as id
[0m00:00:12.596548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:14.812583 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.216 seconds
[0m00:00:14.815326 [debug] [MainThread]: On debug: Close
[0m00:00:15.545279 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:00:15.548258 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:00:15.554336 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4211342, "process_user_time": 1.898302, "process_kernel_time": 0.175397, "process_mem_max_rss": "236736", "process_out_blocks": "22", "process_in_blocks": "0"}
[0m00:00:15.558698 [debug] [MainThread]: Command `dbt debug` succeeded at 00:00:15.558300 after 3.43 seconds
[0m00:00:15.560293 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:00:15.561917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c105a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f69eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2e4c50>]}
[0m00:00:15.565025 [debug] [MainThread]: Flushing usage events
[0m00:00:19.189658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8beb3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3c02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a414bf0>]}


============================== 00:00:19.192932 | 8b8a3fb3-4f3b-445f-b620-e05ae649163b ==============================
[0m00:00:19.192932 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:00:19.193547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:00:19.215791 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:00:19.216164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b8a3fb3-4f3b-445f-b620-e05ae649163b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a493b90>]}
[0m00:00:19.244316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b8a3fb3-4f3b-445f-b620-e05ae649163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae30170>]}
[0m00:00:19.289014 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ipifquv9'
[0m00:00:19.289434 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:00:19.605185 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:00:19.606078 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:00:19.794004 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:00:19.799784 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:00:20.472246 [info ] [MainThread]: Installed from version 1.1.1
[0m00:00:20.473415 [info ] [MainThread]: Updated version available: 1.3.2
[0m00:00:20.473996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b8a3fb3-4f3b-445f-b620-e05ae649163b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89363c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89363b30>]}
[0m00:00:20.474347 [info ] [MainThread]: 
[0m00:00:20.474703 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:00:20.475711 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3224996, "process_user_time": 0.967548, "process_kernel_time": 0.103232, "process_mem_max_rss": "234748", "process_out_blocks": "743", "process_in_blocks": "0"}
[0m00:00:20.476191 [debug] [MainThread]: Command `dbt deps` succeeded at 00:00:20.476103 after 1.32 seconds
[0m00:00:20.476505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895b67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8beb3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8beb2420>]}
[0m00:00:20.476778 [debug] [MainThread]: Flushing usage events
[0m00:00:23.187727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e81c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e93dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f510b30>]}


============================== 00:00:23.191114 | d29e5f49-3b5e-4bf4-a972-78d3c41f249e ==============================
[0m00:00:23.191114 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:00:23.191697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:00:23.555851 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:00:23.556497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd29e5f49-3b5e-4bf4-a972-78d3c41f249e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ea286b0>]}
[0m00:00:23.581155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd29e5f49-3b5e-4bf4-a972-78d3c41f249e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6ec260>]}
[0m00:00:23.602083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd29e5f49-3b5e-4bf4-a972-78d3c41f249e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f227230>]}
[0m00:00:23.602617 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:00:23.610530 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m00:00:23.693036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:23.693439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:23.717111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd29e5f49-3b5e-4bf4-a972-78d3c41f249e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e70f440>]}
[0m00:00:23.781937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd29e5f49-3b5e-4bf4-a972-78d3c41f249e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e4776b0>]}
[0m00:00:23.782365 [info ] [MainThread]: Found 7 models, 1 snapshot, 33 data tests, 1 source, 568 macros
[0m00:00:23.782900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd29e5f49-3b5e-4bf4-a972-78d3c41f249e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e77ae70>]}
[0m00:00:23.784265 [info ] [MainThread]: 
[0m00:00:23.784757 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:23.785391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m00:00:23.792268 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m00:00:23.792586 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m00:00:23.792821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:26.601985 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.809 seconds
[0m00:00:26.603678 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m00:00:27.454331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_analytics)
[0m00:00:27.455585 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_raw'
[0m00:00:27.456429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m00:00:27.458132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_test_failures'
[0m00:00:27.466883 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_analytics"
[0m00:00:27.468809 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_raw"
[0m00:00:27.470432 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m00:00:27.471985 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_test_failures"
[0m00:00:27.472487 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_analytics"} */
show objects in ASH_DB.STOCK_analytics limit 10000
[0m00:00:27.472890 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_raw"} */
show objects in ASH_DB.STOCK_raw limit 10000
[0m00:00:27.473311 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m00:00:27.473665 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_test_failures"} */
show objects in ASH_DB.STOCK_test_failures limit 10000
[0m00:00:27.474076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:27.474447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:27.474806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:27.475143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:33.764727 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.290 seconds
[0m00:00:33.768335 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: Close
[0m00:00:34.202608 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.709 seconds
[0m00:00:34.207471 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m00:00:35.643623 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 8.168 seconds
[0m00:00:35.645283 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: Close
[0m00:00:36.636949 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 9.163 seconds
[0m00:00:36.638237 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: Close
[0m00:00:36.890243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd29e5f49-3b5e-4bf4-a972-78d3c41f249e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e32d820>]}
[0m00:00:36.890905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:36.892678 [info ] [MainThread]: 
[0m00:00:36.899089 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_price_snapshot
[0m00:00:36.899554 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_price_snapshot ........................... [RUN]
[0m00:00:36.900055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_analytics, now snapshot.stock_analytics.stock_price_snapshot)
[0m00:00:36.900380 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_price_snapshot
[0m00:00:36.909677 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_price_snapshot
[0m00:00:36.936136 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:00:36.936577 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select CLOSE, VOLUME from (
                



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m00:00:36.936886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:42.272544 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 5.335 seconds
[0m00:00:42.286975 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:00:42.287844 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m00:00:43.497830 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.209 seconds
[0m00:00:43.511848 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:00:43.512994 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m00:00:44.743408 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.229 seconds
[0m00:00:44.770712 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:00:44.771222 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
create or replace temporary table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:00:57.896488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 13.125 seconds
[0m00:00:57.903910 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:00:57.904891 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m00:00:59.176690 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 1.271 seconds
[0m00:00:59.184391 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:00:59.185686 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m00:01:01.438759 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 2.252 seconds
[0m00:01:01.447672 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:01.449017 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m00:01:01.560642 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.110 seconds
[0m00:01:01.567887 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:01.569201 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
[0m00:01:01.858682 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.288 seconds
[0m00:01:01.871260 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:01.872401 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
describe table "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp"
[0m00:01:02.302955 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.430 seconds
[0m00:01:02.329015 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:02.329989 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT 
    md5(cast(coalesce(cast(SYMBOL as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(DATE as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS snapshot_key,
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME
FROM ASH_DB.STOCK.fact_stock_price_daily
WHERE "DATE" >= CURRENT_DATE - INTERVAL '180 days'


    ),

    snapshotted_data as (

        select *,
            snapshot_key as dbt_unique_key

        from "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snapshot_key as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snapshot_key as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:01:03.053256 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.722 seconds
[0m00:01:03.056854 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:03.057306 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:01:03.249539 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.191 seconds
[0m00:01:03.252279 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:03.258852 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:03.259901 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
BEGIN
[0m00:01:03.672294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m00:01:03.673728 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:03.674828 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
merge into "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ASH_DB"."SNAPSHOTS"."STOCK_PRICE_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAPSHOT_KEY", "SYMBOL", "DATE", "OPEN", "CLOSE", "MIN", "MAX", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:01:05.492920 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 1.817 seconds
[0m00:01:05.495507 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_price_snapshot"
[0m00:01:05.496618 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_price_snapshot"} */
COMMIT
[0m00:01:07.271125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.774 seconds
[0m00:01:07.284331 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_price_snapshot: Close
[0m00:01:07.627840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd29e5f49-3b5e-4bf4-a972-78d3c41f249e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e88b170>]}
[0m00:01:07.628716 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_price_snapshot ........................... [[32mSUCCESS 4[0m in 30.73s]
[0m00:01:07.631535 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_price_snapshot
[0m00:01:07.633109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:07.633397 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_price_snapshot' was properly closed.
[0m00:01:07.633644 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_raw' was properly closed.
[0m00:01:07.633919 [debug] [MainThread]: Connection 'list_ASH_DB_snapshots' was properly closed.
[0m00:01:07.634163 [debug] [MainThread]: Connection 'list_ASH_DB_STOCK_test_failures' was properly closed.
[0m00:01:07.634453 [info ] [MainThread]: 
[0m00:01:07.634945 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 43.85 seconds (43.85s).
[0m00:01:07.635612 [debug] [MainThread]: Command end result
[0m00:01:07.667529 [info ] [MainThread]: 
[0m00:01:07.668264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:07.668659 [info ] [MainThread]: 
[0m00:01:07.669086 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:01:07.670776 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 44.51986, "process_user_time": 2.546544, "process_kernel_time": 0.177712, "process_mem_max_rss": "232792", "process_in_blocks": "24", "process_out_blocks": "2878"}
[0m00:01:07.671377 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:01:07.671307 after 44.52 seconds
[0m00:01:07.671807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f02f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6efec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e81fd10>]}
[0m00:01:07.672089 [debug] [MainThread]: Flushing usage events
[0m00:01:10.735571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eecce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ced2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ced2bd0>]}


============================== 00:01:10.739745 | 30c55471-66de-476d-8072-e1749c30d5d4 ==============================
[0m00:01:10.739745 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:01:10.740485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:11.165150 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:01:11.165764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3cdd30>]}
[0m00:01:11.195328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff610ef440>]}
[0m00:01:11.219861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b136b0>]}
[0m00:01:11.220511 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:01:11.230270 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m00:01:11.310822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:11.311165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:11.334022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61040710>]}
[0m00:01:11.393990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f410a0>]}
[0m00:01:11.394361 [info ] [MainThread]: Found 7 models, 1 snapshot, 33 data tests, 1 source, 568 macros
[0m00:01:11.394788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6111b9e0>]}
[0m00:01:11.396022 [info ] [MainThread]: 
[0m00:01:11.396615 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:11.398849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m00:01:11.399170 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m00:01:11.405884 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m00:01:11.407256 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m00:01:11.407546 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m00:01:11.407815 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m00:01:11.408076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:11.408334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:13.195979 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.787 seconds
[0m00:01:13.198468 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m00:01:13.252646 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.844 seconds
[0m00:01:13.255446 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m00:01:14.430926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_test_failures)
[0m00:01:14.433045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_snapshots)
[0m00:01:14.434389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_analytics'
[0m00:01:14.436607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_raw'
[0m00:01:14.446807 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_test_failures"
[0m00:01:14.449496 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m00:01:14.451645 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_analytics"
[0m00:01:14.454510 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_raw"
[0m00:01:14.454970 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_test_failures"} */
show objects in ASH_DB.STOCK_test_failures limit 10000
[0m00:01:14.455411 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m00:01:14.455853 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_analytics"} */
show objects in ASH_DB.STOCK_analytics limit 10000
[0m00:01:14.456329 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_raw"} */
show objects in ASH_DB.STOCK_raw limit 10000
[0m00:01:14.456839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:14.457244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:14.457720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:14.458129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:15.349979 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.892 seconds
[0m00:01:15.351670 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.894 seconds
[0m00:01:15.354693 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m00:01:15.357222 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: Close
[0m00:01:15.418157 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.960 seconds
[0m00:01:15.421511 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: Close
[0m00:01:16.578301 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 2.121 seconds
[0m00:01:16.583442 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: Close
[0m00:01:16.828260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e74c740>]}
[0m00:01:16.829919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:01:16.831520 [info ] [MainThread]: 
[0m00:01:16.844795 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_daily
[0m00:01:16.845808 [info ] [Thread-1 (]: 1 of 7 START sql view model STOCK_raw.stg_stock_daily .......................... [RUN]
[0m00:01:16.847211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_test_failures, now model.stock_analytics.stg_stock_daily)
[0m00:01:16.847911 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_daily
[0m00:01:16.855448 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_daily"
[0m00:01:16.857169 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_daily
[0m00:01:16.878181 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m00:01:16.878580 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
select * from (
        

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
    ) as __dbt_sbq
    where false
    limit 0
[0m00:01:16.878897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:18.426721 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.547 seconds
[0m00:01:18.439568 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_daily"
[0m00:01:18.443043 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m00:01:18.443815 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
create or replace   view ASH_DB.STOCK_raw.stg_stock_daily
  
    
    
(
  
    "SYMBOL" COMMENT $$Stock ticker symbol$$, 
  
    "DATE" COMMENT $$Trading date$$, 
  
    "OPEN" COMMENT $$$$, 
  
    "CLOSE" COMMENT $$Closing price$$, 
  
    "MIN" COMMENT $$$$, 
  
    "MAX" COMMENT $$$$, 
  
    "VOLUME" COMMENT $$$$, 
  
    "DATA_QUALITY_FLAG" COMMENT $$Data quality validation flag$$, 
  
    "DAILY_CHANGE" COMMENT $$$$, 
  
    "DAILY_CHANGE_PCT" COMMENT $$Percentage change from open to close$$, 
  
    "INTRADAY_RANGE" COMMENT $$$$, 
  
    "INTRADAY_RANGE_PCT" COMMENT $$$$
  
)

   as (
    

WITH source_data AS (
	SELECT
		SYMBOL,
        "DATE",
        "OPEN",
        "CLOSE",
        "MIN",
        "MAX",
        VOLUME
	FROM ASH_DB.STOCK.fact_stock_price_daily
),
data_quality_check AS (
	SELECT
		*,
        CASE
			WHEN "CLOSE" = 0 OR "OPEN" = 0 THEN 'INVALID'
			WHEN "MAX" < "MIN" THEN 'ANOMALY'
			WHEN "CLOSE" IS NULL OR "OPEN" IS NULL THEN 'MISSING'
			ELSE 'VALID'
		END AS DATA_QUALITY_FLAG
	FROM source_data
)

SELECT 
	-- Basic fileds
    SYMBOL,
    "DATE",
    "OPEN",
    "CLOSE",
    "MIN",
    "MAX",
    VOLUME,
    DATA_QUALITY_FLAG,
    
    -- Daily price change
    "CLOSE" - "OPEN" as DAILY_CHANGE,
    
    -- Daily percentage change
    ROUND(("CLOSE" - "OPEN") / NULLIF("OPEN", 0) * 100, 2) as DAILY_CHANGE_PCT,
    
    -- Intraday range
    "MAX" - "MIN" as INTRADAY_RANGE,
    
    -- Intraday range (percentage)
    ROUND(("MAX" - "MIN") / NULLIF("MIN", 0) * 100, 2) as INTRADAY_RANGE_PCT

FROM data_quality_check
WHERE DATA_QUALITY_FLAG = 'VALID'
  );
[0m00:01:20.137410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.693 seconds
[0m00:01:20.163457 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_daily"
[0m00:01:20.164189 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_daily"} */
comment on view ASH_DB.STOCK_raw.stg_stock_daily IS $$Cleaned and validated daily stock prices$$;
[0m00:01:20.555133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m00:01:20.565898 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_daily: Close
[0m00:01:20.786951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61326f60>]}
[0m00:01:20.788856 [info ] [Thread-1 (]: 1 of 7 OK created sql view model STOCK_raw.stg_stock_daily ..................... [[32mSUCCESS 1[0m in 3.94s]
[0m00:01:20.792175 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_daily
[0m00:01:20.794775 [debug] [Thread-3 (]: Began running node model.stock_analytics.int_bollinger
[0m00:01:20.795754 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_daily_returns
[0m00:01:20.796290 [debug] [Thread-2 (]: Began running node model.stock_analytics.int_macd
[0m00:01:20.796817 [debug] [Thread-1 (]: Began running node model.stock_analytics.int_moving_averages
[0m00:01:20.797724 [info ] [Thread-3 (]: 2 of 7 START sql table model STOCK_analytics.int_bollinger ..................... [RUN]
[0m00:01:20.798994 [info ] [Thread-4 (]: 3 of 7 START sql table model STOCK_analytics.int_daily_returns ................. [RUN]
[0m00:01:20.800093 [info ] [Thread-2 (]: 4 of 7 START sql table model STOCK_analytics.int_macd .......................... [RUN]
[0m00:01:20.801225 [info ] [Thread-1 (]: 5 of 7 START sql table model STOCK_analytics.int_moving_averages ............... [RUN]
[0m00:01:20.802064 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now model.stock_analytics.int_bollinger)
[0m00:01:20.802739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_analytics, now model.stock_analytics.int_daily_returns)
[0m00:01:20.803711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_raw, now model.stock_analytics.int_macd)
[0m00:01:20.804408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_daily, now model.stock_analytics.int_moving_averages)
[0m00:01:20.805020 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.int_bollinger
[0m00:01:20.805607 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_daily_returns
[0m00:01:20.806180 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.int_macd
[0m00:01:20.806788 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.int_moving_averages
[0m00:01:20.809916 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.int_bollinger"
[0m00:01:20.814598 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_daily_returns"
[0m00:01:20.817105 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.int_macd"
[0m00:01:20.819500 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.int_moving_averages"
[0m00:01:20.822460 [debug] [Thread-3 (]: Began executing node model.stock_analytics.int_bollinger
[0m00:01:20.823003 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_daily_returns
[0m00:01:20.823463 [debug] [Thread-2 (]: Began executing node model.stock_analytics.int_macd
[0m00:01:20.837358 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.int_bollinger"
[0m00:01:20.839071 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_daily_returns"
[0m00:01:20.839322 [debug] [Thread-1 (]: Began executing node model.stock_analytics.int_moving_averages
[0m00:01:20.840804 [debug] [Thread-2 (]: Writing runtime sql for node "model.stock_analytics.int_macd"
[0m00:01:20.842609 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.int_moving_averages"
[0m00:01:20.843825 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m00:01:20.844757 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m00:01:20.846006 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m00:01:20.846293 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
create or replace transient table ASH_DB.STOCK_analytics.int_daily_returns
         as
        (-- SELECT
-- 	SYMBOL,
--     "DATE",
--     "CLOSE",
--     
--     -- Previous day's close
--     LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PREV_ADJ_CLOSE,
--     
--     -- Daily change (absolte)
--     "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS ADJ_DAILY_CHANGE,
--     
--     -- Daily return (percentage)
--     ROUND(
--         ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--         / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0) * 100, 
--         4
--     ) AS ADJ_DAILY_RETURN_PCT,
--     
--     -- Log return (for financial analysis)
--     LN(
--         "CLOSE" / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--     ) AS LOG_RETURN,
--     
--     -- Rolling volatility (20-day standard deviation)
--     ROUND(
--         STDDEV(
--             ("CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) 
--             / NULLIF(LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE"), 0)
--         ) OVER (
--             PARTITION BY SYMBOL 
--             ORDER BY "DATE" 
--             ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
--         ) * 100,
--         4
--     ) AS VOLATILITY_20D,
--     
--     -- Cumulative return from start
--     ROUND(
--         (("CLOSE" / FIRST_VALUE("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE")) - 1) * 100,
--         4
--     ) AS CUMULATIVE_RETURN_PCT

-- FROM ASH_DB.STOCK_raw.stg_stock_daily
-- WHERE DATA_QUALITY_FLAG = 'VALID'



WITH base AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS prev_close
    FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

calc AS (
    SELECT
        SYMBOL,
        "DATE",
        "CLOSE",
        prev_close,
        ("CLOSE" - prev_close) AS adj_daily_change,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN ("CLOSE" - prev_close) / prev_close
            ELSE NULL
        END AS ret_decimal,
        CASE
            WHEN prev_close IS NOT NULL AND prev_close <> 0
                THEN LN("CLOSE" / prev_close)
            ELSE NULL
        END AS log_return
    FROM base
)

SELECT
    SYMBOL,
    "DATE",
    "CLOSE",
    prev_close AS PREV_ADJ_CLOSE,
    adj_daily_change AS ADJ_DAILY_CHANGE,
    ROUND(ret_decimal * 100, 4) AS ADJ_DAILY_RETURN_PCT,
    log_return AS LOG_RETURN,

    ROUND(
        STDDEV(ret_decimal) OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) * 100,
        4
    ) AS VOLATILITY_20D,

    ROUND(
        ( "CLOSE" / FIRST_VALUE("CLOSE") OVER (
            PARTITION BY SYMBOL
            ORDER BY "DATE"
        ) - 1 ) * 100,
        4
    ) AS CUMULATIVE_RETURN_PCT
FROM calc
        );
[0m00:01:20.847606 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m00:01:20.847867 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
create or replace transient table ASH_DB.STOCK_analytics.int_bollinger
         as
        (

WITH ma_std AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        ROUND(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_MIDDLE,
        ROUND(
            STDDEV("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS BB_STDDEV
    FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    BB_MIDDLE,
    BB_STDDEV,
    ROUND(BB_MIDDLE + (2 * BB_STDDEV), 4) AS BB_UPPER,
    ROUND(BB_MIDDLE - (2 * BB_STDDEV), 4) AS BB_LOWER,
    
    -- Band Width (volatility measure)
    ROUND(
        ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) * 100,
        4
    ) AS BB_WIDTH_PCT,
    
    -- %B (price position within bands)
    ROUND(
        ("CLOSE" - (BB_MIDDLE - (2 * BB_STDDEV))) / 
        NULLIF((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV)), 0) * 100,
        4
    ) AS BB_PERCENT_B,
    
    -- Bollinger Band Signal
    CASE 
        WHEN "CLOSE" > BB_MIDDLE + (2 * BB_STDDEV) THEN 'ABOVE_UPPER_BAND'
        WHEN "CLOSE" < BB_MIDDLE - (2 * BB_STDDEV) THEN 'BELOW_LOWER_BAND'
        WHEN "CLOSE" > BB_MIDDLE THEN 'ABOVE_MIDDLE'
        WHEN "CLOSE" < BB_MIDDLE THEN 'BELOW_MIDDLE'
        ELSE 'AT_MIDDLE'
    END AS BB_SIGNAL,
    
    -- Bollinger Squeeze (low volatility)
    CASE 
        WHEN ((BB_MIDDLE + (2 * BB_STDDEV)) - (BB_MIDDLE - (2 * BB_STDDEV))) / NULLIF(BB_MIDDLE, 0) < 0.10 
        THEN TRUE
        ELSE FALSE
    END AS BB_SQUEEZE

FROM ma_std
        );
[0m00:01:20.848226 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
create or replace transient table ASH_DB.STOCK_analytics.int_macd
         as
        (

WITH ema_calc AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- 12-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ) AS EMA_12,
        
        -- 26-day EMA
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ) AS EMA_26
    FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

macd_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        ROUND(EMA_12 - EMA_26, 4) as MACD_LINE
    FROM ema_calc
),

signal_line AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        EMA_12,
        EMA_26,
        MACD_LINE,
        ROUND(
            AVG(MACD_LINE) OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 8 PRECEDING AND CURRENT ROW
            ),
            4
        ) AS SIGNAL_LINE
    FROM macd_line
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    EMA_12,
    EMA_26,
    MACD_LINE,
    SIGNAL_LINE,
    
    -- MACD Histogram = MACD Line - Signal Line
    ROUND(MACD_LINE - SIGNAL_LINE, 4) AS MACD_HISTOGRAM,
    
    -- MACD Signal
    CASE 
        WHEN MACD_LINE > SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") <= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BULLISH_CROSSOVER'
        WHEN MACD_LINE < SIGNAL_LINE 
             AND LAG(MACD_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE") >= LAG(SIGNAL_LINE) OVER (PARTITION BY SYMBOL ORDER BY "DATE")
        THEN 'BEARISH_CROSSOVER'
        WHEN MACD_LINE > SIGNAL_LINE THEN 'BULLISH'
        WHEN MACD_LINE < SIGNAL_LINE THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS MACD_SIGNAL

FROM signal_line
        );
[0m00:01:20.848583 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:01:20.848919 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
create or replace transient table ASH_DB.STOCK_analytics.int_moving_averages
         as
        (

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    
    -- Short-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_5,
    
    -- Medium-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_20,
    
    -- Long-term moving averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ),
        4
    ) as MA_50,
    
    -- Exponential Moving Averages
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 11 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_12,
    
    ROUND(
        AVG("CLOSE") OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 25 PRECEDING AND CURRENT ROW
        ),
        4
    ) as EMA_26,
    
    -- Price position relative to MA20
    ROUND(
        (("CLOSE" / NULLIF(
            AVG("CLOSE") OVER (
                PARTITION BY SYMBOL 
                ORDER BY "DATE" 
                ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
            ), 
            0
        )) - 1) * 100,
        4
    ) AS PRICE_VS_MA20_PCT,
    
    -- Golden Cross / Death Cross signal
    CASE 
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) >
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'GOLDEN_CROSS'
        WHEN AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) <
             AVG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE" ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)
        THEN 'DEATH_CROSS'
        ELSE 'NEUTRAL'
    END AS MA_CROSS_SIGNAL

FROM ASH_DB.STOCK_raw.stg_stock_daily
WHERE DATA_QUALITY_FLAG = 'VALID'
        );
[0m00:01:20.849280 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:01:20.849610 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:01:20.850940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:23.949918 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.100 seconds
[0m00:01:23.951845 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.103 seconds
[0m00:01:23.953749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.102 seconds
[0m00:01:23.955685 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.106 seconds
[0m00:01:23.959110 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m00:01:23.963957 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m00:01:23.967447 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m00:01:23.970380 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m00:01:23.971046 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
comment on table ASH_DB.STOCK_analytics.int_bollinger IS $$Bollinger Bands$$;
[0m00:01:23.971667 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
comment on table ASH_DB.STOCK_analytics.int_daily_returns IS $$Daily returns and volatility metrics$$;
[0m00:01:23.972239 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
comment on table ASH_DB.STOCK_analytics.int_moving_averages IS $$Moving averages for trend analysis$$;
[0m00:01:23.972852 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
comment on table ASH_DB.STOCK_analytics.int_macd IS $$MACD indicator$$;
[0m00:01:24.202583 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m00:01:24.204983 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m00:01:24.226218 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m00:01:24.229711 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m00:01:24.230455 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
describe table ASH_DB.STOCK_analytics.int_daily_returns
[0m00:01:24.231214 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
describe table ASH_DB.STOCK_analytics.int_macd
[0m00:01:24.333781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m00:01:24.339720 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m00:01:24.340818 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
describe table ASH_DB.STOCK_analytics.int_moving_averages
[0m00:01:24.366501 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.393 seconds
[0m00:01:24.373069 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m00:01:24.374283 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
describe table ASH_DB.STOCK_analytics.int_bollinger
[0m00:01:24.495799 [debug] [Thread-2 (]: SQL status: SUCCESS 9 in 0.263 seconds
[0m00:01:24.498476 [debug] [Thread-2 (]: Using snowflake connection "model.stock_analytics.int_macd"
[0m00:01:24.498996 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_macd"} */
alter table ASH_DB.STOCK_analytics.int_macd alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$MACD signal classification$$;
[0m00:01:24.648910 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.307 seconds
[0m00:01:24.654288 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.int_moving_averages"
[0m00:01:24.655500 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_moving_averages"} */
alter table ASH_DB.STOCK_analytics.int_moving_averages alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "PRICE_VS_MA20_PCT" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$Golden cross or death cross signal$$;
[0m00:01:24.687869 [debug] [Thread-4 (]: SQL status: SUCCESS 9 in 0.456 seconds
[0m00:01:24.690684 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_daily_returns"
[0m00:01:24.691205 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_daily_returns"} */
alter table ASH_DB.STOCK_analytics.int_daily_returns alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "PREV_ADJ_CLOSE" COMMENT $$$$,
    
        "ADJ_DAILY_CHANGE" COMMENT $$$$,
    
        "ADJ_DAILY_RETURN_PCT" COMMENT $$$$,
    
        "LOG_RETURN" COMMENT $$$$,
    
        "VOLATILITY_20D" COMMENT $$20-day rolling volatility$$,
    
        "CUMULATIVE_RETURN_PCT" COMMENT $$$$;
[0m00:01:24.716738 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.341 seconds
[0m00:01:24.719486 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.int_bollinger"
[0m00:01:24.720030 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_bollinger"} */
alter table ASH_DB.STOCK_analytics.int_bollinger alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_STDDEV" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$Upper band (must be > middle band)$$,
    
        "BB_LOWER" COMMENT $$Lower band (must be < middle band)$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$;
[0m00:01:25.073527 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m00:01:25.075805 [debug] [Thread-4 (]: On model.stock_analytics.int_daily_returns: Close
[0m00:01:25.178516 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m00:01:25.182446 [debug] [Thread-2 (]: On model.stock_analytics.int_macd: Close
[0m00:01:25.273224 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m00:01:25.277519 [debug] [Thread-3 (]: On model.stock_analytics.int_bollinger: Close
[0m00:01:25.385197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m00:01:25.389320 [debug] [Thread-1 (]: On model.stock_analytics.int_moving_averages: Close
[0m00:01:25.464837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60130980>]}
[0m00:01:25.465781 [info ] [Thread-4 (]: 3 of 7 OK created sql table model STOCK_analytics.int_daily_returns ............ [[32mSUCCESS 1[0m in 4.66s]
[0m00:01:25.466722 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_daily_returns
[0m00:01:25.467185 [debug] [Thread-4 (]: Began running node model.stock_analytics.int_rsi
[0m00:01:25.467687 [info ] [Thread-4 (]: 6 of 7 START sql table model STOCK_analytics.int_rsi ........................... [RUN]
[0m00:01:25.468598 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_daily_returns, now model.stock_analytics.int_rsi)
[0m00:01:25.469215 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60194620>]}
[0m00:01:25.469807 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.int_rsi
[0m00:01:25.470392 [info ] [Thread-3 (]: 2 of 7 OK created sql table model STOCK_analytics.int_bollinger ................ [[32mSUCCESS 1[0m in 4.67s]
[0m00:01:25.473219 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.int_rsi"
[0m00:01:25.473794 [debug] [Thread-3 (]: Finished running node model.stock_analytics.int_bollinger
[0m00:01:25.474961 [debug] [Thread-4 (]: Began executing node model.stock_analytics.int_rsi
[0m00:01:25.476940 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.int_rsi"
[0m00:01:25.478493 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m00:01:25.478885 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
create or replace transient table ASH_DB.STOCK_analytics.int_rsi
         as
        (


WITH price_changes AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        "CLOSE" - LAG("CLOSE") OVER (PARTITION BY SYMBOL ORDER BY "DATE") AS PRICE_CHANGE
    FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        CASE WHEN PRICE_CHANGE > 0 THEN PRICE_CHANGE ELSE 0 END as GAIN,
        CASE WHEN PRICE_CHANGE < 0 THEN ABS(PRICE_CHANGE) ELSE 0 END as LOSS
    FROM price_changes
),

avg_gains_losses AS (
    SELECT 
        SYMBOL,
        "DATE",
        "CLOSE",
        
        -- Average gain over 14 days
        AVG(gain) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_GAIN_14,
        
        -- Average loss over 14 days
        AVG(loss) OVER (
            PARTITION BY SYMBOL 
            ORDER BY "DATE" 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS AVG_LOSS_14
    FROM gains_losses
)

SELECT 
    SYMBOL,
    "DATE",
    "CLOSE",
    AVG_GAIN_14,
    AVG_LOSS_14,
    
    -- Relative Strength
    ROUND(
        AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0),
        4
    ) AS RELATIVE_STRENGTH,
    
    -- RSI (14-day)
    ROUND(
        100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))),
        4
    ) AS RSI_14,
    
    -- RSI signal 
    CASE 
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) > 70 THEN 'OVERBOUGHT'
        WHEN 100 - (100 / (1 + (AVG_GAIN_14 / NULLIF(AVG_LOSS_14, 0)))) < 30 THEN 'OVERSOLD'
        ELSE 'NEUTRAL'
    END AS RSI_SIGNAL

FROM avg_gains_losses
        );
[0m00:01:25.479275 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:01:25.554608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff601aad80>]}
[0m00:01:25.555239 [info ] [Thread-1 (]: 5 of 7 OK created sql table model STOCK_analytics.int_moving_averages .......... [[32mSUCCESS 1[0m in 4.75s]
[0m00:01:25.556010 [debug] [Thread-1 (]: Finished running node model.stock_analytics.int_moving_averages
[0m00:01:26.003900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6001fc20>]}
[0m00:01:26.005796 [info ] [Thread-2 (]: 4 of 7 OK created sql table model STOCK_analytics.int_macd ..................... [[32mSUCCESS 1[0m in 5.20s]
[0m00:01:26.007646 [debug] [Thread-2 (]: Finished running node model.stock_analytics.int_macd
[0m00:01:29.068671 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.589 seconds
[0m00:01:29.072462 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m00:01:29.073222 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
comment on table ASH_DB.STOCK_analytics.int_rsi IS $$Relative Strength Index (14-day)$$;
[0m00:01:29.580222 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m00:01:29.587619 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m00:01:29.588757 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
describe table ASH_DB.STOCK_analytics.int_rsi
[0m00:01:29.774469 [debug] [Thread-4 (]: SQL status: SUCCESS 8 in 0.185 seconds
[0m00:01:29.779911 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.int_rsi"
[0m00:01:29.781195 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.int_rsi"} */
alter table ASH_DB.STOCK_analytics.int_rsi alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "AVG_GAIN_14" COMMENT $$$$,
    
        "AVG_LOSS_14" COMMENT $$$$,
    
        "RELATIVE_STRENGTH" COMMENT $$$$,
    
        "RSI_14" COMMENT $$14-day RSI (must be between 0-100)$$,
    
        "RSI_SIGNAL" COMMENT $$RSI signal classification$$;
[0m00:01:32.140931 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.358 seconds
[0m00:01:32.145651 [debug] [Thread-4 (]: On model.stock_analytics.int_rsi: Close
[0m00:01:32.621496 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60af9af0>]}
[0m00:01:32.623300 [info ] [Thread-4 (]: 6 of 7 OK created sql table model STOCK_analytics.int_rsi ...................... [[32mSUCCESS 1[0m in 7.15s]
[0m00:01:32.628016 [debug] [Thread-4 (]: Finished running node model.stock_analytics.int_rsi
[0m00:01:32.630372 [debug] [Thread-3 (]: Began running node model.stock_analytics.mart_stock_daily_metrics
[0m00:01:32.632972 [info ] [Thread-3 (]: 7 of 7 START sql table model STOCK_analytics.mart_stock_daily_metrics .......... [RUN]
[0m00:01:32.635930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stock_analytics.int_bollinger, now model.stock_analytics.mart_stock_daily_metrics)
[0m00:01:32.637881 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.mart_stock_daily_metrics
[0m00:01:32.649022 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_daily_metrics"
[0m00:01:32.653013 [debug] [Thread-3 (]: Began executing node model.stock_analytics.mart_stock_daily_metrics
[0m00:01:32.659208 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_daily_metrics"
[0m00:01:32.662001 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m00:01:32.662532 [debug] [Thread-3 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
create or replace transient table ASH_DB.STOCK_analytics.mart_stock_daily_metrics
         as
        (

WITH base AS (
    SELECT * FROM ASH_DB.STOCK_raw.stg_stock_daily
    WHERE DATA_QUALITY_FLAG = 'VALID'
),

ma AS (
    SELECT * FROM ASH_DB.STOCK_analytics.int_moving_averages
),

rsi AS (
    SELECT * FROM ASH_DB.STOCK_analytics.int_rsi
),

bollinger AS (
    SELECT * FROM ASH_DB.STOCK_analytics.int_bollinger
),

macd AS (
    SELECT * FROM ASH_DB.STOCK_analytics.int_macd
)

SELECT 
    -- Basic information
    base.SYMBOL,
    base."DATE",
    base."CLOSE",
    base."OPEN",
    base."MAX",
    base."MIN",
    base.VOLUME,
    
    -- Daily changes
    base.DAILY_CHANGE,
    base.DAILY_CHANGE_PCT,
    base.INTRADAY_RANGE,
    base.INTRADAY_RANGE_PCT,
    
    -- Moving Averages
    ma.MA_5,
    ma.MA_20,
    ma.MA_50,
    ma.EMA_12,
    ma.EMA_26,
    
    -- MA Cross Signals (Golden Cross / Death Cross)
    CASE 
        -- Golden Cross: MA5 crosses above MA20
        WHEN ma.MA_5 > ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") 
        THEN 'GOLDEN_CROSS_5_20'
        
        -- Death Cross: MA5 crosses below MA20
        WHEN ma.MA_5 < ma.MA_20 
             AND LAG(ma.MA_5) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_5_20'
        
        -- Golden Cross: MA20 crosses above MA50
        WHEN ma.MA_20 > ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") <= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'GOLDEN_CROSS_20_50'
        
        -- Death Cross: MA20 crosses below MA50
        WHEN ma.MA_20 < ma.MA_50 
             AND LAG(ma.MA_20) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE") >= LAG(ma.MA_50) OVER (PARTITION BY base.SYMBOL ORDER BY base."DATE")
        THEN 'DEATH_CROSS_20_50'
        
        ELSE 'NO_CROSS'
    END as MA_CROSS_SIGNAL,
    
    -- Price vs MA trend analysis
    CASE 
        WHEN base."CLOSE" > ma.MA_5 AND base."CLOSE" > ma.MA_20 AND base."CLOSE" > ma.MA_50 THEN 'STRONG_UPTREND'
        WHEN base."CLOSE" < ma.MA_5 AND base."CLOSE" < ma.MA_20 AND base."CLOSE" < ma.MA_50 THEN 'STRONG_DOWNTREND'
        WHEN base."CLOSE" > ma.MA_20 THEN 'UPTREND'
        WHEN base."CLOSE" < ma.MA_20 THEN 'DOWNTREND'
        ELSE 'SIDEWAYS'
    END as PRICE_TREND,
    
    -- RSI indicators
    rsi.RSI_14,
    rsi.RSI_SIGNAL,
    
    -- Bollinger Bands
    bollinger.BB_UPPER,
    bollinger.BB_LOWER,
    bollinger.BB_MIDDLE,
    bollinger.BB_WIDTH_PCT,
    bollinger.BB_PERCENT_B,
    bollinger.BB_SIGNAL,
    bollinger.BB_SQUEEZE,
    
    -- MACD indicators
    macd.MACD_LINE,
    macd.SIGNAL_LINE,
    macd.MACD_HISTOGRAM,
    macd.MACD_SIGNAL,
    
    -- Volatility (using intraday range as proxy)
    CASE 
        WHEN base.INTRADAY_RANGE_PCT > 5 THEN 'HIGH_VOLATILITY'
        WHEN base.INTRADAY_RANGE_PCT < 1 THEN 'LOW_VOLATILITY'
        ELSE 'NORMAL_VOLATILITY'
    END as VOLATILITY_SIGNAL

FROM base
LEFT JOIN ma 
    ON base.SYMBOL = ma.SYMBOL AND base."DATE" = ma."DATE"
LEFT JOIN rsi 
    ON base.SYMBOL = rsi.SYMBOL AND base."DATE" = rsi."DATE"
LEFT JOIN bollinger 
    ON base.SYMBOL = bollinger.SYMBOL AND base."DATE" = bollinger."DATE"
LEFT JOIN macd 
    ON base.SYMBOL = macd.SYMBOL AND base."DATE" = macd."DATE"
        );
[0m00:01:32.663098 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:01:36.647131 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.984 seconds
[0m00:01:36.652246 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m00:01:36.653270 [debug] [Thread-3 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
comment on table ASH_DB.STOCK_analytics.mart_stock_daily_metrics IS $$Daily stock metrics with all technical indicators$$;
[0m00:01:37.002222 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m00:01:37.009529 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m00:01:37.011132 [debug] [Thread-3 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
describe table ASH_DB.STOCK_analytics.mart_stock_daily_metrics
[0m00:01:38.385536 [debug] [Thread-3 (]: SQL status: SUCCESS 32 in 1.373 seconds
[0m00:01:38.389426 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.mart_stock_daily_metrics"
[0m00:01:38.389779 [debug] [Thread-3 (]: On model.stock_analytics.mart_stock_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_daily_metrics"} */
alter table ASH_DB.STOCK_analytics.mart_stock_daily_metrics alter
    
        "SYMBOL" COMMENT $$$$,
    
        "DATE" COMMENT $$$$,
    
        "CLOSE" COMMENT $$$$,
    
        "OPEN" COMMENT $$$$,
    
        "MAX" COMMENT $$$$,
    
        "MIN" COMMENT $$$$,
    
        "VOLUME" COMMENT $$$$,
    
        "DAILY_CHANGE" COMMENT $$$$,
    
        "DAILY_CHANGE_PCT" COMMENT $$$$,
    
        "INTRADAY_RANGE" COMMENT $$$$,
    
        "INTRADAY_RANGE_PCT" COMMENT $$$$,
    
        "MA_5" COMMENT $$$$,
    
        "MA_20" COMMENT $$$$,
    
        "MA_50" COMMENT $$$$,
    
        "EMA_12" COMMENT $$$$,
    
        "EMA_26" COMMENT $$$$,
    
        "MA_CROSS_SIGNAL" COMMENT $$$$,
    
        "PRICE_TREND" COMMENT $$Overall price trend$$,
    
        "RSI_14" COMMENT $$$$,
    
        "RSI_SIGNAL" COMMENT $$$$,
    
        "BB_UPPER" COMMENT $$$$,
    
        "BB_LOWER" COMMENT $$$$,
    
        "BB_MIDDLE" COMMENT $$$$,
    
        "BB_WIDTH_PCT" COMMENT $$$$,
    
        "BB_PERCENT_B" COMMENT $$$$,
    
        "BB_SIGNAL" COMMENT $$$$,
    
        "BB_SQUEEZE" COMMENT $$$$,
    
        "MACD_LINE" COMMENT $$$$,
    
        "SIGNAL_LINE" COMMENT $$$$,
    
        "MACD_HISTOGRAM" COMMENT $$$$,
    
        "MACD_SIGNAL" COMMENT $$$$,
    
        "VOLATILITY_SIGNAL" COMMENT $$$$;
[0m00:01:38.676797 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m00:01:38.678094 [debug] [Thread-3 (]: On model.stock_analytics.mart_stock_daily_metrics: Close
[0m00:01:39.655132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c55471-66de-476d-8072-e1749c30d5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6001d220>]}
[0m00:01:39.655857 [info ] [Thread-3 (]: 7 of 7 OK created sql table model STOCK_analytics.mart_stock_daily_metrics ..... [[32mSUCCESS 1[0m in 7.02s]
[0m00:01:39.656997 [debug] [Thread-3 (]: Finished running node model.stock_analytics.mart_stock_daily_metrics
[0m00:01:39.658853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:39.659205 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_daily_metrics' was properly closed.
[0m00:01:39.659466 [debug] [MainThread]: Connection 'model.stock_analytics.int_moving_averages' was properly closed.
[0m00:01:39.659706 [debug] [MainThread]: Connection 'model.stock_analytics.int_rsi' was properly closed.
[0m00:01:39.659906 [debug] [MainThread]: Connection 'model.stock_analytics.int_macd' was properly closed.
[0m00:01:39.660272 [info ] [MainThread]: 
[0m00:01:39.660692 [info ] [MainThread]: Finished running 1 view model, 6 table models in 0 hours 0 minutes and 28.26 seconds (28.26s).
[0m00:01:39.661460 [debug] [MainThread]: Command end result
[0m00:01:39.764420 [info ] [MainThread]: 
[0m00:01:39.765030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:39.765302 [info ] [MainThread]: 
[0m00:01:39.765603 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m00:01:39.766370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.070425, "process_user_time": 2.949552, "process_kernel_time": 0.21723, "process_mem_max_rss": "236736", "process_in_blocks": "496", "process_out_blocks": "3055"}
[0m00:01:39.766711 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:39.766668 after 29.07 seconds
[0m00:01:39.766993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7deca1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a30c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61654470>]}
[0m00:01:39.767253 [debug] [MainThread]: Flushing usage events
[0m00:01:43.123790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bcefec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9f4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df81220>]}


============================== 00:01:43.127646 | 76ffdd55-5d9a-41c8-ad51-dc292c8ac6d2 ==============================
[0m00:01:43.127646 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:01:43.128753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:01:43.570082 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:01:43.571313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76ffdd55-5d9a-41c8-ad51-dc292c8ac6d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed988f0>]}
[0m00:01:43.601351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76ffdd55-5d9a-41c8-ad51-dc292c8ac6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70c86840>]}
[0m00:01:43.623185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76ffdd55-5d9a-41c8-ad51-dc292c8ac6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc866c0>]}
[0m00:01:43.623830 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:01:43.632644 [debug] [MainThread]: checksum: 57c41580a38e89e4b05d375c1c5c6d10e12c61f686c39f659f6bca32dfc17a2b, vars: {}, profile: , target: dev, version: 1.8.8
[0m00:01:43.723774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:43.724120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:43.747988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76ffdd55-5d9a-41c8-ad51-dc292c8ac6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b8ecbf0>]}
[0m00:01:43.821522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76ffdd55-5d9a-41c8-ad51-dc292c8ac6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b33b7d0>]}
[0m00:01:43.822060 [info ] [MainThread]: Found 7 models, 1 snapshot, 33 data tests, 1 source, 568 macros
[0m00:01:43.823065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ffdd55-5d9a-41c8-ad51-dc292c8ac6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ba89e50>]}
[0m00:01:43.824854 [info ] [MainThread]: 
[0m00:01:43.825440 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:43.828416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB'
[0m00:01:43.836470 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB"
[0m00:01:43.836895 [debug] [ThreadPool]: On list_ASH_DB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB"} */
show terse schemas in database ASH_DB
    limit 10000
[0m00:01:43.837158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:45.556913 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.719 seconds
[0m00:01:45.561208 [debug] [ThreadPool]: On list_ASH_DB: Close
[0m00:01:45.922857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASH_DB, now list_ASH_DB_STOCK_raw)
[0m00:01:45.924694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_analytics'
[0m00:01:45.929128 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_STOCK_test_failures'
[0m00:01:45.939426 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_raw"
[0m00:01:45.941766 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_analytics"
[0m00:01:45.942351 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASH_DB_snapshots'
[0m00:01:45.944354 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_STOCK_test_failures"
[0m00:01:45.944838 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_raw"} */
show objects in ASH_DB.STOCK_raw limit 10000
[0m00:01:45.945280 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_analytics"} */
show objects in ASH_DB.STOCK_analytics limit 10000
[0m00:01:45.946950 [debug] [ThreadPool]: Using snowflake connection "list_ASH_DB_snapshots"
[0m00:01:45.947391 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_STOCK_test_failures"} */
show objects in ASH_DB.STOCK_test_failures limit 10000
[0m00:01:45.947861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:45.948272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:45.948673 [debug] [ThreadPool]: On list_ASH_DB_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_ASH_DB_snapshots"} */
show objects in ASH_DB.snapshots limit 10000
[0m00:01:45.949081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:45.952629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:47.243154 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.295 seconds
[0m00:01:47.247359 [debug] [ThreadPool]: On list_ASH_DB_STOCK_raw: Close
[0m00:01:47.529295 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.581 seconds
[0m00:01:47.533449 [debug] [ThreadPool]: On list_ASH_DB_STOCK_analytics: Close
[0m00:01:47.634230 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.681 seconds
[0m00:01:47.637511 [debug] [ThreadPool]: On list_ASH_DB_snapshots: Close
[0m00:01:47.958204 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 2.009 seconds
[0m00:01:47.961237 [debug] [ThreadPool]: On list_ASH_DB_STOCK_test_failures: Close
[0m00:01:48.669763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ffdd55-5d9a-41c8-ad51-dc292c8ac6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b7459d0>]}
[0m00:01:48.672177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:01:48.674655 [info ] [MainThread]: 
[0m00:01:48.688182 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m00:01:48.688890 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m00:01:48.690176 [debug] [Thread-3 (]: Began running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m00:01:48.690943 [debug] [Thread-4 (]: Began running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m00:01:48.691406 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [RUN]
[0m00:01:48.692165 [info ] [Thread-2 (]: 2 of 33 START test accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [RUN]
[0m00:01:48.692760 [info ] [Thread-3 (]: 3 of 33 START test accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL  [RUN]
[0m00:01:48.693323 [info ] [Thread-4 (]: 4 of 33 START test accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [RUN]
[0m00:01:48.694012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_test_failures, now test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6)
[0m00:01:48.694454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ASH_DB_snapshots, now test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef)
[0m00:01:48.695131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_analytics, now test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859)
[0m00:01:48.695590 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_ASH_DB_STOCK_raw, now test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a)
[0m00:01:48.696050 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m00:01:48.696498 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m00:01:48.696919 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m00:01:48.697330 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m00:01:48.709192 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m00:01:48.712136 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m00:01:48.714761 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m00:01:48.718797 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m00:01:48.721032 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m00:01:48.721341 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m00:01:48.732868 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_INT_MACD_03D76AC49786AFFDB0C9DCED06432A11"
[0m00:01:48.733133 [debug] [Thread-3 (]: Began executing node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m00:01:48.733469 [debug] [Thread-4 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m00:01:48.735434 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_INT_MOVING_AVE_6CA08515D89550A8F253DD31743BCB67"
[0m00:01:48.738665 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m00:01:48.740460 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_INT_RSI_E03F19197F66DE5A3784EE911F15DCB3"
[0m00:01:48.742766 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_MART_STOCK_DAI_7F3B5CE4F2B7B009A1EB3E6E2DF356F8"
[0m00:01:48.743314 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m00:01:48.743592 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_INT_MACD_03D76AC49786AFFDB0C9DCED06432A11" cascade
[0m00:01:48.744170 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m00:01:48.744766 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m00:01:48.745153 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_INT_MOVING_AVE_6CA08515D89550A8F253DD31743BCB67" cascade
[0m00:01:48.745492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:48.745795 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_INT_RSI_E03F19197F66DE5A3784EE911F15DCB3" cascade
[0m00:01:48.746055 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_MART_STOCK_DAI_7F3B5CE4F2B7B009A1EB3E6E2DF356F8" cascade
[0m00:01:48.746321 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:01:48.747719 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:01:48.748142 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:01:50.167113 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.420 seconds
[0m00:01:50.174490 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.426 seconds
[0m00:01:50.179918 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
[0m00:01:50.182068 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
[0m00:01:50.201023 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m00:01:50.202247 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m00:01:50.202709 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
         as
        (
    
    

with all_values as (

    select
        MA_CROSS_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_analytics.int_moving_averages where MA_CROSS_SIGNAL IS NOT NULL) dbt_subquery
    group by MA_CROSS_SIGNAL

)

select *
from all_values
where value_field not in (
    'GOLDEN_CROSS','DEATH_CROSS','NEUTRAL'
)



        );
[0m00:01:50.203155 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
         as
        (
    
    

with all_values as (

    select
        PRICE_TREND as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
    group by PRICE_TREND

)

select *
from all_values
where value_field not in (
    'STRONG_UPTREND','UPTREND','SIDEWAYS','DOWNTREND','STRONG_DOWNTREND'
)



        );
[0m00:01:50.569308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.824 seconds
[0m00:01:50.570471 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
[0m00:01:50.571674 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m00:01:50.572125 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
         as
        (
    
    

with all_values as (

    select
        MACD_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_analytics.int_macd where MACD_SIGNAL IS NOT NULL) dbt_subquery
    group by MACD_SIGNAL

)

select *
from all_values
where value_field not in (
    'BULLISH_CROSSOVER','BEARISH_CROSSOVER','BULLISH','BEARISH','NEUTRAL'
)



        );
[0m00:01:50.609379 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.862 seconds
[0m00:01:50.610298 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
[0m00:01:50.611209 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m00:01:50.611466 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
         as
        (
    
    

with all_values as (

    select
        RSI_SIGNAL as value_field,
        count(*) as n_records

    from (select * from ASH_DB.STOCK_analytics.int_rsi where RSI_SIGNAL IS NOT NULL) dbt_subquery
    group by RSI_SIGNAL

)

select *
from all_values
where value_field not in (
    'OVERBOUGHT','OVERSOLD','NEUTRAL'
)



        );
[0m00:01:52.723366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.151 seconds
[0m00:01:52.725056 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.522 seconds
[0m00:01:52.732899 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m00:01:52.735489 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m00:01:52.741708 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"
[0m00:01:52.742626 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"
[0m00:01:52.743370 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_int_moving_ave_6ca08515d89550a8f253dd31743bcb67
    
      
    ) dbt_internal_test
[0m00:01:52.744131 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_int_macd_03d76ac49786affdb0c9dced06432a11
    
      
    ) dbt_internal_test
[0m00:01:52.907153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m00:01:52.923947 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6: Close
[0m00:01:52.939045 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m00:01:52.941013 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef: Close
[0m00:01:53.439391 [info ] [Thread-2 (]: 2 of 33 PASS accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL  [[32mPASS[0m in 4.74s]
[0m00:01:53.440726 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL  [[32mPASS[0m in 4.75s]
[0m00:01:53.442528 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef
[0m00:01:53.443213 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6
[0m00:01:53.443808 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m00:01:53.444481 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m00:01:53.445043 [info ] [Thread-2 (]: 5 of 33 START test accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [RUN]
[0m00:01:53.445778 [info ] [Thread-1 (]: 6 of 33 START test dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE  [RUN]
[0m00:01:53.446448 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_moving_averages_MA_CROSS_SIGNAL__GOLDEN_CROSS__DEATH_CROSS__NEUTRAL.d96c4518ef, now test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987)
[0m00:01:53.446964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_macd_MACD_SIGNAL__BULLISH_CROSSOVER__BEARISH_CROSSOVER__BULLISH__BEARISH__NEUTRAL.8ebcc8d5b6, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1)
[0m00:01:53.447530 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m00:01:53.448015 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m00:01:53.454499 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m00:01:53.460847 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m00:01:53.462215 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m00:01:53.462549 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m00:01:53.465538 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_STG_STOCK_DAIL_56D0AB7DE46C8DB0B014849697C2711B"
[0m00:01:53.468387 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_LOWER___BB_MIDDLE"
[0m00:01:53.469281 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m00:01:53.471232 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m00:01:53.471694 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."ACCEPTED_VALUES_STG_STOCK_DAIL_56D0AB7DE46C8DB0B014849697C2711B" cascade
[0m00:01:53.472142 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_LOWER___BB_MIDDLE" cascade
[0m00:01:53.472567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:01:53.473088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:53.482061 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.871 seconds
[0m00:01:53.483071 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m00:01:53.484362 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"
[0m00:01:53.484661 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_int_rsi_e03f19197f66de5a3784ee911f15dcb3
    
      
    ) dbt_internal_test
[0m00:01:54.047382 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.843 seconds
[0m00:01:54.052766 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m00:01:54.058555 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m00:01:54.062583 [debug] [Thread-3 (]: On test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859: Close
[0m00:01:54.067564 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"
[0m00:01:54.068324 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_mart_stock_dai_7f3b5ce4f2b7b009a1eb3e6e2df356f8
    
      
    ) dbt_internal_test
[0m00:01:54.281937 [info ] [Thread-3 (]: 3 of 33 PASS accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL . [[32mPASS[0m in 5.59s]
[0m00:01:54.284037 [debug] [Thread-3 (]: Finished running node test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859
[0m00:01:54.284888 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m00:01:54.285587 [info ] [Thread-3 (]: 7 of 33 START test dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE  [RUN]
[0m00:01:54.286478 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_int_rsi_RSI_SIGNAL__OVERBOUGHT__OVERSOLD__NEUTRAL.7966448859, now test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c)
[0m00:01:54.287095 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m00:01:54.292539 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m00:01:54.294084 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m00:01:54.297950 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_UPPER___BB_MIDDLE"
[0m00:01:54.298981 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m00:01:54.299418 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_BOLLINGER_BB_UPPER___BB_MIDDLE" cascade
[0m00:01:54.299916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:01:54.501273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.028 seconds
[0m00:01:54.502242 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
[0m00:01:54.503205 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m00:01:54.503478 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_analytics.int_bollinger where BB_LOWER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_LOWER < BB_MIDDLE)


        );
[0m00:01:54.733181 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m00:01:54.737926 [debug] [Thread-4 (]: On test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a: Close
[0m00:01:55.077682 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.605 seconds
[0m00:01:55.080946 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
[0m00:01:55.084347 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m00:01:55.085474 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
create or replace transient table ASH_DB.STOCK_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
         as
        (
    
    

with all_values as (

    select
        DATA_QUALITY_FLAG as value_field,
        count(*) as n_records

    from ASH_DB.STOCK_raw.stg_stock_daily
    group by DATA_QUALITY_FLAG

)

select *
from all_values
where value_field not in (
    'VALID','INVALID','ANOMALY','MISSING','NO_TRADING'
)



        );
[0m00:01:55.162156 [info ] [Thread-4 (]: 4 of 33 PASS accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND  [[32mPASS[0m in 6.47s]
[0m00:01:55.164628 [debug] [Thread-4 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a
[0m00:01:55.165940 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m00:01:55.167147 [info ] [Thread-4 (]: 8 of 33 START test dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0  [RUN]
[0m00:01:55.168562 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_daily_metrics_PRICE_TREND__STRONG_UPTREND__UPTREND__SIDEWAYS__DOWNTREND__STRONG_DOWNTREND.4e1440582a, now test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d)
[0m00:01:55.169285 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m00:01:55.175375 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m00:01:55.177615 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m00:01:55.181451 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_I_073ECBDFB3F8461B722A2236FFC246EF"
[0m00:01:55.182455 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m00:01:55.182891 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_I_073ECBDFB3F8461B722A2236FFC246EF" cascade
[0m00:01:55.183296 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:01:56.731983 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.432 seconds
[0m00:01:56.733606 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
[0m00:01:56.735296 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m00:01:56.735813 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
         as
        (



select
    *
from (select * from ASH_DB.STOCK_analytics.int_bollinger where BB_UPPER IS NOT NULL AND BB_MIDDLE IS NOT NULL) dbt_subquery

where not(BB_UPPER > BB_MIDDLE)


        );
[0m00:01:56.740623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.237 seconds
[0m00:01:56.742118 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m00:01:56.744309 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"
[0m00:01:56.744786 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m00:01:56.919246 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.736 seconds
[0m00:01:56.925416 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
[0m00:01:56.928647 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m00:01:56.929705 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
         as
        (



select
    *
from (select * from ASH_DB.STOCK_analytics.int_daily_returns where VOLATILITY_20D IS NOT NULL) dbt_subquery

where not(VOLATILITY_20D >= 0)


        );
[0m00:01:57.055651 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.969 seconds
[0m00:01:57.059332 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m00:01:57.063166 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"
[0m00:01:57.063983 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.accepted_values_stg_stock_dail_56d0ab7de46c8db0b014849697c2711b
    
      
    ) dbt_internal_test
[0m00:01:57.535362 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m00:01:57.540521 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987: Close
[0m00:01:58.146662 [info ] [Thread-2 (]: 5 of 33 PASS accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING  [[32mPASS[0m in 4.70s]
[0m00:01:58.147594 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987
[0m00:01:58.147980 [debug] [Thread-2 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m00:01:58.148313 [info ] [Thread-2 (]: 9 of 33 START test dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100  [RUN]
[0m00:01:58.148745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_daily_DATA_QUALITY_FLAG__VALID__INVALID__ANOMALY__MISSING__NO_TRADING.b734ba6987, now test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb)
[0m00:01:58.149018 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m00:01:58.152393 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m00:01:58.153222 [debug] [Thread-2 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m00:01:58.213787 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_RSI_RSI_14__BETWEEN_0_AND_100"
[0m00:01:58.214522 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m00:01:58.214796 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_EXPRESSION_IS_TRUE_INT_RSI_RSI_14__BETWEEN_0_AND_100" cascade
[0m00:01:58.215084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:01:58.402754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.657 seconds
[0m00:01:58.404943 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1: Close
[0m00:01:58.814795 [info ] [Thread-1 (]: 6 of 33 PASS dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE ... [[32mPASS[0m in 5.37s]
[0m00:01:58.817485 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1
[0m00:01:58.818933 [debug] [Thread-1 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m00:01:58.820049 [info ] [Thread-1 (]: 10 of 33 START test dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [RUN]
[0m00:01:58.821916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_LOWER___BB_MIDDLE.ec7aa907f1, now test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12)
[0m00:01:58.822977 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m00:01:58.835842 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m00:01:58.837432 [debug] [Thread-1 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m00:01:58.841627 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_C9286FF21D21C3798E9AC65985930CF6"
[0m00:01:58.842676 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m00:01:58.843105 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_C9286FF21D21C3798E9AC65985930CF6" cascade
[0m00:01:58.843369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:59.007742 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.077 seconds
[0m00:01:59.009953 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m00:01:59.011765 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"
[0m00:01:59.012360 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_i_073ecbdfb3f8461b722a2236ffc246ef
    
      
    ) dbt_internal_test
[0m00:01:59.370508 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.634 seconds
[0m00:01:59.372561 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m00:01:59.374330 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"
[0m00:01:59.374880 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE
    
      
    ) dbt_internal_test
[0m00:01:59.515433 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m00:01:59.519092 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d: Close
[0m00:01:59.536222 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.321 seconds
[0m00:01:59.537944 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
[0m00:01:59.539065 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m00:01:59.539391 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
         as
        (



select
    *
from (select * from ASH_DB.STOCK_analytics.int_rsi where RSI_14 IS NOT NULL) dbt_subquery

where not(RSI_14 BETWEEN 0 AND 100)


        );
[0m00:01:59.723681 [info ] [Thread-4 (]: 8 of 33 PASS dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0 . [[32mPASS[0m in 4.55s]
[0m00:01:59.725756 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d
[0m00:01:59.726928 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m00:01:59.728002 [info ] [Thread-4 (]: 11 of 33 START test dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [RUN]
[0m00:01:59.729183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_daily_returns_VOLATILITY_20D___0.1ab6051e4d, now test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b)
[0m00:01:59.729884 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m00:01:59.736170 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m00:01:59.737118 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m00:01:59.739315 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_1CD5BBDAE1662B4E1877B262934E23BF"
[0m00:01:59.739975 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m00:01:59.740245 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."DBT_UTILS_UNIQUE_COMBINATION_O_1CD5BBDAE1662B4E1877B262934E23BF" cascade
[0m00:01:59.740521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:01:59.791865 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.417 seconds
[0m00:01:59.793294 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c: Close
[0m00:02:00.102911 [info ] [Thread-3 (]: 7 of 33 PASS dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE ... [[32mPASS[0m in 5.82s]
[0m00:02:00.104579 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c
[0m00:02:00.105497 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m00:02:00.106183 [info ] [Thread-3 (]: 12 of 33 START test not_null_int_bollinger_DATE ................................ [RUN]
[0m00:02:00.107109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_bollinger_BB_UPPER___BB_MIDDLE.513ff47e6c, now test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac)
[0m00:02:00.107701 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m00:02:00.113670 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m00:02:00.114582 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m00:02:00.117781 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_DATE"
[0m00:02:00.118890 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m00:02:00.119356 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_DATE" cascade
[0m00:02:00.119889 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:02:00.409851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.566 seconds
[0m00:02:00.411691 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
[0m00:02:00.413599 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m00:02:00.414124 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m00:02:00.647769 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.907 seconds
[0m00:02:00.651501 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
[0m00:02:00.654098 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m00:02:00.654848 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
create or replace transient table ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
         as
        (





with validation_errors as (

    select
        SYMBOL, DATE
    from ASH_DB.STOCK_raw.stg_stock_daily
    group by SYMBOL, DATE
    having count(*) > 1

)

select *
from validation_errors



        );
[0m00:02:01.117459 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.997 seconds
[0m00:02:01.120232 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_bollinger_DATE
[0m00:02:01.122721 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m00:02:01.123711 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_bollinger_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_bollinger
where DATE is null



        );
[0m00:02:01.295472 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.756 seconds
[0m00:02:01.297387 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m00:02:01.299101 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"
[0m00:02:01.299615 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100
    
      
    ) dbt_internal_test
[0m00:02:02.394716 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.094 seconds
[0m00:02:02.397682 [debug] [Thread-2 (]: On test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb: Close
[0m00:02:02.678212 [info ] [Thread-2 (]: 9 of 33 PASS dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100 .... [[32mPASS[0m in 4.53s]
[0m00:02:02.681178 [debug] [Thread-2 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb
[0m00:02:02.682504 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m00:02:02.684078 [info ] [Thread-2 (]: 13 of 33 START test not_null_int_bollinger_SYMBOL .............................. [RUN]
[0m00:02:02.687194 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.562 seconds
[0m00:02:02.688086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_int_rsi_RSI_14__BETWEEN_0_AND_100.8c31216ceb, now test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443)
[0m00:02:02.690875 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m00:02:02.691947 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m00:02:02.698698 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m00:02:02.700018 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"
[0m00:02:02.700677 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_bollinger_DATE
    
      
    ) dbt_internal_test
[0m00:02:02.701517 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m00:02:02.706879 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_SYMBOL"
[0m00:02:02.707993 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m00:02:02.708429 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_BOLLINGER_SYMBOL" cascade
[0m00:02:02.708817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:02:02.956516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.542 seconds
[0m00:02:02.957762 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m00:02:02.959194 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"
[0m00:02:02.959559 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_c9286ff21d21c3798e9ac65985930cf6
    
      
    ) dbt_internal_test
[0m00:02:03.139111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m00:02:03.140704 [debug] [Thread-1 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12: Close
[0m00:02:03.482401 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m00:02:03.488591 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac: Close
[0m00:02:03.777878 [info ] [Thread-3 (]: 12 of 33 PASS not_null_int_bollinger_DATE ...................................... [[32mPASS[0m in 3.67s]
[0m00:02:03.780989 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac
[0m00:02:03.782328 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m00:02:03.783579 [info ] [Thread-3 (]: 14 of 33 START test not_null_int_daily_returns_DATE ............................ [RUN]
[0m00:02:03.785544 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_DATE.3b572faeac, now test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54)
[0m00:02:03.786484 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m00:02:03.793064 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m00:02:03.794391 [info ] [Thread-1 (]: 10 of 33 PASS dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE  [[32mPASS[0m in 4.97s]
[0m00:02:03.796157 [debug] [Thread-1 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12
[0m00:02:03.796956 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m00:02:03.797539 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m00:02:03.798110 [info ] [Thread-1 (]: 15 of 33 START test not_null_int_daily_returns_SYMBOL .......................... [RUN]
[0m00:02:03.802391 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_DATE"
[0m00:02:03.803002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_mart_stock_daily_metrics_SYMBOL__DATE.6d47245f12, now test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2)
[0m00:02:03.804119 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m00:02:03.804590 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m00:02:03.805034 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_DATE" cascade
[0m00:02:03.809612 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m00:02:03.810031 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:02:03.812276 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m00:02:03.815786 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_SYMBOL"
[0m00:02:03.817235 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m00:02:03.817663 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_DAILY_RETURNS_SYMBOL" cascade
[0m00:02:03.818028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:03.842785 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.187 seconds
[0m00:02:03.844026 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m00:02:03.845178 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"
[0m00:02:03.845571 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.dbt_utils_unique_combination_o_1cd5bbdae1662b4e1877b262934e23bf
    
      
    ) dbt_internal_test
[0m00:02:04.144101 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.435 seconds
[0m00:02:04.146678 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_bollinger_SYMBOL
[0m00:02:04.148890 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m00:02:04.150155 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_bollinger_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_bollinger
where SYMBOL is null



        );
[0m00:02:04.834910 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.988 seconds
[0m00:02:04.839611 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b: Close
[0m00:02:04.976492 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.166 seconds
[0m00:02:04.979681 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_daily_returns_DATE
[0m00:02:04.982638 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m00:02:04.983694 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_daily_returns_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_daily_returns
where DATE is null



        );
[0m00:02:05.058086 [info ] [Thread-4 (]: 11 of 33 PASS dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE  [[32mPASS[0m in 5.33s]
[0m00:02:05.059601 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.909 seconds
[0m00:02:05.060370 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b
[0m00:02:05.061708 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m00:02:05.062287 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m00:02:05.063389 [info ] [Thread-4 (]: 16 of 33 START test not_null_int_macd_DATE ..................................... [RUN]
[0m00:02:05.064200 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_stg_stock_daily_SYMBOL__DATE.03da64f87b, now test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b)
[0m00:02:05.065152 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"
[0m00:02:05.065564 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m00:02:05.066025 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_bollinger_SYMBOL
    
      
    ) dbt_internal_test
[0m00:02:05.069355 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m00:02:05.071233 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m00:02:05.074097 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_MACD_DATE"
[0m00:02:05.075246 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m00:02:05.075602 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_MACD_DATE" cascade
[0m00:02:05.075949 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:02:05.623321 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m00:02:05.625878 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443: Close
[0m00:02:05.695073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.877 seconds
[0m00:02:05.696760 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_daily_returns_SYMBOL
[0m00:02:05.698531 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m00:02:05.699184 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_daily_returns_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_daily_returns
where SYMBOL is null



        );
[0m00:02:05.794853 [info ] [Thread-2 (]: 13 of 33 PASS not_null_int_bollinger_SYMBOL .................................... [[32mPASS[0m in 3.11s]
[0m00:02:05.797007 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443
[0m00:02:05.797802 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m00:02:05.798737 [info ] [Thread-2 (]: 17 of 33 START test not_null_int_macd_SYMBOL ................................... [RUN]
[0m00:02:05.799738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_bollinger_SYMBOL.27dbc52443, now test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2)
[0m00:02:05.800451 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m00:02:05.806959 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m00:02:05.809045 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m00:02:05.815453 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_MACD_SYMBOL"
[0m00:02:05.816906 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m00:02:05.817424 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_MACD_SYMBOL" cascade
[0m00:02:05.817931 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:02:06.039007 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.963 seconds
[0m00:02:06.042119 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_macd_DATE
[0m00:02:06.045189 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m00:02:06.046345 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_macd_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_macd
where DATE is null



        );
[0m00:02:06.460745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m00:02:06.461752 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m00:02:06.463009 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"
[0m00:02:06.463361 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_daily_returns_SYMBOL
    
      
    ) dbt_internal_test
[0m00:02:06.790317 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.972 seconds
[0m00:02:06.793898 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_macd_SYMBOL
[0m00:02:06.797049 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m00:02:06.798712 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_macd_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_macd
where SYMBOL is null



        );
[0m00:02:06.963432 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.978 seconds
[0m00:02:06.966938 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m00:02:06.973163 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"
[0m00:02:06.974484 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_daily_returns_DATE
    
      
    ) dbt_internal_test
[0m00:02:06.990898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m00:02:06.993696 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2: Close
[0m00:02:07.291372 [info ] [Thread-1 (]: 15 of 33 PASS not_null_int_daily_returns_SYMBOL ................................ [[32mPASS[0m in 3.49s]
[0m00:02:07.295213 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2
[0m00:02:07.296420 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m00:02:07.297533 [info ] [Thread-1 (]: 18 of 33 START test not_null_int_moving_averages_DATE .......................... [RUN]
[0m00:02:07.299261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_SYMBOL.5fa5194ad2, now test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4)
[0m00:02:07.300268 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m00:02:07.306318 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m00:02:07.308070 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m00:02:07.312185 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_DATE"
[0m00:02:07.313257 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m00:02:07.313713 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_DATE" cascade
[0m00:02:07.314126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:07.383379 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m00:02:07.384877 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54: Close
[0m00:02:07.797526 [info ] [Thread-3 (]: 14 of 33 PASS not_null_int_daily_returns_DATE .................................. [[32mPASS[0m in 4.01s]
[0m00:02:07.798453 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54
[0m00:02:07.798915 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m00:02:07.799352 [info ] [Thread-3 (]: 19 of 33 START test not_null_int_moving_averages_SYMBOL ........................ [RUN]
[0m00:02:07.799894 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_daily_returns_DATE.52a46a3f54, now test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a)
[0m00:02:07.800219 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m00:02:07.802758 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m00:02:07.804435 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m00:02:07.806700 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_SYMBOL"
[0m00:02:07.807350 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m00:02:07.807624 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_MOVING_AVERAGES_SYMBOL" cascade
[0m00:02:07.807895 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:02:07.885242 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.085 seconds
[0m00:02:07.886475 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m00:02:07.887504 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"
[0m00:02:07.887865 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_macd_SYMBOL
    
      
    ) dbt_internal_test
[0m00:02:07.936046 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.889 seconds
[0m00:02:07.937227 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m00:02:07.938320 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"
[0m00:02:07.938717 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_macd_DATE
    
      
    ) dbt_internal_test
[0m00:02:08.126528 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m00:02:08.132949 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b: Close
[0m00:02:08.277497 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m00:02:08.282283 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2: Close
[0m00:02:08.301325 [info ] [Thread-4 (]: 16 of 33 PASS not_null_int_macd_DATE ........................................... [[32mPASS[0m in 3.24s]
[0m00:02:08.303672 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b
[0m00:02:08.304876 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m00:02:08.305883 [info ] [Thread-4 (]: 20 of 33 START test not_null_int_rsi_DATE ...................................... [RUN]
[0m00:02:08.306995 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_DATE.d0b8d5fa9b, now test.stock_analytics.not_null_int_rsi_DATE.1856743a58)
[0m00:02:08.307668 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m00:02:08.312860 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m00:02:08.315482 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m00:02:08.320904 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_RSI_DATE"
[0m00:02:08.321926 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m00:02:08.322364 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_RSI_DATE" cascade
[0m00:02:08.322789 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:02:08.551050 [info ] [Thread-2 (]: 17 of 33 PASS not_null_int_macd_SYMBOL ......................................... [[32mPASS[0m in 2.75s]
[0m00:02:08.553476 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2
[0m00:02:08.554386 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m00:02:08.555203 [info ] [Thread-2 (]: 21 of 33 START test not_null_int_rsi_SYMBOL .................................... [RUN]
[0m00:02:08.556331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_macd_SYMBOL.97a3b8c3c2, now test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035)
[0m00:02:08.556982 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m00:02:08.563651 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m00:02:08.566794 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m00:02:08.571331 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_RSI_SYMBOL"
[0m00:02:08.572449 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m00:02:08.572918 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_INT_RSI_SYMBOL" cascade
[0m00:02:08.573388 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:02:08.662482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.348 seconds
[0m00:02:08.664011 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_moving_averages_DATE
[0m00:02:08.665397 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m00:02:08.665812 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_moving_averages_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_moving_averages
where DATE is null



        );
[0m00:02:09.370018 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.047 seconds
[0m00:02:09.370857 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_rsi_DATE
[0m00:02:09.371668 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m00:02:09.371959 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_rsi_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_rsi
where DATE is null



        );
[0m00:02:10.109017 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.301 seconds
[0m00:02:10.110270 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_moving_averages_SYMBOL
[0m00:02:10.111525 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m00:02:10.111863 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_moving_averages_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_moving_averages
where SYMBOL is null



        );
[0m00:02:10.179177 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.606 seconds
[0m00:02:10.180147 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_int_rsi_SYMBOL
[0m00:02:10.181177 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m00:02:10.181716 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_int_rsi_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.int_rsi
where SYMBOL is null



        );
[0m00:02:10.538317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.872 seconds
[0m00:02:10.539267 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m00:02:10.541133 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"
[0m00:02:10.541386 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_moving_averages_DATE
    
      
    ) dbt_internal_test
[0m00:02:10.763762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m00:02:10.765029 [debug] [Thread-1 (]: On test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4: Close
[0m00:02:10.910713 [info ] [Thread-1 (]: 18 of 33 PASS not_null_int_moving_averages_DATE ................................ [[32mPASS[0m in 3.61s]
[0m00:02:10.911764 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4
[0m00:02:10.912418 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m00:02:10.912868 [info ] [Thread-1 (]: 22 of 33 START test not_null_mart_stock_daily_metrics_CLOSE .................... [RUN]
[0m00:02:10.913768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_DATE.6bd46d80c4, now test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9)
[0m00:02:10.914206 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m00:02:10.916676 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m00:02:10.917371 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m00:02:10.919317 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_CLOSE"
[0m00:02:10.919895 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m00:02:10.920136 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_CLOSE" cascade
[0m00:02:10.920360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:10.923097 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m00:02:10.923864 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m00:02:10.924930 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"
[0m00:02:10.925462 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_rsi_SYMBOL
    
      
    ) dbt_internal_test
[0m00:02:11.461784 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m00:02:11.463244 [debug] [Thread-2 (]: On test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035: Close
[0m00:02:12.077339 [info ] [Thread-2 (]: 21 of 33 PASS not_null_int_rsi_SYMBOL .......................................... [[32mPASS[0m in 3.52s]
[0m00:02:12.079567 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035
[0m00:02:12.081057 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m00:02:12.082167 [info ] [Thread-2 (]: 23 of 33 START test not_null_mart_stock_daily_metrics_DATE ..................... [RUN]
[0m00:02:12.083306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_SYMBOL.3ca4cea035, now test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510)
[0m00:02:12.084521 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m00:02:12.094175 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m00:02:12.096983 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m00:02:12.100871 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_DATE"
[0m00:02:12.101987 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m00:02:12.102545 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_DATE" cascade
[0m00:02:12.103234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:02:12.398454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.478 seconds
[0m00:02:12.400085 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_CLOSE
[0m00:02:12.401492 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m00:02:12.401951 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
where CLOSE is null



        );
[0m00:02:13.199398 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.827 seconds
[0m00:02:13.201497 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m00:02:13.203010 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"
[0m00:02:13.203449 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_rsi_DATE.1856743a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_rsi_DATE
    
      
    ) dbt_internal_test
[0m00:02:13.292970 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.180 seconds
[0m00:02:13.295738 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m00:02:13.298759 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"
[0m00:02:13.299583 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_int_moving_averages_SYMBOL
    
      
    ) dbt_internal_test
[0m00:02:13.472963 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m00:02:13.475424 [debug] [Thread-4 (]: On test.stock_analytics.not_null_int_rsi_DATE.1856743a58: Close
[0m00:02:13.480374 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m00:02:13.482060 [debug] [Thread-3 (]: On test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a: Close
[0m00:02:13.628927 [info ] [Thread-4 (]: 20 of 33 PASS not_null_int_rsi_DATE ............................................ [[32mPASS[0m in 5.32s]
[0m00:02:13.631409 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_int_rsi_DATE.1856743a58
[0m00:02:13.634810 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m00:02:13.636100 [info ] [Thread-4 (]: 24 of 33 START test not_null_mart_stock_daily_metrics_PRICE_TREND .............. [RUN]
[0m00:02:13.637689 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_rsi_DATE.1856743a58, now test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200)
[0m00:02:13.638584 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m00:02:13.644510 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m00:02:13.646215 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m00:02:13.650024 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_PRICE_TREND"
[0m00:02:13.651231 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m00:02:13.651716 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_PRICE_TREND" cascade
[0m00:02:13.652206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:02:13.741578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.339 seconds
[0m00:02:13.743746 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m00:02:13.745780 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"
[0m00:02:13.746381 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_CLOSE
    
      
    ) dbt_internal_test
[0m00:02:13.785825 [info ] [Thread-3 (]: 19 of 33 PASS not_null_int_moving_averages_SYMBOL .............................. [[32mPASS[0m in 5.99s]
[0m00:02:13.787574 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a
[0m00:02:13.788600 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m00:02:13.789295 [info ] [Thread-3 (]: 25 of 33 START test not_null_mart_stock_daily_metrics_SYMBOL ................... [RUN]
[0m00:02:13.790154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_int_moving_averages_SYMBOL.30d5961b1a, now test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435)
[0m00:02:13.790724 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m00:02:13.795196 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m00:02:13.796368 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m00:02:13.799814 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_SYMBOL"
[0m00:02:13.800857 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m00:02:13.801240 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_MART_STOCK_DAILY_METRICS_SYMBOL" cascade
[0m00:02:13.801573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:02:14.023507 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.920 seconds
[0m00:02:14.026596 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_DATE
[0m00:02:14.029601 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m00:02:14.030955 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
where DATE is null



        );
[0m00:02:14.494778 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m00:02:14.496478 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
[0m00:02:14.500512 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m00:02:14.501039 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
where PRICE_TREND is null



        );
[0m00:02:14.727015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m00:02:14.731525 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9: Close
[0m00:02:15.146337 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.114 seconds
[0m00:02:15.148368 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m00:02:15.149545 [info ] [Thread-1 (]: 22 of 33 PASS not_null_mart_stock_daily_metrics_CLOSE .......................... [[32mPASS[0m in 4.24s]
[0m00:02:15.151223 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9
[0m00:02:15.151901 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m00:02:15.152683 [info ] [Thread-1 (]: 26 of 33 START test not_null_stg_stock_daily_CLOSE ............................. [RUN]
[0m00:02:15.153400 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"
[0m00:02:15.153940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_CLOSE.a09ef01de9, now test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75)
[0m00:02:15.154483 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_DATE
    
      
    ) dbt_internal_test
[0m00:02:15.155208 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m00:02:15.160307 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m00:02:15.161732 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m00:02:15.164883 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_CLOSE"
[0m00:02:15.165696 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m00:02:15.166089 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_CLOSE" cascade
[0m00:02:15.166410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:15.401993 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.246 seconds
[0m00:02:15.405537 [debug] [Thread-2 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510: Close
[0m00:02:15.611004 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.809 seconds
[0m00:02:15.612097 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
[0m00:02:15.613078 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m00:02:15.613369 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_analytics.mart_stock_daily_metrics
where SYMBOL is null



        );
[0m00:02:15.963983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.797 seconds
[0m00:02:15.965703 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_CLOSE
[0m00:02:15.966879 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m00:02:15.967191 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where CLOSE is null



        );
[0m00:02:16.374416 [info ] [Thread-2 (]: 23 of 33 PASS not_null_mart_stock_daily_metrics_DATE ........................... [[32mPASS[0m in 4.29s]
[0m00:02:16.375863 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510
[0m00:02:16.376292 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m00:02:16.376794 [info ] [Thread-2 (]: 27 of 33 START test not_null_stg_stock_daily_DAILY_CHANGE_PCT .................. [RUN]
[0m00:02:16.377306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_DATE.5e2f887510, now test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285)
[0m00:02:16.377672 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m00:02:16.381110 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m00:02:16.381845 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m00:02:16.383990 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DAILY_CHANGE_PCT"
[0m00:02:16.384624 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m00:02:16.384877 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DAILY_CHANGE_PCT" cascade
[0m00:02:16.385119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:02:17.091986 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.590 seconds
[0m00:02:17.093807 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m00:02:17.095679 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"
[0m00:02:17.096523 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_PRICE_TREND
    
      
    ) dbt_internal_test
[0m00:02:17.433079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.465 seconds
[0m00:02:17.434295 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m00:02:17.435568 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"
[0m00:02:17.435916 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_CLOSE
    
      
    ) dbt_internal_test
[0m00:02:17.580900 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m00:02:17.582904 [debug] [Thread-4 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200: Close
[0m00:02:18.020531 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.635 seconds
[0m00:02:18.022073 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
[0m00:02:18.023443 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m00:02:18.023897 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where DAILY_CHANGE_PCT is null



        );
[0m00:02:18.104042 [info ] [Thread-4 (]: 24 of 33 PASS not_null_mart_stock_daily_metrics_PRICE_TREND .................... [[32mPASS[0m in 4.47s]
[0m00:02:18.106204 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200
[0m00:02:18.106877 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m00:02:18.107527 [info ] [Thread-4 (]: 28 of 33 START test not_null_stg_stock_daily_DATA_QUALITY_FLAG ................. [RUN]
[0m00:02:18.108238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_PRICE_TREND.d4a458b200, now test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291)
[0m00:02:18.108763 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m00:02:18.113762 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m00:02:18.114786 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m00:02:18.120303 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATA_QUALITY_FLAG"
[0m00:02:18.121209 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m00:02:18.121553 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATA_QUALITY_FLAG" cascade
[0m00:02:18.121871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:02:18.343145 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.729 seconds
[0m00:02:18.346774 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m00:02:18.350531 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"
[0m00:02:18.351779 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_mart_stock_daily_metrics_SYMBOL
    
      
    ) dbt_internal_test
[0m00:02:18.732866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.296 seconds
[0m00:02:18.738024 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75: Close
[0m00:02:18.744397 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m00:02:18.747770 [debug] [Thread-3 (]: On test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435: Close
[0m00:02:18.881913 [info ] [Thread-3 (]: 25 of 33 PASS not_null_mart_stock_daily_metrics_SYMBOL ......................... [[32mPASS[0m in 5.09s]
[0m00:02:18.883046 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435
[0m00:02:18.883878 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m00:02:18.884419 [info ] [Thread-3 (]: 29 of 33 START test not_null_stg_stock_daily_DATE .............................. [RUN]
[0m00:02:18.885229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_daily_metrics_SYMBOL.81a77bf435, now test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022)
[0m00:02:18.885617 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m00:02:18.888806 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m00:02:18.889845 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m00:02:18.892358 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATE"
[0m00:02:18.893125 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m00:02:18.893419 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_DATE" cascade
[0m00:02:18.893698 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:02:19.114933 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m00:02:19.116940 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
[0m00:02:19.118667 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m00:02:19.120250 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where DATA_QUALITY_FLAG is null



        );
[0m00:02:19.158348 [info ] [Thread-1 (]: 26 of 33 PASS not_null_stg_stock_daily_CLOSE ................................... [[32mPASS[0m in 4.00s]
[0m00:02:19.159901 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75
[0m00:02:19.160603 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m00:02:19.161276 [info ] [Thread-1 (]: 30 of 33 START test not_null_stg_stock_daily_SYMBOL ............................ [RUN]
[0m00:02:19.162013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_CLOSE.32634cac75, now test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0)
[0m00:02:19.162618 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m00:02:19.167439 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m00:02:19.168881 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m00:02:19.172217 [debug] [Thread-1 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_SYMBOL"
[0m00:02:19.173162 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m00:02:19.173578 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."NOT_NULL_STG_STOCK_DAILY_SYMBOL" cascade
[0m00:02:19.174048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:19.514700 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.490 seconds
[0m00:02:19.518640 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m00:02:19.523358 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"
[0m00:02:19.524544 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DAILY_CHANGE_PCT
    
      
    ) dbt_internal_test
[0m00:02:20.473737 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.580 seconds
[0m00:02:20.475376 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATE
[0m00:02:20.476785 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m00:02:20.477249 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where DATE is null



        );
[0m00:02:20.632277 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.106 seconds
[0m00:02:20.636732 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285: Close
[0m00:02:20.731275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.557 seconds
[0m00:02:20.735062 [debug] [Thread-1 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_SYMBOL
[0m00:02:20.738876 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m00:02:20.743383 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
create or replace transient table ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK_raw.stg_stock_daily
where SYMBOL is null



        );
[0m00:02:20.880803 [info ] [Thread-2 (]: 27 of 33 PASS not_null_stg_stock_daily_DAILY_CHANGE_PCT ........................ [[32mPASS[0m in 4.50s]
[0m00:02:20.883769 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285
[0m00:02:20.887428 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m00:02:20.890009 [info ] [Thread-2 (]: 31 of 33 START test source_not_null_raw_fact_stock_price_daily_CLOSE ........... [RUN]
[0m00:02:20.891818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DAILY_CHANGE_PCT.ed0d72d285, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178)
[0m00:02:20.892743 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m00:02:20.898931 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m00:02:20.901655 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m00:02:20.907880 [debug] [Thread-2 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_CLOSE"
[0m00:02:20.909061 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m00:02:20.909523 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_CLOSE" cascade
[0m00:02:20.909930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:02:21.458397 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.981 seconds
[0m00:02:21.460148 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m00:02:21.461942 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"
[0m00:02:21.462303 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATE
    
      
    ) dbt_internal_test
[0m00:02:21.657197 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m00:02:21.661775 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022: Close
[0m00:02:21.751106 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.630 seconds
[0m00:02:21.754865 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m00:02:21.758640 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"
[0m00:02:21.759695 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_DATA_QUALITY_FLAG
    
      
    ) dbt_internal_test
[0m00:02:22.001800 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.091 seconds
[0m00:02:22.005442 [debug] [Thread-2 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
[0m00:02:22.008608 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m00:02:22.009529 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
create or replace transient table ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
         as
        (
    
    



select *
from ASH_DB.STOCK.fact_stock_price_daily
where CLOSE is null



        );
[0m00:02:22.127347 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m00:02:22.131519 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291: Close
[0m00:02:22.218569 [info ] [Thread-3 (]: 29 of 33 PASS not_null_stg_stock_daily_DATE .................................... [[32mPASS[0m in 3.33s]
[0m00:02:22.220785 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022
[0m00:02:22.222072 [debug] [Thread-3 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m00:02:22.223045 [info ] [Thread-3 (]: 32 of 33 START test source_not_null_raw_fact_stock_price_daily_DATE ............ [RUN]
[0m00:02:22.224100 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATE.9dba784022, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198)
[0m00:02:22.224894 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m00:02:22.231784 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m00:02:22.235815 [debug] [Thread-3 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m00:02:22.240228 [debug] [Thread-3 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_DATE"
[0m00:02:22.241458 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m00:02:22.241956 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_DATE" cascade
[0m00:02:22.242436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:02:22.374249 [info ] [Thread-4 (]: 28 of 33 PASS not_null_stg_stock_daily_DATA_QUALITY_FLAG ....................... [[32mPASS[0m in 4.27s]
[0m00:02:22.375261 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291
[0m00:02:22.375801 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m00:02:22.376318 [info ] [Thread-4 (]: 33 of 33 START test source_not_null_raw_fact_stock_price_daily_SYMBOL .......... [RUN]
[0m00:02:22.376931 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_daily_DATA_QUALITY_FLAG.bf0361e291, now test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a)
[0m00:02:22.377355 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m00:02:22.380690 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m00:02:22.381707 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m00:02:22.384476 [debug] [Thread-4 (]: Applying DROP to: "ASH_DB"."STOCK_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_SYMBOL"
[0m00:02:22.385278 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m00:02:22.385615 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
drop table if exists "ASH_DB"."STOCK_TEST_FAILURES"."SOURCE_NOT_NULL_RAW_FACT_STOCK_PRICE_DAILY_SYMBOL" cascade
[0m00:02:22.385977 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:02:22.930769 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.920 seconds
[0m00:02:22.934526 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m00:02:22.938845 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"
[0m00:02:22.939762 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_CLOSE
    
      
    ) dbt_internal_test
[0m00:02:22.944509 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m00:02:22.946313 [debug] [Thread-3 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
[0m00:02:22.948406 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m00:02:22.949121 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
create or replace transient table ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
         as
        (
    
    



select *
from ASH_DB.STOCK.fact_stock_price_daily
where DATE is null



        );
[0m00:02:22.987470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.243 seconds
[0m00:02:22.988848 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m00:02:22.990087 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"
[0m00:02:22.990485 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.not_null_stg_stock_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m00:02:23.172155 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m00:02:23.174035 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178: Close
[0m00:02:23.391837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m00:02:23.395468 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0: Close
[0m00:02:23.403213 [info ] [Thread-2 (]: 31 of 33 PASS source_not_null_raw_fact_stock_price_daily_CLOSE ................. [[32mPASS[0m in 2.51s]
[0m00:02:23.405399 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178
[0m00:02:23.544511 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.158 seconds
[0m00:02:23.545915 [debug] [Thread-4 (]: Applying CREATE to: ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
[0m00:02:23.547356 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m00:02:23.547858 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
create or replace transient table ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
         as
        (
    
    



select *
from ASH_DB.STOCK.fact_stock_price_daily
where SYMBOL is null



        );
[0m00:02:24.161428 [info ] [Thread-1 (]: 30 of 33 PASS not_null_stg_stock_daily_SYMBOL .................................. [[32mPASS[0m in 5.00s]
[0m00:02:24.162922 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0
[0m00:02:24.661311 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m00:02:24.664498 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m00:02:24.667949 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"
[0m00:02:24.668889 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_SYMBOL
    
      
    ) dbt_internal_test
[0m00:02:24.772209 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.822 seconds
[0m00:02:24.776023 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m00:02:24.779923 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"
[0m00:02:24.780837 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from ASH_DB.STOCK_test_failures.source_not_null_raw_fact_stock_price_daily_DATE
    
      
    ) dbt_internal_test
[0m00:02:24.972313 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m00:02:24.974791 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a: Close
[0m00:02:25.220405 [info ] [Thread-4 (]: 33 of 33 PASS source_not_null_raw_fact_stock_price_daily_SYMBOL ................ [[32mPASS[0m in 2.84s]
[0m00:02:25.222600 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a
[0m00:02:25.444206 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m00:02:25.448041 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198: Close
[0m00:02:25.656224 [info ] [Thread-3 (]: 32 of 33 PASS source_not_null_raw_fact_stock_price_daily_DATE .................. [[32mPASS[0m in 3.43s]
[0m00:02:25.657605 [debug] [Thread-3 (]: Finished running node test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198
[0m00:02:25.661156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:25.661617 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_SYMBOL.fcd895ef0a' was properly closed.
[0m00:02:25.661931 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_DATE.5b3410b198' was properly closed.
[0m00:02:25.662237 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_daily_SYMBOL.a95b4130d0' was properly closed.
[0m00:02:25.662541 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_fact_stock_price_daily_CLOSE.b701acb178' was properly closed.
[0m00:02:25.663009 [info ] [MainThread]: 
[0m00:02:25.663689 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 41.84 seconds (41.84s).
[0m00:02:25.666779 [debug] [MainThread]: Command end result
[0m00:02:25.705315 [info ] [MainThread]: 
[0m00:02:25.705987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:02:25.706255 [info ] [MainThread]: 
[0m00:02:25.706565 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 TOTAL=33
[0m00:02:25.708319 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 42.62562, "process_user_time": 4.514104, "process_kernel_time": 0.365, "process_mem_max_rss": "236748", "process_out_blocks": "3230", "process_in_blocks": "0"}
[0m00:02:25.709017 [debug] [MainThread]: Command `dbt test` succeeded at 00:02:25.708932 after 42.63 seconds
[0m00:02:25.709502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c050aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b991760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9f45f0>]}
[0m00:02:25.709816 [debug] [MainThread]: Flushing usage events
